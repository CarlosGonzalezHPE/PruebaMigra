

[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore]


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains]

RuleChainNames=224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain
RuleChainNames=224A.DEG20PrimaryBlackListeSubscriberdRuleChain
RuleChainNames=224B.DEG20FastPathAuthRuleChain
RuleChainNames=224C.DEG20FullAuthRuleChain
RuleChainNames=224D.DEG20GenerateOEMResponseRuleChain
RuleChainNames=224E.DEG20PrimaryCompanionTokenRuleChain
RuleChainNames=224F.DEG20ConnectivityAuthTypeRuleChain
RuleChainNames=224G.DEG20InsertCompanionTokenRuleChain
RuleChainNames=224I.DEG20GenerateBlackListedResponseRuleChain
RuleChainNames=224J.DEG21CheckCustFeatureListRuleChain
RuleChainNames=224K.DEG21CheckDAIRuleChain
RuleChainNames=DAI_DisableCredentials
RuleChainNames=701.DEG20GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain
RuleChainNames=702.DEG20GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain
RuleChainNames=703.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain
RuleChainNames=704.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
RuleChainNames=705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain
RuleChainNames=707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
RuleChainNames=708.DEG20GenerateGetAuthenticationBlackListSubscriberEndAuditDataRuleChain
RuleChainNames=709.DEG20GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ProcessAction


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction]

CheckIfSubscriberBlackListed=500.CheckIfSubscriberBlackListed
CheckIfSubscriberProvisioned=600.CheckIfSubscriberProvisioned
CheckIfSubscriberProvisioned=601.CheckKeyExistsFlag
CheckIfSubscriberProvisioned=700.UpdateSSLSessionTable
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
ExtractImsiFromSubscriberIdAttribute=400.ExtractImsiFromSubscriberIdAttribute
GenerateGetAuthenticationEndAuditData=900.GenerateGetAuthenticationEndAuditData
GenerateGetAuthenticationStartAuditData=1000.MonitorSessionRuleChain
GenerateGetAuthenticationStartAuditData=2000.GenerateGetAuthenticationStartAuditData
GenerateOEMResponse=800.GenerateOEMResponse
GetDataFromDeviceDataTable=3000.GetDataFromDeviceDataTable
InitVariables=1000.InitVariables
Operations=DoAll
ProcessPerAuthType=700.InitVariables
ProcessPerAuthType=710.LookupDEGToken
ProcessPerAuthType=720.CheckDEGToken
SetCustFeaturesListValue=610.SetCustFeaturesListValue
SetCustFeaturesListValue=620.CheckEntitlementStatus
SetCustFeaturesListValue=650.CompareIMSI
TrueRuleChain=InitVariables
TrueRuleChain=ValidateDAIAttribute
TrueRuleChain=ValidateSubscriberIdAttribute
TrueRuleChain=ValidateToken
TrueRuleChain=ValidateUniqueId
TrueRuleChain=ExtractImsiFromSubscriberIdAttribute
TrueRuleChain=GenerateGetAuthenticationStartAuditData
TrueRuleChain=GetDataFromDeviceDataTable
TrueRuleChain=CheckIfSubscriberBlackListed
TrueRuleChain=CheckIfSubscriberProvisioned
TrueRuleChain=SetCustFeaturesListValue
TrueRuleChain=ProcessPerAuthType
TrueRuleChain=GenerateOEMResponse
TrueRuleChain=GenerateGetAuthenticationEndAuditData
ValidateDAIAttribute=000.ValidateDAIAttribute
ValidateSubscriberIdAttribute=100.ValidateSubscriberIdAttribute
ValidateToken=200.ValidateToken
ValidateUniqueId=300.ValidateUniqueId


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/000.ValidateDAIAttribute]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSkipDAICheckString,=,"enabled"
TrueRuleChain=100.ExtractDAIFromRequest
TrueRuleChain=200.ValidateDAIAttribute
TrueRuleChain=300.ValidateDAI


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/000.ValidateDAIAttribute/100.ExtractDAIFromRequest]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
StructuredNMEToNMEMap=device_account_identifier.CData,DEG_OEMDevDAIString,dummy


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/000.ValidateDAIAttribute/200.ValidateDAIAttribute]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevDAIString,=,dummy
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=200.GenerateStartAuditData
TrueRuleChain=210.GenerateErrorEndAudit


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/000.ValidateDAIAttribute/200.ValidateDAIAttribute/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1201"
AdornOps=set DEG_OEMDevErrorMessageString "DAI attribute is missing in the request"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/000.ValidateDAIAttribute/200.ValidateDAIAttribute/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_OEMDevDAIString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid getAuthenticate action - DAI attribute not present: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/000.ValidateDAIAttribute/200.ValidateDAIAttribute/200.GenerateStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/000.ValidateDAIAttribute/200.ValidateDAIAttribute/210.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/000.ValidateDAIAttribute/300.ValidateDAI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevDAIString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=200.GenerateStartAuditData
TrueRuleChain=210.GenerateErrorEndAudit


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/000.ValidateDAIAttribute/300.ValidateDAI/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1202"
AdornOps=set DEG_OEMDevErrorMessageString "DAI is empty in the request"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/000.ValidateDAIAttribute/300.ValidateDAI/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_OEMDevDAIString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid getAuthenticate action - DAI is empty: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/000.ValidateDAIAttribute/300.ValidateDAI/200.GenerateStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/000.ValidateDAIAttribute/300.ValidateDAI/210.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/100.ValidateSubscriberIdAttribute]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
FalseRuleChain=200.SetHttpErrorResponse
FalseRuleChain=210.ErrorLog
FalseRuleChain=230.GenerateGetAuthenticationStartAuditData
FalseRuleChain=220.GenerateErrorEndAudit
Operation=match
RegExPattern=${SUBSCRIBERID_PATTERN}
SourceAttribute=DEG_OEMDevSubscriberIdString


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/100.ValidateSubscriberIdAttribute/200.SetHttpErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1203"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber-id attribute not NAI format"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/100.ValidateSubscriberIdAttribute/210.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid getAuthenticate action - subscriber-id attribute must be in NAI format: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/100.ValidateSubscriberIdAttribute/220.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/100.ValidateSubscriberIdAttribute/230.GenerateGetAuthenticationStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/1000.InitVariables]

AdornOps=set DEG_OEMDevDeviceTypeString "Primary"
AdornOps=set DEG_OEMDevDeviceCountIntegerTbl ${COMPANIONDEVICE_COUNT}
AdornOps=set DEG_OEMDevtempGatewayAddressString ${GATEWAY_ADDRESS_PRIMARY}
AdornOps=lower DEG_OEMDevtempGatewayAddressString DEG_OEMDevGatewayAddressString
AdornOps=set DEG_OEMDevSkipDAICheckString ${DEG_DAI_FEATURE}
AdornOps=lower DEG_OEMDevSkipDAICheckString DEG_OEMDevSkipDAICheckString
AdornOps=set DEG_OEMDevDBTypeString ${DEG_DB_TYPE}
AdornOps=lower DEG_OEMDevDBTypeString DEG_OEMDevDBTypeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/1000.MonitorSessionRuleChain]

ClassName=LocalRuleChainInvoker
RuleChain=400A.ProcessSubscriberExistsResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/200.ValidateToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=130.GenerateGetAuthenticationStartAuditData
TrueRuleChain=120.GenerateErrorEndAudit


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/200.ValidateToken/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1204"
AdornOps=set DEG_OEMDevErrorMessageString "Token is empty"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/200.ValidateToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid getAuthenticate action - token is empty: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/200.ValidateToken/120.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/200.ValidateToken/130.GenerateGetAuthenticationStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/2000.GenerateGetAuthenticationStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/300.ValidateUniqueId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevUniqueIdString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=130.GenerateGetAuthenticationStartAuditData
TrueRuleChain=120.GenerateErrorEndAudit


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/300.ValidateUniqueId/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1205"
AdornOps=set DEG_OEMDevErrorMessageString "UniqueID is empty"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/300.ValidateUniqueId/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_OEMDevUniqueIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid getAuthenticate action - UniqueID is empty: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/300.ValidateUniqueId/120.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/300.ValidateUniqueId/130.GenerateGetAuthenticationStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/3000.GetDataFromDeviceDataTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVariables
RuleNames=110.LookupDeviceDataTable


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/3000.GetDataFromDeviceDataTable/100.InitVariables]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=copy DEG_OEMDevUniqueIDString DEG_UNIQUE_ID
AdornOps=set DEG_ENTITLEMENT_NAME ${VOWIFI_ENTITLEMENT_NAME}
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/3000.GetDataFromDeviceDataTable/110.LookupDeviceDataTable]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223O.DEG30GetDeviceDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/400.ExtractImsiFromSubscriberIdAttribute]

AdornOps=substr "0" "@" DEG_OEMDevSubscriberIdString DEG_OEMDevImsiString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/500.CheckIfSubscriberBlackListed]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224A.DEG20PrimaryBlackListeSubscriberdRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/600.CheckIfSubscriberProvisioned]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400.GetSubscriberProfileRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=CUST_GSP_OUT_JSON_Response_Code_String,!=,"0"
Conditions=CUST_GSP_OUT_Reset_GetAuth_Flag_Integer,=,1
Conditions=CUST_GSP_OUT_Reset_IMS_Flag_Integer,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
DBConnectionError=100.SetErrorInfo
DBConnectionError=110.ErrorLog
DeleteRowFromTable=200.DeleteCompanionTokenTable
DeleteRowFromTable=200.DeleteDeviceDataTable
Operations=None
ResetIMSTable=300.CheckAndResetIMSDataWithImsi
SetCarrierResponse=130.SetHTTPErrorResponse
SetCarrierResponse=140.SetErrorResponse
SetCarrierResponse=150.CallGetAuthenticationDisallowedActionEndAuditDataRuleChain
SubscriberExist=300.ProcessSubscriberExistsResponse
SubscriberExist=310.CheckMsessionKeyFlag
SubscriberExist=300.setErrorInfo
TrueRuleChain=DBConnectionError
TrueRuleChain=SetCarrierResponse
TrueRuleChain=DeleteRowFromTable
TrueRuleChain=ResetIMSTable
TrueRuleChain=UnknownSubscriber
TrueRuleChain=SubscriberExist
UnknownSubscriber=100.UnknownSubscriber_GenerateResponse
UnknownSubscriber=101.SetTransactionType
UnknownSubscriber=110.GenerateGetAuthenticationUnknownSubscriberEndAuditData


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1206"
AdornOps=set DEG_OEMDevErrorMessageString "Failed to get subscriber profile information"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/100.UnknownSubscriber_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/101.SetTransactionType]

AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Error: Failed to get subscriber profile information from 400.GetSubscriberProfileRuleChain :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/110.GenerateGetAuthenticationUnknownSubscriberEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/130.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=setifnull CUST_GSP_OUT_SSL_STATE_String ""
AdornOps=copy CUST_GSP_OUT_SSL_STATE_String DEG_SSL_STATE
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=copy CUST_GSP_OUT_JSON_Response_Code_String DEG_OEMDevRespStatusString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1216"
AdornOps=set DEG_OEMDevErrorMessageString "Get Auth error response is set in custom code"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/140.SetErrorResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/150.CallGetAuthenticationDisallowedActionEndAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=709.DEG20GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteCompanionTokenTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitDeleteSession
RuleNames=300.ExecuteDeleteSession
RuleNames=400.CheckDeleteSessionStatus


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteCompanionTokenTable/100.InitDeleteSession]

AdornOps=set log_DB_Operation "DELETE"
AdornOps=set log_Table_Name "DEG_COMPANION_TOKENS"
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteCompanionTokenTable/300.ExecuteDeleteSession]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
NativeCondition=1.MatchByImsi
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_COMPANION_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteCompanionTokenTable/400.CheckDeleteSessionStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
DBError=105.LogDBErrorInfo
DBError=110.LogDBError
Operations=None
SubscriberDoesNotExist=102.SetErrorInfo
SubscriberDoesNotExist=200.LogSubscriberDoesNotExist
TrueRuleChain=DBError
TrueRuleChain=SubscriberDoesNotExist


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteCompanionTokenTable/400.CheckDeleteSessionStatus/102.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1209"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber IMSI does not exist in DEG_COMPANION_TOKENS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteCompanionTokenTable/400.CheckDeleteSessionStatus/105.LogDBErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1208"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to delete from DEG_COMPANION_TOKENS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteCompanionTokenTable/400.CheckDeleteSessionStatus/110.LogDBError]

Attributes=log_Table_Name
Attributes=log_DB_Operation
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to delete from DEG_COMPANION_TOKENS table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteCompanionTokenTable/400.CheckDeleteSessionStatus/200.LogSubscriberDoesNotExist]

Attributes=log_Table_Name
Attributes=log_DB_Operation
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Subscriber IMSI does not exist in DEG_COMPANION_TOKENS table :
NullAlso=true
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteDeviceDataTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitDeviceDataUpdate
RuleNames=200.DeleteDeviceDataTable
RuleNames=300.CheckDeleteStatus


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteDeviceDataTable/100.InitDeviceDataUpdate]

AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteDeviceDataTable/200.DeleteDeviceDataTable]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
NativeCondition=1.MatchByIMSI
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteDeviceDataTable/300.CheckDeleteStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SystemError_SetResponse
TrueRuleChain=110.SystemError_Log


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteDeviceDataTable/300.CheckDeleteStatus/100.SystemError_SetResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1210"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteDeviceDataTable/300.CheckDeleteStatus/110.SystemError_Log]

Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
Message=Unable to perform delete operation on DEG_DEVICE_DATA table: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteDeviceDataTable/300.CheckDeleteStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteDeviceDataTable/300.CheckDeleteStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1211"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/200.DeleteDeviceDataTable/300.CheckDeleteStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Database Error: No data in DEG_DEVICE_DATA session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DeviceIdListLength,=,PrivateIdListLength
Conditions=DeviceIdListLength,=,PublicIdListLength
Conditions=DeviceIdListLength,=,SipUsernameListLength
Conditions=DeviceIdListLength,=,SipPasswordListLength
FalseRuleChain=300.ListLengthMismatchError
Operations=and,and,and
TrueRuleChain=100.DeleteIMSDataWithImsi
TrueRuleChain=200.CheckListAndInsert


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/100.DeleteIMSDataWithImsi]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.InitializeVariables
RuleNames=120.DeleteIMSData
RuleNames=130.CheckErrorFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/100.DeleteIMSDataWithImsi/110.InitializeVariables]

AdornOps=set log_DB_Operation "DELETE"
AdornOps=set log_Table_Name "DEG_IMS_DATA"
AdornOps=set DEG_SubProvSessionStoreErrorFlagInteger 0
AdornOps=set DEG_SubProvSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/100.DeleteIMSDataWithImsi/120.DeleteIMSData]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
NativeCondition=1.MatchByIMSI
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_IMS_DATA_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/100.DeleteIMSDataWithImsi/130.CheckErrorFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,!=,0
TrueRuleChain=110.SetErrorInfo
TrueRuleChain=120.SetErrorLog


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/100.DeleteIMSDataWithImsi/130.CheckErrorFlag/110.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1212"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/100.DeleteIMSDataWithImsi/130.CheckErrorFlag/120.SetErrorLog]

Attributes=DEG_IMSI
Attributes=DEG_ENTITLEMENT_NAME
Attributes=DEG_PROVISIONING_STATUS
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_SSL_REQUEST_STATE
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform Update or access DEG_IMS_DATA table
NullAlso=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DeviceIdListLength,>,0
TrueRuleChain=200.ExtractOutListVariablesAndInsert


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert]

ClassName=ListAttributeIterator
ListAttributeName=CUST_GSP_OUT_IMS_DEVICE_ID_List
ListAttributeName=CUST_GSP_OUT_IMS_PRIVATE_ID_List
ListAttributeName=CUST_GSP_OUT_IMS_PUBLIC_ID_List
ListAttributeName=CUST_GSP_OUT_IMS_SIP_USERNAME_List
ListAttributeName=CUST_GSP_OUT_IMS_SIP_PASSWORD_List
RuleChain=100.CheckLog
RuleChain=100.SetErrorInfo
RuleChain=100.InsertIntoImsData
TmpAttributeName=DEG_DEVICE_ID
TmpAttributeName=DEG_IMS_PRIVATE_ID
TmpAttributeName=DEG_IMS_PUBLIC_ID
TmpAttributeName=DEG_SIP_USERNAME
TmpAttributeName=DEG_SIP_PASSWORD


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.CheckLog]

Attributes=DEG_DEVICE_ID
Attributes=DEG_IMS_PRIVATE_ID
Attributes=DEG_SIP_USERNAME
Attributes=DEG_IMS_PUBLIC_ID
Attributes=DEG_SIP_PASSWORD
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=<<<<<CheckLog::>>>>>


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.InsertIntoImsData]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitializeVariables
RuleNames=110.CreateIMSData
RuleNames=120.CheckErrorFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.InsertIntoImsData/100.InitializeVariables]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=setifnull DEG_OEMDevSipUserNameString ""
AdornOps=setifnull DEG_OEMDevSipPasswordString ""
AdornOps=setifnull DEG_OEMDevPublicIDString ""
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_IMS_DATA"
AdornOps=set DEG_UNIQUE_ID ""
AdornOps=setsystime DEG_PROVTIME
AdornOps=setsystime DEG_LASTUPDATE
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.InsertIntoImsData/110.CreateIMSData]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_IMS_DATA_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.InsertIntoImsData/120.CheckErrorFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.InsertIntoImsData/120.CheckErrorFlag/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1214"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.InsertIntoImsData/120.CheckErrorFlag/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_DEVICE_ID
Attributes=DEG_SIP_PASSWORD
Attributes=DEG_SIP_USERNAME
Attributes=DEG_IMS_PUBLIC_ID
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to create entry in DEG_IMS_DATA session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.1213"
AdornOps=set DEG_OEMDevMessageString "<<<<<CheckLog::>>>>>"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/300.ListLengthMismatchError]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetHTTPErrorResponse
RuleNames=110.ErrorLog


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/300.ListLengthMismatchError/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRespStatusString 6005
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1215"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_IMS_DATA table"
AdornOps=set DEG_OEMDevSetProvisioningRequestProcessedInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/300.ListLengthMismatchError/110.ErrorLog]

Attributes=DeviceIdListLength
Attributes=PublicIdListLength
Attributes=SipUsernameListLength
Attributes=SipPasswordListLength
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=LIST Length Mismatch while updating DEG_IMS_DATA table :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.ProcessSubscriberExistsResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Row found from DEG_SUBSCRIBERS table
NullAlso=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/300.setErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.1207"
AdornOps=set DEG_OEMDevMessageString "Row found from DEG_SUBSCRIBERS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/310.CheckMsessionKeyFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SessionKeyInteger,=,1
TrueRuleChain=100.CopyMDNToMSessionKey
TrueRuleChain=200.QueryMonitoredSessionsMDN


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/310.CheckMsessionKeyFlag/100.CopyMDNToMSessionKey]

ClassName=ConditionalRule
Conditions=DEG_OEMDevRespPhoneNumberString,=,""
FalseRuleChain=200.CopyRespPhoneNumberToMDN
TrueRuleChain=100.CopyDirect


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/310.CheckMsessionKeyFlag/100.CopyMDNToMSessionKey/100.CopyDirect]

AdornOps=set DEG_NrbMonitoringSessionIdList null
AdornOps=copy DEG_MDN DEG_MSESSIONKEY
AdornOps=copy DEG_MDN DEG_OEMDevRespPhoneNumberString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/310.CheckMsessionKeyFlag/100.CopyMDNToMSessionKey/200.CopyRespPhoneNumberToMDN]

AdornOps=copy DEG_MDN DEG_OEMDevRespPhoneNumberString
AdornOps=copy DEG_MDN DEG_MSESSIONKEY
AdornOps=set DEG_NrbMonitoringSessionIdList null
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/601.CheckKeyExistsFlag/310.CheckMsessionKeyFlag/200.QueryMonitoredSessionsMDN]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessions


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/610.SetCustFeaturesListValue]

AdornOps=setifnull DEG_EntitlementStatus ""
AdornOps=copy DEG_EntitlementStatus DEG_SSL_ENTITLEMENTSTATUS
AdornOps=setifnull DEG_OEMDevDeviceCountIntegerTbl 0
AdornOps=copy DEG_OEMDevDeviceCountIntegerTbl DEG_SSL_COMPANION_DEVICE_COUNT
AdornOps=setifnull DEG_SSL_CUSTOM_FIELD ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/620.CheckEntitlementStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_EntitlementStatus,=,""
FalseRuleChain=300.CleanUpRule
TrueRuleChain=100.InitDeviceDataDelete
TrueRuleChain=200.ExecuteDeviceDataDelete


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/620.CheckEntitlementStatus/100.InitDeviceDataDelete]

AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/620.CheckEntitlementStatus/200.ExecuteDeviceDataDelete]

ClassName=com.hp.siu.sessionserver.rules.PurgeSessionsRule
PurgeConditions=DEG_IMSI,=,%DEG_IMSI
SessionStore=DEG_DEVICE_DATA_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/620.CheckEntitlementStatus/300.CleanUpRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=010.DEG21ReadDeviceDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/650.CompareIMSI]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=011.DEG21ReadDeviceDataRuleChainBycomparingIMSI
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/700.InitVariables]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_TOKENS"
AdornOps=copy DEG_MDN DEG_CDevMobileNumberString
AdornOps=set DEG_CDevTokenString ""
AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_OEMDevFastAuthFlag 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/700.UpdateSSLSessionTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/700.UpdateSSLSessionTable/100.InitUpdate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=setifnull DEG_OEMDevCustomMschapUsernameString ""
AdornOps=setifnull DEG_OEMDevCustomMschapPasswordString ""
AdornOps=copy DEG_OEMDevCustomMschapUsernameString DEG_SSL_MSCHAP_USERNAME
AdornOps=copy DEG_OEMDevCustomMschapPasswordString DEG_SSL_MSCHAP_PASSWORD
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_SSL_SESSION"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/700.UpdateSSLSessionTable/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_MSCHAP_USERNAME,DEG_SSL_MSCHAP_USERNAME
MapAttributes=DEG_SSL_MSCHAP_PASSWORD,DEG_SSL_MSCHAP_PASSWORD
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/700.UpdateSSLSessionTable/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateErrorEndAudit


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/700.UpdateSSLSessionTable/300.CheckUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1217"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/700.UpdateSSLSessionTable/300.CheckUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_SSL_SESSION session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/700.UpdateSSLSessionTable/300.CheckUpdateStatus/120.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/700.UpdateSSLSessionTable/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/700.UpdateSSLSessionTable/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1218"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/700.UpdateSSLSessionTable/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_SSL_SESSION session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/710.LookupDEGToken]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_AUTHENTICATION_TYPE,DEG_AUTHENTICATION_TYPE
MapAttributes=DEG_AUTHENTICATION_SUBTYPE,DEG_AUTHENTICATION_SUBTYPE
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckTokenTimeStamp
FalseRuleChain=210.CheckGBAAuthType
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateGetAuthenticationSystemErrorEndAuditData


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken/100.SetHTTPErrorResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1219"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_TOKENS table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken/120.GenerateGetAuthenticationSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken/200.CheckTokenTimeStamp]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=210D.DEG20CheckTokenTimeStampRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken/210.CheckGBAAuthType]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAuthTypeString,=,"GBA"
FalseRuleChain=210.GetToken
TrueRuleChain=100.ProcessGBARuleChain
TrueRuleChain=200.GenerateAuthorizationInfoResponseHeader


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken/210.CheckGBAAuthType/100.ProcessGBARuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300.BSFProcessingRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken/210.CheckGBAAuthType/200.GenerateAuthorizationInfoResponseHeader]

ClassName=ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=GenerateAuthorizationInfoHeader


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken/210.CheckGBAAuthType/200.GenerateAuthorizationInfoResponseHeader/GenerateAuthorizationInfoHeader]

AdornOps=set DEG_OEMDevAuthenticationInfoString "rspauth="
AdornOps=setifnull DEG_OEMDevGBArspauthString ""
AdornOps=+ DEG_OEMDevAuthenticationInfoString " DEG_OEMDevAuthenticationInfoString 
AdornOps=+ DEG_OEMDevAuthenticationInfoString DEG_OEMDevGBArspauthString DEG_OEMDevAuthenticationInfoString
AdornOps=+ DEG_OEMDevAuthenticationInfoString ",qop=" DEG_OEMDevAuthenticationInfoString
AdornOps=+ DEG_OEMDevAuthenticationInfoString DEG_OEMDevQOPString DEG_OEMDevAuthenticationInfoString
AdornOps=+ DEG_OEMDevAuthenticationInfoString ",cnonce= DEG_OEMDevAuthenticationInfoString
AdornOps=+ DEG_OEMDevAuthenticationInfoString DEG_OEMDevCNONCEString DEG_OEMDevAuthenticationInfoString
AdornOps=+ DEG_OEMDevAuthenticationInfoString ,nc= DEG_OEMDevAuthenticationInfoString
AdornOps=+ DEG_OEMDevAuthenticationInfoString DEG_OEMDevRequestNCString DEG_OEMDevAuthenticationInfoString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken/210.CheckGBAAuthType/210.GetToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
FalseRuleChain=200.EAPAKAAuth
TrueRuleChain=100.CheckSubType


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken/210.CheckGBAAuthType/210.GetToken/100.CheckSubType]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"DFT"
Conditions=DEG_OEMDevFastAuthFlag,=,0
FalseRuleChain=200.CheckAuthToken
Operations=or
TrueRuleChain=100.EAPAKAAuth


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken/210.CheckGBAAuthType/210.GetToken/100.CheckSubType/100.EAPAKAAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224C.DEG20FullAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken/210.CheckGBAAuthType/210.GetToken/100.CheckSubType/200.CheckAuthToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevFastAuthFlag,=,1
Conditions=DEG_TOKENSTATUS,=,"AE"
Conditions=DEG_OEMDevTokenString,=,DEG_SUBSTOKEN
FalseRuleChain=200.EAPAKAAuth
Operations=and,and,and
TrueRuleChain=100.FastPathAuth


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken/210.CheckGBAAuthType/210.GetToken/100.CheckSubType/200.CheckAuthToken/100.FastPathAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224B.DEG20FastPathAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken/210.CheckGBAAuthType/210.GetToken/100.CheckSubType/200.CheckAuthToken/200.EAPAKAAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224C.DEG20FullAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/720.CheckDEGToken/210.CheckGBAAuthType/210.GetToken/200.EAPAKAAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224C.DEG20FullAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/800.GenerateOEMResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224D.DEG20GenerateOEMResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/900.GenerateGetAuthenticationEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,!=,UNKNOWN_SUBSCRIBER
Description=Unknown Subscriber case already Handled
Operations=or
TrueRuleChain=100.CheckAuthenticationState


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/900.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState]

AkaRejected=100.GenerateGetAuthenticationAkaRejectedEndAuditData
AkaWait=200.GenerateGetAuthenticationAkaWaitEndAuditData
AuthenticatedAAA=300.GenerateGetAuthenticationAAAAuthenticatedEndAuditData
AuthenticatedDEGToken=400.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditData
BlackListSubscriber=500.GenerateGetAuthenticationBlackListSubscriberEndAuditData
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=None
StatusDisallowed=600.GenerateGetAuthenticationDisallowedActionEndAuditData
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=AuthenticatedAAA
TrueRuleChain=AuthenticatedDEGToken
TrueRuleChain=BlackListSubscriber
TrueRuleChain=StatusDisallowed


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/900.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState/100.GenerateGetAuthenticationAkaRejectedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/900.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState/200.GenerateGetAuthenticationAkaWaitEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=702.DEG20GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/900.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState/300.GenerateGetAuthenticationAAAAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=701.DEG20GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/900.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState/400.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"TKN"
FalseRuleChain=200.GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditData
TrueRuleChain=100.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditData


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/900.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState/400.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditData/100.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=703.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/900.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState/400.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditData/200.GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=704.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/900.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState/500.GenerateGetAuthenticationBlackListSubscriberEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=708.DEG20GenerateGetAuthenticationBlackListSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain/100.ProcessAction/900.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState/600.GenerateGetAuthenticationDisallowedActionEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=709.DEG20GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain]

ClassName=RuleChain
RuleNames=100.InitVariables
RuleNames=200.CheckIfBlackListEnabled


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/100.InitVariables]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_TOKENS"
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=setifnull DEG_MDN 0
AdornOps=setifnull DEG_BLACKLIST_FLAG 0
AdornOps=setifnull DEG_AUTH_COUNT 0
AdornOps=set DEG_EVENTTIMESTAMP 0
AdornOps=set DEG_FULLAUTHTIMESTAMP 0
AdornOps=set DEG_BLACKLISTWINDOW_STARTTIME 0
AdornOps=set DEG_OEMDevBlacklistStatusString ${DEG_BLACKLIST_STATUS}
AdornOps=lower DEG_OEMDevBlacklistStatusString DEG_OEMDevBlacklistStatusString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled]

ClassName=ConditionalRule
Conditions=DEG_OEMDevBlacklistStatusString,=,"enabled"
TrueRuleChain=200.LookupDEGToken
TrueRuleChain=300.CheckDEGToken
TrueRuleChain=400.UpdateDEGToken


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/200.LookupDEGToken]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
MapAttributes=DEG_BLACKLISTWINDOW_STARTTIME,DEG_BLACKLISTWINDOW_STARTTIME
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckIfSessionKeyExists
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateGetAuthenticationSystemErrorEndAuditData


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1227"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_TOKENS table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/120.GenerateGetAuthenticationSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
FalseRuleChain=200.TokenFound
TrueRuleChain=100.TokenNotFound


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/100.TokenNotFound]

AdornOps=set DEG_AUTH_COUNT 0
AdornOps=setsystime DEG_BLACKLISTWINDOW_STARTTIME
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckIfSubscriberIsBlacklisted
RuleNames=200.CheckAndUpdateAuthCount


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted]

ClassName=ConditionalRule
Conditions=DEG_BLACKLIST_FLAG,=,1
TrueRuleChain=100.SetBlackListedResponse


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GetDifference
RuleNames=200.CheckDOAWindow


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/100.GetDifference]

AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=set DEG_OEMDevDenialOfActionWindowLong ${DENIAL_OF_ACTION_WINDOW}
AdornOps=copy DEG_BLACKLISTWINDOW_STARTTIME DEG_OEMDevDOAStartTimeLong
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_OEMDevDOAStartTimeLong DEG_OEMDevTimeStampDiffLong
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/200.CheckDOAWindow]

ClassName=ConditionalRule
Conditions=DEG_OEMDevTimeStampDiffLong,<,DEG_OEMDevDenialOfActionWindowLong
FalseRuleChain=200.ResetAuthCount
TrueRuleChain=100.GenerateBlackListedResponse
TrueRuleChain=200.LogBlackListSubscriber


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/200.CheckDOAWindow/100.GenerateBlackListedResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224I.DEG20GenerateBlackListedResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/200.CheckDOAWindow/200.LogBlackListSubscriber]

Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_BLACKLISTWINDOW_STARTTIME
Attributes=DEG_OEMDevImsiString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=Subscriber is blacklisted :
NullAlso=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/200.CheckDOAWindow/200.ResetAuthCount]

AdornOps=set DEG_BLACKLIST_FLAG 0
AdornOps=set DEG_AUTH_COUNT 0
AdornOps=setsystime DEG_BLACKLISTWINDOW_STARTTIME
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount]

ClassName=ConditionalRule
Conditions=DEG_BLACKLIST_FLAG,=,0
TrueRuleChain=VerifyIfSubscriberBlacklisted


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted]

ClassName=RuleChain
RuleNames=100.GetDifference
RuleNames=200.CheckEventTimeStamp


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/100.GetDifference]

AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=copy DEG_BLACKLISTWINDOW_STARTTIME DEG_OEMDevBlackListWindowStartTimeLong
AdornOps=set DEG_OEMDevBlackListWindowLong ${BLACKLIST_TIMEWINDOW}
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_OEMDevBlackListWindowStartTimeLong DEG_OEMDevTimeStampDiffLong
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTimeStampDiffLong,<,DEG_OEMDevBlackListWindowLong
FalseRuleChain=200.ResetAuthCount
TrueRuleChain=000.GetAuthThresholdCount
TrueRuleChain=100.UpdateAuthCount
TrueRuleChain=200.CheckAuthCount


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequest
RuleNames=110.ReadValue
RuleNames=120.CheckErrorAndNoMatchFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/100.InitRequest]

AdornOps=set DEG_OEMDevLicenseTypeString "EAP"
AdornOps=set DEG_OEMDevAuthThresholdCountInteger 0
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_OEMDevLicenseTypeString
ResponseAttributes=DEG_OEMDevAuthThresholdCountInteger
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=004.ReadTokenLifeTimeRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
FalseRuleChain=210.SetErrorForLog
FalseRuleChain=220.ErrorLog
TrueRuleChain=100.CheckIfKeyExist


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
FalseRuleChain=210.SetErrorForLog
FalseRuleChain=220.RowNotExistsLog


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/210.SetErrorForLog]

AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/220.RowNotExistsLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=No Row Found in DEG_LIC_LIMITS cache: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag/210.SetErrorForLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1228"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag/220.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to access DEG_LIC_LIMITS cache
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/100.UpdateAuthCount]

AdornOps=+ DEG_AUTH_COUNT 1 DEG_AUTH_COUNT
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.CheckAuthCount]

ClassName=ConditionalRule
Conditions=DEG_AUTH_COUNT,>,DEG_OEMDevAuthThresholdCountInteger
TrueRuleChain=100.SetBlackListed
TrueRuleChain=200.SendBlacklistResponse
TrueRuleChain=300.LogBlackListSubscriber


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.CheckAuthCount/100.SetBlackListed]

AdornOps=set DEG_BLACKLIST_FLAG 1
AdornOps=setsystime DEG_BLACKLISTWINDOW_STARTTIME
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1230"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber is blacklisted"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.CheckAuthCount/200.SendBlacklistResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224I.DEG20GenerateBlackListedResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.CheckAuthCount/300.LogBlackListSubscriber]

Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_BLACKLISTWINDOW_STARTTIME
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=Subscriber is blacklisted :
NullAlso=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.ResetAuthCount]

AdornOps=set DEG_AUTH_COUNT 1
AdornOps=setsystime DEG_BLACKLISTWINDOW_STARTTIME
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.SetLogInfo
RuleNames=000.LogRule
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/000.LogRule]

Attributes=DEG_IMSI
Attributes=DEG_BLACKLISTWINDOW_STARTTIME
Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
ClassName=LogNMERule
LogLevel=DEBUG
Message=While updating DEG_TOKENS table :
NullAlso=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/000.SetLogInfo]

AdornOps=set DEG_OEMDevErrorMessageString "updating DEG_TOKENS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/100.InitUpdate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_TOKENS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/200.Update]

ClassName=ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
TrueRuleChain=UpdateTokenstable


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/200.Update/UpdateTokenstable]

ClassName=UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_BLACKLISTWINDOW_STARTTIME,DEG_BLACKLISTWINDOW_STARTTIME
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=000.SetErrorInfo
TrueRuleChain=100.SystemErrorLog


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/300.CheckUpdateStatus/000.SetErrorInfo]

AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_TOKENS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224A.DEG20PrimaryBlackListeSubscriberdRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/300.CheckUpdateStatus/100.SystemErrorLog]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while updating DEG_TOKENS table :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224B.DEG20FastPathAuthRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetSessionStatus
RuleNames=200.LogFastPathAuth
RuleNames=600.SetErrorInfo


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224B.DEG20FastPathAuthRuleChain/100.SetSessionStatus]

AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "TKN"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224B.DEG20FastPathAuthRuleChain/200.LogFastPathAuth]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_AUTH_COUNT
Attributes=DEG_OEMDevAuthThresholdCountInteger
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Perform FastPathAuth: 
NullAlso=true
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224B.DEG20FastPathAuthRuleChain/600.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.1220"
AdornOps=set DEG_OEMDevMessageString "Perform FastPathAuth:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain]

ClassName=RuleChain
RuleNames=100.InitRequestVariables
RuleNames=200.ReadValue
RuleNames=300.CheckErrorAndNoMatchFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/100.InitRequestVariables]

AdornOps=set DEG_CDevSysParameter "EAPAKAAuth"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/200.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
Conditions=DEG_CDevSysValueString,=,"Enabled"
Conditions=DEG_OEMDevEAPAKAAuthRequiredFlagString,=,"Y"
FalseRuleChain=200.SetSessionStatus
FalseRuleChain=210.LogEAPAKAAtuhDisabled
Operations=and,and,and
TrueRuleChain=100.AAAProcessingRule
TrueRuleChain=111.SetErrorInfo
TrueRuleChain=110.LogEAPAKAAtuhEnabled
TrueRuleChain=120.UpdateTokenTable


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/100.AAAProcessingRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_OEMDevSubscriberIdString
RequestAttributes=DEG_OEMDevEAPPayloadBinary
RequestAttributes=DEG_SSL_NAI
ResponseAttributes=DEG_OEMDevRequestIdString
ResponseAttributes=DEG_SSL_STATE
ResponseAttributes=DEG_SSL_AAA_STATE
ResponseAttributes=DEG_AUTHENTICATION_TYPE
ResponseAttributes=DEG_AUTHENTICATION_SUBTYPE
ResponseAttributes=DEG_OEMDevEAPPayloadBinary
RuleChain=301.AAAProcessingRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/110.LogEAPAKAAtuhEnabled]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_SSL_STATE
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Perform EAPAKAAtuh Enable: 
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/111.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.1221"
AdornOps=set DEG_OEMDevMessageString "Perform EAPAKAAtuh Enable"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
TrueRuleChain=100.InitUpdate
TrueRuleChain=200.Update
TrueRuleChain=300.CheckUpdateStatus


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/100.InitUpdate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=setifnull DEG_BLACKLIST_FLAG 0
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_TOKENS"
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateErrorEndAudit


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1222"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_TOKENS session store during blacklist processing
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/120.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1223"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_TOKENS BLACKLISTED session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/200.SetSessionStatus]

AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "DFT"
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_OEMDevErrorMessageString "EAPAKAAtuh Disabled or Transient System Error"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1224" 
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224C.DEG20FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/210.LogEAPAKAAtuhDisabled]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_CDevSysValueString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Perform EAPAKAAtuh Disabled:
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateOEMResponse


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse]

AkaRejected=300.AkaRejected_InitResponse
AkaRejected=310.AkaRejected_DeactiveToken
AkaRejected=320.AkaRejected_GenerateResponse
AkaWait=200.AkaWait_InitResponse
AkaWait=210.AkaWait_GenerateResponse
Authenticated=400.Authenticated_InitResponse
Authenticated=405.Authenticated_UserAgent
Authenticated=410.Authenticated_StoreToken
Authenticated=415.Authenticated_CheckDAI
Authenticated=420.Authenticated_CompanionData
Authenticated=430.Authenticated_DeviceData
Authenticated=440.Authenticated_ConnectivityAuthType
Authenticated=450.Authenticated_GenerateResponse
BlacListedSubscriber=600.BlackListedSubscriber_InitResponse
BlacListedSubscriber=610.BlackListedSubscriber_GenerateResponse
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Conditions=DEG_SSL_STATE,starts,"AUTHENTICATED"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE
Operations=None
StatusDisallowed=600.DisallowedAction_InitResponse
StatusDisallowed=610.DisallowedAction_GenerateResponse
TrueRuleChain=UnknownSubscriber
TrueRuleChain=BlacListedSubscriber
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=StatusDisallowed
TrueRuleChain=Authenticated
TrueRuleChain=Unknown
Unknown=500.Unknown_SetHttpErrorResponseTo500C
UnknownSubscriber=100.UnknownSubscriber_InitResponse
UnknownSubscriber=110.UnknownSubscriber_GenerateResponse


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/100.UnknownSubscriber_InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 6004
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/110.UnknownSubscriber_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/200.AkaWait_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "200"
AdornOps=set DEG_OEMDevRespStatusString 6302
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/210.AkaWait_GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodePayload
FalseRuleChain=210.GenerateResponse
TrueRuleChain=100.GenerateNullPayloadResponse


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/210.AkaWait_GenerateResponse/100.GenerateNullPayloadResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/210.AkaWait_GenerateResponse/200.EncodePayload]

AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/210.AkaWait_GenerateResponse/210.GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevEAPPayloadString,jsonResponse.challenge.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/210.AkaWait_GenerateResponse/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/300.AkaRejected_InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 6300
AdornOps=set DEG_TOKENSTATUS "DE"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaRejected_DeactiveToken]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/320.AkaRejected_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/400.Authenticated_InitResponse]

AdornOps=set DEG_APP_TOKEN_FLAG 1
AdornOps=set DEG_OEMDevRespStatusString 6000
AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEG_OEMDevRespTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEG_CDevTokenString
AdornOps=set DEG_OEMDevtempEntitlementServerAddressString ${ENTITLEMENT_SERVERADDRESS}
AdornOps=lower DEG_OEMDevtempEntitlementServerAddressString DEG_OEMDevEntitlementServerAddressString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/405.Authenticated_UserAgent]

ClassName=RuleChain
RuleNames=100.CopyCoreNMEToCustNME
RuleNames=200.CallUserAgentCustomTemplate
RuleNames=205.CheckoutuserAgentValues


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/405.Authenticated_UserAgent/100.CopyCoreNMEToCustNME]

AdornOps=setifnull CUST_GAC_OUT_UserAgentString ""
AdornOps=copy DEG_OEMDevUserAgentString DEG_USER_AGENT
AdornOps=copy DEG_OEMDevUserAgentString CUST_GAC_IN_UserAgentString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/405.Authenticated_UserAgent/200.CallUserAgentCustomTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_Apple_GA_UserAgentUpdate
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/405.Authenticated_UserAgent/205.CheckoutuserAgentValues]

AdornOps=copy CUST_GAC_OUT_UserAgentString DEG_OEMDevUserAgentString 
AdornOps=copy CUST_GAC_OUT_UserAgentString DEG_USER_AGENT
AdornOps=copy DEG_OEMDevUniqueIdString DEG_UNIQUE_ID
AdornOps=copy CUST_GAC_OUT_UserAgentString DEG_AuditUserAgentString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/410.Authenticated_StoreToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevMobileNumberString
RequestAttributes=DEG_IMSI
RequestAttributes=DEG_CDevTokenString
RequestAttributes=DEG_AUTHENTICATION_TYPE
RequestAttributes=DEG_AUTHENTICATION_SUBTYPE
RequestAttributes=DEG_APP_TOKEN_FLAG
RequestAttributes=DEG_FULLAUTHTIMESTAMP
ResponseAttributes=DEG_OEMDevErrorMessageString
ResponseAttributes=DEG_EVENTTIMESTAMP
ResponseAttributes=DEG_DAI
RuleChain=005.StoreTokenRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/415.Authenticated_CheckDAI]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224K.DEG21CheckDAIRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/420.Authenticated_CompanionData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224J.DEG21CheckCustFeatureListRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/430.Authenticated_DeviceData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=007.DEG20ReadEntitlementFCMappingNameRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/440.Authenticated_ConnectivityAuthType]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224F.DEG20ConnectivityAuthTypeRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/450.Authenticated_GenerateResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RUleNames=100.CheckEAPPayload
RuleNames=300.GenerateResponse


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/450.Authenticated_GenerateResponse/100.CheckEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodePayload
TrueRuleChain=100.GenerateNullPayloadResponse


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/450.Authenticated_GenerateResponse/100.CheckEAPPayload/100.GenerateNullPayloadResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
NMEToStructuredNMEMap=DEG_OEMDevRespTokenString,jsonResponse.token.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/450.Authenticated_GenerateResponse/100.CheckEAPPayload/200.EncodePayload]

AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/450.Authenticated_GenerateResponse/100.CheckEAPPayload/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/450.Authenticated_GenerateResponse/300.GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
NMEToStructuredNMEMap=DEG_OEMDevRespTokenString,jsonResponse.token.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/500.Unknown_SetHttpErrorResponseTo500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/600.BlackListedSubscriber_InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 6300
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/600.DisallowedAction_InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 6002
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/610.BlackListedSubscriber_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224D.DEG20GenerateOEMResponseRuleChain/100.GenerateOEMResponse/610.DisallowedAction_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224E.DEG20PrimaryCompanionTokenRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=200.CheckCompanionCount


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224E.DEG20PrimaryCompanionTokenRuleChain/200.CheckCompanionCount]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevDeviceCountIntegerTblTemp,>,0
Conditions=DEG_OEMDevEntitlementListFlagInteger,=,1
Operations=and
TrueRuleChain=100.ReadTokenLifeTime
TrueRuleChain=200.LookupCompanionTable


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224E.DEG20PrimaryCompanionTokenRuleChain/200.CheckCompanionCount/100.ReadTokenLifeTime]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequest
RuleNames=110.ReadValue
RuleNames=120.CheckErrorAndNoMatchFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224E.DEG20PrimaryCompanionTokenRuleChain/200.CheckCompanionCount/100.ReadTokenLifeTime/100.InitRequest]

AdornOps=set DEG_OEMDevLicenseTypeString "ST"
AdornOps=set DEG_OEMDevTokenLifetimeLong 0
AdornOps=set DEG_OEMDevAuthThresholdCountInteger 0
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224E.DEG20PrimaryCompanionTokenRuleChain/200.CheckCompanionCount/100.ReadTokenLifeTime/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_OEMDevLicenseTypeString
ResponseAttributes=DEG_OEMDevTokenLifetimeLong
ResponseAttributes=DEG_OEMDevAuthThresholdCountInteger
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=004.ReadTokenLifeTimeRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224E.DEG20PrimaryCompanionTokenRuleChain/200.CheckCompanionCount/100.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
FalseRuleChain=100.SetErrorForLog
FalseRuleChain=110.ErrorLog
TrueRuleChain=200.CheckIfKeyExists


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224E.DEG20PrimaryCompanionTokenRuleChain/200.CheckCompanionCount/100.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.SetErrorForLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1234"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224E.DEG20PrimaryCompanionTokenRuleChain/200.CheckCompanionCount/100.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to access DEG_LIC_LIMITS cache
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224E.DEG20PrimaryCompanionTokenRuleChain/200.CheckCompanionCount/100.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/200.CheckIfKeyExists]

ClassName=ConditionalRule
Conditions=DEG_CDevDBNoMatchFlagInteger,!=,0
TrueRuleChain=100.SetNoRowExistForLog
TrueRuleChain=110.NoRowExistLog


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224E.DEG20PrimaryCompanionTokenRuleChain/200.CheckCompanionCount/100.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/200.CheckIfKeyExists/100.SetNoRowExistForLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1235"
AdornOps=set DEG_OEMDevErrorMessageString "No row found"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224E.DEG20PrimaryCompanionTokenRuleChain/200.CheckCompanionCount/100.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/200.CheckIfKeyExists/110.NoRowExistLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=No Row found DEG_LIC_LIMITS cache: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224E.DEG20PrimaryCompanionTokenRuleChain/200.CheckCompanionCount/200.LookupCompanionTable]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=008.DEG20ReadCompanionDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224F.DEG20ConnectivityAuthTypeRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVariables
RuleNames=200.CheckConnectivityAuthType


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224F.DEG20ConnectivityAuthTypeRuleChain/100.InitVariables]

AdornOps=set DEG_OEMDevConnectivityAuthTypeString ${CONNECTIVITY_AUTH_TYPE}
AdornOps=set DEG_OEMDevtempIPSECCredentialsString ${DEVICE_IPSEC_CREDENTIALS_PREPROVISIONED}
AdornOps=lower DEG_OEMDevtempIPSECCredentialsString DEG_OEMDevIPSECCredentialsPreprovisionedString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224F.DEG20ConnectivityAuthTypeRuleChain/200.CheckConnectivityAuthType]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevConnectivityAuthTypeString,!=,"none"
TrueRuleChain=100.CheckIPSECValue


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224F.DEG20ConnectivityAuthTypeRuleChain/200.CheckConnectivityAuthType/100.CheckIPSECValue]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevIPSECCredentialsPreprovisionedString,=,true
FalseRuleChain=200.WithMSCHAP_Credentials


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224F.DEG20ConnectivityAuthTypeRuleChain/200.CheckConnectivityAuthType/100.CheckIPSECValue/200.WithMSCHAP_Credentials]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=200.CheckMSCHAPIsEmpty


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224F.DEG20ConnectivityAuthTypeRuleChain/200.CheckConnectivityAuthType/100.CheckIPSECValue/200.WithMSCHAP_Credentials/200.CheckMSCHAPIsEmpty]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevCustomMschapUsernameString,=,""
Conditions=DEG_OEMDevCustomMschapPasswordString,=,""
FalseRuleChain=200.UsernameIteration
FalseRuleChain=300.PasswordIteration
FalseRuleChain=100.SetErrorInfo
FalseRuleChain=400.LogsForMschap
Operations=and


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224F.DEG20ConnectivityAuthTypeRuleChain/200.CheckConnectivityAuthType/100.CheckIPSECValue/200.WithMSCHAP_Credentials/200.CheckMSCHAPIsEmpty/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.1238"
AdornOps=set DEG_OEMDevMessageString "NME For MSCHAP Credentials is"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224F.DEG20ConnectivityAuthTypeRuleChain/200.CheckConnectivityAuthType/100.CheckIPSECValue/200.WithMSCHAP_Credentials/200.CheckMSCHAPIsEmpty/200.UsernameIteration]

ClassName=StringTokenizerRule
Delimiter=,
SourceAttribute=DEG_OEMDevCustomMschapUsernameString
TokenAttribute=DEG_OEMDevMSCHAPUserNameString


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224F.DEG20ConnectivityAuthTypeRuleChain/200.CheckConnectivityAuthType/100.CheckIPSECValue/200.WithMSCHAP_Credentials/200.CheckMSCHAPIsEmpty/200.UsernameIteration/IterationRule]

ClassName=AddToListAttributeRule
Delimiters=,
InputAttribute=DEG_OEMDevMSCHAPUserNameString
ListAttribute=DEG_OEMDevMSCHAPUsernameList


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224F.DEG20ConnectivityAuthTypeRuleChain/200.CheckConnectivityAuthType/100.CheckIPSECValue/200.WithMSCHAP_Credentials/200.CheckMSCHAPIsEmpty/300.PasswordIteration]

ClassName=StringTokenizerRule
Delimiter=,
SourceAttribute=DEG_OEMDevCustomMschapPasswordString
TokenAttribute=DEG_OEMDevMSCHAPPasswordString


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224F.DEG20ConnectivityAuthTypeRuleChain/200.CheckConnectivityAuthType/100.CheckIPSECValue/200.WithMSCHAP_Credentials/200.CheckMSCHAPIsEmpty/300.PasswordIteration/IterationRule]

ClassName=AddToListAttributeRule
Delimiters=,
InputAttribute=DEG_OEMDevMSCHAPPasswordString
ListAttribute=DEG_OEMDevMSCHAPPasswordList


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224F.DEG20ConnectivityAuthTypeRuleChain/200.CheckConnectivityAuthType/100.CheckIPSECValue/200.WithMSCHAP_Credentials/200.CheckMSCHAPIsEmpty/400.LogsForMschap]

Attributes=DEG_OEMDevCustomMschapUsernameString
Attributes=DEG_OEMDevCustomMschapPasswordString
Attributes=DEG_OEMDevMSCHAPUserNameString
Attributes=DEG_OEMDevMSCHAPPasswordString
Attributes=DEG_OEMDevMSCHAPUsernameList
Attributes=DEG_OEMDevMSCHAPPasswordList
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=NME For MSCHAP Credentials is:
NullAlso=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckServiceTokenType


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevServiceTokenTypeString,=,"limited"
Conditions=DEG_OEMDevServiceTokenTypeString,=,"unlimited"
LimitedSenario=100.GenerateLimitedServiceToken
LimitedSenario=120.CheckRequestProcessedInteger
Operations=DoAll
TrueRuleChain=LimitedSenario
TrueRuleChain=UnlimitedSenario
UnlimitedSenario=200.GenerateUnlimitedServiceToken
UnlimitedSenario=300.InsertIntoDB
UnlimitedSenario=400.InitVariables
UnlimitedSenario=500.GenerateOEMResponse


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/100.GenerateLimitedServiceToken]

ClassName=com.hp.usage.bulkcm.LoopRule
ExitConditions=DEG_OEMDevDeviceCountIntegerTblTemp,=,0
RetryCount=100
RetryDelay=0
RuleNames=100.GenerateServiceToken
RuleNames=110.GenerateDeviceID
RuleNames=120.GenerateUniqueID
RuleNames=200.InitVariables
RuleNames=205.SetUniqueID
RuleNames=210.PopulateServiceTokenResponse
RuleNames=220.AddDeviceIDtoList
RuleNames=300.InsertCompanionData
RuleNames=400.CheckDBErrorFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/100.GenerateLimitedServiceToken/100.GenerateServiceToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=210A.DEG20GenerateServiceTokensRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/100.GenerateLimitedServiceToken/110.GenerateDeviceID]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=210B.DEG20GenerateDevcieIDRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/100.GenerateLimitedServiceToken/120.GenerateUniqueID]

ClassName=ConditionalRule
Conditions=DEG_OEMDevDBTypeString,!=,timesten
TrueRuleChain=GenerateUniqueID


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/100.GenerateLimitedServiceToken/120.GenerateUniqueID/GenerateUniqueID]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_COMPANION_UNIQUEID_GENERATOR


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/100.GenerateLimitedServiceToken/200.InitVariables]

AdornOps=set log_DB_Operation INSERT
AdornOps=set log_Table_Name DEG_COMPANION_TOKENS
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=copy DEG_OEMDeviceIdString DEG_DEVICE_ID
AdornOps=copy DEG_OEMDevServiceTokenString DEG_SERVICE_TOKEN
AdornOps=set DEG_SERVICETOKEN_STATUS "DE"
AdornOps=set DEG_AUTH_TIMESTAMP 0
AdornOps=setsystime DEG_TOKENCREATE_TIMESTAMP
AdornOps=set DEG_AUTH_COUNT 0
AdornOps=set DEG_BLACKLIST_FLAG 0
AdornOps=copy DEG_OEMDevDeviceCountInteger DEG_OEMDevServiceTokenIndexInteger
AdornOps=+ 1 DEG_OEMDevDeviceCountInteger DEG_OEMDevDeviceCountInteger
AdornOps=+ 1 DEG_OEMDeviceIdInteger DEG_OEMDeviceIdInteger
AdornOps=- DEG_OEMDevDeviceCountIntegerTblTemp 1 DEG_OEMDevDeviceCountIntegerTblTemp
AdornOps=set DEG_USER_AGENT ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/100.GenerateLimitedServiceToken/205.SetUniqueID]

ClassName=ConditionalRule
Conditions=DEG_OEMDevDBTypeString,=,timesten
FalseRuleChain=100.CopyUniqueID
TrueRuleChain=100.SetUniqueID


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/100.GenerateLimitedServiceToken/205.SetUniqueID/100.CopyUniqueID]

AdornOps=copy DEG_UNIQUE_ID_SEQ DEG_UNIQUE_ID
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/100.GenerateLimitedServiceToken/205.SetUniqueID/100.SetUniqueID]

AdornOps=set DEG_UNIQUE_ID ""
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/100.GenerateLimitedServiceToken/210.PopulateServiceTokenResponse]

ClassName=NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevServiceTokenString,jsonResponse.service_tokens[DEG_OEMDevServiceTokenIndexInteger].CData,""
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/100.GenerateLimitedServiceToken/220.AddDeviceIDtoList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDeviceIdString
ListAttribute=DEG_OEMDevResponseSubscriberIdList


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/100.GenerateLimitedServiceToken/300.InsertCompanionData]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_COMPANION_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/100.GenerateLimitedServiceToken/400.CheckDBErrorFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.PrintError


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/100.GenerateLimitedServiceToken/400.CheckDBErrorFlag/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEGv31.GA.1127"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to access or create entry in DEG_COMPANION_TOKENS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/100.GenerateLimitedServiceToken/400.CheckDBErrorFlag/110.PrintError]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevUniqueIDString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while creating Row in DEG_COMPANION_TOKENS Table
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/120.CheckRequestProcessedInteger]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,1
TrueRuleChain=100.GenerateErrorEndAudit


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/120.CheckRequestProcessedInteger/100.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/200.GenerateUnlimitedServiceToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=210A.DEG20GenerateServiceTokensRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB]

ClassName=com.hp.usage.bulkcm.LoopRule
ExitConditions=DEG_OEMDevDeviceCountIntegerTblTemp,=,0
RetryCount=100
RetryDelay=0
RuleNames=100.GenerateDevcieID
RuleNames=110.AddDeviceIDtoList
RuleNames=150.GenerateUniqueID
RuleNames=200.InitVariables
RuleNames=205.SetUniqueID
RuleNames=300.InsertCompanionData
RuleNames=400.CheckCreateStatus


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB/100.GenerateDevcieID]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=210B.DEG20GenerateDevcieIDRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB/110.AddDeviceIDtoList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDeviceIdString
ListAttribute=DEG_OEMDevResponseSubscriberIdList


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB/150.GenerateUniqueID]

ClassName=ConditionalRule
Conditions=DEG_OEMDevDBTypeString,!=,timesten
TrueRuleChain=GenerateUniqueID


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB/150.GenerateUniqueID/GenerateUniqueID]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_COMPANION_UNIQUEID_GENERATOR


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB/200.InitVariables]

AdornOps=set log_DB_Operation INSERT
AdornOps=set log_Table_Name DEG_COMPANION_TOKENS
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=copy DEG_OEMDeviceIdString DEG_DEVICE_ID
AdornOps=copy DEG_OEMDevServiceTokenString DEG_SERVICE_TOKEN
AdornOps=set DEG_SERVICETOKEN_STATUS "DE"
AdornOps=set DEG_AUTH_TIMESTAMP 0
AdornOps=setsystime DEG_TOKENCREATE_TIMESTAMP
AdornOps=set DEG_AUTH_COUNT 0
AdornOps=set DEG_BLACKLIST_FLAG 0
AdornOps=copy DEG_OEMDevDeviceCountInteger DEG_OEMDevServiceTokenIndexInteger
AdornOps=+ 1 DEG_OEMDevDeviceCountInteger DEG_OEMDevDeviceCountInteger
AdornOps=+ 1 DEG_OEMDeviceIdInteger DEG_OEMDeviceIdInteger
AdornOps=- DEG_OEMDevDeviceCountIntegerTblTemp 1 DEG_OEMDevDeviceCountIntegerTblTemp
AdornOps=set DEG_USER_AGENT ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB/205.SetUniqueID]

ClassName=ConditionalRule
Conditions=DEG_OEMDevDBTypeString,=,timesten
FalseRuleChain=100.CopyUniqueID
TrueRuleChain=100.SetUniqueID


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB/205.SetUniqueID/100.CopyUniqueID]

AdornOps=copy DEG_UNIQUE_ID_SEQ DEG_UNIQUE_ID
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB/205.SetUniqueID/100.SetUniqueID]

AdornOps=set DEG_UNIQUE_ID ""
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB/300.InsertCompanionData]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_COMPANION_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB/400.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckDuplicateKeyError
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB/400.CheckCreateStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1236"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB/400.CheckCreateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to create entry in DEG_COMPANION_TOKENS session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB/400.CheckCreateStatus/200.CheckDuplicateKeyError]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
FalseRuleChain=90.SetErrorInfo
FalseRuleChain=100.ErrorLog


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB/400.CheckCreateStatus/200.CheckDuplicateKeyError/100.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Unable to insert into  DEG_COMPANION_TOKENS table: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/300.InsertIntoDB/400.CheckCreateStatus/200.CheckDuplicateKeyError/90.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1237"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to insert into  DEG_COMPANION_TOKENS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/400.InitVariables]

AdornOps=set DEG_OEMDevServiceTokenIndexInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224G.DEG20InsertCompanionTokenRuleChain/100.CheckServiceTokenType/500.GenerateOEMResponse]

ClassName=NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevServiceTokenString,jsonResponse.service_tokens[DEG_OEMDevServiceTokenIndexInteger].CData,""
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224I.DEG20GenerateBlackListedResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=50.GenerateGetAuthenticationStartAuditDataRuleChain
RuleNames=100.BlackListSubscriber_InitResponse
RuleNames=110.BlackListSubscriber_GenerateResponse
RuleNames=120.GenerateBlackListEndAudit
RuleNames=200.UpdateSslSessionState


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224I.DEG20GenerateBlackListedResponseRuleChain/100.BlackListSubscriber_InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 6300
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224I.DEG20GenerateBlackListedResponseRuleChain/110.BlackListSubscriber_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224I.DEG20GenerateBlackListedResponseRuleChain/120.GenerateBlackListEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=708.DEG20GenerateGetAuthenticationBlackListSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224I.DEG20GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=300.CheckSslSessionUpdateStatus


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224I.DEG20GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/100.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set  DEG_SSL_STATE "BLACKLISTED_SUBSCRIBER"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224I.DEG20GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224I.DEG20GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateErrorEndAudit


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224I.DEG20GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1231"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224I.DEG20GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_SSL_SESSION session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224I.DEG20GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/120.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224I.DEG20GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224I.DEG20GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1232"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224I.DEG20GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_SSL_SESSION session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224I.DEG20GenerateBlackListedResponseRuleChain/50.GenerateGetAuthenticationStartAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224J.DEG21CheckCustFeatureListRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVariables
RuleNames=110.CheckiClouVioWiFiIsEnabled
RuleNames=120.CheckingIcloudVoWiFiStatus


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224J.DEG21CheckCustFeatureListRuleChain/100.InitVariables]

AdornOps=set DEG_OEMDevEntitlementListFlagInteger 0
AdornOps=set DEG_OEMDevFeatureCodeTypeString ${FEATURECODE_TYPE}
AdornOps=+ DEG_OEMDevFeatureCodeTypeString = DEG_OEMDevFeatureCodeTypeString
AdornOps=+ DEG_OEMDevFeatureCodeTypeString 6100 DEG_OEMDevFeatureCodeTypeString
AdornOps=set DEG_OEMDevIcloudEnabledString ${ICLOUDVoWiFI}
AdornOps=lower DEG_OEMDevIcloudEnabledString DEG_OEMDevIcloudEnabledString
AdornOps=copy DEG_SSL_ENTITLEMENTSTATUS DEG_EntitlementStatus
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224J.DEG21CheckCustFeatureListRuleChain/110.CheckiClouVioWiFiIsEnabled]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevIcloudEnabledString,=,"enabled"
TrueRuleChain=100.CheckEntitlmentStatus


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224J.DEG21CheckCustFeatureListRuleChain/110.CheckiClouVioWiFiIsEnabled/100.CheckEntitlmentStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_EntitlementStatus,=,""
FalseRuleChain=100.ExtractIcloudVoWiFiStatus
TrueRuleChain=200.SetIcloudVoWiFiStatus


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224J.DEG21CheckCustFeatureListRuleChain/110.CheckiClouVioWiFiIsEnabled/100.CheckEntitlmentStatus/100.ExtractIcloudVoWiFiStatus]

ClassName=com.hp.siu.collector.rules.StringTokenizerRule
Delimiter=,
SourceAttribute=DEG_ENTITLEMENTSTATUS
TokenAttribute=tmp_FEATCODE


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224J.DEG21CheckCustFeatureListRuleChain/110.CheckiClouVioWiFiIsEnabled/100.CheckEntitlmentStatus/100.ExtractIcloudVoWiFiStatus/IterationRule]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=tmp_FEATCODE,=,DEG_OEMDevFeatureCodeTypeString
TrueRuleChain=100.SetEntitlementListFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224J.DEG21CheckCustFeatureListRuleChain/110.CheckiClouVioWiFiIsEnabled/100.CheckEntitlmentStatus/100.ExtractIcloudVoWiFiStatus/IterationRule/100.SetEntitlementListFlag]

AdornOps=set DEG_OEMDevIcloudVoWiFiStatusString 6100
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224J.DEG21CheckCustFeatureListRuleChain/110.CheckiClouVioWiFiIsEnabled/100.CheckEntitlmentStatus/200.SetIcloudVoWiFiStatus]

AdornOps=set DEG_OEMDevIcloudVoWiFiStatusString 6100
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224J.DEG21CheckCustFeatureListRuleChain/120.CheckingIcloudVoWiFiStatus]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVariables
RuleNames=200.CheckIcloudVoWiFistatus


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224J.DEG21CheckCustFeatureListRuleChain/120.CheckingIcloudVoWiFiStatus/100.InitVariables]

AdornOps=set DEG_OEMDevDeviceCountInteger 0
AdornOps=set DEG_OEMDeviceIdInteger 1
AdornOps=set DEG_OEMDevEntitlementListFlagInteger 1
AdornOps=copy DEG_SSL_COMPANION_DEVICE_COUNT DEG_OEMDevDeviceCountIntegerTblTemp
AdornOps=setifnull DEG_SSL_CUSTOM_FIELD ""
AdornOps=set DEG_OEMDevtempServiceTokenTypeString ${SERVICE_TOKEN_TYPE}
AdornOps=lower DEG_OEMDevtempServiceTokenTypeString DEG_OEMDevServiceTokenTypeString 
AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=set DEG_OEMDevFeatureCodeTypeString ${FEATURECODE_TYPE}
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224J.DEG21CheckCustFeatureListRuleChain/120.CheckingIcloudVoWiFiStatus/200.CheckIcloudVoWiFistatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevIcloudVoWiFiStatusString,=,6100
TrueRuleChain=100.GenarateServiceToken


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224J.DEG21CheckCustFeatureListRuleChain/120.CheckingIcloudVoWiFiStatus/200.CheckIcloudVoWiFistatus/100.GenarateServiceToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224E.DEG20PrimaryCompanionTokenRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224K.DEG21CheckDAIRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=200.CheckDAI


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224K.DEG21CheckDAIRuleChain/200.CheckDAI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSkipDAICheckString,=,"enabled"
TrueRuleChain=ProcessDAIRequest


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224K.DEG21CheckDAIRuleChain/200.CheckDAI/ProcessDAIRequest]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_DAI,!=,""
Conditions=DEG_OEMDevDAIString,!=,DEG_DAI
Operations=and
TrueRuleChain=CallDiableCreditials


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224K.DEG21CheckDAIRuleChain/200.CheckDAI/ProcessDAIRequest/CallDiableCreditials]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
ResponseAttributes=DEG_OEMDevDAIDisableFlagInteger
RuleChain=DAI_DisableCredentials
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224K.DEG21CheckDAIRuleChain/200.CheckDAI/ProcessDAIRequest/CheckDAIDisableFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevDAIDisableFlagInteger,=,1
TrueRuleChain=030.SetErrorInfo
TrueRuleChain=100.SetErrorLog


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224K.DEG21CheckDAIRuleChain/200.CheckDAI/ProcessDAIRequest/CheckDAIDisableFlag/030.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1233"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/224K.DEG21CheckDAIRuleChain/200.CheckDAI/ProcessDAIRequest/CheckDAIDisableFlag/100.SetErrorLog]

Attributes=DEG_DAI
Attributes=DEG_OEMDevDAIString
Attributes=DEG_OEMDevDAIDisableFlagInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=Data does not exists in tables,hence credentials can't be disabled:
NullAlso=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/701.DEG20GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/701.DEG20GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/701.DEG20GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/701.DEG20GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/701.DEG20GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/701.DEG20GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by AAA,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/701.DEG20GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/702.DEG20GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/702.DEG20GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/702.DEG20GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/702.DEG20GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/702.DEG20GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/702.DEG20GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sent EAP-AKA message to Device,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/702.DEG20GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/703.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/703.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/703.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/703.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/703.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/703.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by DEG_TOKEN,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/703.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/704.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/704.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/704.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/704.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/704.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/704.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by default,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/704.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Authentication attempt rejected by AAA,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/708.DEG20GenerateGetAuthenticationBlackListSubscriberEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/708.DEG20GenerateGetAuthenticationBlackListSubscriberEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/708.DEG20GenerateGetAuthenticationBlackListSubscriberEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/708.DEG20GenerateGetAuthenticationBlackListSubscriberEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/708.DEG20GenerateGetAuthenticationBlackListSubscriberEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/708.DEG20GenerateGetAuthenticationBlackListSubscriberEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "BlackListed Subscriber,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/708.DEG20GenerateGetAuthenticationBlackListSubscriberEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/709.DEG20GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/709.DEG20GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/709.DEG20GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/709.DEG20GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/709.DEG20GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/709.DEG20GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_SSL_STATE DEG_AuditNRBMessageString
AdornOps=set DEG_Tmp1String ",Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_Tmp1String DEG_AuditNRBMessageString
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2PrimaryCore/RuleChains/709.DEG20GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true
