

[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter]


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors]

ConnectorNames=300.DEGDROIDDiameterAdapter


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter]

ApplicationId=${DEG_DAIMETER_APLLICATION_ID}
ApplicationIdAttribute=DEG_OEMDevAppIdLong
AuthApplicationIds=${DEG_DAIMETER_APLLICATION_ID}
ClassName=com.hp.usage.diameter.DiameterAdapter
CommandCodeAttribute=DEG_OEMDevCommandcodeInteger
E2EAttribute=DEG_OEMDevE2ELong
ErrorFlagAttribute=DEG_OEMDevErrorFlagInteger
HbHAttribute=DEG_OEMDevHbHLong
JNDIName=DEGDROIDDevice
Managed=${MANAGED_SETUP}
MaxMessageSize=8192
NeedResponseAttribute=DEG_OEMDevNeedResponseInteger
PersistentConnectionAddress=${PRIMARY_AAA_HOST_NAME},${AAA_SERVER_REALM}
PersistentConnectionAddress=${SECONDARY_AAA_HOST_NAME},${AAA_SERVER_REALM}
ProductName=Diameter HSS Client
ProxiableFlagAttribute=DEG_OEMDevProxiableFlagInteger
RemoteHostAttribute=DEG_OEMDevDesthostString
RemoteRealmAttribute=DEG_OEMDevDestRealmString
RequestFlagAttribute=DEG_OEMDevRequestFlagInteger
RetransmitFlagAttribute=DEG_OEMDevRetransmitFlagInteger
RetryTimeouts=3,20
ServerHost=${DEGDROID_DEVICE_DIAMETER_SERVER_HOST_NAME}
ServerIP=${DEVICE_DIAMETER_SERVER_HOST_IP}
ServerRealm=${DEVICE_SERVER_REALM}
StopAttribute=DEG_OEMDevStopInteger


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter/DecoderFactory]

ClassName=com.hp.usage.diameter.codec.AVPDecoderFactory
DecoderMap=275,0,SWADecoder


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter/DecoderFactory/SWADecoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpDecoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWa/SessionTerminationAnswerSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter/EncoderFactory]

ClassName=com.hp.usage.diameter.codec.AVPEncoderFactory
EncoderMap=275,0,SWAEncoder


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter/EncoderFactory/SWAEncoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpEncoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWa/SessionTerminationRequestSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter/StateMachinePool]

ClassName=com.hp.usage.diameter.StateMachinePool
ThreadPoolSize=10


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter/StateMachinePool/StateMachine]

ClassName=com.hp.usage.diameter.GenericStateMachine
MessageCodeAttribute=DEG_OEMDevCommandcodeInteger
MessageDirectionAttribute=DEG_OEMDevRequestFlagInteger
RuleChainMapping=268,1,301.DEG30AAAProcessingRuleChain
RuleChainMapping=275,0,304.STAProcessingRuleChain
RuleChainMapping=275,1,303.STRProcessingRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter/Transport]

ClassName=com.hp.usage.diameter.DiameterTCPTransport
HostName=${DEVICE_DIAMETER_SERVER_HOST_IP}
HostsMap=${PRIMARY_AAA_HOST_NAME},${AAA_SERVER_REALM},${PRIMARY_AAA_HOST_IP},${PRIMARY_AAA_HOST_PORT}
HostsMap=${SECONDARY_AAA_HOST_NAME},${AAA_SERVER_REALM},${SECONDARY_AAA_HOST_IP},${SECONDARY_AAA_HOST_PORT}
PortNumber=${DEGDROID_DEVICE_DIAMETER_SERVER_PORT}


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains]

RuleChainNames=301.DEG30AAAProcessingRuleChain
RuleChainNames=301A.GenerateOrCopyAAASessionIDRuleChain
RuleChainNames=301B.SendDERToAAARuleChain
RuleChainNames=301C.ReceiveDEAFromAAARuleChain
RuleChainNames=301D.ValidateResponseFromAAARuleChain
RuleChainNames=303.STRProcessingRuleChain
RuleChainNames=304.STAProcessingRuleChain
RuleChainNames=275.GenerateAAASTRCallStartAuditDataRuleChain
RuleChainNames=276.GenerateAAASTRCallEndErrorAuditDataRuleChain
RuleChainNames=277.GenerateAAASTACallEndOKAuditDataRuleChain
RuleChainNames=533.GenerateAAADERCallStartAuditDataRuleChain
RuleChainNames=534.GenerateAAADERCallEndErrorAuditDataRuleChain
RuleChainNames=535.GenerateAAADERCallEndOKAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=copy DEG_OEMDevAAAProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DROID-STR"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO AAA -> Sending AAA STR message: "
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString ""
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=410.CallMonitoringSessionLookup
RuleNames=500.GenerateAuditAndNRBEvents
RuleNames=600.ResetNRBList


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_AuditResultCodeString
AdornOps=copy DEG_SSL_MDN DEG_AuditMdnString
AdornOps=copy DEG_SSL_IMSI DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DROID-STR"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=setifnull DEG_OEMDevErrorMessageString ""
AdornOps=setifnull DEG_CDevProcessingErrorIdString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=copy DEG_SSL_IMSI DEG_AuditChannelNameString
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=copy DEG_SSL_MDN DEG_MDN
AdornOps=copy DEG_SSL_IMSI DEG_OEMDevImsiString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_OEMDevUniqueIDString
AdornOps=copy DEG_SSL_MDN DEG_OEMDevRespPhoneNumberString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
ClassName=AdornmentRule
_AdornOps=- DEG_AuditTimestampLong DEG_OEMDevAAAProcessStartTimeLong DEG_AuditDurationString


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "After sending STR message: "
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevProcessingErrorIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevProcessingErrorIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevResultCodeInteger DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
AdornOps=set DEG_AuditNRBMessageString "AAA to DEG response, ReturnCode is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevResultCodeInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/410.CallMonitoringSessionLookup]

ClassName=LocalRuleChainInvoker
RuleChain=400A.ProcessSubscriberExistsResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/600.ResetNRBList]

AdornOps=set DEG_NrbMonitoringSessionIdList null
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=410.CallMonitoringSessionLookup
RuleNames=500.GenerateAuditAndNRBEvents
RuleNames=600.ResetNRBList


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_AuditResultCodeString
AdornOps=copy DEG_SSL_MDN DEG_AuditMdnString
AdornOps=copy DEG_SSL_IMSI DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DROID-STR"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=copy DEG_SSL_IMSI DEG_AuditChannelNameString
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=copy DEG_SSL_MDN DEG_MDN
AdornOps=copy DEG_SSL_IMSI DEG_OEMDevImsiString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_OEMDevUniqueIDString
AdornOps=copy DEG_SSL_MDN DEG_OEMDevRespPhoneNumberString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO DEG -> After sending STA message: "
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_IMSI DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevResultCodeInteger DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful execution of AAA call,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevResultCodeInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/410.CallMonitoringSessionLookup]

ClassName=LocalRuleChainInvoker
RuleChain=400A.ProcessSubscriberExistsResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/600.ResetNRBList]

AdornOps=set DEG_NrbMonitoringSessionIdList null
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain]

ClassName=RuleChain
RuleNames=100.ExtractVisitedNetId
RuleNames=110.SetRequestParams
RuleNames=120.GetSessionID
RuleNames=200.SendDERToAAA
RuleNames=300.ReceiveDEAFromAAA
RuleNames=400.ValidateResponse
RuleNames=410.SetDEAInfo
RuleNames=500.LogDEAResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/100.ExtractVisitedNetId]

ClassName=com.hp.siu.collector.rules.SplitStringRule
DstAttribute=DEG_OEMDevVisitedNetworkIdString
LeftSplitString=@
SrcAttribute=DEG_SSL_NAI


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/110.SetRequestParams]

AdornOps=set disc 0
AdornOps=set DEG_OEMDevProxiableFlagInteger 1
AdornOps=set DEG_OEMDevRequestFlagInteger 1
AdornOps=setsystime DEG_OEMDevSessionIdTimeInMilliSecs
AdornOps=/ DEG_OEMDevSessionIdTimeInMilliSecs 1000 DEG_OEMDevSessionIdTimeInSecs
AdornOps=- DEG_OEMDevSessionIdTimeInMilliSecs DEG_OEMDevSessionIdTimeInSecs DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=* DEG_OEMDevSessionIdTimeInNanoSecsLong 1000000 DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=set DEG_OEMDevOriginRealmString ${DEVICE_SERVER_REALM}
AdornOps=set DEG_OEMDevOriginHostString ${DEGDROID_DEVICE_DIAMETER_SERVER_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDesthostString ${PRIMARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=set DEG_OEMDevSecondaryDesthostString ${SECONDARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevSecondaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=set DEG_OEMDevAuthApplicationIdInteger ${DEG_DAIMETER_APLLICATION_ID}
AdornOps=set DEG_OEMDevAuthRequestTypeInteger 3
AdornOps=set DEG_OEMDevRATTypeInteger 2001
AdornOps=str2bin DEG_OEMDevVisitedNetworkIdString DEG_OEMDevVisitedNetworkIdBinary
AdornOps=set DEG_OEMDevAuthLifeTime 2592000
AdornOps=set DEG_OEMDevAuthGracePeriod 7200
AdornOps=set DEG_OEMDevAuthSessionState 0
AdornOps=set DEG_OEMDevANIDString NSN
AdornOps=set DEG_SSL_STATE WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA
AdornOps=copy DEG_SSL_AAA_STATE DEG_OEMDevDiameterStateBinary
AdornOps=setsystime DEG_OEMDevAAAProcessStartTimeLong
AdornOps=setifnull DEG_AuditUniqueIDString ""
AdornOps=copy DEG_AuditUniqueIDString DEG_MSESSIONUNIQUE_ID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/120.GetSessionID]

ClassName=LocalRuleChainInvoker
RuleChain=301A.GenerateOrCopyAAASessionIDRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/200.SendDERToAAA]

ClassName=LocalRuleChainInvoker
RuleChain=301B.SendDERToAAARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/300.ReceiveDEAFromAAA]

ClassName=LocalRuleChainInvoker
RuleChain=301C.ReceiveDEAFromAAARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/400.ValidateResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=301D.ValidateResponseFromAAARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/410.SetDEAInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0605"
AdornOps=setifnull DEG_OEMDevMessageString "Response of DEA"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/500.LogDEAResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_SSL_NAI
Attributes=DEG_MDN
Attributes=DEG_OEMDevDiameterSessionIdString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevRATTypeInteger
Attributes=DEG_SSL_STATE
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevDiameterStateBinary
Attributes=DEG_SSL_AAA_STATE
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=DERProcessingRule - DEAResponse: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301A.GenerateOrCopyAAASessionIDRuleChain]

ClassName=RuleChain
RuleNames=100.CheckAAASessionId


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301A.GenerateOrCopyAAASessionIDRuleChain/100.CheckAAASessionId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_AAA_SESSIONID,!=,DEG_SSL_ID
FalseRuleChain=200.NewSessionId
TrueRuleChain=100.CopySessionId


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301A.GenerateOrCopyAAASessionIDRuleChain/100.CheckAAASessionId/100.CopySessionId]

AdornOps=copy DEG_SSL_AAA_SESSIONID DEG_OEMDevDiameterSessionIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301A.GenerateOrCopyAAASessionIDRuleChain/100.CheckAAASessionId/200.NewSessionId]

AdornOps=setsystime DEG_OEMDevSessionIdTimeInMilliSecs
AdornOps=% DEG_OEMDevSessionIdTimeInMilliSecs 1000 DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=* DEG_OEMDevSessionIdTimeInNanoSecsLong 1000000 DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=/ DEG_OEMDevSessionIdTimeInMilliSecs 1000 DEG_OEMDevSessionIdTimeInSecs
AdornOps=set DEG_OEMDevDiameterSessionIdString ${DEGDROID_DEVICEINTERFACE_PROCESS_NAME}
AdornOps=+ DEG_OEMDevDiameterSessionIdString ; DEG_OEMDevDiameterSessionIdString
AdornOps=set DEG_OEMDevDiameterHostNameString ${DEGDROID_DEVICE_DIAMETER_SERVER_HOST_NAME}
AdornOps=+ DEG_OEMDevDiameterSessionIdString DEG_OEMDevDiameterHostNameString DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString ; DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString DEG_OEMDevSessionIdTimeInSecs DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString ; DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString DEG_OEMDevSessionIdTimeInNanoSecsLong DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString ; DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString DEG_OEMDevImsiString DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString ; DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString DEG_MDN DEG_OEMDevDiameterSessionIdString
AdornOps=copy DEG_OEMDevDiameterSessionIdString DEG_SSL_AAA_SESSIONID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain]

RuleNames=100.DERNMEConversion
RuleNames=110.GenerateAAACallStartAuditData
RuleNames=120.SendDERRequest
RuleNames=130.LogIfRequestTimeOutFlagSet


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/100.DERNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_SSL_AAA_SESSIONID,session_id
NMEToStructuredNMEMap=DEG_OEMDevAuthApplicationIdInteger,auth_application_id
NMEToStructuredNMEMap=DEG_OEMDevOriginHostString,origin_Host
NMEToStructuredNMEMap=DEG_OEMDevOriginRealmString,origin_Realm
NMEToStructuredNMEMap=DEG_OEMDevPrimaryDestRealmString,destination_Realm
NMEToStructuredNMEMap=DEG_OEMDevAuthRequestTypeInteger,auth_request_type
NMEToStructuredNMEMap=DEG_OEMDevEAPPayloadBinary,eap_payload
NMEToStructuredNMEMap=DEG_OEMDevSubscriberIdString,user_Name
NMEToStructuredNMEMap=DEG_OEMDevImsiString,calling_station_id
NMEToStructuredNMEMap=DEG_OEMDevRATTypeInteger,RAT_type
NMEToStructuredNMEMap=DEG_OEMDevVisitedNetworkIdBinary,visited_network_identifier
NMEToStructuredNMEMap=DEG_OEMDevAuthLifeTime,authorization_lifeTime
NMEToStructuredNMEMap=DEG_OEMDevAuthGracePeriod,auth_grace_period
NMEToStructuredNMEMap=DEG_OEMDevAuthSessionState,auth_session_state
NMEToStructuredNMEMap=DEG_OEMDevANIDString,ANID
NMEToStructuredNMEMap=DEG_OEMDevDiameterStateBinary,state
SNMEType=diameterSWa:DiameterEAPRequestSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/110.GenerateAAACallStartAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=533.GenerateAAADERCallStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/120.SendDERRequest]

ApplicationId=${DEG_DAIMETER_APLLICATION_ID}
ClassName=com.hp.usage.diameter.DiameterClientRule
CommandCode=268
DCJNDIName=DEGDROIDDevice
DestinationHostAttribute=DEG_OEMDevPrimaryDesthostString
DestinationRealmAttribute=DEG_OEMDevPrimaryDestRealmString
DisconnectAttribute=disc
E2EAttribute=DEG_OEMDevE2ELong
ErrorResultFlagAttribute=errFlag
HbHAttribute=DEG_OEMDevHbHLong
ProxiableFlagAttribute=DEG_OEMDevProxiableFlagInteger
RequestFlagAttribute=DEG_OEMDevRequestFlagInteger
Retries=0
SecondaryDestinationHostAttribute=DEG_OEMDevSecondaryDesthostString
SecondaryDestinationRealmAttribute=DEG_OEMDevSecondaryDestRealmString
TimeOut=5000
TimeOutFlagAttribute=toFlag
WaitForConnection=false


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/120.SendDERRequest/Decoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpDecoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWa/DiameterEAPAnswerSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/120.SendDERRequest/Encoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpEncoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWa/DiameterEAPRequestSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/130.LogIfRequestTimeOutFlagSet]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=toFlag,!=,0
TrueRuleChain=100.SetErrorParams
TrueRuleChain=110.Log


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/130.LogIfRequestTimeOutFlagSet/100.SetErrorParams]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0601"
AdornOps=set DEG_OEMDevErrorMessageString "AAA could not reply in configured timeout period"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/130.LogIfRequestTimeOutFlagSet/110.Log]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=AAA Request Timeout Error : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain]

RuleNames=100.DEASNMEConversion
RuleNames=110.LogIfInvalidResponse
RuleNames=120.SetOutReturnCodeIfErrorFlagSet


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/100.DEASNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
SNMEType=diameterSWa:DiameterEAPAnswerSWa
StructuredNMEToNMEMap=session_id,DEG_SSL_AAA_SESSIONID
StructuredNMEToNMEMap=auth_application_id,DEG_OEMDevAuthApplicationIdInteger
StructuredNMEToNMEMap=result_Code,DEG_OEMDevResultCodeInteger
StructuredNMEToNMEMap=experimental_result[0].vendor_id,DEG_OEMDevVendorIdInteger
StructuredNMEToNMEMap=experimental_result[0].experimental_result_code,DEG_OEMDevExperimentalResultCodeInteger
StructuredNMEToNMEMap=origin_Host,DEG_OEMDevOriginHostString
StructuredNMEToNMEMap=origin_Realm,DEG_OEMDevOriginRealmString
StructuredNMEToNMEMap=auth_request_type,DEG_OEMDevAuthRequestTypeInteger
StructuredNMEToNMEMap=eap_payload,DEG_OEMDevEAPPayloadBinary
StructuredNMEToNMEMap=user_Name,DEG_SSL_NAI
StructuredNMEToNMEMap=error_message,DEG_OEMDevErrorMessageString
StructuredNMEToNMEMap=state,DEG_OEMDevDiameterStateBinary


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/110.LogIfInvalidResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,within,[3001-3010]
Conditions=DEG_OEMDevResultCodeInteger,within,[5002,5004-5017,5241]
Operations=or
TrueRuleChain=100.SetErrorParams
TrueRuleChain=110.Log


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/110.LogIfInvalidResponse/100.SetErrorParams]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0602"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid response code from AAA"
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_CDevOutReturnCodeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/110.LogIfInvalidResponse/110.Log]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=AAA Invalid Response: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/120.SetOutReturnCodeIfErrorFlagSet]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=errFlag,!=,0
TrueRuleChain=100.SetErrorParams


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/120.SetOutReturnCodeIfErrorFlagSet/100.SetErrorParams]

AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain]

ClassName=RuleChain
RuleNames=100.CheckAAAResultCode


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,=,2001
FalseRuleChain=200.CheckIfDiameterMultiRoundAuth
TrueRuleChain=100.setSessionStatus
TrueRuleChain=110.GenerateAAACallEndOKAuditData
TrueRuleChain=120.STRProcessingRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/100.setSessionStatus]

AdornOps=set DEG_SSL_STATE AUTHENTICATED_BY_AAA
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "EAP"
AdornOps=setsystime DEG_FULLAUTHTIMESTAMP
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_CDevOutReturnCodeString
AdornOps=set DEG_AuditNRBMessageString "Successful execution of AAA call,Return code from AAA is "
AdornOps=+ DEG_AuditNRBMessageString DEG_CDevOutReturnCodeString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/110.GenerateAAACallEndOKAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=535.GenerateAAADERCallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequest
RuleNames=110.ReadValue
RuleNames=120.CheckErrorAndNoMatchFlag
RuleNames=130.ExecuteDependingOnSysParameterValue


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/100.InitRequest]

AdornOps=set DEG_CDevSysParameter "DEG_AAA_CONNECTIONTYPE"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevGetAAAConnectionTypeValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
FalseRuleChain=200.DefaultValue
Operations=and
TrueRuleChain=100.SetSysValue


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/120.CheckErrorAndNoMatchFlag/100.SetSysValue]

AdornOps=copy DEG_CDevSysValueString DEG_CDevGetAAAConnectionTypeValueString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/120.CheckErrorAndNoMatchFlag/200.DefaultValue]

AdornOps=set DEG_CDevGetAAAConnectionTypeValueString "Internal"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevGetAAAConnectionTypeValueString,=,"Internal"
Conditions=DEG_CDevGetAAAConnectionTypeValueString,=,"External"
InvokeSTRProcessingRuleChain=100.InvokeSTRProcessingRuleChain
Operations=None
TrueRuleChain=UpdateSTRFlag
TrueRuleChain=InvokeSTRProcessingRuleChain
UpdateSTRFlag=001.setSTRFlag
UpdateSTRFlag=100.UpdateSession
UpdateSTRFlag=105.SetFlagResponse
UpdateSTRFlag=110.LogUpdate


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue/001.setSTRFlag]

AdornOps=set DEG_STR_FLAG 1
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=copy DEG_OEMDevDiameterSessionIdString DEG_SSL_AAA_SESSIONID
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue/100.InvokeSTRProcessingRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_SSL_AAA_SESSIONID
RequestAttributes=DEG_OEMDevAuthApplicationIdInteger
RequestAttributes=DEG_SSL_NAI
ResponseAttributes=DEG_OEMDevDiameterSessionIdString
ResponseAttributes=DEG_OEMDevResultCodeInteger
RuleChain=303.STRProcessingRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue/100.UpdateSession]

ClassName=UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_STR_FLAG,DEG_STR_FLAG
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue/105.SetFlagResponse]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0603"
AdornOps=set DEG_OEMDevMessageString "Update STR Flag for Internal AAA"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue/110.LogUpdate]

Attributes=DEG_OEMDevDiameterSessionIdString
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_OEMDevOriginHostString
Attributes=DEG_OEMDevOriginRealmString
Attributes=DEG_SSL_ID
Attributes=DEG_OEMDevMessageString
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Update STR Flag for Internal AAA : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,=,1001
FalseRuleChain=200.CheckIfDiameterAuthRejected
TrueRuleChain=100.setSessionStatus
TrueRuleChain=110.GenerateAAACallEndOKAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/100.setSessionStatus]

AdornOps=set DEG_SSL_STATE WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE
AdornOps=copy DEG_OEMDevDiameterStateBinary DEG_SSL_AAA_STATE
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_CDevOutReturnCodeString
AdornOps=set DEG_AuditNRBMessageString "Successful execution of AAA call, NEED_AKA_CHALLENGE_RESPONSE_FROM_DEVICE,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevResultCodeInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/110.GenerateAAACallEndOKAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=535.GenerateAAADERCallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,=,4001
Conditions=DEG_OEMDevResultCodeInteger,within,[5001,5003]
FalseRuleChain=200.isDiameterError
Operations=or
TrueRuleChain=100.setSessionStatus
TrueRuleChain=110.GenerateAAACallEndOKAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/100.setSessionStatus]

AdornOps=set DEG_SSL_STATE AKA_CHALLENGE_REJECTED_BY_AAA
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_CDevOutReturnCodeString
AdornOps=set DEG_AuditNRBMessageString "Successful execution of AAA call,Return code from AAA is "
AdornOps=+ DEG_AuditNRBMessageString DEG_CDevOutReturnCodeString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/110.GenerateAAACallEndOKAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=535.GenerateAAADERCallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=errFlag,!=,0
Conditions=DEG_OEMDevResultCodeInteger,within,[3001-3010]
Conditions=DEG_OEMDevResultCodeInteger,within,[5002,5004-5017,5241]
Operations=or,or
TrueRuleChain=001.SetErrorResponse
TrueRuleChain=000.LogAAAError
TrueRuleChain=100.CheckEAPAKADefaultValue
TrueRuleChain=120.GenerateAAACallEndErrorAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/000.LogAAAError]

Attributes=DEG_OEMDevResultCodeInteger
Attributes=errFlag
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=WARNING
Message=Default internal authentication is called as error response is sent from AAA.
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/001.SetErrorResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0604"
AdornOps=set DEG_OEMDevErrorMessageString "Default internal authentication is called as error response is sent from AAA"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/100.CheckEAPAKADefaultValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=170.DEG30CheckEAPAKADefaultRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/120.GenerateAAACallEndErrorAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=534.GenerateAAADERCallEndErrorAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/130.GenerateAAAAkaRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,1
TrueRuleChain=100.AuditDataRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/130.GenerateAAAAkaRejectedEndAuditDataRuleChain/100.AuditDataRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetRequestParams
RuleNames=275.STRCallStartAuditDataRule
RuleNames=110.STRNMEConversion
RuleNames=115.SetSTRInfo
RuleNames=200.LogSTRRequest
RuleNames=300.SendSTRRequest


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/100.SetRequestParams]

AdornOps=set DEG_OEMDevSSLSSDeletedInteger 1
AdornOps=set disc 0
AdornOps=set DEG_OEMDevRequestFlagInteger 1
AdornOps=set DEG_OEMDevTerminationCauseInteger 8
AdornOps=set DEG_OEMDevOriginRealmString ${DEVICE_SERVER_REALM}
AdornOps=set DEG_OEMDevOriginHostString ${DEGDROID_DEVICE_DIAMETER_SERVER_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDesthostString ${PRIMARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=set DEG_OEMDevSecondaryDesthostString ${SECONDARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevSecondaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=copy DEG_SSL_AAA_SESSIONID DEG_OEMDevDiameterSessionIdString
AdornOps=copy DEG_SSL_NAI DEG_OEMDevSubscriberIdString
AdornOps=set DEG_OEMDevAuthApplicationIdInteger ${DEG_DAIMETER_APLLICATION_ID}
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/110.STRNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevDiameterSessionIdString,session_id
NMEToStructuredNMEMap=DEG_OEMDevOriginHostString,origin_Host
NMEToStructuredNMEMap=DEG_OEMDevOriginRealmString,origin_Realm
NMEToStructuredNMEMap=DEG_OEMDevPrimaryDestRealmString,destination_Realm
NMEToStructuredNMEMap=DEG_OEMDevAuthApplicationIdInteger,auth_application_id
NMEToStructuredNMEMap=DEG_OEMDevTerminationCauseInteger,termination_cause
NMEToStructuredNMEMap=DEG_OEMDevSubscriberIdString,user_Name
SNMEType=diameterSWa:SessionTerminationRequestSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/115.SetSTRInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0606"
AdornOps=set DEG_OEMDevMessageString "STR Process"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/200.LogSTRRequest]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevDiameterSessionIdString
Attributes=DEG_OEMDevOriginHostString
Attributes=DEG_OEMDevOriginRealmString
Attributes=DEG_OEMDevPrimaryDestRealmString
Attributes=DEG_OEMDevTerminationCauseInteger
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevPrimaryDesthostString
Attributes=DEG_SSL_ID
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=STRProcessingRule - STRRequest:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/275.STRCallStartAuditDataRule]

ClassName=LocalRuleChainInvoker
RuleChain=275.GenerateAAASTRCallStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/300.SendSTRRequest]

ApplicationId=${DEG_DAIMETER_APLLICATION_ID}
ClassName=com.hp.usage.diameter.DiameterClientRule
CommandCode=275
DCJNDIName=DEGDROIDDevice
DestinationHostAttribute=DEG_OEMDevPrimaryDesthostString
DestinationRealmAttribute=DEG_OEMDevPrimaryDestRealmString
DisconnectAttribute=disc
E2EAttribute=DEG_OEMDevE2ELong
ErrorResultFlagAttribute=errFlag
HbHAttribute=DEG_OEMDevHbHLong
SecondaryDestinationHostAttribute=DEG_OEMDevSecondaryDesthostString
SecondaryDestinationRealmAttribute=DEG_OEMDevSecondaryDestRealmString
TimeOut=0
TimeOutFlagAttribute=toFlag
WaitForConnection=false


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/300.SendSTRRequest/Decoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpDecoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWa/SessionTerminationAnswerSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/300.SendSTRRequest/Encoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpEncoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWa/SessionTerminationRequestSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain]

ClassName=RuleChain
RuleNames=100.SetResponseParams
RuleNames=200.STASNMEConversion
RuleNames=210.InitLookup
RuleNames=220.LookupSessionTable
RuleNames=230.CheckLookupStatus
RuleNames=231.SetErrorResponse
RuleNames=400.LogAfterSTAResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/100.SetResponseParams]

AdornOps=set DEG_OEMDevNeedResponseInteger 0
AdornOps=set DEG_OEMDevErrorMessageString ""
AdornOps=set DEG_OEMDevOriginHostString ""
AdornOps=set DEG_OEMDevOriginRealmString ""
AdornOps=set DEG_OEMDevDiameterSessionIdString ""
AdornOps=set DEG_OEMDevResultCodeInteger 0
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/200.STASNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
SNMEType=diameterSWa:SessionTerminationAnswerSWa
StructuredNMEToNMEMap=session_id,DEG_OEMDevDiameterSessionIdString
StructuredNMEToNMEMap=result_Code,DEG_OEMDevResultCodeInteger
StructuredNMEToNMEMap=origin_Host,DEG_OEMDevOriginHostString
StructuredNMEToNMEMap=origin_Realm,DEG_OEMDevOriginRealmString
StructuredNMEToNMEMap=error_message,DEG_OEMDevErrorMessageString


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/210.InitLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevDiameterSessionIdString DEG_SSL_AAA_SESSIONID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/220.LookupSessionTable]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExistFlag
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.PrintError


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0607"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/110.PrintError]

Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while looking up in DEG_SSL_SESSION table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
FalseRuleChain=50.SetErrorInfo
FalseRuleChain=100.ErrorLog
TrueRuleChain=300.GenAudit
TrueRuleChain=400.DelSession


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/100.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to get data from DEG_SSL_SESSION table:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/300.GenAudit]

ClassName=ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,within,[2001,5002]
FalseRuleChain=275.STRCallEndErrorAuditDataRule
TrueRuleChain=275.STACallEndOKAuditDataRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/300.GenAudit/275.STACallEndOKAuditDataRule]

ClassName=LocalRuleChainInvoker
RuleChain=277.GenerateAAASTACallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/300.GenAudit/275.STRCallEndErrorAuditDataRule]

ClassName=LocalRuleChainInvoker
RuleChain=276.GenerateAAASTRCallEndErrorAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/400.DelSession]

ClassName=RuleChain
RuleNames=100.InitialDel
RuleNames=200.DeleteSession


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/400.DelSession/100.InitialDel]

AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=copy DEG_OEMDevDiameterSessionIdString DEG_SSL_AAA_SESSIONID
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/400.DelSession/200.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
ContinueAfterErrorFixed=false
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/50.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0608"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to get data from DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/231.SetErrorResponse]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0609"
AdornOps=set DEG_OEMDevMessageString "STAResponse"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/400.LogAfterSTAResponse]

Attributes=DEG_OEMDevDiameterSessionIdString
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_OEMDevOriginHostString
Attributes=DEG_OEMDevOriginRealmString
Attributes=DEG_SSL_ID
Attributes=DEG_OEMDevMessageString
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=STAResponse : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=copy DEG_OEMDevAAAProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DROID-DER"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO AAA -> Sending AAA DER message: "
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString ""
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_OEMDevAAAProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=setifnull DEG_CDevOutReturnCodeString "500"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DROID-DER"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=setifnull DEG_OEMDevErrorMessageString ""
AdornOps=setifnull DEG_CDevProcessingErrorIdString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "After sending DER message: "
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevProcessingErrorIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevProcessingErrorIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
AdornOps=set DEG_AuditNRBMessageString "AAA to DEG response, Return Code from AAA is "
AdornOps=+ DEG_AuditNRBMessageString DEG_CDevOutReturnCodeString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_OEMDevAAAProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DROID-DER"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO DEG -> After sending DER message: "
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true
