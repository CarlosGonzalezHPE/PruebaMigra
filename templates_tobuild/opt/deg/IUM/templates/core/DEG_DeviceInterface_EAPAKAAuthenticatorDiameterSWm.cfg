

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter]


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors]

ConnectorNames=300.DiameterAdapter


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DiameterAdapter]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/Connectors/300.DiameterAdapter


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DiameterAdapter/DecoderFactory]

ClassName=com.hp.usage.diameter.codec.AVPDecoderFactory
DecoderMap=275,0,SWMDecoder


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DiameterAdapter/DecoderFactory/SWMDecoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpDecoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWm/SessionTerminationAnswerSWm


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DiameterAdapter/EncoderFactory]

ClassName=com.hp.usage.diameter.codec.AVPEncoderFactory
EncoderMap=275,0,SWMEncoder


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DiameterAdapter/EncoderFactory/SWMEncoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpEncoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWm/SessionTerminationRequestSWm


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DiameterAdapter/StateMachinePool]

ClassName=com.hp.usage.diameter.StateMachinePool
ThreadPoolSize=10


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DiameterAdapter/StateMachinePool/StateMachine]

ClassName=com.hp.usage.diameter.GenericStateMachine
MessageCodeAttribute=DEG_OEMDevCommandcodeInteger
MessageDirectionAttribute=DEG_OEMDevRequestFlagInteger
RuleChainMapping=268,1,301.AAAProcessingRuleChain
RuleChainMapping=275,0,304.STAProcessingRuleChain
RuleChainMapping=275,1,303.STRProcessingRuleChain


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains]

RuleChainNames=301.AAAProcessingRuleChain
RuleChainNames=301A.GenerateOrCopyAAASessionIDRuleChain
RuleChainNames=301B.SendDERToAAARuleChain
RuleChainNames=301C.ReceiveDEAFromAAARuleChain
RuleChainNames=301C.SendDERToSecondaryAAA
RuleChainNames=301C.ReceiveDEAFromSecondaryAAA
RuleChainNames=301C.SendDERToAAAInFailureCondition
RuleChainNames=301C.ReceiveDEAFromAAAInFailureCondition
RuleChainNames=302.SendPostChallengeDER
RuleChainNames=301D.ValidateResponseFromAAARuleChain
RuleChainNames=303.STRProcessingRuleChain
RuleChainNames=304.STAProcessingRuleChain
RuleChainNames=275.GenerateAAASTRCallStartAuditDataRuleChain
RuleChainNames=276.GenerateAAASTRCallEndErrorAuditDataRuleChain
RuleChainNames=277.GenerateAAASTACallEndOKAuditDataRuleChain
RuleChainNames=533.GenerateAAADERCallStartAuditDataRuleChain
RuleChainNames=534.GenerateAAADERCallEndErrorAuditDataRuleChain
RuleChainNames=535.GenerateAAADERCallEndOKAuditDataRuleChain


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=copy DEG_OEMDevAAAProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "STR"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO AAA -> Sending AAA STR message: "
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=301.SetErrorInfo
RuleNames=310.LOG
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=410.CallMonitoringSessionLookup
RuleNames=500.GenerateAuditAndNRBEvents
RuleNames=600.ResetNRBList


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_AuditResultCodeString
AdornOps=copy DEG_SSL_MDN DEG_AuditMdnString
AdornOps=copy DEG_SSL_IMSI DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "STR"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=setifnull DEG_OEMDevErrorMessageString ""
AdornOps=setifnull DEG_CDevProcessingErrorIdString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=copy DEG_SSL_IMSI DEG_AuditChannelNameString
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=copy DEG_SSL_MDN DEG_MDN
AdornOps=setifnull DEG_OEMDevImsiString "invalid_SSLsession"
AdornOps=copy DEG_SSL_IMSI DEG_OEMDevImsiString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_OEMDevUniqueIDString
AdornOps=copy DEG_SSL_MDN DEG_OEMDevRespPhoneNumberString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "After sending STR message: "
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevProcessingErrorIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevProcessingErrorIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevResultCodeInteger DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/301.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEGv31.GA.152"
AdornOps=set DEG_OEMDevErrorMessageString "Since Session closed STA --ERROR"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/310.LOG]

Attributes=DEG_CDevOutReturnCodeString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_AuditNRBMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=<<<< audit attributes>>>>>Since Session closed STA --ERROR
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
AdornOps=set DEG_AuditNRBMessageString "AAA to DEG response,Return Code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevResultCodeInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/410.CallMonitoringSessionLookup]

ClassName=LocalRuleChainInvoker
RuleChain=400A.ProcessSubscriberExistsResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/600.ResetNRBList]

AdornOps=set DEG_NrbMonitoringSessionIdList null
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=410.CallMonitoringSessionLookup
RuleNames=500.GenerateAuditAndNRBEvents
RuleNames=600.ResetNRBList


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_AuditResultCodeString
AdornOps=copy DEG_SSL_MDN DEG_AuditMdnString
AdornOps=copy DEG_SSL_IMSI DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "STR"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=copy DEG_SSL_IMSI DEG_AuditChannelNameString
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=copy DEG_SSL_MDN DEG_MDN
AdornOps=copy DEG_SSL_IMSI DEG_OEMDevImsiString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_OEMDevUniqueIDString
AdornOps=copy DEG_SSL_MDN DEG_OEMDevRespPhoneNumberString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO DEG -> After sending STA message: "
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_IMSI DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevResultCodeInteger DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful execution of AAA call"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/410.CallMonitoringSessionLookup]

ClassName=LocalRuleChainInvoker
RuleChain=400A.ProcessSubscriberExistsResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/600.ResetNRBList]

AdornOps=set DEG_NrbMonitoringSessionIdList null
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain]

ClassName=RuleChain
RuleNames=100.ExtractVisitedNetId
RuleNames=110.SetRequestParams
RuleNames=111.SetRequestParams
RuleNames=125.LookupSSLSession
RuleNames=125.UpdateSessionToSSLSession
RuleNames=200.SendDERToAAA
RuleNames=300.ReceiveDEAFromAAA
RuleNames=400.ValidateResponse
RuleNames=410.SetErrorInfo
RuleNames=500.LogDEAResponse


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain/100.ExtractVisitedNetId]

ClassName=com.hp.siu.collector.rules.SplitStringRule
DstAttribute=DEG_OEMDevVisitedNetworkIdString
LeftSplitString=@
SrcAttribute=DEG_SSL_NAI


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain/110.SetRequestParams]

AdornOps=set disc 0
AdornOps=set DEG_OEMDevProxiableFlagInteger 1
AdornOps=set DEG_OEMDevRequestFlagInteger 1
AdornOps=setsystime DEG_OEMDevSessionIdTimeInMilliSecs
AdornOps=/ DEG_OEMDevSessionIdTimeInMilliSecs 1000 DEG_OEMDevSessionIdTimeInSecs
AdornOps=- DEG_OEMDevSessionIdTimeInMilliSecs DEG_OEMDevSessionIdTimeInSecs DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=* DEG_OEMDevSessionIdTimeInNanoSecsLong 1000000 DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=set DEG_OEMDevOriginRealmString ${DEVICE_SERVER_REALM}
AdornOps=set DEG_OEMDevOriginHostString ${DEVICE_DIAMETER_SERVER_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDesthostString ${PRIMARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=set DEG_OEMDevSecondaryDesthostString ${SECONDARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevSecondaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=set DEG_OEMDevAuthApplicationIdInteger 16777264
AdornOps=set DEG_OEMDevAuthRequestTypeInteger 3
AdornOps=set DEG_OEMDevRATTypeInteger 2001
AdornOps=str2bin DEG_OEMDevVisitedNetworkIdString DEG_OEMDevVisitedNetworkIdBinary
AdornOps=set DEG_OEMDevAuthLifeTime 2592000
AdornOps=set DEG_OEMDevAuthGracePeriod 7200
AdornOps=set DEG_OEMDevAuthSessionState 0
AdornOps=set DEG_OEMDevANIDString NSN
AdornOps=set DEG_SSL_STATE WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA
AdornOps=copy DEG_SSL_AAA_STATE DEG_OEMDevDiameterStateBinary
AdornOps=setsystime DEG_OEMDevAAAProcessStartTimeLong
AdornOps=setifnull DEG_AuditUniqueIDString ""
AdornOps=copy DEG_AuditUniqueIDString DEG_MSESSIONUNIQUE_ID
AdornOps=set DEG_OEMDevAAAFailureIndicationFlagInteger 0
AdornOps=copy DEG_OEMDevEAPPayloadBinary DEG_OEMDevRedirectEAPPayloadBinary
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain/111.SetRequestParams]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301.AAAProcessingRuleChain/111.SetRequestParams


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain/125.LookupSSLSession]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_GETAUTH_CONTACTED_AAA,DEG_GETAUTH_CONTACTED_AAA
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain/125.UpdateSessionToSSLSession]

ClassName=ConditionalRule
Conditions=DEG_SSL_AAA_SESSIONID,=,""
TrueRuleChain=120.GetSessionID
TrueRuleChain=120.LogBeforeUpdate
TrueRuleChain=100.UpdateSession


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain/125.UpdateSessionToSSLSession/100.UpdateSession]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain/125.UpdateSessionToSSLSession/120.GetSessionID]

ClassName=LocalRuleChainInvoker
RuleChain=301A.GenerateOrCopyAAASessionIDRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain/125.UpdateSessionToSSLSession/120.LogBeforeUpdate]

Attributes=DEG_SSL_ID
Attributes=DEG_SSL_AAA_SESSIONID
ClassName=LogNMERule
LogLevel=DEBUG2
Message=Logging Before Update SSL Session:


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain/200.SendDERToAAA]

ClassName=ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,"postChallenge"
FalseRuleChain=SendGetAuthDER
TrueRuleChain=SendPostChalengeDER


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain/200.SendDERToAAA/SendGetAuthDER]

ClassName=LocalRuleChainInvoker
RuleChain=301B.SendDERToAAARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain/200.SendDERToAAA/SendPostChalengeDER]

ClassName=LocalRuleChainInvoker
RuleChain=302.SendPostChallengeDER
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain/300.ReceiveDEAFromAAA]

ClassName=LocalRuleChainInvoker
RuleChain=301C.ReceiveDEAFromAAARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain/400.ValidateResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=301D.ValidateResponseFromAAARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain/410.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEGv31.GA.158"
AdornOps=set DEG_OEMDevErrorMessageString "DERProcessingRule - DEAResponse:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.AAAProcessingRuleChain/500.LogDEAResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_SSL_NAI
Attributes=DEG_MDN
Attributes=DEG_OEMDevDiameterSessionIdString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevRATTypeInteger
Attributes=DEG_SSL_STATE
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevDiameterStateBinary
Attributes=DEG_SSL_AAA_STATE
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=DERProcessingRule - DEAResponse: 
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301A.GenerateOrCopyAAASessionIDRuleChain]

ClassName=RuleChain
RuleNames=100.CheckAAASessionId


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301A.GenerateOrCopyAAASessionIDRuleChain/100.CheckAAASessionId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_AAA_SESSIONID,!=,""
FalseRuleChain=200.NewSessionId
TrueRuleChain=100.CopySessionId


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301A.GenerateOrCopyAAASessionIDRuleChain/100.CheckAAASessionId/100.CopySessionId]

AdornOps=copy DEG_SSL_AAA_SESSIONID DEG_OEMDevDiameterSessionIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301A.GenerateOrCopyAAASessionIDRuleChain/100.CheckAAASessionId/200.NewSessionId]

AdornOps=setsystime DEG_OEMDevSessionIdTimeInMilliSecs
AdornOps=% DEG_OEMDevSessionIdTimeInMilliSecs 1000 DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=* DEG_OEMDevSessionIdTimeInNanoSecsLong 1000000 DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=/ DEG_OEMDevSessionIdTimeInMilliSecs 1000 DEG_OEMDevSessionIdTimeInSecs
AdornOps=set DEG_OEMDevDiameterSessionIdString ${DEVICEINTERFACE_PROCESS_NAME}
AdornOps=+ DEG_OEMDevDiameterSessionIdString ; DEG_OEMDevDiameterSessionIdString
AdornOps=set DEG_OEMDevDiameterHostNameString ${DEVICE_DIAMETER_SERVER_HOST_NAME}
AdornOps=+ DEG_OEMDevDiameterSessionIdString DEG_OEMDevDiameterHostNameString DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString ; DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString DEG_OEMDevSessionIdTimeInSecs DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString ; DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString DEG_OEMDevSessionIdTimeInNanoSecsLong DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString ; DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString DEG_OEMDevImsiString DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString ; DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString DEG_MDN DEG_OEMDevDiameterSessionIdString
AdornOps=copy DEG_OEMDevDiameterSessionIdString DEG_SSL_AAA_SESSIONID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain]

RuleNames=100.DERNMEConversion
RuleNames=110.GenerateAAACallStartAuditData
RuleNames=120.SendDERRequest
RuleNames=130.LogIfRequestTimeOutFlagSet


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/100.DERNMEConversion]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301B.SendDERToAAARuleChain/100.DERNMEConversion


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/110.GenerateAAACallStartAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=533.GenerateAAADERCallStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/120.SendDERRequest]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301B.SendDERToAAARuleChain/120.SendDERRequest


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/120.SendDERRequest/Decoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpDecoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWm/DiameterEAPAnswerSWm


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/120.SendDERRequest/Encoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpEncoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWm/DiameterEAPRequestSWm


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/130.LogIfRequestTimeOutFlagSet]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=toFlag,!=,0
TrueRuleChain=100.SetErrorParams
TrueRuleChain=110.Log


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/130.LogIfRequestTimeOutFlagSet/100.SetErrorParams]

AdornOps=set DEG_OEMDevErrorMessageString "AAA could not reply in configured timeout period"
AdornOps=set DEG_CDevProcessingErrorIdString "DEGv31.GA.155"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/130.LogIfRequestTimeOutFlagSet/110.Log]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=From DEG to AAA Request Timeout Error : 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAAInFailureCondition]

RuleNames=100.DEASNMEConversion
RuleNames=105.CheckIfResultCodeNull
RuleNames=101.LogResponseFromAAA


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAAInFailureCondition/100.DEASNMEConversion]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.ReceiveDEAFromAAAInFailureCondition/100.DEASNMEConversion


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAAInFailureCondition/101.LogResponseFromAAA]

Attributes=DEG_OEMDevRedirectedHostString
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_OEMDevAuthApplicationIdInteger
Attributes=DEG_OEMDevOriginHostString
Attributes=DEG_OEMDevAuthRequestTypeInteger
Attributes=DEG_OEMDevOriginRealmString
Attributes=DEG_OEMDevSecondaryDesthostString
Attributes=DEG_OEMDevSecondaryDestRealmString
ClassName=LogNMERule
LogLevel=DEBUG2
Message=Logged Response From Primary AAA In Secondary Failure Case:


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAAInFailureCondition/105.CheckIfResultCodeNull]

ClassName=ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,=,0
TrueRuleChain=SetResultCode


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAAInFailureCondition/105.CheckIfResultCodeNull/SetResultCode]

AdornOps=copy DEG_OEMDevExperimentalResultCodeInteger DEG_OEMDevResultCodeInteger
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain]

RuleNames=100.DEASNMEConversion
RuleNames=120.RememberHostName
RuleNames=101.LogResponseFromAAA
RuleNames=105.CheckIfResultCodeNull
RuleNames=105.CheckRedirectionIndication
RuleNames=StoreGetAuthContactedAAA
RuleNames=110.LogIfInvalidResponse
RuleNames=120.SetOutReturnCodeIfErrorFlagSet


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/100.DEASNMEConversion]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.ReceiveDEAFromAAARuleChain/100.DEASNMEConversion


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/101.LogResponseFromAAA]

Attributes=DEG_OEMDevRedirectedHostString
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_OEMDevAuthApplicationIdInteger
Attributes=DEG_OEMDevOriginHostString
Attributes=DEG_OEMDevAuthRequestTypeInteger
Attributes=DEG_OEMDevOriginRealmString
Attributes=DEG_OEMDevSecondaryDesthostString
Attributes=DEG_OEMDevSecondaryDestRealmString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevRedirectEAPPayloadBinary
Attributes=DEG_SSL_STATE
ClassName=LogNMERule
LogLevel=DEBUG2
Message=Logged Response From AAA:


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/105.CheckIfResultCodeNull]

ClassName=ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,=,0
TrueRuleChain=SetResultCode


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/105.CheckIfResultCodeNull/SetResultCode]

AdornOps=copy DEG_OEMDevExperimentalResultCodeInteger DEG_OEMDevResultCodeInteger
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/105.CheckRedirectionIndication]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,=,3006
TrueRuleChain=CheckRedirectedHostString


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/105.CheckRedirectionIndication/CheckRedirectedHostString]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRedirectedHostString,!=,""
FalseRuleChain=LogFailureCondition
FalseRuleChain=InitRedirectionFailureResponse
FalseRuleChain=SetRedirectionFailureResponse
TrueRuleChain=CheckPrefixForRedirectedHost
TrueRuleChain=RedirectToSecondaryAAA
TrueRuleChain=ReceiveDEAFromSecondaryAAA


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/105.CheckRedirectionIndication/CheckRedirectedHostString/CheckPrefixForRedirectedHost]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRedirectedHostString,starts,"aaa://"
TrueRuleChain=RemovePrefix


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/105.CheckRedirectionIndication/CheckRedirectedHostString/CheckPrefixForRedirectedHost/RemovePrefix]

AdornOps=substr 6 length DEG_OEMDevRedirectedHostString DEG_OEMDevRedirectedHostString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/105.CheckRedirectionIndication/CheckRedirectedHostString/InitRedirectionFailureResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_STATE "STATUS_TEMPORARY_FAILURE"
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_OEMDevRespStatusString 6005
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/105.CheckRedirectionIndication/CheckRedirectedHostString/LogFailureCondition]

Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_OEMDevRedirectedHostString
Attributes=DEG_SSL_STATE
Attributes=DEG_OEMDevOriginHostString
ClassName=LogNMERule
LogLevel=DEBUG2
Message=Condition Failed to call Secondary AAA:


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/105.CheckRedirectionIndication/CheckRedirectedHostString/ReceiveDEAFromSecondaryAAA]

ClassName=LocalRuleChainInvoker
RuleChain=301C.ReceiveDEAFromSecondaryAAA
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/105.CheckRedirectionIndication/CheckRedirectedHostString/RedirectToSecondaryAAA]

ClassName=LocalRuleChainInvoker
RuleChain=301C.SendDERToSecondaryAAA
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/105.CheckRedirectionIndication/CheckRedirectedHostString/SetRedirectionFailureResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/110.LogIfInvalidResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,within,[3001-3010]
Conditions=DEG_OEMDevResultCodeInteger,within,[5002,5004-5017,5241,5450,5452]
Operations=or
TrueRuleChain=100.SetErrorParams
TrueRuleChain=110.Log


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/110.LogIfInvalidResponse/100.SetErrorParams]

AdornOps=set DEG_OEMDevErrorMessageString "Invalid response code from AAA"
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_CDevOutReturnCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEGv31.GA.156"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/110.LogIfInvalidResponse/110.Log]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=AAA Invalid Response: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/120.RememberHostName]

AdornOps=setifnull DEG_OEMDevOriginHostString ""
AdornOps=copy DEG_OEMDevOriginHostString DEG_OEMDevRememberedHostNameString
AdornOps=copy DEG_OEMDevOriginRealmString DEG_OEMDevRememberedRealmString
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/120.SetOutReturnCodeIfErrorFlagSet]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=errFlag,!=,0
TrueRuleChain=100.SetErrorParams


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/120.SetOutReturnCodeIfErrorFlagSet/100.SetErrorParams]

AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/StoreGetAuthContactedAAA]

ClassName=ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,"getAuthentication"
Conditions=DEG_OEMDevResultCodeInteger,=,1001
Operations=and
TrueRuleChain=CheckContactedAAA
TrueRuleChain=LogBeforeUpdateSSLTable
TrueRuleChain=UpdateToSSLSession


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/StoreGetAuthContactedAAA/CheckContactedAAA]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevOriginHostString,=,DEG_OEMDevPrimaryDesthostString
FalseRuleChain=RememberSecondaryAAAAddress
TrueRuleChain=RememberPrimaryAAAAddress


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/StoreGetAuthContactedAAA/CheckContactedAAA/RememberPrimaryAAAAddress]

AdornOps=set DEG_OEMDevGetAuthContactedAAAString "PRIMARY_AAA"
AdornOps=copy DEG_OEMDevGetAuthContactedAAAString DEG_GETAUTH_CONTACTED_AAA
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/StoreGetAuthContactedAAA/CheckContactedAAA/RememberSecondaryAAAAddress]

AdornOps=set DEG_OEMDevGetAuthContactedAAAString "SECONDARY_AAA"
AdornOps=copy DEG_OEMDevGetAuthContactedAAAString DEG_GETAUTH_CONTACTED_AAA
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/StoreGetAuthContactedAAA/LogBeforeUpdateSSLTable]

Attributes=DEG_OEMDevOriginHostString
Attributes=DEG_OEMDevOriginRealmString
Attributes=DEG_GETAUTH_CONTACTED_AAA
Attributes=DEG_SSL_ID
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_OEMDevGetAuthContactedAAAString
ClassName=LogNMERule
LogLevel=INFO
Message=Logging Before Update DEG_SSL_AAA_SESSIONID:


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/StoreGetAuthContactedAAA/UpdateToSSLSession]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_GETAUTH_CONTACTED_AAA,DEG_GETAUTH_CONTACTED_AAA
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromSecondaryAAA]

RuleNames=100.DEASNMEConversion
RuleNames=105.CheckIfResultCodeNull
RuleNames=110.SetFailureIndicationFlagIncaseOfFailure
RuleNames=200.CheckAAAFailureIndication


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromSecondaryAAA/100.DEASNMEConversion]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.ReceiveDEAFromSecondaryAAA/100.DEASNMEConversion


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromSecondaryAAA/105.CheckIfResultCodeNull]

ClassName=ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,=,0
TrueRuleChain=SetResultCode


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromSecondaryAAA/105.CheckIfResultCodeNull/SetResultCode]

AdornOps=copy DEG_OEMDevExperimentalResultCodeInteger DEG_OEMDevResultCodeInteger
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromSecondaryAAA/110.SetFailureIndicationFlagIncaseOfFailure]

ClassName=ConditionalRule
Conditions=DEG_SSL_AAA_SESSIONID,=,""
TrueRuleChain=SetFailureFlag


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromSecondaryAAA/110.SetFailureIndicationFlagIncaseOfFailure/SetFailureFlag]

AdornOps=set DEG_OEMDevAAAFailureIndicationFlagInteger 1
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromSecondaryAAA/200.CheckAAAFailureIndication]

ClassName=ConditionalRule
Conditions=DEG_OEMDevAAAFailureIndicationFlagInteger,=,1
TrueRuleChain=100.LogFailureOfSecondaryAAA
TrueRuleChain=200.CallPrimaryAAAInCaseofSecondaryFailure
TrueRuleChain=300.ReceiveDEAFromAAAInCaseofSecondaryFailure


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromSecondaryAAA/200.CheckAAAFailureIndication/100.LogFailureOfSecondaryAAA]

ClassName=LogNMERule
LogLevel=DEBUG2
Message=Secondary AAA failed to respond(AAA-failure-Indication). Calling Primary AAA.


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromSecondaryAAA/200.CheckAAAFailureIndication/200.CallPrimaryAAAInCaseofSecondaryFailure]

ClassName=LocalRuleChainInvoker
RuleChain=301C.SendDERToAAAInFailureCondition
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromSecondaryAAA/200.CheckAAAFailureIndication/300.ReceiveDEAFromAAAInCaseofSecondaryFailure]

ClassName=LocalRuleChainInvoker
RuleChain=301C.ReceiveDEAFromAAAInFailureCondition
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToAAAInFailureCondition]

RuleNames=005.SetParameters
RuleNames=010.SetParameters
RuleNames=LookupSSLTableForSessionId
RuleNames=LogSessioIDAfterLookup
RuleNames=100.DERNMEConversion
RuleNames=100.LogBeforePrimaryAAACallInCaseSecondaryFailure
RuleNames=120.SendDERRequest
RuleNames=130.LogIfRequestTimeOutFlagSet


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToAAAInFailureCondition/005.SetParameters]

AdornOps=set disc 0
AdornOps=set DEG_OEMDevProxiableFlagInteger 1
AdornOps=set DEG_OEMDevRequestFlagInteger 1
AdornOps=setsystime DEG_OEMDevSessionIdTimeInMilliSecs
AdornOps=/ DEG_OEMDevSessionIdTimeInMilliSecs 1000 DEG_OEMDevSessionIdTimeInSecs
AdornOps=- DEG_OEMDevSessionIdTimeInMilliSecs DEG_OEMDevSessionIdTimeInSecs DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=* DEG_OEMDevSessionIdTimeInNanoSecsLong 1000000 DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=set DEG_OEMDevOriginRealmString ${DEVICE_SERVER_REALM}
AdornOps=set DEG_OEMDevOriginHostString ${DEVICE_DIAMETER_SERVER_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDesthostString ${PRIMARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=set DEG_OEMDevSecondaryDesthostString ${SECONDARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevSecondaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=set DEG_OEMDevAuthApplicationIdInteger 16777264
AdornOps=set DEG_OEMDevAuthRequestTypeInteger 3
AdornOps=set DEG_OEMDevRATTypeInteger 2001
AdornOps=str2bin DEG_OEMDevVisitedNetworkIdString DEG_OEMDevVisitedNetworkIdBinary
AdornOps=set DEG_OEMDevAuthLifeTime 2592000
AdornOps=set DEG_OEMDevAuthGracePeriod 7200
AdornOps=set DEG_OEMDevAuthSessionState 0
AdornOps=set DEG_OEMDevANIDString NSN
AdornOps=set DEG_SSL_STATE WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA
AdornOps=copy DEG_SSL_AAA_STATE DEG_OEMDevDiameterStateBinary
AdornOps=setsystime DEG_OEMDevAAAProcessStartTimeLong
AdornOps=setifnull DEG_AuditUniqueIDString ""
AdornOps=copy DEG_AuditUniqueIDString DEG_MSESSIONUNIQUE_ID
AdornOps=copy EAP_PayloadBinary DEG_OEMDevEAPPayloadBinary
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToAAAInFailureCondition/010.SetParameters]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.SendDERToAAAInFailureCondition/010.SetParameters


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToAAAInFailureCondition/100.DERNMEConversion]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.SendDERToAAAInFailureCondition/100.DERNMEConversion


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToAAAInFailureCondition/100.LogBeforePrimaryAAACallInCaseSecondaryFailure]

Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_OEMDevAuthApplicationIdInteger
Attributes=DEG_OEMDevOriginHostString
Attributes=DEG_OEMDevOriginRealmString
Attributes=DEG_OEMDevSecondaryDestRealmString
Attributes=DEG_OEMDevAuthRequestTypeInteger
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRATTypeInteger
Attributes=DEG_OEMDevVisitedNetworkIdBinary
Attributes=DEG_OEMDevAuthLifeTime
Attributes=DEG_OEMDevAuthGracePeriod
Attributes=DEG_OEMDevAuthSessionState
Attributes=DEG_OEMDevANIDString
Attributes=DEG_OEMDevDiameterStateBinary
ClassName=LogNMERule
LogLevel=DEBUG2
Message=Logging Before Primary AAA call In case of Secondary Failure:


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToAAAInFailureCondition/120.SendDERRequest]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.SendDERToAAAInFailureCondition/120.SendDERRequest


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToAAAInFailureCondition/120.SendDERRequest/Decoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpDecoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWm/DiameterEAPAnswerSWm


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToAAAInFailureCondition/120.SendDERRequest/Encoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpEncoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWm/DiameterEAPRequestSWm


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToAAAInFailureCondition/130.LogIfRequestTimeOutFlagSet]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=toFlag,!=,0
TrueRuleChain=100.SetErrorParams
TrueRuleChain=108.SetErrorInfo
TrueRuleChain=110.Log


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToAAAInFailureCondition/130.LogIfRequestTimeOutFlagSet/100.SetErrorParams]

AdornOps=set DEG_OEMDevErrorMessageString "AAA could not reply in configured timeout period,Return code is "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToAAAInFailureCondition/130.LogIfRequestTimeOutFlagSet/108.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEGv31.GA.164"
AdornOps=set DEG_OEMDevErrorMessageString "Timeout Error,Return code is "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToAAAInFailureCondition/130.LogIfRequestTimeOutFlagSet/110.Log]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=From DEG to AAA Request Timeout Error : 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToAAAInFailureCondition/LogSessioIDAfterLookup]

Attributes=DEG_SSL_ID
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_OEMDevEAPPayloadBinary
ClassName=LogNMERule
LogLevel=DEBUG2
Message=Logging Session ID After Lookup:


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToAAAInFailureCondition/LookupSSLTableForSessionId]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToSecondaryAAA]

RuleNames=005.SetParameters
RuleNames=010.SetParameters
RuleNames=100.SetParameters
RuleNames=100.DERNMEConversion
RuleNames=100.LogBeforeSecondaryAAACall
RuleNames=120.SendDERRequest
RuleNames=130.LogIfRequestTimeOutFlagSet


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToSecondaryAAA/005.SetParameters]

AdornOps=set disc 0
AdornOps=set DEG_OEMDevProxiableFlagInteger 1
AdornOps=set DEG_OEMDevRequestFlagInteger 1
AdornOps=setsystime DEG_OEMDevSessionIdTimeInMilliSecs
AdornOps=/ DEG_OEMDevSessionIdTimeInMilliSecs 1000 DEG_OEMDevSessionIdTimeInSecs
AdornOps=- DEG_OEMDevSessionIdTimeInMilliSecs DEG_OEMDevSessionIdTimeInSecs DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=* DEG_OEMDevSessionIdTimeInNanoSecsLong 1000000 DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=set DEG_OEMDevOriginRealmString ${DEVICE_SERVER_REALM}
AdornOps=set DEG_OEMDevOriginHostString ${DEVICE_DIAMETER_SERVER_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDesthostString ${PRIMARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=set DEG_OEMDevSecondaryDesthostString ${SECONDARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevSecondaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=set DEG_OEMDevAuthApplicationIdInteger 16777264
AdornOps=set DEG_OEMDevAuthRequestTypeInteger 3
AdornOps=set DEG_OEMDevRATTypeInteger 2001
AdornOps=str2bin DEG_OEMDevVisitedNetworkIdString DEG_OEMDevVisitedNetworkIdBinary
AdornOps=set DEG_OEMDevAuthLifeTime 2592000
AdornOps=set DEG_OEMDevAuthGracePeriod 7200
AdornOps=set DEG_OEMDevAuthSessionState 0
AdornOps=set DEG_OEMDevANIDString NSN
AdornOps=set DEG_SSL_STATE WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA
AdornOps=copy DEG_SSL_AAA_STATE DEG_OEMDevDiameterStateBinary
AdornOps=setsystime DEG_OEMDevAAAProcessStartTimeLong
AdornOps=setifnull DEG_AuditUniqueIDString ""
AdornOps=copy DEG_AuditUniqueIDString DEG_MSESSIONUNIQUE_ID
AdornOps=copy DEG_OEMDevEAPPayloadBinary EAP_PayloadBinary
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToSecondaryAAA/010.SetParameters]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.SendDERToSecondaryAAA/010.SetParameters


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToSecondaryAAA/100.DERNMEConversion]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.SendDERToSecondaryAAA/100.DERNMEConversion


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToSecondaryAAA/100.LogBeforeSecondaryAAACall]

Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_OEMDevAuthApplicationIdInteger
Attributes=DEG_OEMDevOriginHostString
Attributes=DEG_OEMDevOriginRealmString
Attributes=DEG_OEMDevSecondaryDestRealmString
Attributes=DEG_OEMDevAuthRequestTypeInteger
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRATTypeInteger
Attributes=DEG_OEMDevVisitedNetworkIdBinary
Attributes=DEG_OEMDevAuthLifeTime
Attributes=DEG_OEMDevAuthGracePeriod
Attributes=DEG_OEMDevAuthSessionState
Attributes=DEG_OEMDevANIDString
Attributes=DEG_OEMDevDiameterStateBinary
Attributes=DEG_OEMDevRedirectEAPPayloadBinary
ClassName=LogNMERule
LogLevel=DEBUG2
Message=Logging Before Secondary AAA call:


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToSecondaryAAA/100.SetParameters]

AdornOps=copy DEG_OEMDevRedirectEAPPayloadBinary DEG_OEMDevEAPPayloadBinary
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToSecondaryAAA/120.SendDERRequest]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.SendDERToSecondaryAAA/120.SendDERRequest


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToSecondaryAAA/120.SendDERRequest/Decoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpDecoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWm/DiameterEAPAnswerSWm


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToSecondaryAAA/120.SendDERRequest/Encoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpEncoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWm/DiameterEAPRequestSWm


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToSecondaryAAA/130.LogIfRequestTimeOutFlagSet]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=toFlag,!=,0
TrueRuleChain=100.SetErrorParams
TrueRuleChain=108.SetErrorInfo
TrueRuleChain=110.Log


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToSecondaryAAA/130.LogIfRequestTimeOutFlagSet/100.SetErrorParams]

AdornOps=set DEG_OEMDevErrorMessageString "AAA could not reply in configured timeout period,Return code is "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToSecondaryAAA/130.LogIfRequestTimeOutFlagSet/108.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEGv31.GA.163"
AdornOps=set DEG_OEMDevErrorMessageString "Timeout Error,Return code is "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.SendDERToSecondaryAAA/130.LogIfRequestTimeOutFlagSet/110.Log]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=From DEG to AAA Request Timeout Error : 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain]

ClassName=RuleChain
RuleNames=100.CheckAAAResultCode


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,=,2001
FalseRuleChain=200.CheckIfDiameterMultiRoundAuth
TrueRuleChain=100.setSessionStatus
TrueRuleChain=110.GenerateAAACallEndOKAuditData
TrueRuleChain=120.STRProcessingRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/100.setSessionStatus]

AdornOps=set DEG_SSL_STATE AUTHENTICATED_BY_AAA
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "EAP"
AdornOps=setsystime DEG_FULLAUTHTIMESTAMP
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_CDevOutReturnCodeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/110.GenerateAAACallEndOKAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=535.GenerateAAADERCallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequest
RuleNames=110.ReadValue
RuleNames=120.CheckErrorAndNoMatchFlag
RuleNames=130.ExecuteDependingOnSysParameterValue


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/100.InitRequest]

AdornOps=set DEG_CDevSysParameter "DEG_AAA_CONNECTIONTYPE"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevGetAAAConnectionTypeValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
FalseRuleChain=200.DefaultValue
Operations=and
TrueRuleChain=100.SetSysValue


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/120.CheckErrorAndNoMatchFlag/100.SetSysValue]

AdornOps=copy DEG_CDevSysValueString DEG_CDevGetAAAConnectionTypeValueString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/120.CheckErrorAndNoMatchFlag/200.DefaultValue]

AdornOps=set DEG_CDevGetAAAConnectionTypeValueString "Internal"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevGetAAAConnectionTypeValueString,=,"Internal"
Conditions=DEG_CDevGetAAAConnectionTypeValueString,=,"External"
InvokeSTRProcessingRuleChain=100.InvokeSTRProcessingRuleChain
Operations=None
TrueRuleChain=UpdateSTRFlag
TrueRuleChain=InvokeSTRProcessingRuleChain
UpdateSTRFlag=001.setSTRFlag
UpdateSTRFlag=100.UpdateSession
UpdateSTRFlag=070.SetErrorInfo
UpdateSTRFlag=110.LogUpdate


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue/001.setSTRFlag]

AdornOps=set DEG_STR_FLAG 1
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps= setifnull DEG_OEMDevDiameterSessionIdString ""
AdornOps=copy DEG_OEMDevDiameterSessionIdString DEG_SSL_AAA_SESSIONID
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue/070.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEGv31.GA.157"
AdornOps=set DEG_OEMDevErrorMessageString "Update STR Flag for Internal AAA : "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue/100.InvokeSTRProcessingRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_SSL_AAA_SESSIONID
RequestAttributes=DEG_OEMDevAuthApplicationIdInteger
RequestAttributes=DEG_SSL_NAI
ResponseAttributes=DEG_OEMDevDiameterSessionIdString
ResponseAttributes=DEG_OEMDevResultCodeInteger
RuleChain=303.STRProcessingRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue/100.UpdateSession]

ClassName=UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_STR_FLAG,DEG_STR_FLAG
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue/110.LogUpdate]

Attributes=DEG_OEMDevDiameterSessionIdString
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_OEMDevOriginHostString
Attributes=DEG_OEMDevOriginRealmString
Attributes=DEG_SSL_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_IMSI
ClassName=LogNMERule
LogLevel=DEBUG
Message=Update STR Flag for Internal AAA : 
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,=,1001
FalseRuleChain=200.CheckIfDiameterAuthRejected
TrueRuleChain=100.setSessionStatus
TrueRuleChain=110.GenerateAAACallEndOKAuditData


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/100.setSessionStatus]

AdornOps=set DEG_SSL_STATE WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE
AdornOps=copy DEG_OEMDevDiameterStateBinary DEG_SSL_AAA_STATE
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_CDevOutReturnCodeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/110.GenerateAAACallEndOKAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=535.GenerateAAADERCallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,=,4001
Conditions=DEG_OEMDevResultCodeInteger,within,[5001,5003]
FalseRuleChain=200.isDiameterError
Operations=or
TrueRuleChain=100.setSessionStatus
TrueRuleChain=110.GenerateAAACallEndOKAuditData


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/100.setSessionStatus]

AdornOps=set DEG_SSL_STATE AKA_CHALLENGE_REJECTED_BY_AAA
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_CDevOutReturnCodeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/110.GenerateAAACallEndOKAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=535.GenerateAAADERCallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=errFlag,!=,0
Conditions=DEG_OEMDevResultCodeInteger,within,[3001-3005,3007-3010]
Conditions=DEG_OEMDevResultCodeInteger,within,[5002,5004-5017,5241,5450,5452]
Operations=or,or
TrueRuleChain=100.CheckEAPAKADefaultValue
TrueRuleChain=120.GenerateAAACallEndErrorAuditData
TrueRuleChain=130.GenerateAAAAkaRejectedEndAuditDataRuleChain


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/100.CheckEAPAKADefaultValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=210G.DEG21CheckEAPAKADefaultRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/120.GenerateAAACallEndErrorAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=534.GenerateAAADERCallEndErrorAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/130.GenerateAAAAkaRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,1
Conditions=DEG_OEMDevActionNameString,=,"getAuthentication"
Operations=and
TrueRuleChain=100.AuditDataRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/130.GenerateAAAAkaRejectedEndAuditDataRuleChain/100.AuditDataRule]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevXProtocolVersionString,=,2
FalseRuleChain=100.CreateENDAuditRecordV1
TrueRuleChain=200.CreateEndAuditRecordV2


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/130.GenerateAAAAkaRejectedEndAuditDataRuleChain/100.AuditDataRule/100.CreateENDAuditRecordV1]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=505.GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/130.GenerateAAAAkaRejectedEndAuditDataRuleChain/100.AuditDataRule/200.CreateEndAuditRecordV2]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/302.SendPostChallengeDER]

RuleNames=SetAAAAddress
RuleNames=100.DERNMEConversion
RuleNames=110.GenerateAAACallStartAuditData
RuleNames=120.SendDERRequest
RuleNames=130.LogIfRequestTimeOutFlagSet


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/302.SendPostChallengeDER/100.DERNMEConversion]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/302.SendPostChallengeDER/100.DERNMEConversion


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/302.SendPostChallengeDER/110.GenerateAAACallStartAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=533.GenerateAAADERCallStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/302.SendPostChallengeDER/120.SendDERRequest]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/302.SendPostChallengeDER/120.SendDERRequest


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/302.SendPostChallengeDER/120.SendDERRequest/Decoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpDecoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWm/DiameterEAPAnswerSWm


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/302.SendPostChallengeDER/120.SendDERRequest/Encoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpEncoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWm/DiameterEAPRequestSWm


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/302.SendPostChallengeDER/130.LogIfRequestTimeOutFlagSet]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=toFlag,!=,0
TrueRuleChain=100.SetErrorParams
TrueRuleChain=108.SetErrorInfo
TrueRuleChain=110.Log


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/302.SendPostChallengeDER/130.LogIfRequestTimeOutFlagSet/100.SetErrorParams]

AdornOps=set DEG_OEMDevErrorMessageString "AAA could not reply in configured timeout period,Return code is "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/302.SendPostChallengeDER/130.LogIfRequestTimeOutFlagSet/108.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEGv31.GA.165"
AdornOps=set DEG_OEMDevErrorMessageString "Timeout Error,Return code is "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/302.SendPostChallengeDER/130.LogIfRequestTimeOutFlagSet/110.Log]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=From DEG to AAA Request Timeout Error : 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/302.SendPostChallengeDER/SetAAAAddress]

ClassName=ConditionalRule
Conditions=DEG_GETAUTH_CONTACTED_AAA,=,"PRIMARY_AAA"
FalseRuleChain=LoadSecondaryAAAEnvironment
TrueRuleChain=LoadPrimaryAAAEnvironment


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/302.SendPostChallengeDER/SetAAAAddress/LoadPrimaryAAAEnvironment]

AdornOps=set DEG_OEMDevDestinationHostString ${PRIMARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevDestinationRealmString ${AAA_SERVER_REALM}
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/302.SendPostChallengeDER/SetAAAAddress/LoadSecondaryAAAEnvironment]

AdornOps=set DEG_OEMDevDestinationHostString ${SECONDARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevDestinationRealmString ${AAA_SERVER_REALM}
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetRequestParams
RuleNames=101.SetRequestParams
RuleNames=275.STRCallStartAuditDataRule
RuleNames=110.STRNMEConversion
RuleNames=175.SetErrorInfo
RuleNames=200.LogSTRRequest
RuleNames=300.SendSTRRequest


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/100.SetRequestParams]

AdornOps=set disc 0
AdornOps=set DEG_OEMDevRequestFlagInteger 1
AdornOps=set DEG_OEMDevTerminationCauseInteger 8
AdornOps=set DEG_OEMDevOriginRealmString ${DEVICE_SERVER_REALM}
AdornOps=set DEG_OEMDevOriginHostString ${DEVICE_DIAMETER_SERVER_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDesthostString ${PRIMARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=set DEG_OEMDevSecondaryDesthostString ${SECONDARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevSecondaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=copy DEG_SSL_AAA_SESSIONID DEG_OEMDevDiameterSessionIdString
AdornOps=copy DEG_SSL_NAI DEG_OEMDevSubscriberIdString
AdornOps=set DEG_OEMDevAuthApplicationIdInteger 16777264
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/101.SetRequestParams]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/303.STRProcessingRuleChain/101.SetRequestParams


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/110.STRNMEConversion]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/303.STRProcessingRuleChain/110.STRNMEConversion


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/175.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEGv31.GA.159"
AdornOps=set DEG_OEMDevErrorMessageString "STRProcessingRule - STRRequest:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/200.LogSTRRequest]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevDiameterSessionIdString
Attributes=DEG_OEMDevOriginHostString
Attributes=DEG_OEMDevOriginRealmString
Attributes=DEG_OEMDevPrimaryDestRealmString
Attributes=DEG_OEMDevTerminationCauseInteger
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevPrimaryDesthostString
Attributes=DEG_SSL_ID
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=STRProcessingRule - STRRequest:
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/275.STRCallStartAuditDataRule]

ClassName=LocalRuleChainInvoker
RuleChain=275.GenerateAAASTRCallStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/300.SendSTRRequest]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/303.STRProcessingRuleChain/300.SendSTRRequest


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/300.SendSTRRequest/Decoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpDecoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWm/SessionTerminationAnswerSWm


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/300.SendSTRRequest/Encoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpEncoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWm/SessionTerminationRequestSWm


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain]

ClassName=RuleChain
RuleNames=100.SetResponseParams
RuleNames=200.STASNMEConversion
RuleNames=205.CheckIfResultCodeNull
RuleNames=210.InitLookup
RuleNames=220.LookupSessionTable
RuleNames=230.CheckLookupStatus
RuleNames=300.UpdateSTRFlag
RuleNames=330.SetErrorInfo
RuleNames=400.LogAfterSTAResponse


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/100.SetResponseParams]

AdornOps=set DEG_OEMDevNeedResponseInteger 0
AdornOps=set DEG_OEMDevErrorMessageString ""
AdornOps=set DEG_OEMDevOriginHostString ""
AdornOps=set DEG_OEMDevOriginRealmString ""
AdornOps=set DEG_OEMDevDiameterSessionIdString ""
AdornOps=set DEG_OEMDevResultCodeInteger 0
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/200.STASNMEConversion]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/304.STAProcessingRuleChain/200.STASNMEConversion


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/205.CheckIfResultCodeNull]

ClassName=ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,=,0
TrueRuleChain=SetResultCode


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/205.CheckIfResultCodeNull/SetResultCode]

AdornOps=copy DEG_OEMDevExperimentalResultCodeInteger DEG_OEMDevResultCodeInteger
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/210.InitLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevDiameterSessionIdString DEG_SSL_AAA_SESSIONID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/220.LookupSessionTable]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExistFlag
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.PrintError


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEGv31.GA.160"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/110.PrintError]

Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while looking up in DEG_SSL_SESSION table
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
FalseRuleChain=50.SetErrorInfo
FalseRuleChain=100.ErrorLog
FalseRuleChain=200.SetErrorEndAudit


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/100.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to get data from DEG_SSL_SESSION table:
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/200.SetErrorEndAudit]

ClassName=LocalRuleChainInvoker
RuleChain=276.GenerateAAASTRCallEndErrorAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/50.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEGv31.GA.161"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to get data from DEG_SSL_SESSION table:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/300.UpdateSTRFlag]

ClassName=ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,within,[2001,5002]
FalseRuleChain=275.STRCallEndErrorAuditDataRule
TrueRuleChain=275.STACallEndOKAuditDataRule
TrueRuleChain=001.setSTRFlag
TrueRuleChain=100.UpdateSession


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/300.UpdateSTRFlag/001.setSTRFlag]

AdornOps=set DEG_STR_FLAG 1
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=copy DEG_OEMDevDiameterSessionIdString DEG_SSL_AAA_SESSIONID
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/300.UpdateSTRFlag/100.UpdateSession]

ClassName=UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_STR_FLAG,DEG_STR_FLAG
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/300.UpdateSTRFlag/275.STACallEndOKAuditDataRule]

ClassName=LocalRuleChainInvoker
RuleChain=277.GenerateAAASTACallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/300.UpdateSTRFlag/275.STRCallEndErrorAuditDataRule]

ClassName=LocalRuleChainInvoker
RuleChain=276.GenerateAAASTRCallEndErrorAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/330.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEGv31.GA.162"
AdornOps=set DEG_OEMDevErrorMessageString "STAResponse : "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/400.LogAfterSTAResponse]

Attributes=DEG_OEMDevDiameterSessionIdString
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_OEMDevOriginHostString
Attributes=DEG_OEMDevOriginRealmString
Attributes=DEG_SSL_ID
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=STAResponse : 
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=copy DEG_OEMDevAAAProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DER"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
AdornOps=set DEG_AuditDeviceTypeString ""
AdornOps=set DEG_AuditNRBMessageString ""
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO AAA -> Sending AAA DER message: "
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_OEMDevAAAProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DER"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=setifnull DEG_OEMDevErrorMessageString ""
AdornOps=setifnull DEG_CDevProcessingErrorIdString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "After sending DER message: "
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevProcessingErrorIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevProcessingErrorIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
AdornOps=set DEG_AuditNRBMessageString "AAA to DEG response, Return Code from AAA is "
AdornOps=+ DEG_AuditNRBMessageString DEG_CDevOutReturnCodeString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_OEMDevAAAProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DER"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO DEG -> After sending DER message: "
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful execution of AAA call,Return code from AAA is "
AdornOps=+ DEG_AuditNRBMessageString DEG_CDevOutReturnCodeString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true
