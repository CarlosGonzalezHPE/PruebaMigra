

[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain]


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/Connectors]

ConnectorNames=100.HttpClientConnector


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/Connectors/100.HttpClientConnector]

ClassName=HttpClientConnector
DefaultRequest=EAPSIMRequest
RequestAttribute=DEG_MAPRequestString
Requests=EAPAKARequest
Requests=EAPSIMRequest
SynchronousCallTimeout=5000


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/Connectors/100.HttpClientConnector/EAPAKARequest]

ClassName=PlainHttpRequest
HttpMethod=POST
RequestAttributeMap=V,DEG_MAPVersionString
RequestAttributeMap=U,DEG_MAPUserNameString
RequestAttributeMap=OP,DEG_MAPOperationString
RequestAttributeMap=IMSI,DEG_MAPIMSIString
RequestAttributeMap=NV,DEG_MAPNumVectorsInteger,1
RequestAttributeMap=RAND,DEG_EAPAKARANDBinary
RequestAttributeMap=AUTS,DEG_EAPAKAAUTSBinary


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/Connectors/100.HttpClientConnector/EAPAKARequest/ResponseHandler]

ClassName=DelimitedTextResponseHandler
NameValueSeparators==
ResponseAttributeMap=RV,DEG_MAPResponseValueInteger,2
ResponseAttributeMap=RANDQ1,DEG_MAPRand1String,""
ResponseAttributeMap=RANDQ2,DEG_MAPRand2String,""
ResponseAttributeMap=RANDQ3,DEG_MAPRand3String,""
ResponseAttributeMap=RANDQ4,DEG_MAPRand4String,""
ResponseAttributeMap=RANDQ5,DEG_MAPRand5String,""
ResponseAttributeMap=XRES1,DEG_MAPXRES1String,""
ResponseAttributeMap=XRES2,DEG_MAPXRES2String,""
ResponseAttributeMap=XRES3,DEG_MAPXRES3String,""
ResponseAttributeMap=XRES4,DEG_MAPXRES4String,""
ResponseAttributeMap=XRES5,DEG_MAPXRES5String,""
ResponseAttributeMap=Ck1,DEG_MAPCK1String,""
ResponseAttributeMap=Ck2,DEG_MAPCK2String,""
ResponseAttributeMap=Ck3,DEG_MAPCK3String,""
ResponseAttributeMap=Ck4,DEG_MAPCK4String,""
ResponseAttributeMap=Ck5,DEG_MAPCK5String,""
ResponseAttributeMap=Ik1,DEG_MAPIK1String,""
ResponseAttributeMap=Ik2,DEG_MAPIK2String,""
ResponseAttributeMap=Ik3,DEG_MAPIK3String,""
ResponseAttributeMap=Ik4,DEG_MAPIK4String,""
ResponseAttributeMap=Ik5,DEG_MAPIK5String,""
ResponseAttributeMap=AUTN1,DEG_MAPAUTN1String,""
ResponseAttributeMap=AUTN2,DEG_MAPAUTN2String,""
ResponseAttributeMap=AUTN3,DEG_MAPAUTN3String,""
ResponseAttributeMap=AUTN4,DEG_MAPAUTN4String,""
ResponseAttributeMap=AUTN5,DEG_MAPAUTN5String,""
ResponseParameterSeparator=,


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/Connectors/100.HttpClientConnector/EAPSIMRequest]

ClassName=PlainHttpRequest
HttpMethod=POST
RequestAttributeMap=V,DEG_MAPVersionString
RequestAttributeMap=U,DEG_MAPUserNameString
RequestAttributeMap=OP,DEG_MAPOperationString
RequestAttributeMap=IMSI,DEG_MAPIMSIString
RequestAttributeMap=NV,DEG_MAPNumVectorsInteger,5
RequestAttributeMap=TRO,DEG_MAPTROString,Y


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/Connectors/100.HttpClientConnector/EAPSIMRequest/ResponseHandler]

ClassName=DelimitedTextResponseHandler
NameValueSeparators==
ResponseAttributeMap=RV,DEG_MAPResponseValueInteger,2
ResponseAttributeMap=RANDT1,DEG_MAPRand1String,""
ResponseAttributeMap=RANDT2,DEG_MAPRand2String,""
ResponseAttributeMap=RANDT3,DEG_MAPRand3String,""
ResponseAttributeMap=RANDT4,DEG_MAPRand4String,""
ResponseAttributeMap=RANDT5,DEG_MAPRand5String,""
ResponseAttributeMap=SRES1,DEG_MAPSRES1String,""
ResponseAttributeMap=SRES2,DEG_MAPSRES2String,""
ResponseAttributeMap=SRES3,DEG_MAPSRES3String,""
ResponseAttributeMap=SRES4,DEG_MAPSRES4String,""
ResponseAttributeMap=SRES5,DEG_MAPSRES5String,""
ResponseAttributeMap=KC1,DEG_MAPKC1String,""
ResponseAttributeMap=KC2,DEG_MAPKC2String,""
ResponseAttributeMap=KC3,DEG_MAPKC3String,""
ResponseAttributeMap=KC4,DEG_MAPKC4String,""
ResponseAttributeMap=KC5,DEG_MAPKC5String,""
ResponseParameterSeparator=,


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/Connectors/100.HttpClientConnector/EndPoints]

ClassName=com.hp.usage.connector.lookup.RoundRobinEndPointSelector
EndPoints=EndPoint1
EndPoints=EndPoint2
ReconnectRetryInterval=30
ReconnectRetryLimit=3


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/Connectors/100.HttpClientConnector/EndPoints/EndPoint1]

ClassName=HttpEndPoint
NumberRetries=3
NumConnections=10
RemoteHostURL=${AAA_HTTP_REMOTE_HOST_URL1}
RetryTimeout=20000


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/Connectors/100.HttpClientConnector/EndPoints/EndPoint2]

ClassName=HttpEndPoint
NumberRetries=3
NumConnections=10
RemoteHostURL=${AAA_HTTP_REMOTE_HOST_URL2}
RetryTimeout=20000


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains]

RuleChainNames=400.HSSMAPGWProcessingRuleChain
RuleChainNames=912.GenerateAAAMapGatewayCallStartAuditDataRuleChain
RuleChainNames=913.GenerateAAAMapGatewayCallEndErrorAuditDataRuleChain
RuleChainNames=914.GenerateAAAMapGatewayCallEndOKAuditDataRuleChain


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain]

ClassName=RuleChain
RuleNames=100.InitHLRRequest
RuleNames=200.CheckIfNewSession
RuleNames=300.UpdateAAASession
RuleNames=400.InvokeHttpConnector
RuleNames=500.ValidateHLRResponse
RuleNames=600.GenerateMapGatewayCallEndAuditData


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/100.InitHLRRequest]

AdornOps=set DEG_MAPRequestString "EAPAKARequest"
AdornOps=set DEG_MAPNumVectorsInteger 1
AdornOps=set DEG_MAPVersionString "1"
AdornOps=copy DEG_EAPUserIdentityString DEG_MAPUserNameString
AdornOps=copy DEG_MAPUserNameString DEG_AAAUserNameString
AdornOps=set DEG_MAPOperationString 20
AdornOps=set DEG_MAPTROString Y
AdornOps=substr 1 "@" DEG_MAPUserNameString DEG_MAPIMSIString
AdornOps=set DEG_MAPHttpErrorAttributeString ""
AdornOps=set DEG_MAPHttpErrorMsgAttributeString ""
AdornOps=set DEG_EAPSIMTripletsRequiredInteger 3
AdornOps=setsystime DEG_AAAHLRProcessStartTimeLong
AdornOps=setifnull DEG_EAPAKAAUTSBinary 0
AdornOps=set DEG_MAPRANDList null
AdornOps=set DEG_AAARANDList null
AdornOps=set DEG_MAPCKList null
AdornOps=set DEG_AAACKList null
AdornOps=set DEG_MAPIKList null
AdornOps=set DEG_AAAIKList null
AdornOps=set DEG_MAPXRESList null
AdornOps=set DEG_AAAXRESList null
AdornOps=set DEG_MAPAUTNList null
AdornOps=set DEG_AAAAUTNList null
AdornOps=set DEG_MAPSRESList null
AdornOps=set DEG_AAASRESList null
AdornOps=set DEG_MAPKCList null
AdornOps=set DEG_AAAKCList null
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/200.CheckIfNewSession]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_EAPAKAAUTSBinary,=,0
FalseRuleChain=200.SetWAIT_FOR_REAUTHVECTORS_FROM_AUC
TrueRuleChain=100.SetWAIT_FOR_AUTHVECTORS_FROM_AUC


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/200.CheckIfNewSession/100.SetWAIT_FOR_AUTHVECTORS_FROM_AUC]

AdornOps=copy DEG_EAPUserIdentityString DEG_USERIDENTITY
AdornOps=set DEG_STATUS "WAIT_FOR_AUTHVECTORS_FROM_AUC"
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
AdornOps=set DEG_MAPReSyncInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/200.CheckIfNewSession/200.SetWAIT_FOR_REAUTHVECTORS_FROM_AUC]

AdornOps=copy DEG_EAPUserIdentityString DEG_USERIDENTITY
AdornOps=set DEG_STATUS "WAIT_FOR_REAUTHVECTORS_FROM_AUC"
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
AdornOps=set DEG_MAPReSyncInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/300.UpdateAAASession]

ClassName=RuleChain
RuleNames=100.InitAAASessionUpdate
RuleNames=200.ExecuteAAASessionUpdate
RuleNames=300.CheckAAASessionUpdateStatus


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/300.UpdateAAASession/100.InitAAASessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_AAA_SESSIONS
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 0
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/300.UpdateAAASession/200.ExecuteAAASessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_USERIDENTITY,DEG_USERIDENTITY
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=2.MatchByUserIdentity
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/300.UpdateAAASession/300.CheckAAASessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/300.UpdateAAASession/300.CheckAAASessionUpdateStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access entry in DEG_AAA_SESSIONS table"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0201"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update or access entry in DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/300.UpdateAAASession/300.CheckAAASessionUpdateStatus/110.ErrorLog]

Attributes=DEG_USERIDENTITY
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing MAPGW
NullAlso=true


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.InvokeHttpConnector]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
GetActiveMonitoringSessionsByMDN=001.GetActiveMonitoringSessionsByMDN
InvokeMAPGatewayCall=100.GenerateMapGatewayCallStartAuditData
InvokeMAPGatewayCall=110.HttpClientConnectorRule
Operations=DoAll
TrueRuleChain=GetActiveMonitoringSessionsByMDN
TrueRuleChain=InvokeMAPGatewayCall


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.InvokeHttpConnector/001.GetActiveMonitoringSessionsByMDN]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=008.ReadMonitoringSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.InvokeHttpConnector/100.GenerateMapGatewayCallStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=912.GenerateAAAMapGatewayCallStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.InvokeHttpConnector/110.HttpClientConnectorRule]

ClassName=SynchronousLookupRule
ConnectorName=100.HttpClientConnector
ErrorCodeAttribute=DEG_MAPHttpErrorAttributeString
ErrorMessageAttribute=DEG_MAPHttpErrorMsgAttributeString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse]

ClassName=ConditionalRule
Conditions=DEG_MAPHttpErrorAttributeString,=,""
Conditions=DEG_MAPHttpErrorMsgAttributeString,=,""
FalseRuleChain=200.SetAAAErrorAttributes
FalseRuleChain=210.LogFailureResponse
Operations=and
TrueRuleChain=001.SetErrorInfo
TrueRuleChain=100.LogHLRResponse
TrueRuleChain=110.CheckForHLRError


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/001.SetErrorInfo]

AdornOps=set DEG_AAAErrorMessageString "Response From HLR:"
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0202"
AdornOps=set DEG_OEMDevMessageString "Response From HLR:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/100.LogHLRResponse]

Attribute=DEG_MAPResponseValueInteger
Attribute=DEG_MAPRANDList
Attribute=DEG_MAPXRESList
Attribute=DEG_MAPCKList
Attribute=DEG_MAPIKList
Attribute=DEG_MAPAUTNList
Attribute=DEG_MAPRandString
Attribute=DEG_MAPSRESString
Attribute=DEG_MAPKCString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_AAAErrorMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Response From HLR:
NullAlso=true


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError]

ClassName=ConditionalRule
Conditions=DEG_MAPResponseValueInteger,!=,0
FalseRuleChain=200.CheckRequestType
TrueRuleChain=100.SetAAAErrorAttributes
TrueRuleChain=110.LogFailureResponse


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/100.SetAAAErrorAttributes]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Invalid Response from HLR"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0203"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid Response from HLR"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/110.LogFailureResponse]

Attributes=DEG_MAPResponseValueInteger
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_AAAExperimentalResultInteger
Attributes=DEG_AAAExperimentalResultCodeInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=ERROR
Message=Invalid Response from HLR::


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_MAPRequestString,=,"EAPAKARequest"
Conditions=DEG_MAPRequestString,=,"EAPSIMRequest"
EAPAKARequest=001.InitialiseEAPAKAAttbs
EAPAKARequest=002.SetEAPAKAVectors
EAPSIMRequest=001.InitialiseEAPSIMAttbs
EAPSIMRequest=002.SetEAPSIMAttbs
Operations=None
TrueRuleChain=EAPAKARequest
TrueRuleChain=EAPSIMRequest


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/001.InitialiseEAPAKAAttbs]

AdornOps=setifnull DEG_MAPRand1String ""
AdornOps=setifnull DEG_MAPRand2String ""
AdornOps=setifnull DEG_MAPRand3String ""
AdornOps=setifnull DEG_MAPRand4String ""
AdornOps=setifnull DEG_MAPRand5String ""
AdornOps=setifnull DEG_MAPXRES1String ""
AdornOps=setifnull DEG_MAPXRES2String ""
AdornOps=setifnull DEG_MAPXRES3String ""
AdornOps=setifnull DEG_MAPXRES4String ""
AdornOps=setifnull DEG_MAPXRES5String ""
AdornOps=setifnull DEG_MAPCk1String ""
AdornOps=setifnull DEG_MAPCk2String ""
AdornOps=setifnull DEG_MAPCk3String ""
AdornOps=setifnull DEG_MAPCk4String ""
AdornOps=setifnull DEG_MAPCk5String ""
AdornOps=setifnull DEG_MAPIk1String ""
AdornOps=setifnull DEG_MAPIk2String ""
AdornOps=setifnull DEG_MAPIk3String ""
AdornOps=setifnull DEG_MAPIk4String ""
AdornOps=setifnull DEG_MAPIk5String ""
AdornOps=setifnull DEG_MAPAUTN1String ""
AdornOps=setifnull DEG_MAPAUTN2String ""
AdornOps=setifnull DEG_MAPAUTN3String ""
AdornOps=setifnull DEG_MAPAUTN4String ""
AdornOps=setifnull DEG_MAPAUTN5String ""
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/001.InitialiseEAPSIMAttbs]

AdornOps=setifnull DEG_MAPRand1String ""
AdornOps=setifnull DEG_MAPRand2String ""
AdornOps=setifnull DEG_MAPRand3String ""
AdornOps=setifnull DEG_MAPRand4String ""
AdornOps=setifnull DEG_MAPRand5String ""
AdornOps=setifnull DEG_MAPSRES1String ""
AdornOps=setifnull DEG_MAPSRES2String ""
AdornOps=setifnull DEG_MAPSRES3String ""
AdornOps=setifnull DEG_MAPSRES4String ""
AdornOps=setifnull DEG_MAPSRES5String ""
AdornOps=setifnull DEG_MAPKC1String ""
AdornOps=setifnull DEG_MAPKC2String ""
AdornOps=setifnull DEG_MAPKC3String ""
AdornOps=setifnull DEG_MAPKC4String ""
AdornOps=setifnull DEG_MAPKC5String ""
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateRANDList
RuleNames=110.GenerateXRESList
RuleNames=120.GenerateCKList
RuleNames=130.GenerateIKList
RuleNames=140.GenerateAUTNList
RuleNames=200.ValidateAuthVectors


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/100.GenerateRANDList]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.SetRANDString
RuleNames=002.SetRANDTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/100.GenerateRANDList/001.SetRANDString]

AdornOps=set DEG_MAPRandString ""
AdornOps=+ DEG_MAPRandString DEG_MAPRand1String DEG_MAPRandString
AdornOps=+ DEG_MAPRandString , DEG_MAPRandString
AdornOps=+ DEG_MAPRandString DEG_MAPRand2String DEG_MAPRandString
AdornOps=+ DEG_MAPRandString , DEG_MAPRandString
AdornOps=+ DEG_MAPRandString DEG_MAPRand3String DEG_MAPRandString
AdornOps=+ DEG_MAPRandString , DEG_MAPRandString
AdornOps=+ DEG_MAPRandString DEG_MAPRand4String DEG_MAPRandString
AdornOps=+ DEG_MAPRandString , DEG_MAPRandString
AdornOps=+ DEG_MAPRandString DEG_MAPRand5String DEG_MAPRandString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/100.GenerateRANDList/002.SetRANDTokenString]

ClassName=StringTokenizerRule
Delimiter=,
SourceAttribute=DEG_MAPRandString
TokenAttribute=DEG_MAPRandTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/100.GenerateRANDList/002.SetRANDTokenString/IterationRule]

ClassName=AddToListAttributeRule
InputAttribute=DEG_MAPRandTokenString
ListAttribute=DEG_MAPRANDList


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/110.GenerateXRESList]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.SetXRESString
RuleNames=002.SetXRESTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/110.GenerateXRESList/001.SetXRESString]

AdornOps=set DEG_MAPXRESString ""
AdornOps=+ DEG_MAPXRESString DEG_MAPXRES1String DEG_MAPXRESString
AdornOps=+ DEG_MAPXRESString , DEG_MAPXRESString
AdornOps=+ DEG_MAPXRESString DEG_MAPXRES2String DEG_MAPXRESString
AdornOps=+ DEG_MAPXRESString , DEG_MAPXRESString
AdornOps=+ DEG_MAPXRESString DEG_MAPXRES3String DEG_MAPXRESString
AdornOps=+ DEG_MAPXRESString , DEG_MAPXRESString
AdornOps=+ DEG_MAPXRESString DEG_MAPXRES4String DEG_MAPXRESString
AdornOps=+ DEG_MAPXRESString , DEG_MAPXRESString
AdornOps=+ DEG_MAPXRESString DEG_MAPXRES5String DEG_MAPXRESString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/110.GenerateXRESList/002.SetXRESTokenString]

ClassName=StringTokenizerRule
Delimiter=,
SourceAttribute=DEG_MAPXRESString
TokenAttribute=DEG_MAPXRESTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/110.GenerateXRESList/002.SetXRESTokenString/IterationRule]

ClassName=AddToListAttributeRule
InputAttribute=DEG_MAPXRESTokenString
ListAttribute=DEG_MAPXRESList


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/120.GenerateCKList]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.SetCKString
RuleNames=002.SetCKTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/120.GenerateCKList/001.SetCKString]

AdornOps=set DEG_MAPCkString ""
AdornOps=+ DEG_MAPCkString DEG_MAPCK1String DEG_MAPCkString
AdornOps=+ DEG_MAPCkString , DEG_MAPCkString
AdornOps=+ DEG_MAPCkString DEG_MAPCK2String DEG_MAPCkString
AdornOps=+ DEG_MAPCkString , DEG_MAPCkString
AdornOps=+ DEG_MAPCkString DEG_MAPCK3String DEG_MAPCkString
AdornOps=+ DEG_MAPCkString , DEG_MAPCkString
AdornOps=+ DEG_MAPCkString DEG_MAPCK4String DEG_MAPCkString
AdornOps=+ DEG_MAPCkString , DEG_MAPCkString
AdornOps=+ DEG_MAPCkString DEG_MAPCK5String DEG_MAPCkString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/120.GenerateCKList/002.SetCKTokenString]

ClassName=StringTokenizerRule
Delimiter=,
SourceAttribute=DEG_MAPCkString
TokenAttribute=DEG_MAPCKTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/120.GenerateCKList/002.SetCKTokenString/IterationRule]

ClassName=AddToListAttributeRule
InputAttribute=DEG_MAPCKTokenString
ListAttribute=DEG_MAPCKList


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/130.GenerateIKList]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.SetIKString
RuleNames=002.SetIKTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/130.GenerateIKList/001.SetIKString]

AdornOps=set DEG_MAPIkString ""
AdornOps=+ DEG_MAPIkString DEG_MAPIK1String DEG_MAPIkString
AdornOps=+ DEG_MAPIkString , DEG_MAPIkString
AdornOps=+ DEG_MAPIkString DEG_MAPIK2String DEG_MAPIkString
AdornOps=+ DEG_MAPIkString , DEG_MAPIkString
AdornOps=+ DEG_MAPIkString DEG_MAPIK3String DEG_MAPIkString
AdornOps=+ DEG_MAPIkString , DEG_MAPIkString
AdornOps=+ DEG_MAPIkString DEG_MAPIK4String DEG_MAPIkString
AdornOps=+ DEG_MAPIkString , DEG_MAPIkString
AdornOps=+ DEG_MAPIkString DEG_MAPIK5String DEG_MAPIkString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/130.GenerateIKList/002.SetIKTokenString]

ClassName=StringTokenizerRule
Delimiter=,
SourceAttribute=DEG_MAPIkString
TokenAttribute=DEG_MAPIKTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/130.GenerateIKList/002.SetIKTokenString/IterationRule]

ClassName=AddToListAttributeRule
InputAttribute=DEG_MAPIKTokenString
ListAttribute=DEG_MAPIKList


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/140.GenerateAUTNList]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.SetAUTNString
RuleNames=002.SetAUTNTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/140.GenerateAUTNList/001.SetAUTNString]

AdornOps=set DEG_MAPAUTNString ""
AdornOps=+ DEG_MAPAUTNString DEG_MAPAUTN1String DEG_MAPAUTNString
AdornOps=+ DEG_MAPAUTNString , DEG_MAPAUTNString
AdornOps=+ DEG_MAPAUTNString DEG_MAPAUTN2String DEG_MAPAUTNString
AdornOps=+ DEG_MAPAUTNString , DEG_MAPAUTNString
AdornOps=+ DEG_MAPAUTNString DEG_MAPAUTN3String DEG_MAPAUTNString
AdornOps=+ DEG_MAPAUTNString , DEG_MAPAUTNString
AdornOps=+ DEG_MAPAUTNString DEG_MAPAUTN4String DEG_MAPAUTNString
AdornOps=+ DEG_MAPAUTNString , DEG_MAPAUTNString
AdornOps=+ DEG_MAPAUTNString DEG_MAPAUTN5String DEG_MAPAUTNString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/140.GenerateAUTNList/002.SetAUTNTokenString]

ClassName=StringTokenizerRule
Delimiter=,
SourceAttribute=DEG_MAPAUTNString
TokenAttribute=DEG_MAPAUTNTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/140.GenerateAUTNList/002.SetAUTNTokenString/IterationRule]

ClassName=AddToListAttributeRule
InputAttribute=DEG_MAPAUTNTokenString
ListAttribute=DEG_MAPAUTNList


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/200.ValidateAuthVectors]

ClassName=RuleChain
RuleNames=100.InitialiseAuthVectors
RuleNames=200.CheckIfNull


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/200.ValidateAuthVectors/100.InitialiseAuthVectors]

AdornOps=setifnull DEG_MAPRANDList null
AdornOps=setifnull DEG_MAPCKList null
AdornOps=setifnull DEG_MAPIKList null
AdornOps=setifnull DEG_MAPXRESList null
AdornOps=setifnull DEG_MAPAUTNList null
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/200.ValidateAuthVectors/200.CheckIfNull]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_MAPRANDList,=,null
Conditions=DEG_MAPCKList,=,null
Conditions=DEG_MAPIKList,=,null
Conditions=DEG_MAPXRESList,=,null
Conditions=DEG_MAPAUTNList,=,null
FalseRuleChain=110.SetErrorInfo
FalseRuleChain=100.LogMAPEAPAKAAuthVectors
FalseRuleChain=110.SetEAPAKAAuthVectors
Operations=or,or,or,or
TrueRuleChain=200.SetAAAErrorResponse


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/200.ValidateAuthVectors/200.CheckIfNull/100.LogMAPEAPAKAAuthVectors]

Attribute=DEG_OEMDevMessageString
Attributes=DEG_MAPRANDList
Attributes=DEG_MAPXRESList
Attributes=DEG_MAPCKList
Attributes=DEG_MAPIKList
Attributes=DEG_MAPAUTNList
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_AAAErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Valid EAP-AKA Auth Vectors From HLR :
NullAlso=true


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/200.ValidateAuthVectors/200.CheckIfNull/110.SetEAPAKAAuthVectors]

AdornOps=copy DEG_MAPRANDList DEG_AAARANDList
AdornOps=copy DEG_MAPCKList DEG_AAACKList
AdornOps=copy DEG_MAPIKList DEG_AAAIKList
AdornOps=copy DEG_MAPXRESList DEG_AAAXRESList
AdornOps=copy DEG_MAPAUTNList DEG_AAAAUTNList
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/200.ValidateAuthVectors/200.CheckIfNull/110.SetErrorInfo]

AdornOps=set DEG_AAAErrorMessageString "Valid EAP-AKA Auth Vectors From HLR :"
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0204"
AdornOps=set DEG_OEMDevMessageString "Valid EAP-AKA Auth Vectors From HLR :"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPAKAVectors/200.ValidateAuthVectors/200.CheckIfNull/200.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Invalid AKA Auth vectors from HLR"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateRANDList
RuleNames=110.GenerateSRESList
RuleNames=120.GenerateKCList
RuleNames=200.ValidateAuthVectors


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/100.GenerateRANDList]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.SetRANDString
RuleNames=002.SetRANDTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/100.GenerateRANDList/001.SetRANDString]

AdornOps=set DEG_MAPRandString ""
AdornOps=+ DEG_MAPRandString DEG_MAPRand1String DEG_MAPRandString
AdornOps=+ DEG_MAPRandString , DEG_MAPRandString
AdornOps=+ DEG_MAPRandString DEG_MAPRand2String DEG_MAPRandString
AdornOps=+ DEG_MAPRandString , DEG_MAPRandString
AdornOps=+ DEG_MAPRandString DEG_MAPRand3String DEG_MAPRandString
AdornOps=+ DEG_MAPRandString , DEG_MAPRandString
AdornOps=+ DEG_MAPRandString DEG_MAPRand4String DEG_MAPRandString
AdornOps=+ DEG_MAPRandString , DEG_MAPRandString
AdornOps=+ DEG_MAPRandString DEG_MAPRand5String DEG_MAPRandString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/100.GenerateRANDList/002.SetRANDTokenString]

ClassName=StringTokenizerRule
Delimiter=,
SourceAttribute=DEG_MAPRandString
TokenAttribute=DEG_MAPRandTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/100.GenerateRANDList/002.SetRANDTokenString/IterationRule]

ClassName=AddToListAttributeRule
InputAttribute=DEG_MAPRandTokenString
ListAttribute=DEG_MAPRANDList


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/110.GenerateSRESList]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.SetSRESString
RuleNames=002.SetSRESTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/110.GenerateSRESList/001.SetSRESString]

AdornOps=set DEG_MAPSRESString ""
AdornOps=+ DEG_MAPSRESString DEG_MAPSRES1String DEG_MAPSRESString
AdornOps=+ DEG_MAPSRESString , DEG_MAPSRESString
AdornOps=+ DEG_MAPSRESString DEG_MAPSRES2String DEG_MAPSRESString
AdornOps=+ DEG_MAPSRESString , DEG_MAPSRESString
AdornOps=+ DEG_MAPSRESString DEG_MAPSRES3String DEG_MAPSRESString
AdornOps=+ DEG_MAPSRESString , DEG_MAPSRESString
AdornOps=+ DEG_MAPSRESString DEG_MAPSRES4String DEG_MAPSRESString
AdornOps=+ DEG_MAPSRESString , DEG_MAPSRESString
AdornOps=+ DEG_MAPSRESString DEG_MAPSRES5String DEG_MAPSRESString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/110.GenerateSRESList/002.SetSRESTokenString]

ClassName=StringTokenizerRule
Delimiter=,
SourceAttribute=DEG_MAPSRESString
TokenAttribute=DEG_MAPSRESTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/110.GenerateSRESList/002.SetSRESTokenString/IterationRule]

ClassName=AddToListAttributeRule
InputAttribute=DEG_MAPSRESTokenString
ListAttribute=DEG_MAPSRESList


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/120.GenerateKCList]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.SetKCString
RuleNames=002.SetKCTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/120.GenerateKCList/001.SetKCString]

AdornOps=set DEG_MAPKCString ""
AdornOps=+ DEG_MAPKCString DEG_MAPKC1String DEG_MAPKCString
AdornOps=+ DEG_MAPKCString , DEG_MAPKCString
AdornOps=+ DEG_MAPKCString DEG_MAPKC2String DEG_MAPKCString
AdornOps=+ DEG_MAPKCString , DEG_MAPKCString
AdornOps=+ DEG_MAPKCString DEG_MAPKC3String DEG_MAPKCString
AdornOps=+ DEG_MAPKCString , DEG_MAPKCString
AdornOps=+ DEG_MAPKCString DEG_MAPKC4String DEG_MAPKCString
AdornOps=+ DEG_MAPKCString , DEG_MAPKCString
AdornOps=+ DEG_MAPKCString DEG_MAPKC5String DEG_MAPKCString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/120.GenerateKCList/002.SetKCTokenString]

ClassName=StringTokenizerRule
Delimiter=,
SourceAttribute=DEG_MAPKCString
TokenAttribute=DEG_MAPKCTokenString


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/120.GenerateKCList/002.SetKCTokenString/IterationRule]

ClassName=AddToListAttributeRule
InputAttribute=DEG_MAPKCTokenString
ListAttribute=DEG_MAPKCList


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/200.ValidateAuthVectors]

ClassName=RuleChain
RuleNames=100.InitialiseAuthVectors
RuleNames=200.CheckIfNull


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/200.ValidateAuthVectors/100.InitialiseAuthVectors]

AdornOps=setifnull DEG_MAPRANDList null
AdornOps=setifnull DEG_MAPSRESList null
AdornOps=setifnull DEG_MAPKCList null
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/200.ValidateAuthVectors/200.CheckIfNull]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_MAPRANDList,=,null
Conditions=DEG_MAPSRESList,=,null
Conditions=DEG_MAPKCList,=,null
FalseRuleChain=180.SetErrorInfo
FalseRuleChain=100.LogMAPEAPSIMAuthVectors
FalseRuleChain=110.SetEAPSIMAuthVectors
Operations=or,or
TrueRuleChain=200.SetAAAErrorResponse


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/200.ValidateAuthVectors/200.CheckIfNull/100.LogMAPEAPSIMAuthVectors]

Attributes=DEG_MAPRandString
Attributes=DEG_MAPSRESString
Attributes=DEG_MAPKCString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Valid EAP SIM Auth Vectors From HLR :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/200.ValidateAuthVectors/200.CheckIfNull/110.SetEAPSIMAuthVectors]

AdornOps=copy DEG_MAPRANDList DEG_AAARANDList
AdornOps=copy DEG_MAPSRESList DEG_AAASRESList
AdornOps=copy DEG_MAPKCList DEG_AAAKCList
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/200.ValidateAuthVectors/200.CheckIfNull/180.SetErrorInfo]

AdornOps=set DEG_AAAErrorMessageString "Valid EAP SIM Auth Vectors From HLR :"
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0205"
AdornOps=set DEG_OEMDevMessageString "Valid EAP SIM Auth Vectors From HLR :"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/110.CheckForHLRError/200.CheckRequestType/002.SetEAPSIMAttbs/200.ValidateAuthVectors/200.CheckIfNull/200.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Invalid SIM Auth vectors from HLR"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/200.SetAAAErrorAttributes]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to Connect to HLR"
AdornOps=+ DEG_AAAErrorMessageString : DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString DEG_MAPHttpErrorAttributeString DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString - DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString DEG_MAPHttpErrorMsgAttributeString DEG_AAAErrorMessageString
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0206"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to contact HLR"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateHLRResponse/210.LogFailureResponse]

Attributes=DEG_MAPHttpErrorAttributeString
Attributes=DEG_MAPHttpErrorMsgAttributeString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_AAAErrorMessageString
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Unable To connect To HLR :


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/600.GenerateMapGatewayCallEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
FalseRuleChain=200.GenerateMapGatewayEndErrorAuditData
TrueRuleChain=100.GenerateMapGatewayEndOkAuditData


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/600.GenerateMapGatewayCallEndAuditData/100.GenerateMapGatewayEndOkAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=914.GenerateAAAMapGatewayCallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/600.GenerateMapGatewayCallEndAuditData/200.GenerateMapGatewayEndErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=913.GenerateAAAMapGatewayCallEndErrorAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/912.GenerateAAAMapGatewayCallStartAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/912.GenerateAAAMapGatewayCallStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=copy DEG_AAAHLRProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_AAASessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AAAAuditDurationLong 0
AdornOps=copy DEG_AAAAuditDurationLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTP"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "SendAuthInfo"
AdornOps=set DEG_AuditSourceDestinationString "MAPGW"
AdornOps=copy DEG_AAAImsiString DEG_AuditIMSIString
AdornOps=copy DEG_AAAImsiString DEG_AuditChannelNameString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/912.GenerateAAAMapGatewayCallStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO MAPGW -> Sending request to MapGateway : "
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/912.GenerateAAAMapGatewayCallStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_AAATmp1String "DEG_AAASessionIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAASessionIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditMdnString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAImsiString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAImsiString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/912.GenerateAAAMapGatewayCallStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sending request to MapGateway,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/912.GenerateAAAMapGatewayCallStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=915.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/913.GenerateAAAMapGatewayCallEndErrorAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/913.GenerateAAAMapGatewayCallEndErrorAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_AAASessionIdString DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_AAAHLRProcessStartTimeLong DEG_AAAAuditDurationLong
AdornOps=copy DEG_AAAAuditDurationLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTP"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "5012"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "SendAuthInfo"
AdornOps=set DEG_AuditSourceDestinationString "MAPGW"
AdornOps=setifnull DEG_AAAErrorMessageString ""
AdornOps=setifnull DEG_AAAProcessingErrorIdString ""
AdornOps=copy DEG_AAAImsiString DEG_AuditIMSIString
AdornOps=copy DEG_AAAImsiString DEG_AuditChannelNameString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/913.GenerateAAAMapGatewayCallEndErrorAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "MAPGW TO AAA -> Received error response from MapGateway : "
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/913.GenerateAAAMapGatewayCallEndErrorAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_AAATmp1String "DEG_AAASessionIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAASessionIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditMdnString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAProcessingErrorIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAProcessingErrorIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AuditResultCodeString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAErrorMessageString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/913.GenerateAAAMapGatewayCallEndErrorAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Received error response from MapGateway"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/913.GenerateAAAMapGatewayCallEndErrorAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=915.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/914.GenerateAAAMapGatewayCallEndOKAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/914.GenerateAAAMapGatewayCallEndOKAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_AAASessionIdString DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_AAAHLRProcessStartTimeLong DEG_AAAAuditDurationLong
AdornOps=copy DEG_AAAAuditDurationLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTP"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "2001"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "SendAuthInfo"
AdornOps=set DEG_AuditSourceDestinationString "MAPGW"
AdornOps=copy DEG_AAAImsiString DEG_AuditIMSIString
AdornOps=copy DEG_AAAImsiString DEG_AuditChannelNameString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/914.GenerateAAAMapGatewayCallEndOKAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "MAPGW TO AAA -> Received response from MapGateway : "
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/914.GenerateAAAMapGatewayCallEndOKAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_AAATmp1String "DEG_AAASessionIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAASessionIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditMdnString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAImsiString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAImsiString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AuditResultCodeString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/914.GenerateAAAMapGatewayCallEndOKAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Received response from MapGateway"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/MAPGWProcessingRuleChain/RuleChains/914.GenerateAAAMapGatewayCallEndOKAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=915.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true
