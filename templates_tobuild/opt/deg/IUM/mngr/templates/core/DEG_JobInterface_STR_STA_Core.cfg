
[/templates/DEG/JobsInterface/STR_STA_Core]

[/templates/DEG/JobsInterface/STR_STA_Core/Connectors]

ConnectorNames=200.DiameterAdapter

##RFE82:Issue6:Diameter connector part moved from core to custom refering to EAP-AKA customize template.
[/templates/DEG/JobsInterface/STR_STA_Core/Connectors/200.DiameterAdapter]

Link=/templates/DEG/JobsInterface/EAPAKAAuthenticatorDiameterClient_Customize/Connectors/200.DiameterAdapter

[/templates/DEG/JobsInterface/STR_STA_Core/Connectors/200.DiameterAdapter/StateMachinePool]

ClassName=com.hp.usage.diameter.StateMachinePool
ThreadPoolSize=10


[/templates/DEG/JobsInterface/STR_STA_Core/Connectors/200.DiameterAdapter/StateMachinePool/StateMachine]

ClassName=com.hp.usage.diameter.GenericStateMachine
MessageCodeAttribute=DEG_JobsCommandcodeInteger
MessageDirectionAttribute=DEG_JobsRequestFlagInteger
RuleChainMapping=275,1,300.STRProcessingRuleChain

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService]

QueryNames=LookUpOldSessions
QueryNames=DEG_SYS_PARAMETER_PARA2VAL

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL]

ClassName=com.hp.usage.refdatasrv.CachedQuery
ResultAttribute=DEG_CDevMatchFoundInteger
ResultIndexAttribute=DEG_CDevIndexInteger


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/Cache]

ClassName=com.hp.usage.refdatasrv.HashMapLookupCache
CacheAttributes=DEG_SYSVALUE
CacheKeyAttributes=DEG_SYSPARAMETER
NMEKeyAttributes=DEG_CDevSysParameter


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=101.SetErrorInfo
RuleNames=100.LogAlarming
RuleNames=200.SetErrorFlag

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule/101.SetErrorInfo]

AdornOps=set DEG_OEMDevErrorMessageString "Database Error"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.JOB.0401"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error:
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule/200.SetErrorFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevMatchFoundInteger DEG_CDevMatchFoundInteger


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevMatchFoundInteger 0
AdornOps=set DEG_CDevIndexInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_SYS_PARAMETERS"
AdornOps=set DEG_SYSVALUE ""
AdornOps=set DEG_SYSPARAMETER ""


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/Loader]

ClassName=com.hp.usage.refdatasrv.JDBCLoader
FieldExtracted=DEG_SYSPARAMETER,DEG_SYSPARAMETER
FieldExtracted=DEG_SYSVALUE,DEG_SYSVALUE
CommonPolicyID=Policy1
QueryString=select %FIELDS from DEG_SYS_PARAMETERS


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/RefreshPolicy]

ClassName=com.hp.siu.plugins.dna.collector.rules.CronIntervalRefreshPolicy
RefreshCronInterval=0 * * * *


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ResultRowRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevMatchFoundInteger 1
AdornOps=copy DEG_SYSVALUE DEG_CDevSysValueString

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_SSL_ID,DEG_SSL_ID
FieldExtracted=DEG_SSL_NAI,DEG_SSL_NAI
FieldExtracted=DEG_SSL_IMSI,DEG_SSL_IMSI
FieldExtracted=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
FieldExtracted=DEG_SSL_STATE,DEG_SSL_STATE
FieldExtracted=DEG_SSL_AAA_STATE,DEG_SSL_AAA_STATE
FieldExtracted=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
FieldExtracted=DEG_STR_FLAG,DEG_STR_FLAG
CommonPolicyID=Policy1
QueryString=SELECT %FIELDS  FROM DEG_SSL_SESSION WHERE DEG_SSL_CREATETIMESTAMP <= %DEG_SSL_CREATETIMESTAMP
ResultAttribute=DEG_JobsSigMatchFoundInteger
ResultIndexAttribute=DEG_JobsSigIndexInteger


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=090.SetErrorInfo
RuleNames=100.LogAlarming
RuleNames=200.SetErrorMessage

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ErrorRule/090.SetErrorInfo]

AdornOps=set DEG_OEMDevErrorMessageString "Database Error:"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.JOB.0402"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString

LogLevel=CRITICAL
Message=Database Error:
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ErrorRule/200.SetErrorMessage]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_JobsDatabaseErrorFlagInteger 1
AdornOps=set DEG_JobsReturnCodeString "-1"
AdornOps=set DEG_JobsErrorMessageString "Unable to access DEG_SSL_SESSION table"


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_JobsSigMatchFoundInteger 0
AdornOps=set DEG_JobsDatabaseErrorFlagInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_SSL_SESSION"


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.Set_MatchFound
RuleNames=200.DEGSSLStateCheck
RuleNames=300.CheckDeleteStatus


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/100.Set_MatchFound]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_JobsSigMatchFoundInteger 1


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/200.DEGSSLStateCheck]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_AAA"
Conditions=DEG_STR_FLAG,=,0
TrueRuleChain=100.InvokeReadSystemParameter
TrueRuleChain=110.ExecuteActionAccordingToValueOfPId
FalseRuleChain=170.SetErrorInfo
FalseRuleChain=200.LogAllInvalidSessionStates
FalseRuleChain=210.DeleteEntriesWithAllInvalidSessionStates


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/200.DEGSSLStateCheck/100.InvokeReadSystemParameter]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=100.ReadPIdCheckModeSysParameterValueRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/200.DEGSSLStateCheck/110.ExecuteActionAccordingToValueOfPId]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevPIdSysValueString,=,"Diameter"
Conditions=DEG_CDevPIdSysValueString,=,"Radius"
Conditions=DEG_CDevPIdSysValueString,=,""
Operations=None

DiameterProcessing=100.SetTerminationCause
DiameterProcessing=110.SendSTR
RadiusProcessing=100.SetErrorInfo
RadiusProcessing=200.LogAllSessionStates
RadiusProcessing=210.DeleteAllEntriesInSSLSessions
InvalidSessionStates=001.SetErrorInfo
InvalidSessionStates=300.LogAllInvalidSessionStates
InvalidSessionStates=310.DeleteEntriesWithAllInvalidSessionStates

TrueRuleChain=DiameterProcessing
TrueRuleChain=RadiusProcessing
TrueRuleChain=InvalidSessionStates


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/200.DEGSSLStateCheck/110.ExecuteActionAccordingToValueOfPId/100.SetTerminationCause]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_JobsTerminationCauseInteger 8


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/200.DEGSSLStateCheck/110.ExecuteActionAccordingToValueOfPId/110.SendSTR]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_JobsTerminationCauseInteger
RuleChain=300.STRProcessingRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/200.DEGSSLStateCheck/110.ExecuteActionAccordingToValueOfPId/100.SetErrorInfo]

AdornOps=set DEG_OEMDevMessageString "JobsInterface - AllRadiusSessionStates"
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.JOB.0403"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/200.DEGSSLStateCheck/110.ExecuteActionAccordingToValueOfPId/200.LogAllSessionStates]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Attributes=DEG_SSL_ID
Attributes=DEG_SSL_NAI
Attributes=DEG_SSL_IMSI
Attributes=DEG_SSL_UNIQUE_ID
Attributes=DEG_SSL_STATE
Attributes=DEG_SSL_AAA_STATE
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_STR_FLAG
Attributes=DEG_SSL_CREATETIMESTAMP
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=JobsInterface - AllRadiusSessionStates:


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/200.DEGSSLStateCheck/110.ExecuteActionAccordingToValueOfPId/210.DeleteAllEntriesInSSLSessions]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
SessionStore=DEG_SSL_SESSION_SessionStore
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
ContinueAfterErrorFixed=false
LogInvalidSession=false

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/200.DEGSSLStateCheck/110.ExecuteActionAccordingToValueOfPId/001.SetErrorInfo]

AdornOps=set DEG_OEMDevMessageString "JobsInterface - AllInvalidSessionStates"
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.JOB.0404"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/200.DEGSSLStateCheck/110.ExecuteActionAccordingToValueOfPId/300.LogAllInvalidSessionStates]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Attributes=DEG_SSL_ID
Attributes=DEG_SSL_NAI
Attributes=DEG_SSL_IMSI
Attributes=DEG_SSL_UNIQUE_ID
Attributes=DEG_SSL_STATE
Attributes=DEG_SSL_AAA_STATE
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_STR_FLAG
Attributes=DEG_SSL_CREATETIMESTAMP
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=JobsInterface - AllInvalidSessionStates:


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/200.DEGSSLStateCheck/110.ExecuteActionAccordingToValueOfPId/310.DeleteEntriesWithAllInvalidSessionStates]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
SessionStore=DEG_SSL_SESSION_SessionStore
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
ContinueAfterErrorFixed=false
LogInvalidSession=false

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/200.DEGSSLStateCheck/170.SetErrorInfo]

AdornOps=set  DEG_OEMDevMessageString "JobsInterface - AllInvalidSessionStates"
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.JOB.0405"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/200.DEGSSLStateCheck/200.LogAllInvalidSessionStates]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Attributes=DEG_SSL_ID
Attributes=DEG_SSL_NAI
Attributes=DEG_SSL_IMSI
Attributes=DEG_SSL_UNIQUE_ID
Attributes=DEG_SSL_STATE
Attributes=DEG_SSL_AAA_STATE
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_STR_FLAG
Attributes=DEG_SSL_CREATETIMESTAMP
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=JobsInterface - AllInvalidSessionStates:


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/200.DEGSSLStateCheck/210.DeleteEntriesWithAllInvalidSessionStates]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
SessionStore=DEG_SSL_SESSION_SessionStore
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
ContinueAfterErrorFixed=false
LogInvalidSession=false


[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/300.CheckDeleteStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_JobsSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=090.SetErrorInfo
TrueRuleChain=100.ErrorLog

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/300.CheckDeleteStatus/090.SetErrorInfo]

AdornOps=set DEG_OEMDevErrorMessageString "Session does not exists in DEG_SSL_SESSION Table:"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.JOB.0406"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/JobsInterface/STR_STA_Core/ReferenceDataService/LookUpOldSessions/ResultRowRule/300.CheckDeleteStatus/100.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_SSL_ID
Attributes=DEG_SSL_NAI
Attributes=DEG_SSL_IMSI
Attributes=DEG_SSL_UNIQUE_ID
Attributes=DEG_SSL_STATE
Attributes=DEG_SSL_AAA_STATE
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=INFO
Message=Session does not exists in DEG_SSL_SESSION Table:


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains]

ClassName=com.hp.siu.sessionserver.RuleChainManager
RuleChainNames=100.ReadPIdCheckModeSysParameterValueRuleChain
RuleChainNames=110.ReadSystemParameterRuleChain
RuleChainNames=300.STRProcessingRuleChain


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/200.DeleteExpiredSSLSessionsRuleChain]

RuleNames=050.SetLogInfo
RuleNames=100.LogStartSTRBasedDeletion
RuleNames=200.InitTimestamp
RuleNames=300.DeleteOldSession
RuleNames=350.SetLogInfo
RuleNames=400.LogEndSTRBasedDeletion

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/200.DeleteExpiredSSLSessionsRuleChain/050.SetLogInfo]

ClassName=AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.JOB.0407"
AdornOps=set DEG_OEMDevMessageString "Starting STR based SSL session deletion job"

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/200.DeleteExpiredSSLSessionsRuleChain/100.LogStartSTRBasedDeletion]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=Starting STR based SSL session deletion job:


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/200.DeleteExpiredSSLSessionsRuleChain/200.InitTimestamp]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_SSL_CREATETIMESTAMP
AdornOps=set DEG_SSL_JOBINTERFACE_DELETE_TIME ${DEG_DEVICE_JOB_INTERFACE_SSL_SESSION_DELETE_TIME}
AdornOps=- DEG_SSL_CREATETIMESTAMP DEG_SSL_JOBINTERFACE_DELETE_TIME DEG_SSL_CREATETIMESTAMP


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/200.DeleteExpiredSSLSessionsRuleChain/300.DeleteOldSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=LookUpOldSessions

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/200.DeleteExpiredSSLSessionsRuleChain/350.SetLogInfo]

ClassName=AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.JOB.0408""
AdornOps=set DEG_OEMDevMessageString "Stopping STR based SSL session deletion job"

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/200.DeleteExpiredSSLSessionsRuleChain/400.LogEndSTRBasedDeletion]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=Stopping STR based SSL session deletion job:


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetRequestParams
RuleNames=110.STRNMEConversion
RuleNames=090.SetErrorInfo
RuleNames=120.LogSTRRequest
RuleNames=200.SendSTRRequest
RuleNames=210.LogIfRequestTimeOutFlagSet
RuleNames=300.STASNMEConversion
RuleNames=205.CheckIfResultCodeNull
RuleNames=310.DeleteDEGSSLSession
RuleNames=022.SetLogInfo
RuleNames=320.LogAfterSTAResponse

# Commented regarding QXCM1001403777 
# This problem is extremely intermittent, couldn't reproduce it.
# It seems DEG_SSL_AAA_SESSIONID didn't get default value "" when it is null in table.
# setifnull DEG_SSL_AAA_SESSIONID "" before we do the copy operation
#AdornOps=copy DEG_SSL_AAA_SESSIONID DEG_JobsDiameterSessionIdString
# Commented End

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/100.SetRequestParams]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set disc 0
AdornOps=set DEG_JobsRequestFlagInteger 1
AdornOps=setifnull DEG_SSL_AAA_SESSIONID ""
AdornOps=copy DEG_SSL_AAA_SESSIONID DEG_JobsDiameterSessionIdString
AdornOps=set DEG_JobsOriginRealmString ${DEVICE_SERVER_REALM}
AdornOps=set DEG_JobsOriginHostString ${JOBS_DIAMETER_SERVER_HOST_NAME}
#QXCM1001544811:3.2.4 China Unicom issues,issue 8:2017041008
AdornOps=set DEG_JobsAuthApplicationIdInteger ${DEG_DAIMETER_APLLICATION_ID}
AdornOps=copy DEG_SSL_NAI DEG_JobsNameString
AdornOps=set DEG_JobsPrimaryDesthostString ${PRIMARY_AAA_HOST_NAME}
AdornOps=set DEG_JobsPrimaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=set DEG_JobsSecondaryDesthostString ${SECONDARY_AAA_HOST_NAME}
AdornOps=set DEG_JobsSecondaryDestRealmString ${AAA_SERVER_REALM}


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/110.STRNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_JobsDiameterSessionIdString,STR_DEGtoHSS.session_id
NMEToStructuredNMEMap=DEG_JobsOriginHostString,STR_DEGtoHSS.origin_Host
NMEToStructuredNMEMap=DEG_JobsOriginRealmString,STR_DEGtoHSS.origin_Realm
NMEToStructuredNMEMap=DEG_JobsPrimaryDestRealmString,STR_DEGtoHSS.destination_Realm
NMEToStructuredNMEMap=DEG_JobsAuthApplicationIdInteger,STR_DEGtoHSS.auth_application_id
NMEToStructuredNMEMap=DEG_JobsTerminationCauseInteger,STR_DEGtoHSS.termination_cause
NMEToStructuredNMEMap=DEG_JobsNameString,STR_DEGtoHSS.user_Name
#NMEToStructuredNMEMap=DEG_JobsPrimaryDesthostString,STR_DEGtoHSS.destination_host
SNMEType=DiameterSwa:Body

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/090.SetErrorInfo]

AdornOps=set DEG_OEMDevMessageString "STRProcessingRule - STRRequest"
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.JOB.0409"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/120.LogSTRRequest]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Attributes=DEG_JobsDiameterSessionIdString
Attributes=DEG_JobsOriginHostString
Attributes=DEG_JobsOriginRealmString
Attributes=DEG_JobsPrimaryDestRealmString
Attributes=DEG_JobsTerminationCauseInteger
Attributes=DEG_JobsNameString
Attributes=DEG_JobsPrimaryDesthostString
Attributes=DEG_SSL_ID
Attributes=DEG_SSL_AAA_STATE
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=STRProcessingRule - STRRequest:


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/200.SendSTRRequest]

ClassName=com.hp.usage.diameter.DiameterClientRule
#QXCM1001544811:3.2.4 China Unicom issues,issue 8:2017041008
ApplicationId=${DEG_DAIMETER_APLLICATION_ID}
CommandCode=275
DCJNDIName=Jobs
DestinationHostAttribute=DEG_JobsPrimaryDesthostString
DestinationRealmAttribute=DEG_JobsPrimaryDestRealmString
SecondaryDestinationHostAttribute=DEG_JobsSecondaryDesthostString
SecondaryDestinationRealmAttribute=DEG_JobsSecondaryDestRealmString
DisconnectAttribute=disc
E2EAttribute=DEG_JobsE2ELong
ErrorResultFlagAttribute=errFlag
HbHAttribute=DEG_JobsHbHLong
TimeOut=1000
TimeOutFlagAttribute=toFlag
Retries=3
WaitForConnection=false


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/200.SendSTRRequest/Decoder]

AttrCodec=STA_HSStoDEG.session_id,263,MS,M,,UTF8StringCodec
AttrCodec=STA_HSStoDEG.result_Code,268,MS,M,,com.hp.usage.attrcodec.IntegerCodec
AttrCodec=STA_HSStoDEG.origin_Host,264,MS,M,,UTF8StringCodec
AttrCodec=STA_HSStoDEG.origin_Realm,296,MS,M,,UTF8StringCodec
AttrCodec=STA_HSStoDEG.class,25,OS,,,com.hp.usage.diameter.attrcodec.DiameterOctetStringCodec
AttrCodec=STA_HSStoDEG.error_message,281,OS,,,UTF8StringCodec
AttrCodec=STA_HSStoDEG.error_reporting_host,294,OS,,,UTF8StringCodec
AttrCodec=STA_HSStoDEG.failed_AVP[*],279[*],OS,,,
AttrCodec=STA_HSStoDEG.failed_AVP[*].termination_cause,279[*].295,OS,,,com.hp.usage.attrcodec.IntegerCodec
AttrCodec=STA_HSStoDEG.failed_AVP[*].user_Name,279[*].1,OS,,,UTF8StringCodec
AttrCodec=STA_HSStoDEG.origin_state_id,278,OS,,,UINT32Codec
AttrCodec=STA_HSStoDEG.redirect_host,292,OS,,,com.hp.usage.diameter.attrcodec.DiameterOctetStringCodec
AttrCodec=STA_HSStoDEG.redirect_host_usage,261,OS,,,com.hp.usage.attrcodec.IntegerCodec
AttrCodec=STA_HSStoDEG.redirect_max_cache_time,262,OS,,,UINT32Codec
AttrCodec=STA_HSStoDEG.proxy_Info[*],284[*],OM,,,
AttrCodec=STA_HSStoDEG.proxy_Info[*].proxy_Host,284[*].280,OS,,,UTF8StringCodec
AttrCodec=STA_HSStoDEG.proxy_Info[*].proxy_State,284[*].33,OS,,,com.hp.usage.diameter.attrcodec.DiameterOctetStringCodec
AttrCodec=STA_HSStoDEG.failed_AVP[*].termination_cause,279[*].295,OS,,,com.hp.usage.attrcodec.IntegerCodec
#Experiment result code
AttrCodec=STA_HSStoDEG.experimental_result[*],297[*],OM,,,
AttrCodec=STA_HSStoDEG.experimental_result[*].vendor_id,297[*].266,OS,,,com.hp.usage.attrcodec.IntegerCodec
AttrCodec=STA_HSStoDEG.experimental_result[*].experimental_result_code,297[*].298,OS,,,com.hp.usage.attrcodec.IntegerCodec
ClassName=com.hp.usage.diameter.codec.AVPDecoderHolder
DecoderClassName=com.hp.usage.diameter.codec.AVPDecoder
ListenerClassName=com.hp.usage.diameter.codec.StructuredAVPDecodeListener
NMEType=DiameterSwa:Body


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/200.SendSTRRequest/Decoder/UINT32Codec]

ClassName=com.hp.usage.attrcodec.LongCodec
Size=4


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/200.SendSTRRequest/Decoder/UINT64Codec]

ClassName=com.hp.usage.attrcodec.LongCodec
Size=8

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/200.SendSTRRequest/Decoder/UTF8StringCodec]

ClassName=com.hp.usage.attrcodec.StringCodec
Encoding=UTF-8


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/200.SendSTRRequest/Encoder]

AttrCodec=STR_DEGtoHSS.session_id,263,,M,UTF8StringCodec
AttrCodec=STR_DEGtoHSS.origin_Host,264,,M,UTF8StringCodec
AttrCodec=STR_DEGtoHSS.origin_Realm,296,,M,UTF8StringCodec
AttrCodec=STR_DEGtoHSS.destination_Realm,283,,M,UTF8StringCodec
AttrCodec=STR_DEGtoHSS.auth_application_id,258,,M,UINT32Codec
AttrCodec=STR_DEGtoHSS.eap_payload,462,,M,com.hp.usage.diameter.attrcodec.DiameterOctetStringCodec
AttrCodec=STR_DEGtoHSS.termination_cause,295,,M,com.hp.usage.attrcodec.IntegerCodec
AttrCodec=STR_DEGtoHSS.user_Name,1,O,M,UTF8StringCodec
AttrCodec=STR_DEGtoHSS.destination_host,293,O,M,UTF8StringCodec
AttrCodec=STR_DEGtoHSS.origin_State_Id,278,O,M,UINT32Codec
AttrCodec=STR_DEGtoHSS.class,25,O,M,com.hp.usage.diameter.attrcodec.DiameterOctetStringCodec
AttrCodec=STR_DEGtoHSS.proxy_Info[*],284[*],O,M,
AttrCodec=STR_DEGtoHSS.proxy_Info[*].proxy_Host,284[*].280,O,M,UTF8StringCodec
AttrCodec=STR_DEGtoHSS.proxy_Info[*].proxy_State,284[*].33,O,M,com.hp.usage.diameter.attrcodec.DiameterOctetStringCodec
AttrCodec=STR_DEGtoHSS.route_Record[*],282[*],O,M,UTF8StringCodec
ClassName=AVPEncoderHolder
ListenerClassName=com.hp.usage.diameter.codec.StructuredAVPEncodeListener
NMEType=DiameterSwa:Body


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/200.SendSTRRequest/Encoder/UINT32Codec]

ClassName=com.hp.usage.attrcodec.LongCodec
Size=4


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/200.SendSTRRequest/Encoder/UINT64Codec]

ClassName=com.hp.usage.attrcodec.LongCodec
Size=8


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/200.SendSTRRequest/Encoder/UTF8StringCodec]

ClassName=com.hp.usage.attrcodec.StringCodec
Encoding=UTF-8


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/210.LogIfRequestTimeOutFlagSet]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=toFlag,!=,0
TrueRuleChain=100.SetErrorParams
TrueRuleChain=110.ErrorLog


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/210.LogIfRequestTimeOutFlagSet/100.SetErrorParams]

AdornOps=set DEG_JobsErrorMessageString "AAA could not reply in configured timeout period"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.JOB.0410"
AdornOps=set DEG_OEMDevErrorMessageString "AAA could not reply in configured timeout period"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/210.LogIfRequestTimeOutFlagSet/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_JobsErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=ERROR
Message=AAA Request Timeout Error : 
NullAlso=true
PropertyName=LogRequestFlowLevel1
UseProperty=true
#Action=AAA Request Timeout error. Contact HP Support.


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/300.STASNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
StructuredNMEToNMEMap=STA_HSStoDEG.session_id,DEG_JobsDiameterSessionIdString
StructuredNMEToNMEMap=STA_HSStoDEG.result_Code,DEG_JobsResultCodeInteger
StructuredNMEToNMEMap=STA_HSStoDEG.origin_Host,DEG_JobsOriginHostString
StructuredNMEToNMEMap=STA_HSStoDEG.origin_Realm,DEG_JobsOriginRealmString
StructuredNMEToNMEMap=STA_HSStoDEG.error_message,DEG_JobsErrorMessageString
#QXCM1001549582 : TDC Handle Experimental Result Code (AVP 298) 
StructuredNMEToNMEMap=STA_HSStoDEG.experimental_result[0].vendor_id,DEG_JobsVendorIdInteger
StructuredNMEToNMEMap=STA_HSStoDEG.experimental_result[0].experimental_result_code,DEG_JobsExperimentalResultCodeInteger
SNMEType=DiameterSwa:Body

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/205.CheckIfResultCodeNull]

ClassName=ConditionalRule
Conditions=DEG_JobsResultCodeInteger,=,0
TrueRuleChain=SetResultCode

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/205.CheckIfResultCodeNull/SetResultCode]

ClassName=AdornmentRule
AdornOps=copy DEG_JobsExperimentalResultCodeInteger DEG_JobsResultCodeInteger


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/310.DeleteDEGSSLSession]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_JobsResultCodeInteger,within,[2001,5002]
TrueRuleChain=100.DeleteSession


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/310.DeleteDEGSSLSession/100.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
SessionStore=DEG_SSL_SESSION_SessionStore
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
NativeCondition=MatchingSession
ContinueAfterErrorFixed=true
LogInvalidSession=false
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/022.SetLogInfo]

AdornOps=set DEG_OEMDevMessageString "STRProcessingRule - STAResponse"
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.JOB.0411"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/300.STRProcessingRuleChain/320.LogAfterSTAResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_JobsDiameterSessionIdString
Attributes=DEG_JobsResultCodeInteger
Attributes=DEG_JobsOriginHostString
Attributes=DEG_JobsOriginRealmString
Attributes=DEG_SSL_ID
Attributes=DEG_SSL_AAA_STATEID
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_JobsErrorMessageString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
LogLevel=INFO
Message=STRProcessingRule - STAResponse:


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/100.ReadPIdCheckModeSysParameterValueRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequest
RuleNames=110.ReadValue
RuleNames=200.CheckErrorAndNoMatchFlag


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/100.ReadPIdCheckModeSysParameterValueRuleChain/100.InitRequest]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSysParameter "EAPAKAAuth"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/100.ReadPIdCheckModeSysParameterValueRuleChain/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=110.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/100.ReadPIdCheckModeSysParameterValueRuleChain/200.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
Operations=and
TrueRuleChain=100.CheckEAPAKAAuth
FalseRuleChain=200.SetEmptyValue

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/100.ReadPIdCheckModeSysParameterValueRuleChain/200.CheckErrorAndNoMatchFlag/200.SetEmptyValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevPIdSysValueString ""

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/100.ReadPIdCheckModeSysParameterValueRuleChain/200.CheckErrorAndNoMatchFlag/100.CheckEAPAKAAuth]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSysValueString,=,"Enabled"
TrueRuleChain=100.InitRequest
TrueRuleChain=110.ReadValue
TrueRuleChain=120.CheckErrorAndNoMatchFlag
FalseRuleChain=200.SetEmptyValue


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/100.ReadPIdCheckModeSysParameterValueRuleChain/200.CheckErrorAndNoMatchFlag/100.CheckEAPAKAAuth/200.SetEmptyValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevPIdSysValueString ""

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/100.ReadPIdCheckModeSysParameterValueRuleChain/200.CheckErrorAndNoMatchFlag/100.CheckEAPAKAAuth/100.InitRequest]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSysParameter "DEG_AAA_INTERFACE"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/100.ReadPIdCheckModeSysParameterValueRuleChain/200.CheckErrorAndNoMatchFlag/100.CheckEAPAKAAuth/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=110.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/100.ReadPIdCheckModeSysParameterValueRuleChain/200.CheckErrorAndNoMatchFlag/100.CheckEAPAKAAuth/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
Operations=and
TrueRuleChain=100.SetSysValue
FalseRuleChain=200.SetEmptyValue


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/100.ReadPIdCheckModeSysParameterValueRuleChain/200.CheckErrorAndNoMatchFlag/100.CheckEAPAKAAuth/120.CheckErrorAndNoMatchFlag/100.SetSysValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevSysValueString DEG_CDevPIdSysValueString


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/100.ReadPIdCheckModeSysParameterValueRuleChain/200.CheckErrorAndNoMatchFlag/100.CheckEAPAKAAuth/120.CheckErrorAndNoMatchFlag/200.SetEmptyValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevPIdSysValueString ""

[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/110.ReadSystemParameterRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReadSystemParameter


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/110.ReadSystemParameterRuleChain/100.ReadSystemParameter]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_SYS_PARAMETER_PARA2VAL


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/110.ReadSystemParameterRuleChain/100.ReadSystemParameter/ErrorRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1


[/templates/DEG/JobsInterface/STR_STA_Core/RuleChains/110.ReadSystemParameterRuleChain/100.ReadSystemParameter/NoMatchRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBNoMatchFlagInteger 1

