

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore]


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains]

RuleChainNames=400.GetSubscriberProfileRuleChain
RuleChainNames=400A.ProcessSubscriberExistsResponseRuleChain
RuleChainNames=400B.ProcessUnknownSubscriberResposneRuleChain
RuleChainNames=400C.ProcessReadSubscribertableRuleChain
RuleChainNames=CUSTRC_GetSubscriberProfile
RuleChainNames=500.GenerateGetAuthenticationStartAuditDataRuleChain
RuleChainNames=506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain
RuleChainNames=507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
RuleChainNames=501.GenerateAndroidStartAuditDataRuleChain

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckCondition

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDeviceTypeString,=,"Android"
TrueRuleChain=100.CallAndroidCustom
FalseRuleChain=200.CallAppleRuleChain

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/100.CallAndroidCustom]

ClassName=com.hp.siu.collector.rules.RuleChain

RuleNames=100.InitVariables
RuleNames=200.LogBeforeCopy
RuleNames=300.CopyBeforeGSPCustomTemplate
RuleNames=400.CallAndroidCustomRuleChain
RuleNames=500.LogAfterCallingCustomTemplate
RuleNames=600.CopyAfterGSPCustomTemplate
RuleNames=700.SubscriberExistRuleChain

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/100.CallAndroidCustom/500.LogAfterCallingCustomTemplate]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=CUST_GSP_IN_MDNString
Attributes=CUST_GSP_IN_IMSIString
Attributes=CUST_GSP_OUT_ErrorFlagInteger
Attributes=CUST_GSP_OUT_SubscriberExistsFlagInteger
Attributes=CUST_GSP_OUT_MDN
Attributes=CUST_GSP_OUT_VoWiFi_PROVISIONING_STATUS
Attributes=CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_POSTDATA
Attributes=CUST_GSP_OUT_VoWiFi_ADDR_STATUS
Attributes=CUST_GSP_OUT_VoWiFi_TC_STATUS
Attributes=CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_URL
Attributes=CUST_GSP_OUT_EntitlementStatus
Attributes=CUST_GSP_OUT_SIP_USERNAME
LogLevel=DEBUG2
Message=Log after calling Android custom template
NullAlso=true


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/100.CallAndroidCustom/200.LogBeforeCopy]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_CDevSessionStoreErrorFlagInteger
Attributes=DEG_CDevSessionStoreKeyExistsFlagInteger
Attributes=DEG_PROVISIONING_STATUS
Attributes=DEG_ADDR_UPDATE_POSTDATA
Attributes=DEG_ADDRESS_STATUS
Attributes=DEG_TC_STATUS
Attributes=DEG_MDN
Attributes=DEG_ADDRESS_UPDATE_URL
Attributes=DEG_EntitlementStatus
Attributes=DEG_OEMDevGatewayAddressString
Attributes=DEG_OEMDevDeviceCountIntegerTbl
Attributes=DEG_SIP_USERNAME
Attributes=DEG_OEMDevMsisdnString
LogLevel=DEBUG2
Message=Log before calling Android custom template
NullAlso=true

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/100.CallAndroidCustom/600.CopyAfterGSPCustomTemplate]

ClassName=AdornmentRule
AdornOps=copy CUST_GSP_IN_MDNString DEG_OEMDevMsisdnString
AdornOps=copy CUST_GSP_OUT_ErrorFlagInteger DEG_CDevSessionStoreErrorFlagInteger
AdornOps=copy CUST_GSP_OUT_SubscriberExistsFlagInteger DEG_CDevSessionStoreKeyExistsFlagInteger
AdornOps=copy CUST_GSP_OUT_MDN DEG_MDN
AdornOps=copy CUST_GSP_OUT_VoWiFi_PROVISIONING_STATUS DEG_PROVISIONING_STATUS
AdornOps=copy CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_POSTDATA DEG_ADDR_UPDATE_POSTDATA
AdornOps=copy CUST_GSP_OUT_VoWiFi_ADDR_STATUS DEG_ADDRESS_STATUS
AdornOps=copy CUST_GSP_OUT_VoWiFi_TC_STATUS DEG_TC_STATUS
AdornOps=copy CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_URL DEG_ADDRESS_UPDATE_URL
AdornOps=copy CUST_GSP_OUT_EntitlementStatus DEG_EntitlementStatus
AdornOps=copy CUST_GSP_OUT_GatewayAddrString DEG_OEMDevGatewayAddressString
AdornOps=copy CUST_GSP_OUT_COMPANIONDEVICE_COUNT DEG_OEMDevDeviceCountIntegerTbl
AdornOps=copy CUST_GSP_OUT_SIP_USERNAME DEG_SIP_USERNAME

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/100.CallAndroidCustom/300.CopyBeforeGSPCustomTemplate]

ClassName=AdornmentRule
AdornOps=copy DEG_OEMDevMsisdnString CUST_GSP_IN_MDNString
AdornOps=copy DEG_OEMDevImsiString CUST_GSP_IN_IMSIString
AdornOps=copy DEG_CDevSessionStoreErrorFlagInteger CUST_GSP_OUT_ErrorFlagInteger
AdornOps=copy DEG_CDevSessionStoreKeyExistsFlagInteger CUST_GSP_OUT_SubscriberExistsFlagInteger
AdornOps=copy DEG_MDN CUST_GSP_OUT_MDN
AdornOps=copy DEG_PROVISIONING_STATUS CUST_GSP_OUT_VoWiFi_PROVISIONING_STATUS
AdornOps=copy DEG_ADDR_UPDATE_POSTDATA CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_POSTDATA
AdornOps=copy DEG_ADDRESS_STATUS CUST_GSP_OUT_VoWiFi_ADDR_STATUS
AdornOps=copy DEG_TC_STATUS CUST_GSP_OUT_VoWiFi_TC_STATUS
AdornOps=copy DEG_ADDRESS_UPDATE_URL CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_URL
AdornOps=copy DEG_EntitlementStatus CUST_GSP_OUT_EntitlementStatus
AdornOps=copy DEG_OEMDevGatewayAddressString CUST_GSP_OUT_GatewayAddrString
AdornOps=copy DEG_OEMDevDeviceCountIntegerTbl CUST_GSP_OUT_COMPANIONDEVICE_COUNT
AdornOps=copy DEG_SIP_USERNAME CUST_GSP_OUT_SIP_USERNAME

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/100.CallAndroidCustom/400.CallAndroidCustomRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_GetSubscriberProfile
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/100.CallAndroidCustom/100.InitVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set CUST_GSP_OUT_COMPANIONDEVICE_COUNT ${COMPANIONDEVICE_COUNT}
AdornOps=setifnull DEG_ADDRESS_UPDATE_URL ${DEGDROID_DEVICE_ADDRESS_UPDATE_URL}
AdornOps=setifnull DEG_MDN 0
AdornOps=setifnull DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=setifnull DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_EntitlementStatus ""
AdornOps=setifnull DEG_OEMDevGatewayAddressString ""
AdornOps=setifnull DEG_OEMDevDeviceCountIntegerTbl 0
AdornOps=setifnull DEG_SIP_USERNAME 0

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/100.CallAndroidCustom/700.SubscriberExistRuleChain]

ClassName=com.hp.siu.collector.rules.ConditionalRule

Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1

TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=300.ProcessSubscriberExistsResponse
TrueRuleChain=310.CheckMsessionKeyFlag

#issue discription:when search based on MDN from GUI, entire getauth audits was not coming because the DEG_NrbMonitoringSessionIdList is null.
#Fix discription:after subscriber lookup again forming DEG_NrbMonitoringSessionIdList only in case of MDN search.
[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/100.CallAndroidCustom/700.SubscriberExistRuleChain/310.CheckMsessionKeyFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SessionKeyInteger,=,1

TrueRuleChain=100.CopyMDNToMSessionKey
TrueRuleChain=200.QueryMonitoredSessionsMDN

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/100.CallAndroidCustom/700.SubscriberExistRuleChain/310.CheckMsessionKeyFlag/100.CopyMDNToMSessionKey]

ClassName=ConditionalRule
Conditions=DEG_OEMDevRespPhoneNumberString,=,""
TrueRuleChain=100.CopyDirect
FalseRuleChain=200.CopyRespPhoneNumberToMDN

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/100.CallAndroidCustom/700.SubscriberExistRuleChain/310.CheckMsessionKeyFlag/100.CopyMDNToMSessionKey/100.CopyDirect]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_NrbMonitoringSessionIdList null
AdornOps=copy DEG_MDN DEG_MSESSIONKEY
AdornOps=copy DEG_MDN DEG_OEMDevRespPhoneNumberString

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/100.CallAndroidCustom/700.SubscriberExistRuleChain/310.CheckMsessionKeyFlag/100.CopyMDNToMSessionKey/200.CopyRespPhoneNumberToMDN]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_MDN DEG_OEMDevRespPhoneNumberString
AdornOps=copy DEG_MDN DEG_MSESSIONKEY
AdornOps=set DEG_NrbMonitoringSessionIdList null

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/100.CallAndroidCustom/700.SubscriberExistRuleChain/310.CheckMsessionKeyFlag/200.QueryMonitoredSessionsMDN]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessions

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/100.CallAndroidCustom/700.SubscriberExistRuleChain/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG31.GSP.851"
AdornOps=set DEG_OEMDevErrorMessageString ""

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/100.CallAndroidCustom/700.SubscriberExistRuleChain/300.ProcessSubscriberExistsResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=DEBUG
Message=Row found from DEG_SUBSCRIBERS table
NullAlso=true

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVariables
RuleNames=200.IMSTableRowCount
RuleNames=300.LookUpIMSTable
RuleNames=100.SetHTTPErrorResponse
RuleNames=350.LogBeforeCopy
RuleNames=400.CopyBeforeGSPCustomTemplate
RuleNames=100.SetErrorResponse
RuleNames=400.LogBeforeGSPCustomTemplate
RuleNames=500.ProcessGSPCustomTemplate
RuleNames=700.CopyAfterGSPCustomTemplate
RuleNames=100.SetErrorResponse
RuleNames=700.LogAfterGSPCustomTemplate
RuleNames=750.MeasureListLength
#RuleNames=800.CheckCustomizeAttributes

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG31.GSP.852"
AdornOps=set DEG_OEMDevErrorMessageString ""

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/350.LogBeforeCopy]


ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevSessionStoreErrorFlagInteger
Attributes=DEG_CDevSessionStoreKeyExistsFlagInteger
Attributes=DEG_MDN

Attributes=DEG_PROVISIONING_STATUS
Attributes=DEG_ADDR_UPDATE_POSTDATA
Attributes=DEG_ADDRESS_STATUS
Attributes=DEG_TC_STATUS
Attributes=DEG_ADDRESS_UPDATE_URL
Attributes=DEG_EntitlementStatus
Attributes=DEG_OEMDevGatewayAddressString
Attributes=DEG_OEMDevCustomMSCHAPUserNameString
Attributes=DEG_OEMDevCustomMSCHAPPasswordString
Attributes=DEG_OEMDevDeviceCountIntegerTbl
Attributes=DEG_SSL_CUSTOM_FIELD
LogLevel=DEBUG2
Message=Log Before Copy Operation
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/100.InitVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set CUST_GSP_IN_IMS_Count 0
AdornOps=set CUST_GSP_OUT_JSON_Response_Code_String "0"
AdornOps=set CUST_GSP_OUT_Reset_GetAuth_Flag_Integer 0
AdornOps=set CUST_GSP_OUT_Reset_IMS_Flag_Integer 0
AdornOps=set CUST_GSP_OUT_IMS_Count 0
AdornOps=set CUST_GSP_OUT_COMPANIONDEVICE_COUNT ${COMPANIONDEVICE_COUNT}


AdornOps=setifnull DEG_ADDRESS_UPDATE_URL ${DEVICE_ADDRESS_UPDATE_URL}

AdornOps=setifnull DEG_MDN 0
AdornOps=setifnull DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=setifnull DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_EntitlementStatus ""
AdornOps=setifnull DEG_OEMDevGatewayAddressString ""
AdornOps=setifnull DEG_OEMDevCustomMSCHAPUserNameString ""
AdornOps=setifnull DEG_OEMDevCustomMSCHAPPasswordString ""
AdornOps=setifnull DEG_OEMDevDeviceCountIntegerTbl 0
AdornOps=setifnull DEG_SSL_CUSTOM_FIELD ""

AdornOps=set CUST_GSP_IN_IMS_DEVICE_ID_List null
AdornOps=set CUST_GSP_IN_IMS_PRIVATE_ID_List null
AdornOps=set CUST_GSP_IN_IMS_PUBLIC_ID_List null
AdornOps=set CUST_GSP_IN_IMS_SIP_USERNAME_List null
AdornOps=set CUST_GSP_IN_IMS_SIP_PASSWORD_List null


AdornOps=set CUST_GSP_OUT_IMS_DEVICE_ID_List null
AdornOps=set CUST_GSP_OUT_IMS_PRIVATE_ID_List null
AdornOps=set CUST_GSP_OUT_IMS_PUBLIC_ID_List null
AdornOps=set CUST_GSP_OUT_IMS_SIP_USERNAME_List null
AdornOps=set CUST_GSP_OUT_IMS_SIP_PASSWORD_List null

AdornOps=set DeviceIdListLength 0
AdornOps=set PrivateIdListLength 0
AdornOps=set PublicIdListLength 0
AdornOps=set SipUsernameListLength 0
AdornOps=set SipPasswordListLength 0

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/200.IMSTableRowCount]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_IMS_DATA_RowCountWithIMSI

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/ReferenceDataService]

QueryNames=DEG_IMS_DATA_RowCountWithIMSI
QueryNames=DEG_IMS_DATA_LookUpWithIMSI

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/ReferenceDataService/DEG_IMS_DATA_RowCountWithIMSI]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_IMSI,CUST_GSP_IN_IMS_Count 
CommonPolicyID=Policy1
QueryString=SELECT COUNT(*) AS CUST_GSP_IN_IMS_Count FROM DEG_IMS_DATA WHERE DEG_IMSI=%DEG_OEMDevImsiString

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/300.LookUpIMSTable]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_IMS_DATA_LookUpWithIMSI

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/ReferenceDataService/DEG_IMS_DATA_LookUpWithIMSI]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_DEVICE_ID,DEG_DEVICE_IDtemp
FieldExtracted=DEG_UNIQUE_ID,DEG_UNIQUE_IDtemp
FieldExtracted=DEG_IMS_PRIVATE_ID,DEG_IMS_PRIVATE_IDtemp
FieldExtracted=DEG_IMS_PUBLIC_ID,DEG_IMS_PUBLIC_IDtemp
FieldExtracted=DEG_IMSI,DEG_IMSI
FieldExtracted=DEG_SIP_USERNAME,DEG_SIP_USERNAMEtemp
FieldExtracted=DEG_SIP_PASSWORD,DEG_SIP_PASSWORDtemp
CommonPolicyID=Policy1
QueryString=SELECT %FIELDS FROM DEG_IMS_DATA where DEG_IMSI=%DEG_OEMDevImsiString
ResultAttribute=DEG_RowFoundInteger
ResultIndexAttribute=DEG_RowFoundIndexInteger

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/ReferenceDataService/DEG_IMS_DATA_LookUpWithIMSI/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=200.SetErrorFlag

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/ReferenceDataService/DEG_IMS_DATA_LookUpWithIMSI/ErrorRule/200.SetErrorFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/ReferenceDataService/DEG_IMS_DATA_LookUpWithIMSI/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_RowFoundInteger 0
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_IMS_DATA"
AdornOps=set CUST_GSP_IN_IMS_DEVICE_ID_List null
AdornOps=set CUST_GSP_IN_IMS_PRIVATE_ID_List null
AdornOps=set CUST_GSP_IN_IMS_PUBLIC_ID_List null
AdornOps=set CUST_GSP_IN_IMS_SIP_USERNAME_List null
AdornOps=set CUST_GSP_IN_IMS_SIP_PASSWORD_List null

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/ReferenceDataService/DEG_IMS_DATA_LookUpWithIMSI/ResultRowRule]

ClassName=RuleChain
RuleNames=100.AddDeviceIdToList
RuleNames=200.AddPrivateIdToList
RuleNames=300.AddPublicIdToList
RuleNames=400.AddSipUserNameToList
RuleNames=500.AddSipPasswordToList

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/ReferenceDataService/DEG_IMS_DATA_LookUpWithIMSI/ResultRowRule/100.AddDeviceIdToList]

ClassName=AddToListAttributeRule
InputAttribute=DEG_DEVICE_IDtemp
ListAttribute=CUST_GSP_IN_IMS_DEVICE_ID_List

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/ReferenceDataService/DEG_IMS_DATA_LookUpWithIMSI/ResultRowRule/200.AddPrivateIdToList]

ClassName=AddToListAttributeRule
InputAttribute=DEG_IMS_PRIVATE_IDtemp
ListAttribute=CUST_GSP_IN_IMS_PRIVATE_ID_List

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/ReferenceDataService/DEG_IMS_DATA_LookUpWithIMSI/ResultRowRule/300.AddPublicIdToList]

ClassName=AddToListAttributeRule
InputAttribute=DEG_IMS_PUBLIC_IDtemp
ListAttribute=CUST_GSP_IN_IMS_PUBLIC_ID_List

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/ReferenceDataService/DEG_IMS_DATA_LookUpWithIMSI/ResultRowRule/400.AddSipUserNameToList]

ClassName=AddToListAttributeRule
InputAttribute=DEG_SIP_USERNAMEtemp
ListAttribute=CUST_GSP_IN_IMS_SIP_USERNAME_List

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/ReferenceDataService/DEG_IMS_DATA_LookUpWithIMSI/ResultRowRule/500.AddSipPasswordToList]

ClassName=AddToListAttributeRule
InputAttribute=DEG_SIP_PASSWORDtemp
ListAttribute=CUST_GSP_IN_IMS_SIP_PASSWORD_List



[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/400.CopyBeforeGSPCustomTemplate]

ClassName=AdornmentRule
AdornOps=copy DEG_OEMDevImsiString CUST_GSP_IN_IMSIString
AdornOps=copy DEG_CDevSessionStoreErrorFlagInteger CUST_GSP_OUT_ErrorFlagInteger
AdornOps=copy DEG_CDevSessionStoreKeyExistsFlagInteger CUST_GSP_OUT_SubscriberExistsFlagInteger
AdornOps=copy DEG_MDN CUST_GSP_OUT_MDN
AdornOps=copy DEG_PROVISIONING_STATUS CUST_GSP_OUT_VoWiFi_PROVISIONING_STATUS
AdornOps=copy DEG_ADDR_UPDATE_POSTDATA CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_POSTDATA
AdornOps=copy DEG_ADDRESS_STATUS CUST_GSP_OUT_VoWiFi_ADDR_STATUS
AdornOps=copy DEG_TC_STATUS CUST_GSP_OUT_VoWiFi_TC_STATUS
AdornOps=copy DEG_ADDRESS_UPDATE_URL CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_URL
AdornOps=copy DEG_EntitlementStatus CUST_GSP_OUT_EntitlementStatus
AdornOps=copy DEG_OEMDevGatewayAddressString CUST_GSP_OUT_GatewayAddrString
AdornOps=copy DEG_OEMDevCustomMSCHAPUserNameString CUST_GSP_OUT_MSCHAPUserNameString
AdornOps=copy DEG_OEMDevCustomMSCHAPPasswordString CUST_GSP_OUT_MSCHAPPasswordString
AdornOps=copy DEG_OEMDevDeviceCountIntegerTbl CUST_GSP_OUT_COMPANIONDEVICE_COUNT
AdornOps=copy DEG_SSL_CUSTOM_FIELD CUST_GSP_OUT_SESSION_CUSTOM_VALUE
##RFE 86 : Include Bell Changes into Product.2.add a output attribute CUST_GSP_OUT_EAPAKAAuthRequiredFlagString which is to decide to EAP-AKA or token based  
## authentication in getSubProfileCust.
AdornOps=set DEG_OEMDevEAPAKAAuthRequiredFlagString "Y"
AdornOps=copy DEG_OEMDevEAPAKAAuthRequiredFlagString CUST_GSP_OUT_EAPAKAAuthRequiredFlagString

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/100.SetErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG31.GSP.853"
AdornOps=set DEG_OEMDevErrorMessageString "Attributes After Calling custom GSPCustomTemplate"


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/400.LogBeforeGSPCustomTemplate]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=CUST_GSP_IN_IMSIString
Attributes=CUST_GSP_IN_IMS_Count
Attributes=CUST_GSP_IN_IMS_DEVICE_ID_List
Attributes=CUST_GSP_IN_IMS_PRIVATE_ID_List
Attributes=CUST_GSP_IN_IMS_PUBLIC_ID_List
Attributes=CUST_GSP_IN_IMS_SIP_USERNAME_List
Attributes=CUST_GSP_IN_IMS_SIP_PASSWORD_List
Attributes=CUST_GSP_OUT_ErrorFlagInteger
Attributes=CUST_GSP_OUT_SubscriberExistsFlagInteger
Attributes=CUST_GSP_OUT_MDN
Attributes=CUST_GSP_OUT_VoWiFi_PROVISIONING_STATUS
Attributes=CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_POSTDATA
Attributes=CUST_GSP_OUT_VoWiFi_ADDR_STATUS
Attributes=CUST_GSP_OUT_VoWiFi_TC_STATUS
Attributes=CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_URL
Attributes=CUST_GSP_OUT_EntitlementStatus
Attributes=CUST_GSP_OUT_GatewayAddrString
Attributes=CUST_GSP_OUT_MSCHAPUserNameString
Attributes=CUST_GSP_OUT_MSCHAPPasswordString
Attributes=CUST_GSP_OUT_SESSION_CUSTOM_VALUE

Attributes=CUST_GSP_OUT_ErrorFlagInteger
Attributes=CUST_GSP_OUT_SubscriberExistsFlagInteger
Attributes=CUST_GSP_OUT_JSON_Response_Code_String
Attributes=CUST_GSP_OUT_Reset_GetAuth_Flag_Integer
Attributes=CUST_GSP_OUT_Reset_IMS_Flag_Integer
Attributes=CUST_GSP_OUT_IMS_Count
Attributes=CUST_GSP_OUT_COMPANIONDEVICE_COUNT

Attributes=CUST_GSP_OUT_GatewayAddrString
Attributes=CUST_GSP_OUT_MSCHAPUserNameString
Attributes=CUST_GSP_OUT_MSCHAPPasswordString


Attributes=CUST_GSP_IN_IMS_DEVICE_ID_List
Attributes=CUST_GSP_IN_IMS_PRIVATE_ID_List
Attributes=CUST_GSP_IN_IMS_PUBLIC_ID_List
Attributes=CUST_GSP_IN_IMS_SIP_USERNAME_List
Attributes=CUST_GSP_IN_IMS_SIP_PASSWORD_List

Attributes=CUST_GSP_OUT_IMS_DEVICE_ID_List
Attributes=CUST_GSP_OUT_IMS_PRIVATE_ID_List
Attributes=CUST_GSP_OUT_IMS_PUBLIC_ID_List
Attributes=CUST_GSP_OUT_IMS_SIP_USERNAME_List
Attributes=CUST_GSP_OUT_IMS_SIP_PASSWORD_List

Attributes=DeviceIdListLength
Attributes=PrivateIdListLength
Attributes=PublicIdListLength
Attributes=SipUsernameListLength
Attributes=SipPasswordListLength
Attributes=CUST_GSP_OUT_EAPAKAAuthRequiredFlagString
LogLevel=DEBUG2
Message=Attributes Before Calling custom GSPCustomTemplate : 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/500.ProcessGSPCustomTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_GetSubscriberProfile
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/700.CopyAfterGSPCustomTemplate]

ClassName=AdornmentRule
AdornOps=copy CUST_GSP_OUT_ErrorFlagInteger DEG_CDevSessionStoreErrorFlagInteger
AdornOps=copy CUST_GSP_OUT_SubscriberExistsFlagInteger DEG_CDevSessionStoreKeyExistsFlagInteger
AdornOps=copy CUST_GSP_OUT_MDN DEG_MDN
AdornOps=copy CUST_GSP_OUT_VoWiFi_PROVISIONING_STATUS DEG_PROVISIONING_STATUS
AdornOps=copy DEG_PROVISIONING_STATUS DEG_SSL_ID_PROV_STATUS
AdornOps=copy CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_POSTDATA DEG_ADDR_UPDATE_POSTDATA
AdornOps=copy DEG_ADDR_UPDATE_POSTDATA DEG_SSL_POSTDATA
AdornOps=copy CUST_GSP_OUT_VoWiFi_ADDR_STATUS DEG_ADDRESS_STATUS
AdornOps=copy DEG_ADDRESS_STATUS DEG_SSL_ADDRESS_STATUS
AdornOps=copy CUST_GSP_OUT_VoWiFi_TC_STATUS DEG_TC_STATUS
AdornOps=copy DEG_TC_STATUS DEG_SSL_TC_STATUS
AdornOps=copy CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_URL DEG_ADDRESS_UPDATE_URL
AdornOps=copy CUST_GSP_OUT_EntitlementStatus DEG_EntitlementStatus
AdornOps=copy CUST_GSP_OUT_GatewayAddrString DEG_OEMDevGatewayAddressString
AdornOps=copy CUST_GSP_OUT_MSCHAPUserNameString DEG_OEMDevCustomMSCHAPUserNameString
AdornOps=copy CUST_GSP_OUT_MSCHAPPasswordString DEG_OEMDevCustomMSCHAPPasswordString
AdornOps=copy CUST_GSP_OUT_COMPANIONDEVICE_COUNT DEG_OEMDevDeviceCountIntegerTbl
AdornOps=copy CUST_GSP_OUT_SESSION_CUSTOM_VALUE DEG_SSL_CUSTOM_FIELD
##RFE 86 : Include Bell Changes into Product.2.add a output attribute CUST_GSP_OUT_EAPAKAAuthRequiredFlagString which is to decide to EAP-AKA or token based  
## authentication in getSubProfileCust.
#RFE89 : : token based authentication for roaming IMSI.
AdornOps=setifnull CUST_GSP_OUT_EAPAKAAuthRequiredFlagString "Y"
AdornOps=copy CUST_GSP_OUT_EAPAKAAuthRequiredFlagString DEG_OEMDevEAPAKAAuthRequiredFlagString

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/100.SetErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG31.GSP.854"
AdornOps=set DEG_OEMDevErrorMessageString "Attributes After Calling custom GSPCustomTemplate"

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/700.LogAfterGSPCustomTemplate]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=CUST_GSP_IN_IMSIString
Attributes=CUST_GSP_IN_IMS_Count
Attributes=CUST_GSP_IN_IMS_DEVICE_ID_List
Attributes=CUST_GSP_IN_IMS_PRIVATE_ID_List
Attributes=CUST_GSP_IN_IMS_PUBLIC_ID_List
Attributes=CUST_GSP_IN_IMS_SIP_USERNAME_List
Attributes=CUST_GSP_IN_IMS_SIP_PASSWORD_List
Attributes=CUST_GSP_OUT_ErrorFlagInteger
Attributes=CUST_GSP_OUT_SubscriberExistsFlagInteger
Attributes=CUST_GSP_OUT_MDN
Attributes=CUST_GSP_OUT_VoWiFi_PROVISIONING_STATUS
Attributes=CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_POSTDATA
Attributes=CUST_GSP_OUT_VoWiFi_ADDR_STATUS
Attributes=CUST_GSP_OUT_VoWiFi_TC_STATUS
Attributes=CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_URL
Attributes=CUST_GSP_OUT_EntitlementStatus
Attributes=CUST_GSP_OUT_GatewayAddrString
Attributes=CUST_GSP_OUT_MSCHAPUserNameString
Attributes=CUST_GSP_OUT_MSCHAPPasswordString


Attributes=CUST_GSP_OUT_ErrorFlagInteger
Attributes=CUST_GSP_OUT_SubscriberExistsFlagInteger
Attributes=CUST_GSP_OUT_JSON_Response_Code_String
Attributes=CUST_GSP_OUT_Reset_GetAuth_Flag_Integer
Attributes=CUST_GSP_OUT_Reset_IMS_Flag_Integer
Attributes=CUST_GSP_OUT_IMS_Count
Attributes=CUST_GSP_OUT_COMPANIONDEVICE_COUNT

Attributes=CUST_GSP_OUT_GatewayAddrString
Attributes=CUST_GSP_OUT_MSCHAPUserNameString
Attributes=CUST_GSP_OUT_MSCHAPPasswordString


Attributes=CUST_GSP_IN_IMS_DEVICE_ID_List
Attributes=CUST_GSP_IN_IMS_PRIVATE_ID_List
Attributes=CUST_GSP_IN_IMS_PUBLIC_ID_List
Attributes=CUST_GSP_IN_IMS_SIP_USERNAME_List
Attributes=CUST_GSP_IN_IMS_SIP_PASSWORD_List

Attributes=CUST_GSP_OUT_IMS_DEVICE_ID_List
Attributes=CUST_GSP_OUT_IMS_PRIVATE_ID_List
Attributes=CUST_GSP_OUT_IMS_PUBLIC_ID_List
Attributes=CUST_GSP_OUT_IMS_SIP_USERNAME_List
Attributes=CUST_GSP_OUT_IMS_SIP_PASSWORD_List

Attributes=DeviceIdListLength
Attributes=PrivateIdListLength
Attributes=PublicIdListLength
Attributes=SipUsernameListLength
Attributes=SipPasswordListLength
Attributes=CUST_GSP_OUT_EAPAKAAuthRequiredFlagString

LogLevel=DEBUG2
Message=Attributes After Calling custom GSPCustomTemplate : 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


##################################################################

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/750.MeasureListLength]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=MeasureDeviceIdListLength
RuleNames=MeasurePrivateIdListLength
RuleNames=MeasurePublicIdListLength
RuleNames=MeasureSipUsernameListLength
RuleNames=MeasureSipPasswordListLength


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/750.MeasureListLength/MeasureDeviceIdListLength]

ClassName=ListAttributeIterator
ListAttributeName=CUST_GSP_OUT_IMS_DEVICE_ID_List
RuleChain=Count_DeviceIdList
TmpAttributeName=Tmp_DeviceId


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/750.MeasureListLength/MeasureDeviceIdListLength/Count_DeviceIdList]

ClassName=AdornmentRule
AdornOps=+ 1 DeviceIdListLength DeviceIdListLength


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/750.MeasureListLength/MeasurePrivateIdListLength]

ClassName=ListAttributeIterator
ListAttributeName=CUST_GSP_OUT_IMS_PRIVATE_ID_List
RuleChain=Count_PrivateIdList
TmpAttributeName=Tmp_PrivateId

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/750.MeasureListLength/MeasurePrivateIdListLength/Count_PrivateIdList]

ClassName=AdornmentRule
AdornOps=+ 1 PrivateIdListLength PrivateIdListLength


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/750.MeasureListLength/MeasurePublicIdListLength]

ClassName=ListAttributeIterator
ListAttributeName=CUST_GSP_OUT_IMS_PUBLIC_ID_List
RuleChain=Count_PublicIdList
TmpAttributeName=Tmp_PublicId


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/750.MeasureListLength/MeasurePublicIdListLength/Count_PublicIdList]

ClassName=AdornmentRule
AdornOps=+ 1 PublicIdListLength PublicIdListLength


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/750.MeasureListLength/MeasureSipUsernameListLength]

ClassName=ListAttributeIterator
ListAttributeName=CUST_GSP_OUT_IMS_SIP_USERNAME_List
RuleChain=Count_SipUsernameList
TmpAttributeName=Tmp_SipUsername

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/750.MeasureListLength/MeasureSipUsernameListLength/Count_SipUsernameList]

ClassName=AdornmentRule
AdornOps=+ 1 SipUsernameListLength SipUsernameListLength



[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/750.MeasureListLength/MeasureSipPasswordListLength]

ClassName=ListAttributeIterator
ListAttributeName=CUST_GSP_OUT_IMS_SIP_PASSWORD_List
RuleChain=Count_SipPasswordList
TmpAttributeName=Tmp_SipPassword

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400C.ProcessReadSubscribertableRuleChain/100.CheckCondition/200.CallAppleRuleChain/750.MeasureListLength/MeasureSipPasswordListLength/Count_SipPasswordList]

ClassName=AdornmentRule
AdornOps=+ 1 SipPasswordListLength SipPasswordListLength



[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400A.ProcessSubscriberExistsResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateGetAuthenticationAuditData


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400A.ProcessSubscriberExistsResponseRuleChain/100.GenerateGetAuthenticationAuditData]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=GetActiveMonitoringSessionsByMDN
TrueRuleChain=GetActiveMonitoringSessionsByIMSI
TrueRuleChain=GetActiveMonitoringSessionsByUniqueID

GetActiveMonitoringSessionsByMDN=900.InitVariables
GetActiveMonitoringSessionsByMDN=910.QueryMonitoredSessionsMDN

GetActiveMonitoringSessionsByIMSI=920.InitVariables
GetActiveMonitoringSessionsByIMSI=930.QueryMonitoredSessionsIMSI

GetActiveMonitoringSessionsByUniqueID=940.InitVariables
GetActiveMonitoringSessionsByUniqueID=950.QueryMonitoredSessionsUniqueID


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400A.ProcessSubscriberExistsResponseRuleChain/100.GenerateGetAuthenticationAuditData/900.InitVariables]

ClassName=ConditionalRule
Conditions=DEG_OEMDevRespPhoneNumberString,=,""
TrueRuleChain=100.CopyDirect
FalseRuleChain=200.CopyRespPhoneNumberToMDN


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400A.ProcessSubscriberExistsResponseRuleChain/100.GenerateGetAuthenticationAuditData/900.InitVariables/100.CopyDirect]

AdornOps=copy DEG_MDN DEG_MSESSIONKEY
AdornOps=copy DEG_MDN DEG_OEMDevRespPhoneNumberString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400A.ProcessSubscriberExistsResponseRuleChain/100.GenerateGetAuthenticationAuditData/900.InitVariables/200.CopyRespPhoneNumberToMDN]

AdornOps=copy DEG_OEMDevRespPhoneNumberString DEG_MDN
AdornOps=copy DEG_MDN DEG_MSESSIONKEY
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400A.ProcessSubscriberExistsResponseRuleChain/100.GenerateGetAuthenticationAuditData/910.QueryMonitoredSessionsMDN]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessions


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400A.ProcessSubscriberExistsResponseRuleChain/100.GenerateGetAuthenticationAuditData/920.InitVariables]

AdornOps=copy DEG_OEMDevImsiString DEG_MSESSIONKEY
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400A.ProcessSubscriberExistsResponseRuleChain/100.GenerateGetAuthenticationAuditData/930.QueryMonitoredSessionsIMSI]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessions


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400A.ProcessSubscriberExistsResponseRuleChain/100.GenerateGetAuthenticationAuditData/940.InitVariables]

AdornOps=copy DEG_OEMDevUniqueIDString DEG_MSESSIONKEY
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400A.ProcessSubscriberExistsResponseRuleChain/100.GenerateGetAuthenticationAuditData/950.QueryMonitoredSessionsUniqueID]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessionsV2


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400B.ProcessUnknownSubscriberResposneRuleChain]

RuleNames=100.CheckDeviceType

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400B.ProcessUnknownSubscriberResposneRuleChain/100.CheckDeviceType]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDeviceTypeString,=,"Android"
#QXCM1001541408 -- Device interface reporting 0 as MDN for IN message
#TrueRuleChain=50.GenerateAndroidStartAuditDataRuleChain
TrueRuleChain=100.UnknownSubscriber_SetSslSessionStatus
TrueRuleChain=120.GenerateGetAuthenticationUnknownSubscriberEndAuditData
#QXCM1001541408 -- Device interface reporting 0 as MDN for IN message
#FalseRuleChain=150.GenerateGetAuthenticationStartAuditDataRuleChain
FalseRuleChain=200.UnknownSubscriber_SetSslSessionStatus
#FalseRuleChain=210.UnknownSubscriber_GenerateResponse
#FalseRuleChain=230.GenerateGetAuthenticationUnknownSubscriberEndAuditData


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400B.ProcessUnknownSubscriberResposneRuleChain/100.CheckDeviceType/50.SetTransactionType]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400B.ProcessUnknownSubscriberResposneRuleChain/100.CheckDeviceType/50.GenerateAndroidStartAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400B.ProcessUnknownSubscriberResposneRuleChain/100.CheckDeviceType/150.GenerateGetAuthenticationStartAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400B.ProcessUnknownSubscriberResposneRuleChain/100.CheckDeviceType/100.UnknownSubscriber_SetSslSessionStatus]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull DEG_AuditTransactionTypeStringtemp ""
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_STATE "UNKNOWN_SUBSCRIBER"
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevHttpStatusInteger 403
AdornOps=set DEG_CDevProcessingErrorIdString "DEG31.GSP.859"
AdornOps=set DEG_OEMDevErrorMessageString "Unknown Subscriber"
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400B.ProcessUnknownSubscriberResposneRuleChain/100.CheckDeviceType/120.GenerateGetAuthenticationUnknownSubscriberEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400B.ProcessUnknownSubscriberResposneRuleChain/100.CheckDeviceType/200.UnknownSubscriber_SetSslSessionStatus]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_STATE "UNKNOWN_SUBSCRIBER"
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_OEMDevRespStatusString 6004
AdornOps=set DEG_CDevProcessingErrorIdString "DEG31.GSP.860"
AdornOps=set DEG_OEMDevErrorMessageString "Unknown Subscriber,Return code is "


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400B.ProcessUnknownSubscriberResposneRuleChain/100.CheckDeviceType/210.UnknownSubscriber_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400B.ProcessUnknownSubscriberResposneRuleChain/100.CheckDeviceType/230.GenerateGetAuthenticationUnknownSubscriberEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.SetIMSICheckFlag
#We moved these below 2 rulechains before calling this template as part of QXCM1001445539 issue fix.
#RuleNames=001.MonitorSessionRuleChain
#RuleNames=002.GenerateGetAuthenticationStartAuditData
RuleNames=001.EnvIMSICheck


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/000.SetIMSICheckFlag]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevEAPAKAAuthRequiredFlagString "Y"
AdornOps=set DEG_OEMDevSkipIMSICheckString ${GETAUTH_SKIP_IMSI_CHECK}
AdornOps=lower DEG_OEMDevSkipIMSICheckString DEG_OEMDevSkipIMSICheckString
AdornOps=set DEG_SessionKeyInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1


#QXCM1001424257	IN NRBGUI getAuth start is not coming and not getting displayed in DEG_MONITORING_TRANSACTIONS for ver 
[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.MonitorSessionRuleChain]

ClassName=LocalRuleChainInvoker
RuleChain=400A.ProcessSubscriberExistsResponseRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/002.GenerateGetAuthenticationStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/501.GenerateAndroidStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/501.GenerateAndroidStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_AuditTransactionTypeString DEG_AuditTransactionTypeStringtemp
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/501.GenerateAndroidStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEVICE TO DEG -> Received EAP-AKA request: "


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/501.GenerateAndroidStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/501.GenerateAndroidStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString ""


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/501.GenerateAndroidStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSkipIMSICheckString,=,"enabled"

FalseRuleChain=100.RetriveSubscriberData
FalseRuleChain=200.CheckDBResults
TrueRuleChain=110.InitRequestVariables
TrueRuleChain=120.ReadEAPAKAAuthValue
TrueRuleChain=130.CheckErrorAndNoMatchFlag


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/100.RetriveSubscriberData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400C.ProcessReadSubscribertableRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/200.CheckDBResults]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
#Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1

TrueRuleChain=DBConnectionError
TrueRuleChain=UnknowSubscriber
#TrueRuleChain=SubscriberExist

#DBConnectionError=100.GenerateStartAudit
DBConnectionError=100.SetHTTPErrorResponse
DBConnectionError=110.ErrorLog
DBConnectionError=120.GenerateErrorEndAudit

UnknowSubscriber=200.ProcessUnknownSubscriberResposne


#SubscriberExist=300.ProcessSubscriberExistsResponse
#SubscriberExist=310.CheckMsessionKeyFlag

#issue discription:when search based on MDN from GUI, entire getauth audits was not coming because the DEG_NrbMonitoringSessionIdList is null.
#Fix discription:after subscriber lookup again forming DEG_NrbMonitoringSessionIdList only in case of MDN search.
[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/200.CheckDBResults/310.CheckMsessionKeyFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SessionKeyInteger,=,1

TrueRuleChain=100.CopyMDNToMSessionKey
TrueRuleChain=200.QueryMonitoredSessionsMDN

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/200.CheckDBResults/310.CheckMsessionKeyFlag/100.CopyMDNToMSessionKey]

ClassName=ConditionalRule
Conditions=DEG_OEMDevRespPhoneNumberString,=,""
TrueRuleChain=100.CopyDirect
FalseRuleChain=200.CopyRespPhoneNumberToMDN

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/200.CheckDBResults/310.CheckMsessionKeyFlag/100.CopyMDNToMSessionKey/100.CopyDirect]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_NrbMonitoringSessionIdList null
AdornOps=copy DEG_MDN DEG_MSESSIONKEY
AdornOps=copy DEG_MDN DEG_OEMDevRespPhoneNumberString

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/200.CheckDBResults/310.CheckMsessionKeyFlag/100.CopyMDNToMSessionKey/200.CopyRespPhoneNumberToMDN]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_MDN DEG_OEMDevRespPhoneNumberString
AdornOps=copy DEG_MDN DEG_MSESSIONKEY
AdornOps=set DEG_NrbMonitoringSessionIdList null

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/200.CheckDBResults/310.CheckMsessionKeyFlag/200.QueryMonitoredSessionsMDN]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessions


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/200.CheckDBResults/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG31.GSP.855"
AdornOps=set DEG_OEMDevErrorMessageString "Failed to get subscriber profile information"


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/200.CheckDBResults/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=ERROR
Message=Error: Failed to get subscriber profile information from Subscribers table/External system :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/200.CheckDBResults/120.GenerateErrorEndAudit]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDeviceTypeString,=,"Android"
FalseRuleChain=100.GenerateAudit


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/200.CheckDBResults/120.GenerateErrorEndAudit/100.GenerateAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/200.CheckDBResults/200.ProcessUnknownSubscriberResposne]

ClassName=LocalRuleChainInvoker
RuleChain=400B.ProcessUnknownSubscriberResposneRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/110.InitRequestVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSysParameter "EAPAKAAuth"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/120.ReadEAPAKAAuthValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/130.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0

TrueRuleChain=100.CheckIfKeyExist
FalseRuleChain=200.SetErrorForLog
FalseRuleChain=210.ErrorLog

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/130.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0

TrueRuleChain=100.CheckEAPAKAAuthValue
FalseRuleChain=210.SetErrorForLog
FalseRuleChain=220.RowNotExistsLog

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/130.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/100.CheckEAPAKAAuthValue]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSysValueString,=,"Disabled"

TrueRuleChain=100.RetriveSubscriberData
TrueRuleChain=200.CheckDBResults


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/130.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/100.CheckEAPAKAAuthValue/100.RetriveSubscriberData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400C.ProcessReadSubscribertableRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/130.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/100.CheckEAPAKAAuthValue/200.CheckDBResults]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0


TrueRuleChain=DBConnectionError
TrueRuleChain=UnknowSubscriber


DBConnectionError=100.SetHTTPErrorResponse
DBConnectionError=110.ErrorLog
DBConnectionError=120.GenerateErrorEndAudit

UnknowSubscriber=200.ProcessUnknownSubscriberResposne




[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/130.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/100.CheckEAPAKAAuthValue/200.CheckDBResults/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG31.GSP.856"
AdornOps=set DEG_OEMDevErrorMessageString "Failed to get subscriber profile information"


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/130.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/100.CheckEAPAKAAuthValue/200.CheckDBResults/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=ERROR
Message=Error: Failed to get subscriber profile information from Subscribers table/External system :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Check whether TimesTen is up. If it is up, There is no match row found.  Contact HP Support.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/130.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/100.CheckEAPAKAAuthValue/200.CheckDBResults/120.GenerateErrorEndAudit]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDeviceTypeString,=,"Android"
FalseRuleChain=100.GenerateAudit


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/130.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/100.CheckEAPAKAAuthValue/200.CheckDBResults/120.GenerateErrorEndAudit/100.GenerateAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/130.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/100.CheckEAPAKAAuthValue/200.CheckDBResults/300.ProcessSubscriberExistsResponse]

ClassName=LocalRuleChainInvoker
RuleChain=400A.ProcessSubscriberExistsResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/130.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/100.CheckEAPAKAAuthValue/200.CheckDBResults/200.ProcessUnknownSubscriberResposne]

ClassName=LocalRuleChainInvoker
RuleChain=400B.ProcessUnknownSubscriberResposneRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/130.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/210.SetErrorForLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG31.GSP.857"
AdornOps=set DEG_OEMDevErrorMessageString "Rows not found in DEG_SYS_PARAMETERS"

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/130.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/220.RowNotExistsLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=No Row Found in DEG_SYS_PARAMETERS cache:
NullAlso=true
#Action=Check whether TimesTen is up. If it is up, There is no match row found.  Contact HP Support.


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/130.CheckErrorAndNoMatchFlag/200.SetErrorForLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG31.GSP.858"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to access DEG_SYS_PARAMETERS cache"


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/400.GetSubscriberProfileRuleChain/001.EnvIMSICheck/130.CheckErrorAndNoMatchFlag/210.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to access DEG_SYS_PARAMETERS cache 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/500.GenerateGetAuthenticationStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckVersion


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/500.GenerateGetAuthenticationStartAuditDataRuleChain/100.CheckVersion]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevXProtocolVersionString,=,2

TrueRuleChain=200.CreateAuditRecordV2
FalseRuleChain=100.CreateAuditRecordV1


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/500.GenerateGetAuthenticationStartAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/500.GenerateGetAuthenticationStartAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
#AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
#AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/500.GenerateGetAuthenticationStartAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEVICE TO DEG -> Received getAuthentication request: "


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/500.GenerateGetAuthenticationStartAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/500.GenerateGetAuthenticationStartAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1/400.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString ""


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/500.GenerateGetAuthenticationStartAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/500.GenerateGetAuthenticationStartAuditDataRuleChain/100.CheckVersion/200.CreateAuditRecordV2]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/500.GenerateGetAuthenticationStartAuditDataRuleChain/100.CheckVersion/200.CreateAuditRecordV2/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
#AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/500.GenerateGetAuthenticationStartAuditDataRuleChain/100.CheckVersion/200.CreateAuditRecordV2/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEVICE TO DEG -> Received getAuthentication request: "


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/500.GenerateGetAuthenticationStartAuditDataRuleChain/100.CheckVersion/200.CreateAuditRecordV2/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/500.GenerateGetAuthenticationStartAuditDataRuleChain/100.CheckVersion/200.CreateAuditRecordV2/400.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
#AdornOps=set DEG_AuditNRBMessageString ""
##RFE 86 : Include Bell Changes into Product. Issue no. 4d : change in Conditions
AdornOps=set DEG_AuditNRBMessageString "Received getAuthentication request from "
AdornOps=setifnull DEG_OEMDevImsiString ""
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevImsiString DEG_AuditNRBMessageString

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/500.GenerateGetAuthenticationStartAuditDataRuleChain/100.CheckVersion/200.CreateAuditRecordV2/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckVersion

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevXProtocolVersionString,=,2

TrueRuleChain=200.CreateAuditRecordV2
FalseRuleChain=100.CreateAuditRecordV1


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
#AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
#AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1/200.PopulateAuditMessageAttribute_Header]

ClassName=ConditionalRule
Conditions=DEG_OEMDevHttpStatusInteger,=,403
FalseRuleChain=100.PopulateHeaderForDevice
TrueRuleChain=200.PopulateHeaderForDegdroid


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1/200.PopulateAuditMessageAttribute_Header/200.PopulateHeaderForDegdroid]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1/200.PopulateAuditMessageAttribute_Header/100.PopulateHeaderForDevice]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1/500.PopulateAuditNRBMessageAttribute]

ClassName=ConditionalRule
Conditions=DEG_OEMDevHttpStatusInteger,=,403
TrueRuleChain=PopulateAuditNRBForDegdroid
FalseRuleChain=PopulateAuditNRBForDevice

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1/500.PopulateAuditNRBMessageAttribute/PopulateAuditNRBForDevice]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Unknown Subscriber,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1/500.PopulateAuditNRBMessageAttribute/PopulateAuditNRBForDegdroid]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Unknown Subscriber,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString 


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/100.CreateAuditRecordV1/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/200.CreateAuditRecordV2]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/200.CreateAuditRecordV2/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
#AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
#AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/200.CreateAuditRecordV2/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/200.CreateAuditRecordV2/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/200.CreateAuditRecordV2/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/200.CreateAuditRecordV2/500.PopulateAuditNRBMessageAttribute]

ClassName=ConditionalRule
Conditions=DEG_OEMDevHttpStatusInteger,=,403
TrueRuleChain=PopulateAuditNRBForDegdroid
FalseRuleChain=PopulateAuditNRBForDevice

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/200.CreateAuditRecordV2/500.PopulateAuditNRBMessageAttribute/PopulateAuditNRBForDevice]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Unknown Subscriber,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString 

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/200.CreateAuditRecordV2/500.PopulateAuditNRBMessageAttribute/PopulateAuditNRBForDegdroid]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Unknown Subscriber,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString 

[/templates/DEG/DeviceInterface/GetSubscriberProfileCore/RuleChains/506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain/100.CheckVersion/200.CreateAuditRecordV2/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true