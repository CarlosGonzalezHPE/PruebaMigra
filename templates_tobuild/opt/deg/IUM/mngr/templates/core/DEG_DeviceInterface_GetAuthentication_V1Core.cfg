[/templates/DEG/DeviceInterface/GetAuthentication_V1Core]


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains]

RuleChainNames=204.ProcessOEMGetAuthenticationRuleChain
RuleChainNames=501.GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain
RuleChainNames=502.GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain
RuleChainNames=503.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain
RuleChainNames=504.GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
RuleChainNames=505.GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain
RuleChainNames=508.GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=200.AddIdAndActionToList
RuleNames=300.ValidationAndProcessAction
RuleNames=400.UpdateSSLSessionStore
RuleNames=500.SetResponseHandler


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/100.InitWorkingVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_OEMDevSubscriberIdString ""
AdornOps=set DEG_OEMDevImsiString ""
AdornOps=set DEG_MDN 0
AdornOps=set DEG_IMSI ""
AdornOps=set DEG_OEMDevRespPhoneNumberString ""
AdornOps=set DEG_OEMDevDeviceTypeString ""

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/200.AddIdAndActionToList]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitCheck
RuleNames=200.AddToList


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/200.AddIdAndActionToList/100.InitCheck]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevRequestIdString DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString _ DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString DEG_OEMDevActionNameString DEG_OEMDevRequestIdAndNameString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/200.AddIdAndActionToList/200.AddToList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevRequestIdAndNameString
ListAttribute=DEG_OEMDevRequestIdAndNameList


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0


TrueRuleChain=CheckIfActionIsGetAuthentication
TrueRuleChain=ExtractGetAuthenticationAttributes
TrueRuleChain=CheckIfSubscriberIdAttributePresent
TrueRuleChain=CheckIfSubscriberIdEmpty
TrueRuleChain=ExtractNAIFromSubscriberIdAttribute
TrueRuleChain=ValidateIMSIInSubscriberId
TrueRuleChain=ValidateAuthTypeAttribute
TrueRuleChain=ValidateSubscriberIdAttribute
TrueRuleChain=ValidateToken
TrueRuleChain=ExtractImsiFromSubscriberIdAttribute
TrueRuleChain=GenerateGetAuthenticationStartAuditData
TrueRuleChain=CheckIfSubscriberProvisioned
TrueRuleChain=ProcessPerAuthType
TrueRuleChain=GenerateOEMResponse
TrueRuleChain=GenerateGetAuthenticationEndAuditData


CheckIfActionIsGetAuthentication=100.CheckIfActionIsGetAuthentication

ExtractGetAuthenticationAttributes=200.ExtractGetAuthenticationAttributes

CheckIfSubscriberIdAttributePresent=250.CheckIfSubscriberIdAttributePresent

CheckIfSubscriberIdEmpty=260.CheckIfSubscriberIdEmpty

ExtractNAIFromSubscriberIdAttribute=300.DecodePayload
ExtractNAIFromSubscriberIdAttribute=310.CheckPlayloadIfBase64

ValidateIMSIInSubscriberId=350.ValidateIMSIInSubscriberId

ValidateAuthTypeAttribute=400.ValidateAuthTypeAttribute

ValidateSubscriberIdAttribute=500.ValidateSubscriberIdAttribute


ValidateToken=600.ValidateToken

ExtractImsiFromSubscriberIdAttribute=700.ExtractImsiFromSubscriberIdAttribute

GenerateGetAuthenticationStartAuditData=350.MonitorSessionRuleChain
GenerateGetAuthenticationStartAuditData=351.SetLogInfo
GenerateGetAuthenticationStartAuditData=355.Log
GenerateGetAuthenticationStartAuditData=360.GenerateGetAuthenticationStartAuditData

CheckIfSubscriberProvisioned=800.CheckIfSubscriberProvisioned
CheckIfSubscriberProvisioned=801.CheckKeyExistsFlag

ProcessPerAuthType=2100.InitVariables
ProcessPerAuthType=2200.LookupDEGToken
ProcessPerAuthType=2300.CheckDEGToken

GenerateOEMResponse=3000.GenerateOEMResponse

GenerateGetAuthenticationEndAuditData=4000.GenerateGetAuthenticationEndAuditData


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/100.CheckIfActionIsGetAuthentication]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,!=,"getAuthentication"
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/100.CheckIfActionIsGetAuthentication/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0801"
AdornOps=set DEG_OEMDevErrorMessageString "GetAuthentication is expected"
AdornOps=copy DEG_OEMDevActionNameString DEG_AuditTransactionTypeString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/100.CheckIfActionIsGetAuthentication/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid OEM action - getAuthentication is expected, in case of previous getAuthentication failure.
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=GetAuthentication Action should be present in the Request for the first time .

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/100.CheckIfActionIsGetAuthentication/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/100.CheckIfActionIsGetAuthentication/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/200.ExtractGetAuthenticationAttributes]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
StructuredNMEToNMEMap=auth_type.CData,DEG_OEMDevAuthTypeString,""
StructuredNMEToNMEMap=subscriber_id.CData,DEG_OEMDevSubscriberIdString,dummy
StructuredNMEToNMEMap=token.CData,DEG_OEMDevTokenString,""

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/250.CheckIfSubscriberIdAttributePresent]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,=,dummy
TrueRuleChain=100.InitResponse
TrueRuleChain=110.ExecuteResponse
TrueRuleChain=115.SetErrorInfo
TrueRuleChain=120.LogResponse
TrueRuleChain=130.GenerateStartAudit
TrueRuleChain=140.GenerateGetAuthenticationUnknownSubscriberEndAuditData


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/250.CheckIfSubscriberIdAttributePresent/100.InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 6004
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/250.CheckIfSubscriberIdAttributePresent/110.ExecuteResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/250.CheckIfSubscriberIdAttributePresent/115.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0802"
AdornOps=set DEG_OEMDevErrorMessageString "subscriber-id attribute is missing in the request"

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/250.CheckIfSubscriberIdAttributePresent/120.LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Invalid getAuthenticate action - subscriber-id attribute is missing in the request
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/250.CheckIfSubscriberIdAttributePresent/130.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/250.CheckIfSubscriberIdAttributePresent/140.GenerateGetAuthenticationUnknownSubscriberEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/260.CheckIfSubscriberIdEmpty]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,=,""
TrueRuleChain=100.InitResponse
TrueRuleChain=110.SetResponse
TrueRuleChain=120.LogResponse
TrueRuleChain=130.GenerateStartAudit
TrueRuleChain=140.GenerateAuthenticatedEndAudit

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/260.CheckIfSubscriberIdEmpty/100.InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 6301
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0803"
AdornOps=set DEG_OEMDevErrorMessageString "subscriber-id is empty in the request"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/260.CheckIfSubscriberIdEmpty/110.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/260.CheckIfSubscriberIdEmpty/120.LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Invalid getAuthenticate action - subscriber-id is empty in the request
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/260.CheckIfSubscriberIdEmpty/130.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/260.CheckIfSubscriberIdEmpty/140.GenerateAuthenticatedEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/300.DecodePayload]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=decBase64 DEG_OEMDevSubscriberIdString DEG_OEMDevEAPPayloadBinary


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/310.CheckPlayloadIfBase64]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit
FalseRuleChain=200.ConvertPayload2String
FalseRuleChain=210.DecodeNAI


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/310.CheckPlayloadIfBase64/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=(DEG_OEMDevEAPPayloadBinary =="") || (DEG_OEMDevEAPPayloadBinary == null)


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/310.CheckPlayloadIfBase64/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0804"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to Extract NAI From SubscriberId"


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/310.CheckPlayloadIfBase64/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevTempSubscriberIdString
Attributes=DEG_OEMDevSubscriberIdLengthInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Data Error in EAP Payload
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Durning Authentication EAP Payload is not a valid .

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/310.CheckPlayloadIfBase64/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/310.CheckPlayloadIfBase64/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/310.CheckPlayloadIfBase64/200.ConvertPayload2String]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=bin2str DEG_OEMDevEAPPayloadBinary DEG_OEMDevTempSubscriberIdString "ISO8859_1"
AdornOps=length DEG_OEMDevTempSubscriberIdString DEG_OEMDevSubscriberIdLengthInteger


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/310.CheckPlayloadIfBase64/210.DecodeNAI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdLengthInteger,>=,6
TrueRuleChain=100.ExtractNAI


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/310.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr 5 length DEG_OEMDevTempSubscriberIdString DEG_OEMDevSubscriberIdString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/350.ValidateIMSIInSubscriberId]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
TrueRuleChain=200.InitResponse
TrueRuleChain=210.SetResponse
TrueRuleChain=220.LogResponse
TrueRuleChain=230.GenerateStartAudit
TrueRuleChain=240.GenerateEndAudit
Operation=match
RegExPattern=${IMSIIN_SUBSCRIBERID_PATTERN}
SourceAttribute=DEG_OEMDevSubscriberIdString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/350.ValidateIMSIInSubscriberId/200.InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 6301
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0805"
AdornOps=set DEG_OEMDevErrorMessageString "IMSI is empty in the request"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/350.ValidateIMSIInSubscriberId/210.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/350.ValidateIMSIInSubscriberId/220.LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Invalid getAuthenticate action - IMSI is empty in the request
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevSslSessionIdString

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/350.ValidateIMSIInSubscriberId/230.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/350.ValidateIMSIInSubscriberId/240.GenerateEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=504.GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/400.ValidateAuthTypeAttribute]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAuthTypeString,!=,"EAP-AKA"
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=130.GenerateStartAudit
TrueRuleChain=120.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/400.ValidateAuthTypeAttribute/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0806"
AdornOps=set DEG_OEMDevErrorMessageString "Auth-type attribute must be EAK-AKA"


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/400.ValidateAuthTypeAttribute/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid getAuthentication action - auth-type attribute must be EAK-AKA: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Auth-type attribute must be EAK-AKA present in the request.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/400.ValidateAuthTypeAttribute/130.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/400.ValidateAuthTypeAttribute/120.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/500.ValidateSubscriberIdAttribute]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
FalseRuleChain=200.SetHttpErrorResponse
FalseRuleChain=210.ErrorLog
FalseRuleChain=230.GenerateStartAudit
FalseRuleChain=220.GenerateErrorEndAudit
Operation=match
RegExPattern=${SUBSCRIBERID_PATTERN}
SourceAttribute=DEG_OEMDevSubscriberIdString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/500.ValidateSubscriberIdAttribute/200.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0807"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber-id attribute not NAI format"


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/500.ValidateSubscriberIdAttribute/210.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid getAuthenticate action - subscriber-id attribute must be in NAI format: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action= Subscriber-id attribute must be in NAI format .

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/500.ValidateSubscriberIdAttribute/230.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/500.ValidateSubscriberIdAttribute/220.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/600.ValidateToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=130.GenerateStartAudit
TrueRuleChain=120.GenerateErrorEndAudit


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/600.ValidateToken/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0808"
AdornOps=set DEG_OEMDevErrorMessageString "Token is empty"


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/600.ValidateToken/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid getAuthenticate action - token is empty: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=During getAuthentication Action ,Token should not be empty.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/600.ValidateToken/130.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/600.ValidateToken/120.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/700.ExtractImsiFromSubscriberIdAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr "0" "@" DEG_OEMDevSubscriberIdString DEG_OEMDevImsiString

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/350.MonitorSessionRuleChain]

ClassName=LocalRuleChainInvoker
RuleChain=400A.ProcessSubscriberExistsResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/351.SetLogInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0809"
AdornOps=set DEG_OEMDevErrorMessageString "LogRequestIssueLevel1"


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/355.Log]

ClassName=LogNMERule
Attribute=DEG_OEMDevUserAgentString
Attribute=DEG_USER_AGENT
Attribute=CUST_GAC_IN_UserAgentString
Attribute=DEG_AuditUserAgentString
Attribute=DEG_CDevProcessingErrorIdString
Attribute=DEG_OEMDevErrorMessageString
LogLevel=DEBUG2
Message=Print the values:::
PropertyName=LogRequestIssueLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/360.GenerateGetAuthenticationStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/800.CheckIfSubscriberProvisioned]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400.GetSubscriberProfileRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=CUST_GSP_OUT_JSON_Response_Code_String,!=,"0"
Conditions=CUST_GSP_OUT_Reset_GetAuth_Flag_Integer,=,1
Conditions=CUST_GSP_OUT_Reset_IMS_Flag_Integer,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1

TrueRuleChain=DBConnectionError
TrueRuleChain=SetCarrierResponse
TrueRuleChain=DeleteRowFromTable
TrueRuleChain=ResetIMSTable
TrueRuleChain=UnknownSubscriber
TrueRuleChain=SubscriberExist

SetCarrierResponse=130.SetHTTPErrorResponse
SetCarrierResponse=140.SetErrorResponse
SetCarrierResponse=150.CallGetAuthenticationDisallowedActionEndAuditDataRuleChain

DeleteRowFromTable=200.DeleteCompanionTokenTable
DeleteRowFromTable=200.DeleteDeviceDataTable

ResetIMSTable=300.CheckAndResetIMSDataWithImsi

SubscriberExist=250.SetErrorInfo
SubscriberExist=300.ProcessSubscriberExistsResponse
SubscriberExist=310.CheckMsessionKeyFlag

UnknownSubscriber=100.UnknownSubscriber_GenerateResponse
#QXCM1001509548:After SPS return an Unknown Subscriber error, wrong transaction type logged
UnknownSubscriber=101.SetTransactionType
UnknownSubscriber=110.GenerateGetAuthenticationUnknownSubscriberEndAuditData

DBConnectionError=100.SetErrorInfo
DBConnectionError=110.ErrorLog

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0810"
AdornOps=set DEG_OEMDevErrorMessageString "Failed to get subscriber profile information"

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=DEBUG
Message=Error: Failed to get subscriber profile information from 400.GetSubscriberProfileRuleChain :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/310.CheckMsessionKeyFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SessionKeyInteger,=,1

TrueRuleChain=100.CopyMDNToMSessionKey
TrueRuleChain=200.QueryMonitoredSessionsMDN

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/310.CheckMsessionKeyFlag/100.CopyMDNToMSessionKey]

ClassName=ConditionalRule
Conditions=DEG_OEMDevRespPhoneNumberString,=,""
TrueRuleChain=100.CopyDirect
FalseRuleChain=200.CopyRespPhoneNumberToMDN

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/310.CheckMsessionKeyFlag/100.CopyMDNToMSessionKey/100.CopyDirect]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_NrbMonitoringSessionIdList null
AdornOps=copy DEG_MDN DEG_MSESSIONKEY
AdornOps=copy DEG_MDN DEG_OEMDevRespPhoneNumberString

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/310.CheckMsessionKeyFlag/100.CopyMDNToMSessionKey/200.CopyRespPhoneNumberToMDN]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_MDN DEG_OEMDevRespPhoneNumberString
AdornOps=copy DEG_MDN DEG_MSESSIONKEY
AdornOps=set DEG_NrbMonitoringSessionIdList null

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/310.CheckMsessionKeyFlag/200.QueryMonitoredSessionsMDN]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessions

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/250.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0811"
AdornOps=set DEG_OEMDevErrorMessageString "Row found from DEG_SUBSCRIBERS table"

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.ProcessSubscriberExistsResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=DEBUG
Message=Row found from DEG_SUBSCRIBERS table
NullAlso=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteCompanionTokenTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitDeleteSession
RuleNames=300.ExecuteDeleteSession
RuleNames=400.CheckDeleteSessionStatus

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteCompanionTokenTable/100.InitDeleteSession]

AdornOps=set log_DB_Operation "DELETE"
AdornOps=set log_Table_Name "DEG_COMPANION_TOKENS"
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteCompanionTokenTable/300.ExecuteDeleteSession]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
NativeCondition=1.MatchByImsi
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_COMPANION_TOKENS_SessionStore

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteCompanionTokenTable/400.CheckDeleteSessionStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
DBError=105.LogDBErrorInfo
DBError=110.LogDBError
Operations=None
SubscriberDoesNotExist=110.SetErrorInfo
SubscriberDoesNotExist=200.LogSubscriberDoesNotExist
TrueRuleChain=DBError
TrueRuleChain=SubscriberDoesNotExist

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteCompanionTokenTable/400.CheckDeleteSessionStatus/105.LogDBErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0812"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to delete from DEG_COMPANION_TOKENS table"

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteCompanionTokenTable/400.CheckDeleteSessionStatus/110.LogDBError]

Attributes=log_Table_Name
Attributes=log_DB_Operation
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to delete from DEG_COMPANION_TOKENS table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteCompanionTokenTable/400.CheckDeleteSessionStatus/110.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0813"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber IMSI does not exist"

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteCompanionTokenTable/400.CheckDeleteSessionStatus/200.LogSubscriberDoesNotExist]

Attributes=log_Table_Name
Attributes=log_DB_Operation
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Subscriber IMSI does not exist in DEG_COMPANION_TOKENS table :
NullAlso=true
PropertyName=LogRequestFlowLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteDeviceDataTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitDeviceDataUpdate
RuleNames=200.DeleteDeviceDataTable
RuleNames=300.CheckDeleteStatus

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteDeviceDataTable/100.InitDeviceDataUpdate]

AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteDeviceDataTable/200.DeleteDeviceDataTable]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
NativeCondition=1.MatchByIMSI
SessionStore=DEG_DEVICE_DATA_SessionStore
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteDeviceDataTable/300.CheckDeleteStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SystemError_SetResponse
TrueRuleChain=110.SystemError_Log
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteDeviceDataTable/300.CheckDeleteStatus/100.SystemError_SetResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0814"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteDeviceDataTable/300.CheckDeleteStatus/110.SystemError_Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
Message=Unable to perform delete operation on DEG_DEVICE_DATA table: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteDeviceDataTable/300.CheckDeleteStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteDeviceDataTable/300.CheckDeleteStatus/200.CheckKeyExists/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0815"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/200.DeleteDeviceDataTable/300.CheckDeleteStatus/200.CheckKeyExists/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=DEBUG
Message=Database Error: No data in DEG_DEVICE_DATA session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true



[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DeviceIdListLength,=,PrivateIdListLength
Conditions=DeviceIdListLength,=,PublicIdListLength
Conditions=DeviceIdListLength,=,SipUsernameListLength
Conditions=DeviceIdListLength,=,SipPasswordListLength
Operations=and,and,and

TrueRuleChain=100.DeleteIMSDataWithImsi
TrueRuleChain=200.CheckListAndInsert
FalseRuleChain=300.ListLengthMismatchError

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/100.DeleteIMSDataWithImsi]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.InitializeVariables
RuleNames=120.DeleteIMSData
RuleNames=130.CheckErrorFlag

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/100.DeleteIMSDataWithImsi/110.InitializeVariables]

AdornOps=set log_DB_Operation "DELETE"
AdornOps=set log_Table_Name "DEG_IMS_DATA"
AdornOps=set DEG_SubProvSessionStoreErrorFlagInteger 0
AdornOps=set DEG_SubProvSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/100.DeleteIMSDataWithImsi/120.DeleteIMSData]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
NativeCondition=1.MatchByIMSI
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_IMS_DATA_SessionStore

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/100.DeleteIMSDataWithImsi/130.CheckErrorFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,!=,0
TrueRuleChain=110.SetErrorInfo
TrueRuleChain=120.SetErrorLog

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/100.DeleteIMSDataWithImsi/130.CheckErrorFlag/110.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0816"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/100.DeleteIMSDataWithImsi/130.CheckErrorFlag/120.SetErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_IMSI
Attributes=DEG_ENTITLEMENT_NAME
Attributes=DEG_PROVISIONING_STATUS
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_SSL_REQUEST_STATE
LogLevel=CRITICAL
Message=Database Error: Unable to perform Update or access DEG_IMS_DATA table
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert]


ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DeviceIdListLength,>,0

TrueRuleChain=200.ExtractOutListVariablesAndInsert


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert]

ClassName=ListAttributeIterator
ListAttributeName=CUST_GSP_OUT_IMS_DEVICE_ID_List
ListAttributeName=CUST_GSP_OUT_IMS_PRIVATE_ID_List
ListAttributeName=CUST_GSP_OUT_IMS_PUBLIC_ID_List
ListAttributeName=CUST_GSP_OUT_IMS_SIP_USERNAME_List
ListAttributeName=CUST_GSP_OUT_IMS_SIP_PASSWORD_List
RuleChain=100.SetErrorInfo
RuleChain=100.CheckLog
RuleChain=100.InsertIntoImsData
TmpAttributeName=DEG_DEVICE_ID
TmpAttributeName=DEG_IMS_PRIVATE_ID
TmpAttributeName=DEG_IMS_PUBLIC_ID
TmpAttributeName=DEG_SIP_USERNAME
TmpAttributeName=DEG_SIP_PASSWORD

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0817"
AdornOps=set DEG_OEMDevMessageString "CheckLog::"

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.CheckLog]

ClassName=LogNMERule
LogLevel=DEBUG
Attributes=DEG_DEVICE_ID
Attributes=DEG_IMS_PRIVATE_ID
Attributes=DEG_SIP_USERNAME
Attributes=DEG_IMS_PUBLIC_ID
Attributes=DEG_SIP_PASSWORD
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=<<<<<CheckLog::>>>>>

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.InsertIntoImsData]


ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitializeVariables
RuleNames=110.CreateIMSData
RuleNames=120.CheckErrorFlag

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.InsertIntoImsData/100.InitializeVariables]


ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=setifnull DEG_OEMDevSipUserNameString ""
AdornOps=setifnull DEG_OEMDevSipPasswordString ""
AdornOps=setifnull DEG_OEMDevPublicIDString ""
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_IMS_DATA"
AdornOps=set DEG_UNIQUE_ID ""
AdornOps=setsystime DEG_PROVTIME
AdornOps=setsystime DEG_LASTUPDATE



[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.InsertIntoImsData/110.CreateIMSData]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_IMS_DATA_SessionStore

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.InsertIntoImsData/120.CheckErrorFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.InsertIntoImsData/120.CheckErrorFlag/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0818"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/200.CheckListAndInsert/200.ExtractOutListVariablesAndInsert/100.InsertIntoImsData/120.CheckErrorFlag/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_DEVICE_ID
Attributes=DEG_SIP_PASSWORD
Attributes=DEG_SIP_USERNAME
Attributes=DEG_IMS_PUBLIC_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to create entry in DEG_IMS_DATA session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/300.ListLengthMismatchError]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetHTTPErrorResponse
RuleNames=110.ErrorLog

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/300.ListLengthMismatchError/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6005
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0819"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_IMS_DATA table"
AdornOps=set DEG_OEMDevSetProvisioningRequestProcessedInteger 1

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/300.CheckAndResetIMSDataWithImsi/300.ListLengthMismatchError/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule

LogLevel=CRITICAL
Message=LIST Length Mismatch while updating DEG_IMS_DATA table :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
Attributes=DeviceIdListLength
Attributes=PublicIdListLength
Attributes=SipUsernameListLength
Attributes=SipPasswordListLength
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString


#Fix for QXCM1001521530 -- Value set in custom template is not reflecting in the getauth response
[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/130.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
#AdornOps=set DEG_SSL_STATE "DISALLOWED_ACTION"
AdornOps=setifnull CUST_GSP_OUT_SSL_STATE_String ""
AdornOps=copy CUST_GSP_OUT_SSL_STATE_String DEG_SSL_STATE
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
#AdornOps=set DEG_OEMDevRespStatusString 6005
AdornOps=copy CUST_GSP_OUT_JSON_Response_Code_String DEG_OEMDevRespStatusString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0820"
AdornOps=set DEG_OEMDevErrorMessageString "Get Auth error response is set in custom code."

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/140.SetErrorResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/150.CallGetAuthenticationDisallowedActionEndAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=508.GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/100.UnknownSubscriber_GenerateResponse]


ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/101.SetTransactionType]

AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/801.CheckKeyExistsFlag/110.GenerateGetAuthenticationUnknownSubscriberEndAuditData]


ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2100.InitVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_TOKENS"
AdornOps=copy DEG_MDN DEG_CDevMobileNumberString
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=set DEG_CDevTokenString ""
AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_OEMDevFastAuthFlag 0


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2200.LookupDEGToken]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateGetAuthenticationSystemErrorEndAuditData
FalseRuleChain=200.CheckTokenTimeStamp
FalseRuleChain=210.GetToken


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0821"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_TOKENS table while Processing Authentication
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/120.GenerateGetAuthenticationSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
TrueRuleChain=100.GetDifference
TrueRuleChain=110.ReadTokenLifeTime
FalseRuleChain=200.SetFullAuthTimeStamp


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/100.GetDifference]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_FULLAUTHTIMESTAMP DEG_OEMDevTokenTimeStampDiffLong


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequest
RuleNames=110.ReadValue
RuleNames=120.CheckErrorAndNoMatchFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/100.InitRequest]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevLicenseTypeString "EAP"
AdornOps=set DEG_OEMDevTokenLifetimeLong 0
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_OEMDevLicenseTypeString
ResponseAttributes=DEG_OEMDevTokenLifetimeLong
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=004.ReadTokenLifeTimeRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0

TrueRuleChain=100.CheckIfKeyExist
FalseRuleChain=200.SetFullAuthTimeStamp
FalseRuleChain=210.SetErrorForLog
FalseRuleChain=220.ErrorLog


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0

TrueRuleChain=100.SetSysValue
TrueRuleChain=110.CompareTokenExpirationTime
TrueRuleChain=200.SetErrorInfo
TrueRuleChain=120.TokenExpirationLog
FalseRuleChain=200.SetFullAuthTimeStamp
FalseRuleChain=210.SetErrorForLog
FalseRuleChain=220.RowNotExistsLog


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/100.SetSysValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevTokenLifetimeLong DEG_OEMDevEAPTokenLifetimeLong


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/110.CompareTokenExpirationTime]

ClassName=RuleChain
RuleNames=110.SetFastAuthFlagWithinEAPTokenLifetime
#RuleNames=120.GenRandomValueifWithinEAPTokenLifetimeto60days
#RuleNames=130.SetFullAuthRequiredif60daysago


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/110.CompareTokenExpirationTime/110.SetFastAuthFlagWithinEAPTokenLifetime]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenTimeStampDiffLong,<=,DEG_OEMDevEAPTokenLifetimeLong
TrueRuleChain=100.SetFastAuthFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/110.CompareTokenExpirationTime/110.SetFastAuthFlagWithinEAPTokenLifetime/100.SetFastAuthFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevFastAuthFlag 1


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/110.CompareTokenExpirationTime/120.GenRandomValueifWithinEAPTokenLifetimeto60days]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenTimeStampDiffLong,>,DEG_OEMDevEAPTokenLifetimeLong
Conditions=DEG_OEMDevTokenTimeStampDiffLong,<=,5184000000
Operations=and
TrueRuleChain=100.GenerateRandomValue


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/110.CompareTokenExpirationTime/120.GenRandomValueifWithinEAPTokenLifetimeto60days/100.GenerateRandomValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=rand DEG_OEMDevRandValueInteger 1 10000000
AdornOps=% DEG_OEMDevRandValueInteger 2 DEG_OEMDevFastAuthFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/110.CompareTokenExpirationTime/130.SetFullAuthRequiredif60daysago]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenTimeStampDiffLong,>,5184000000
TrueRuleChain=100.SetNoFastAuthFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/110.CompareTokenExpirationTime/130.SetFullAuthRequiredif60daysago/100.SetNoFastAuthFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevFastAuthFlag 0

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/200.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0822"
AdornOps=set DEG_OEMDevErrorMessageString "TokenExpiration Log:"

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/120.TokenExpirationLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevCurrentTimeStampLong
Attributes=DEG_OEMDevTokenTimeStampDiffLong
Attributes=DEG_FULLAUTHTIMESTAMP
Attributes=DEG_OEMDevFastAuthFlag
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_TOKENSTATUS
Attributes=DEG_OEMDevTokenString
Attributes=DEG_SUBSTOKEN
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_OEMDevEAPTokenLifetimeLong
Attributes=DEG_CDevDBErrorFlagInteger
Attributes=DEG_CDevDBNoMatchFlagInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=TokenExpiration Log:
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/200.SetFullAuthTimeStamp]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_FULLAUTHTIMESTAMP


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/210.SetErrorForLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0823"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/220.RowNotExistsLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=No Row Found in DEG_LIC_LIMITS cache:
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/200.SetFullAuthTimeStamp]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_FULLAUTHTIMESTAMP


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/210.SetErrorForLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0824"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/220.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to access DEG_LIC_LIMITS table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/200.CheckTokenTimeStamp/200.SetFullAuthTimeStamp]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_FULLAUTHTIMESTAMP


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
Conditions=DEG_OEMDevFastAuthFlag,=,1
Conditions=DEG_TOKENSTATUS,=,"AE"
Conditions=DEG_OEMDevTokenString,=,DEG_SUBSTOKEN
Operations=and,and,and
TrueRuleChain=100.FastPathAuth
FalseRuleChain=200.EAPAKAAuth


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/100.FastPathAuth]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSkipIMSICheckString,!=,"enabled"
TrueRuleChain=100.SetSessionStatus
TrueRuleChain=150.SetErrorInfo
TrueRuleChain=200.LogFastPathAuth
FalseRuleChain=001.LookupSubscriber
FalseRuleChain=002.CheckProcessedInteger

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/100.FastPathAuth/001.LookupSubscriber]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400C.ProcessReadSubscribertableRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/100.FastPathAuth/002.CheckProcessedInteger]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=100.SetSessionStatus

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/100.FastPathAuth/002.CheckProcessedInteger/100.SetSessionStatus]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "TKN"
AdornOps=copy DEG_MDN DEG_CDevMobileNumberString
AdornOps=set DEG_OEMDevRespStatusString 6000

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/100.FastPathAuth/100.SetSessionStatus]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "TKN"

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/100.FastPathAuth/150.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0825"
AdornOps=set DEG_OEMDevMessageString "Perform FastPathAuth: "

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/100.FastPathAuth/200.LogFastPathAuth]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Perform FastPathAuth: 
NullAlso=true
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/200.EAPAKAAuth]

ClassName=RuleChain
RuleNames=100.InitRequestVariables
RuleNames=200.ReadValue
RuleNames=300.CheckErrorAndNoMatchFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/200.EAPAKAAuth/100.InitRequestVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSysParameter "EAPAKAAuth"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN



[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/200.EAPAKAAuth/200.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/200.EAPAKAAuth/300.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
Conditions=DEG_CDevSysValueString,=,"Enabled"
#RFE89 : : token based authentication for roaming IMSI.
Conditions=DEG_OEMDevEAPAKAAuthRequiredFlagString,=,"Y"
Operations=and,and,and
TrueRuleChain=100.AAAProcessingRule
TrueRuleChain=200.SetErrorInfo
TrueRuleChain=110.LogEAPAKAAtuhEnabled
FalseRuleChain=200.SetSessionStatus
FalseRuleChain=210.LogEAPAKAAtuhDisabled


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/200.EAPAKAAuth/300.CheckErrorAndNoMatchFlag/100.AAAProcessingRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_OEMDevSubscriberIdString
RequestAttributes=DEG_OEMDevEAPPayloadBinary
ResponseAttributes=DEG_OEMDevRequestIdString
RequestAttributes=DEG_SSL_NAI
ResponseAttributes=DEG_SSL_STATE
ResponseAttributes=DEG_SSL_AAA_STATE
ResponseAttributes=DEG_AUTHENTICATION_TYPE
ResponseAttributes=DEG_AUTHENTICATION_SUBTYPE
ResponseAttributes=DEG_OEMDevEAPPayloadBinary
RuleChain=301.AAAProcessingRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/200.EAPAKAAuth/300.CheckErrorAndNoMatchFlag/200.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0826"
AdornOps=set DEG_OEMDevMessageString "Perform EAPAKAAtuh Enable: "
AdornOps=set DEG_AuditSourceDestinationVersionString ""

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/200.EAPAKAAuth/300.CheckErrorAndNoMatchFlag/110.LogEAPAKAAtuhEnabled]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_SSL_STATE
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
LogLevel=DEBUG
Message=Perform EAPAKAAtuh Enable: 
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/200.EAPAKAAuth/300.CheckErrorAndNoMatchFlag/200.SetSessionStatus]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "DFT"
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_OEMDevErrorMessageString "EAPAKAAtuh Disabled or Transient System Error"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0827"

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/2300.CheckDEGToken/210.GetToken/200.EAPAKAAuth/300.CheckErrorAndNoMatchFlag/210.LogEAPAKAAtuhDisabled]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=DEBUG
Message=Perform EAPAKAAtuh Disabled: 
PropertyName=LogRequestFlowLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Conditions=DEG_SSL_STATE,starts,"AUTHENTICATED"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE

TrueRuleChain=UnknownSubscriber
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=StatusDisallowed
TrueRuleChain=Authenticated
TrueRuleChain=Unknown

UnknownSubscriber=100.UnknownSubscriber_InitResponse
UnknownSubscriber=110.UnknownSubscriber_GenerateResponse

AkaWait=200.AkaWait_InitResponse
AkaWait=210.AkaWait_GenerateResponse

AkaRejected=300.AkaRejected_InitResponse
AkaRejected=310.AkaRejected_DeactiveToken
AkaRejected=320.AkaRejected_GenerateResponse

Authenticated=400.Authenticated_InitResponse
#RFE75 fix related files.
#New header attribute 'user-agent' added as part of http request from the device.
#iOS device sends specific User-Agent strings that can identify the specific device and version of iOS.
Authenticated=405.Authenticated_UserAgent
Authenticated=410.Authenticated_StoreToken
# DEG part comment begins
#Authenticated=420.Authenticated_createAppToken
# DEG part comment ends
Authenticated=430.Authenticated_GenerateResponse

Unknown=500.Unknown_SetHttpErrorResponseTo500C

StatusDisallowed=600.DisallowedAction_InitResponse
StatusDisallowed=610.DisallowedAction_GenerateResponse


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/100.UnknownSubscriber_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6004


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/110.UnknownSubscriber_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/200.AkaWait_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "200"
AdornOps=set DEG_OEMDevRespStatusString 6302


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/210.AkaWait_GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.GenerateNullPayloadResponse
FalseRuleChain=200.EncodePayload
FalseRuleChain=210.GenerateResponse


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/210.AkaWait_GenerateResponse/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/210.AkaWait_GenerateResponse/100.GenerateNullPayloadResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/210.AkaWait_GenerateResponse/200.EncodePayload]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/210.AkaWait_GenerateResponse/210.GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevEAPPayloadString,jsonResponse.challenge.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/300.AkaRejected_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6300
AdornOps=set DEG_TOKENSTATUS "DE"


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/310.AkaRejected_DeactiveToken]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/320.AkaRejected_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/400.Authenticated_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_APP_TOKEN_FLAG 1
AdornOps=set DEG_OEMDevRespStatusString 6000
AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEG_OEMDevRespTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEG_CDevTokenString

#RFE75 fix related files.
#New header attribute 'user-agent' added as part of http request from the device.
#iOS device sends specific User-Agent strings that can identify the specific device and version of iOS.
[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/405.Authenticated_UserAgent]

ClassName=RuleChain
RuleNames=100.CopyCoreNMEToCustNME
RuleNames=200.CallUserAgentCustomTemplate
RuleNames=205.CheckoutuserAgentValues

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/405.Authenticated_UserAgent/100.CopyCoreNMEToCustNME]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull CUST_GAC_OUT_UserAgentString ""
AdornOps=copy DEG_OEMDevUserAgentString DEG_USER_AGENT
AdornOps=copy DEG_OEMDevUserAgentString CUST_GAC_IN_UserAgentString

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/405.Authenticated_UserAgent/200.CallUserAgentCustomTemplate]


ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_Apple_GA_UserAgentUpdate
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/405.Authenticated_UserAgent/205.CheckoutuserAgentValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy CUST_GAC_OUT_UserAgentString DEG_OEMDevUserAgentString
AdornOps=copy CUST_GAC_OUT_UserAgentString DEG_USER_AGENT
AdornOps=copy DEG_OEMDevUniqueIdString DEG_UNIQUE_ID
AdornOps=copy CUST_GAC_OUT_UserAgentString DEG_AuditUserAgentString

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/410.Authenticated_StoreToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevMobileNumberString
RequestAttributes=DEG_IMSI
RequestAttributes=DEG_CDevTokenString
RequestAttributes=DEG_AUTHENTICATION_TYPE
RequestAttributes=DEG_AUTHENTICATION_SUBTYPE
RequestAttributes=DEG_APP_TOKEN_FLAG
RequestAttributes=DEG_FULLAUTHTIMESTAMP
ResponseAttributes=DEG_OEMDevErrorMessageString
ResponseAttributes=DEG_EVENTTIMESTAMP
RuleChain=005.StoreTokenRuleChain
UseRuleChainManagerPool=true

# DEG part comment begins
#[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/420.Authenticated_createAppToken]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_EVENTTIMESTAMP DEG_OEMDevEVENTTIMESTAMPString
AdornOps=+ DEG_OEMDevEVENTTIMESTAMPString @ DEG_OEMDevEVENTTIMESTAMPString
AdornOps=copy DEG_OEMDevEVENTTIMESTAMPString DEG_OEMDevEVENTTIMESTAMPTempString
AdornOps=+ DEG_OEMDevEVENTTIMESTAMPString DEG_MDN DEG_OEMDevEVENTTIMESTAMPString
AdornOps=str2bin DEG_OEMDevEVENTTIMESTAMPString DEG_OEMDevEVENTTIMESTAMPBinary
AdornOps=hMac "HmacSHA1" DEG_CDevSha1KeyBinary DEG_OEMDevEVENTTIMESTAMPBinary DEG_OEMDevTokenDecryptedBinary
AdornOps=copy DEG_OEMDevTokenDecryptedBinary DEG_OEMDevTokenDecryptedString
AdornOps=lower  DEG_OEMDevTokenDecryptedString DEG_OEMDevTokenDecryptedString
AdornOps=+ DEG_OEMDevEVENTTIMESTAMPTempString DEG_OEMDevTokenDecryptedString DEG_OEMDevEVENTTIMESTAMPTempString
AdornOps=str2bin DEG_OEMDevEVENTTIMESTAMPTempString DEG_OEMDevEVENTTIMESTAMPBinary
AdornOps=encBase64 DEG_OEMDevEVENTTIMESTAMPBinary DEG_OEMDevRespAppTokenString
AdornOps=+ DEG_MDN DEG_OEMDevRespAppTokenString DEG_OEMDevRespAppTokenString
AdornOps=str2bin DEG_OEMDevRespAppTokenString DEG_OEMDevEVENTTIMESTAMPBinary
AdornOps=encBase64 DEG_OEMDevEVENTTIMESTAMPBinary DEG_OEMDevRespAppTokenString
# DEG part comment ends

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/430.Authenticated_GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.GenerateNullPayloadResponse
FalseRuleChain=200.EncodePayload
FalseRuleChain=210.GenerateResponse


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/430.Authenticated_GenerateResponse/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/430.Authenticated_GenerateResponse/100.GenerateNullPayloadResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
NMEToStructuredNMEMap=DEG_OEMDevRespTokenString,jsonResponse.token.CData
# DEG part comment begins
#NMEToStructuredNMEMap=DEG_OEMDevRespAppTokenString,jsonResponse.app_token.CData
# DEG part comment ends
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/430.Authenticated_GenerateResponse/200.EncodePayload]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/430.Authenticated_GenerateResponse/210.GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
NMEToStructuredNMEMap=DEG_OEMDevRespTokenString,jsonResponse.token.CData
# DEG part comment begins
#NMEToStructuredNMEMap=DEG_OEMDevRespAppTokenString,jsonResponse.app_token.CData
# DEG part comment ends
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/500.Unknown_SetHttpErrorResponseTo500C]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "500C"


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/600.DisallowedAction_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/3000.GenerateOEMResponse/610.DisallowedAction_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/4000.GenerateGetAuthenticationEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,!=,UNKNOWN_SUBSCRIBER
Description=Unknown Subscriber case already Handled
TrueRuleChain=100.CheckAuthenticationState


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/4000.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"

TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=AuthenticatedAAA
TrueRuleChain=AuthenticatedDEGToken
TrueRuleChain=StatusDisallowed

AkaRejected=100.GenerateGetAuthenticationAkaRejectedEndAuditData

AkaWait=200.GenerateGetAuthenticationAkaWaitEndAuditData

AuthenticatedAAA=300.GenerateGetAuthenticationAAAAuthenticatedEndAuditData

AuthenticatedDEGToken=400.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditData

StatusDisallowed=500.GenerateGetAuthenticationDisallowedActionEndAuditData


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/4000.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState/100.GenerateGetAuthenticationAkaRejectedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=505.GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/4000.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState/200.GenerateGetAuthenticationAkaWaitEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=502.GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/4000.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState/300.GenerateGetAuthenticationAAAAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/4000.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState/400.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"TKN"
TrueRuleChain=100.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditData
FalseRuleChain=200.GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditData


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/4000.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState/400.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditData/100.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=503.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/4000.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState/400.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditData/200.GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=504.GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction/4000.GenerateGetAuthenticationEndAuditData/100.CheckAuthenticationState/500.GenerateGetAuthenticationDisallowedActionEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=508.GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"NEW"
FalseRuleChain=200.UpdateSslSessionState


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState]

ClassName=RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=300.CheckSslSessionUpdateStatus


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/100.InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI
AdornOps=copy DEG_OEMDevImsiString DEG_SSL_IMSI
AdornOps=copy DEG_MDN DEG_SSL_MDN



[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_STATE,DEG_SSL_AAA_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN

NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Operations=or
TrueRuleChain=50.SetErrorInfo
TrueRuleChain=100.LogError

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/50.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0828"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update DEG_SSL_SESSION store"


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/100.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Database Error: while updating DEG_SSL_SESSION store
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/500.SetResponseHandler]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,within,[200,200C]
TrueRuleChain=100.SetJsonResponseHandler
FalseRuleChain=200.SetEmptyResponseHandler


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/500.SetResponseHandler/100.SetJsonResponseHandler]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevResponseHandlerString "JsonResponseHandler"


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/204.ProcessOEMGetAuthenticationRuleChain/500.SetResponseHandler/200.SetEmptyResponseHandler]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/501.GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/501.GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/501.GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/501.GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/501.GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/501.GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Successful authentication by AAA,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/501.GenerateGetAuthenticationAAAAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/502.GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/502.GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/502.GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/502.GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/502.GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/502.GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Sent EAP-AKA message to Device,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/502.GenerateGetAuthenticationAkaWaitEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/503.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/503.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/503.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/503.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/503.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/503.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Successful authentication by DEG_TOKEN,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/503.GenerateGetAuthenticationDEGTokenAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/504.GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/504.GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/504.GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/504.GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/504.GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/504.GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Successful authentication by default,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/504.GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/505.GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/505.GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""
AdornOps=set DEG_AuditSourceDestinationVersionString ""


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/505.GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/505.GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/505.GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/505.GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Authentication attempt rejected by AAA,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/505.GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/508.GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/508.GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/508.GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/508.GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/508.GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/508.GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
#AdornOps=set DEG_AuditNRBMessageString "Status Disallowed Action,Return code is "
AdornOps=copy DEG_SSL_STATE DEG_AuditNRBMessageString
AdornOps=set DEG_Tmp1String ",Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_Tmp1String DEG_AuditNRBMessageString
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString

[/templates/DEG/DeviceInterface/GetAuthentication_V1Core/RuleChains/508.GenerateGetAuthenticationDisallowedActionEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true
