[/templates/DEG/DeviceInterface/GBA_Common_Core]

[/templates/DEG/DeviceInterface/GBA_Common_Core/Connectors]

ConnectorNames=203.GBADeviceHttpsConnector


[/templates/DEG/DeviceInterface/GBA_Common_Core/Connectors/203.GBADeviceHttpsConnector]

AcceptCount=${DEVICE_GBA_HTTP_ACCEPT_COUNT}
ClassName=com.hp.siu.plugins.tomcat.HttpConnector
Context=GBAInterface
KeyStoreFile=${SERVER_CERT_KEYSTORE_FILE}
KeyStorePassword=${SERVER_CERT_SIGNATURE_PASSWORD}
Managed=${MANAGED_SETUP}
MaxProcessors=${DEVICE_GBA_HTTP_CON_MAX_PROCESSORS}
MinProcessors=${DEVICE_GBA_HTTP_CON_MIN_PROCESSORS}
MaxSpareProcessors=${DEVICE_GBA_HTTP_CON_MIN_PROCESSORS}
Port=${DEVICE_GBA_HTTP_PORT}
ServerXMLTemplate=${SERVER_XML_TEMPLATE}
Secured=true
ConnectionTimeout=5000
MaxKeepAliveRequests=5


[/templates/DEG/DeviceInterface/GBA_Common_Core/Connectors/203.GBADeviceHttpsConnector/GBAInterface]

ClassName=JsonContextProvider
ArrayRoot=true
ContextIdentifier=GBAInterface
ErrorMessageAttribute=DEG_OEMDevHttpErrorMessageString
ErrorNameAttribute=DEG_OEMDevHttpErrorNameString
ErrorRuleChain=203.ProcessOEMParsingErrorRuleChain
HeaderRuleChain=201.ProcessGBARequestHeadersRuleChain
NoLogExceptions=com.hp.usage.listoperations.CustomRuleException
RequestHeaderMap=host,DEG_OEMDevHostnameString,""
RequestHeaderMap=user-agent,DEG_OEMDevUserAgentString,""
RequestHeaderMap=accept,DEG_OEMDevAcceptString,""
RequestHeaderMap=x-protocol-version,DEG_OEMDevXProtocolVersionString,""
RequestHeaderMap=x-3gpp-intended-identity,DEG_OEMDevX3GPPIntendedIdentityString,""
RequestHeaderMap=authorization,DEG_OEMDevAuthorizationString,dummy
RequestHeaderMap=content-type,DEG_OEMDevContentTypeString,""
RequestHeaderMap=content-encoding,DEG_OEMDevContentEncodingString,""
RequestHeaderMap=accept-encoding,DEG_OEMDevAcceptEncodingString,""
RequestHeaderMap=x-country-iso-code,DEG_OEMDevXCountryISOCodeString
RequestHeaderMap=Accept-Language,DEG_OEMDevAcceptLanguageString
RequestNMENamespace=OEMRequest
RequestRootElement=requestRoot
RequestXSDFile=${SERVER_OEM_XSD_FILE}
ResponseHandlerAttribute=DEG_OEMDevResponseHandlerString
ResponseHandlers=EmptyResponseHandler
ResponseHandlers=JsonResponseHandler
ResponseHeaderMap=Connection,DEG_OEMDevConnectionString
ResponseHeaderMap=www-authenticate,DEG_OEMDevWwwauthenticateString
ResponseHeaderMap=authentication-info,DEG_OEMDevAuthenticationInfoString
ResponseHeaderMap=Content-Encoding,DEG_OEMDevEncodingString
ResponseStatusAttribute=DEG_OEMDevHttpStatusInteger
RuleChainName=222.ProcessOEMVersionCheckRuleChain
RequestMethodAttribute=DEG_OEMDevRequestMethodString
RequestContentAttribute=DEG_OEMDevRequestContentString
SSLSessionIDAttribute=DEG_OEMDevSslSessionIdString
VirtualRoot=requestRoot
RuleChainTimeout=${DEVICEINTERFACE_REQUEST_TIMEOUT}


[/templates/DEG/DeviceInterface/GBA_Common_Core/Connectors/203.GBADeviceHttpsConnector/GBAInterface/EmptyResponseHandler]

ClassName=EmptyResponseGenerator


[/templates/DEG/DeviceInterface/GBA_Common_Core/Connectors/203.GBADeviceHttpsConnector/GBAInterface/JsonResponseHandler]

ClassName=JsonResponseGenerator
ArrayRoot=true
##EncodeAttribute=jsonResponse
EncodeAttribute=%specifier%
ResponseNMENamespace=OEMResponse
ResponseRootElement=responseRoot
ResponseRootElement=responseRoot2
ResponseXSDFile=${SERVER_OEM_XSD_FILE}
RootNMEType=Umbrella:Body
VirtualRoot=responseRoot
VirtualRoot=responseRoot2


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains]

RuleChainNames=201.ProcessGBARequestHeadersRuleChain
RuleChainNames=301.GenerateAuthenticateHeaderRuleChain
RuleChainNames=300.BSFProcessingRuleChain
RuleChainNames=302.GenerateAndInserttoGBARuleChain
RuleChainNames=303.GenerateResponseAuthValue

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetLogInfo
RuleNames=100.LogNMERule
RuleNames=100.GenerateHA1
RuleNames=100.GenerateHA1.log
RuleNames=200.CheckQOPValue
RuleNames=110.GenerateResponseAuth
RuleNames=120.LogRule
RuleNames=120.CheckResponseAuthValue

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/100.SetLogInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GBA.0000"
AdornOps=set DEG_OEMDevMessageString "Entered Inside GenerateResponsePathValue rulechain"

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/100.LogNMERule]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Attributes=DEG_OEMDevUsernameString
Attributes=DEG_OEMDevGBARealmString
Attributes=DEG_OEMDevHA1Binary
Attributes=DEG_OEMDevResponseAuthString
Attributes=DEG_OEMDevGBAPasswordString
Attributes=DEG_OEMDevRequestHA2Binary
Attributes=DEG_OEMDevResponseHA2Binary
Attributes=DEG_OEMDevRequestBodyString
Attributes=DEG_OEMDevResponseAuthBinary
Attributes=DEG_OEMDevResponseString
Attributes=DEG_OEMDevHA1String
Attributes=DEG_OEMDevRequestHA2String
Attributes=DEG_OEMDevResponseHA2String
Attributes=DEG_OEMDevRequestMethodString
Attributes=DEG_OEMDevURLString
Attributes=DEG_OEMDevNCInteger
Attributes=DEG_OEMDevNONCEString
Attributes=DEG_OEMDevOPAQUEString
Attributes=DEG_OEMDevQOPString
Attributes=DEG_OEMDevGBArspAuthBinary
Attributes=DEG_OEMDevGBArspauthString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=Entered Inside GenerateResponsePathValue rulechain.......
NullAlso=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/120.LogRule]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Attributes=DEG_OEMDevUsernameString
Attributes=DEG_OEMDevGBARealmString
Attributes=DEG_OEMDevHA1Binary
Attributes=DEG_OEMDevResponseAuthString
Attributes=DEG_OEMDevGBAPasswordString
Attributes=DEG_OEMDevRequestHA2Binary
Attributes=DEG_OEMDevResponseHA2Binary
Attributes=DEG_OEMDevRequestBodyString
Attributes=DEG_OEMDevResponseAuthBinary
Attributes=DEG_OEMDevResponseAuthString
Attributes=DEG_OEMDevResponseString
Attributes=DEG_OEMDevHA1String
Attributes=DEG_OEMDevRequestHA2String
Attributes=DEG_OEMDevResponseHA2String
Attributes=DEG_OEMDevRequestMethodString
Attributes=DEG_OEMDevURLString
Attributes=DEG_OEMDevNCInteger
Attributes=DEG_OEMDevNONCEString
Attributes=DEG_OEMDevOPAQUEString
Attributes=DEG_OEMDevQOPString
Attributes=DEG_OEMDevGBArspAuthBinary
Attributes=DEG_OEMDevGBArspauthString
Message=After calculating response digest :
NullAlso=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/100.GenerateHA1]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevUsernameString DEG_OEMDevHA1String
AdornOps=+ DEG_OEMDevHA1String : DEG_OEMDevHA1String
AdornOps=+ DEG_OEMDevHA1String DEG_OEMDevGBARealmString DEG_OEMDevHA1String
AdornOps=+ DEG_OEMDevHA1String : DEG_OEMDevHA1String
AdornOps=+ DEG_OEMDevHA1String DEG_OEMDevGBAPasswordString DEG_OEMDevHA1String
AdornOps=digest "MD5" DEG_OEMDevHA1String DEG_OEMDevHA1Binary
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GBA.0001"
AdornOps=set DEG_OEMDevMessageString "After calculating HA1 value"


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/100.GenerateHA1.log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Attributes=DEG_OEMDevUsernameString
Attributes=DEG_OEMDevGBARealmString
Attributes=DEG_OEMDevGBAPasswordString
Attributes=DEG_OEMDevHA1String
Attributes=DEG_OEMDevHA1Binary
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=After calculating HA1 value :


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/200.CheckQOPValue]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_OEMDevQOPString,=,""
Conditions=DEG_OEMDevQOPString,=,"auth"
Conditions=DEG_OEMDevQOPString,=,"auth-init"

TrueRuleChain=GenerateauthHA2
TrueRuleChain=GenerateauthHA2
TrueRuleChain=Generateauth_initHA2

GenerateauthHA2=100.GenerateRequestauthHA2
GenerateauthHA2=200.GenerateResponseauthHA2
GenerateauthHA2=300.GenerateauthHA2.log
Generateauth_initHA2=100.GenerateRequestauth_initHA2
Generateauth_initHA2=200.GenerateResponseauth_initHA2
Generateauth_initHA2=300.Generateauth_initHA2.log


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/200.CheckQOPValue/100.GenerateRequestauthHA2]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevRequestMethodString DEG_OEMDevRequestHA2String
AdornOps=+ DEG_OEMDevRequestHA2String : DEG_OEMDevRequestHA2String
AdornOps=+ DEG_OEMDevRequestHA2String DEG_OEMDevURLString DEG_OEMDevRequestHA2String
AdornOps=digest "MD5" DEG_OEMDevRequestHA2String DEG_OEMDevRequestHA2Binary


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/200.CheckQOPValue/200.GenerateResponseauthHA2]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=+ DEG_OEMDevResponseHA2String : DEG_OEMDevResponseHA2String
AdornOps=+ DEG_OEMDevResponseHA2String DEG_OEMDevURLString DEG_OEMDevResponseHA2String
AdornOps=digest "MD5" DEG_OEMDevResponseHA2String DEG_OEMDevResponseHA2Binary
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GBA.0002"
AdornOps=set DEG_OEMDevMessageString "After calculating HA2 value when qop is auth (or) not present"


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/200.CheckQOPValue/300.GenerateauthHA2.log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Attributes=DEG_OEMDevRequestMethodString
Attributes=DEG_OEMDevURLString
Attributes=DEG_OEMDevRequestHA2String
Attributes=DEG_OEMDevResponseHA2String
Attributes=DEG_OEMDevRequestHA2Binary
Attributes=DEG_OEMDevResponseHA2Binary
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=After calculating HA2 value when qop is auth (or) qop is not present :


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/200.CheckQOPValue/100.GenerateRequestauth_initHA2]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CONTENTSTRING DEG_OEMDevRequestBodyString
AdornOps=digest "MD5" DEG_OEMDevRequestBodyString DEG_OEMDevRequestBodyBinary
AdornOps=copy DEG_OEMDevRequestMethodString DEG_OEMDevRequestHA2String
AdornOps=+ DEG_OEMDevRequestHA2String : DEG_OEMDevRequestHA2String
AdornOps=+ DEG_OEMDevRequestHA2String DEG_OEMDevURLString DEG_OEMDevRequestHA2String
AdornOps=+ DEG_OEMDevRequestHA2String : DEG_OEMDevRequestHA2String
AdornOps=+ DEG_OEMDevRequestHA2String DEG_OEMDevRequestBodyBinary DEG_OEMDevRequestHA2String
AdornOps=digest "MD5" DEG_OEMDevRequestHA2String DEG_OEMDevRequestHA2Binary


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/200.CheckQOPValue/200.GenerateResponseauth_initHA2]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CONTENTSTRING DEG_OEMDevRequestBodyString
AdornOps=digest "MD5" DEG_OEMDevRequestBodyString DEG_OEMDevRequestBodyBinary
AdornOps=+ DEG_OEMDevResponseHA2String : DEG_OEMDevResponseHA2String
AdornOps=+ DEG_OEMDevResponseHA2String DEG_OEMDevURLString DEG_OEMDevResponseHA2String
AdornOps=+ DEG_OEMDevResponseHA2String : DEG_OEMDevResponseHA2String
AdornOps=+ DEG_OEMDevResponseHA2String DEG_OEMDevRequestBodyBinary DEG_OEMDevResponseHA2String
AdornOps=digest "MD5" DEG_OEMDevResponseHA2String DEG_OEMDevResponseHA2Binary
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GBA.0003"
AdornOps=set DEG_OEMDevMessageString "After calculating HA2 valu when qop is auth-init"


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/200.CheckQOPValue/300.Generateauth_initHA2.log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Attributes=DEG_OEMDevRequestMethodString
Attributes=DEG_OEMDevURLString
Attributes=DEG_OEMDevRequestBodyString
Attributes=DEG_OEMDevRequestBodyBinary
Attributes=DEG_OEMDevRequestHA2String
Attributes=DEG_OEMDevResponseHA2String
Attributes=DEG_OEMDevRequestHA2Binary
Attributes=DEG_OEMDevResponseHA2Binary
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=After calculating HA2 value when qop is auth-init :


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/110.GenerateResponseAuth]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAuthorizationString,contains,"qop"

FalseRuleChain=100.GenearteRSPAUTH1
FalseRuleChain=100.GenearteRSPAUTH1.log
FalseRuleChain=100.GenearteResponseDigest1

TrueRuleChain=200.GenearteRSPAUTH2
TrueRuleChain=200.GenearteRSPAUTH2.log
TrueRuleChain=200.GenearteResponseDigest2

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/110.GenerateResponseAuth/100.GenearteRSPAUTH1]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevHA1Binary DEG_OEMDevGBArspauthString
AdornOps=+ DEG_OEMDevGBArspauthString : DEG_OEMDevGBArspauthString
AdornOps=+ DEG_OEMDevGBArspauthString DEG_OEMDevNONCEString DEG_OEMDevGBArspauthString
AdornOps=+ DEG_OEMDevGBArspauthString : DEG_OEMDevGBArspauthString
AdornOps=+ DEG_OEMDevGBArspauthString DEG_OEMDevResponseHA2Binary DEG_OEMDevGBArspauthString
AdornOps=digest "MD5" DEG_OEMDevGBArspauthString DEG_OEMDevGBArspAuthBinary
AdornOps=copy DEG_OEMDevGBArspAuthBinary DEG_OEMDevGBArspauthString
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GBA.0004"
AdornOps=set DEG_OEMDevMessageString "Response digest value when qop is not present"


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/110.GenerateResponseAuth/100.GenearteResponseDigest1]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevHA1Binary DEG_OEMDevResponseAuthString
AdornOps=+ DEG_OEMDevResponseAuthString : DEG_OEMDevResponseAuthString
AdornOps=+ DEG_OEMDevResponseAuthString DEG_OEMDevNONCEString DEG_OEMDevResponseAuthString
AdornOps=+ DEG_OEMDevResponseAuthString : DEG_OEMDevResponseAuthString
AdornOps=+ DEG_OEMDevResponseAuthString DEG_OEMDevRequestHA2Binary DEG_OEMDevResponseAuthString
AdornOps=digest "MD5" DEG_OEMDevResponseAuthString DEG_OEMDevResponseAuthBinary
AdornOps=copy DEG_OEMDevResponseAuthBinary DEG_OEMDevResponseAuthString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/110.GenerateResponseAuth/100.GenearteRSPAUTH1.log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Attributes=DEG_OEMDevHA1Binary
Attributes=DEG_OEMDevNONCEString
Attributes=DEG_OEMDevResponseHA2Binary
Attributes=DEG_OEMDevResponseAuthBinary
Attributes=DEG_OEMDevRequestHA2Binary
Attributes=DEG_OEMDevResponseAuthString
Attributes=DEG_OEMDevGBArspAuthBinary
Attributes=DEG_OEMDevGBArspauthString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=Response digest value when qop is not present :


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/110.GenerateResponseAuth/200.GenearteRSPAUTH2]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevHA1Binary DEG_OEMDevGBArspauthString
AdornOps=+ DEG_OEMDevGBArspauthString : DEG_OEMDevGBArspauthString
AdornOps=+ DEG_OEMDevGBArspauthString DEG_OEMDevNONCEString DEG_OEMDevGBArspauthString
AdornOps=+ DEG_OEMDevGBArspauthString : DEG_OEMDevGBArspauthString
AdornOps=+ DEG_OEMDevGBArspauthString DEG_OEMDevRequestNCString DEG_OEMDevGBArspauthString
AdornOps=+ DEG_OEMDevGBArspauthString  : DEG_OEMDevGBArspauthString
AdornOps=+ DEG_OEMDevGBArspauthString DEG_OEMDevCNONCEString DEG_OEMDevGBArspauthString
AdornOps=+ DEG_OEMDevGBArspauthString : DEG_OEMDevGBArspauthString
AdornOps=+ DEG_OEMDevGBArspauthString DEG_OEMDevQOPString DEG_OEMDevGBArspauthString
AdornOps=+ DEG_OEMDevGBArspauthString : DEG_OEMDevGBArspauthString
AdornOps=+ DEG_OEMDevGBArspauthString DEG_OEMDevResponseHA2Binary DEG_OEMDevGBArspauthString
AdornOps=digest "MD5" DEG_OEMDevGBArspauthString DEG_OEMDevResponseAuthBinary
AdornOps=copy DEG_OEMDevResponseAuthBinary DEG_OEMDevGBArspauthString
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GBA.0005"
AdornOps=set DEG_OEMDevMessageString "Response digest value when qop is present"


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/110.GenerateResponseAuth/200.GenearteResponseDigest2]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevHA1Binary DEG_OEMDevResponseAuthString
AdornOps=+ DEG_OEMDevResponseAuthString : DEG_OEMDevResponseAuthString
AdornOps=+ DEG_OEMDevResponseAuthString DEG_OEMDevNONCEString DEG_OEMDevResponseAuthString
AdornOps=+ DEG_OEMDevResponseAuthString : DEG_OEMDevResponseAuthString
AdornOps=+ DEG_OEMDevResponseAuthString DEG_OEMDevRequestNCString DEG_OEMDevResponseAuthString
AdornOps=+ DEG_OEMDevResponseAuthString  : DEG_OEMDevResponseAuthString
AdornOps=+ DEG_OEMDevResponseAuthString DEG_OEMDevCNONCEString DEG_OEMDevResponseAuthString
AdornOps=+ DEG_OEMDevResponseAuthString : DEG_OEMDevResponseAuthString
AdornOps=+ DEG_OEMDevResponseAuthString DEG_OEMDevQOPString DEG_OEMDevResponseAuthString
AdornOps=+ DEG_OEMDevResponseAuthString : DEG_OEMDevResponseAuthString
AdornOps=+ DEG_OEMDevResponseAuthString DEG_OEMDevRequestHA2Binary DEG_OEMDevResponseAuthString
AdornOps=digest "MD5" DEG_OEMDevResponseAuthString DEG_OEMDevResponseAuthBinary
AdornOps=copy DEG_OEMDevResponseAuthBinary DEG_OEMDevResponseAuthString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/110.GenerateResponseAuth/200.GenearteRSPAUTH2.log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Attributes=DEG_OEMDevHA1Binary
Attributes=DEG_OEMDevNONCEString
Attributes=DEG_OEMDevRequestNCString
Attributes=DEG_OEMDevCNONCEString
Attributes=DEG_OEMDevQOPString
Attributes=DEG_OEMDevRequestHA2Binary
Attributes=DEG_OEMDevResponseHA2Binary
Attributes=DEG_OEMDevResponseAuthBinary
Attributes=DEG_OEMDevGBArspAuthBinary
Attributes=DEG_OEMDevResponseAuthString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=Response digest value when qop is present :


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/120.CheckResponseAuthValue]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevResponseAuthString,=,DEG_OEMDevResponseString

FalseRuleChain=100.SetLogInfo
FalseRuleChain=100.LogRule
FalseRuleChain=200.SetErrorResponse
TrueRuleChain=200.SetLogInfo
TrueRuleChain=200.LogRTrue


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/120.CheckResponseAuthValue/200.SetLogInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GBA.0006"
AdornOps=set DEG_OEMDevMessageString "both responses are equal"

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/120.CheckResponseAuthValue/200.LogRTrue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Attributes=DEG_OEMDevResponseAuthBinary
Attributes=DEG_OEMDevResponseString
Attributes=DEG_OEMDevResponseAuthString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=both responses are equal::::
NullAlso=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/120.CheckResponseAuthValue/200.SetErrorResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=302.GenerateAndInserttoGBARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/120.CheckResponseAuthValue/100.SetLogInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GBA.0007"
AdornOps=set DEG_OEMDevErrorMessageString "Response digest value does not match"


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/303.GenerateResponseAuthValue/120.CheckResponseAuthValue/100.LogRule]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Attributes=DEG_OEMDevResponseAuthBinary
Attributes=DEG_OEMDevResponseString
Attributes=DEG_OEMDevResponseAuthString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Message=Response digest value does not match :
NullAlso=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=110.LogNewHttRequest
RuleNames=120.HeadersValidation
RuleNames=130.ExtractAuthorizationHeader


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/100.InitWorkingVariables]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetVariables
RuleNames=200.InitReqIdList
RuleNames=210.InitReqActionList


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/100.InitWorkingVariables/100.SetVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=set DEG_OEMDevHttpStatusInteger 200
AdornOps=set DEG_OEMDevResponseHandlerString "dummy"
AdornOps=set DEG_OEMDevActionNameString "dummy"
AdornOps=set DEG_OEMDevRequestIdString "dummy"
AdornOps=setifnull DEG_SSL_ID ""
AdornOps=setifnull DEG_OEMDevImsiString ""
AdornOps=setifnull DEG_OEMDevSubscriberIdString ""
AdornOps=setifnull DEG_OEMDevRespStatusString ""
AdornOps=setifnull DEG_OEMDevUserAgentString ""
AdornOps=set DEG_OEMDevGBARealmString ${DEG_DEVICE_GBA_REALM}
AdornOps=set DEG_OEMDevGBAAuthTypeString ${DEG_DI_AUTH_TYPE}
AdornOps=set DEG_OEMDevGBANonceLifetimeLong ${DEG_DI_GBA_NONCE_VALIDITY}
AdornOps=setsystime DEG_CDevProcessStartTimeLong
AdornOps=set DEG_OEMDevSSLSSDeletedInteger 0
AdornOps=setsystime DEG_CDevProcessStartTimeLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
#AdornOps=set DEG_OEMDevDateTimeZoneString "UTC"
AdornOps=set DEG_OEMDevUniqueIDString ""
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=set DEG_MDN 0
AdornOps=setifnull DEG_OEMDevResultCodeInteger 0
AdornOps=set DEG_OEMDevDeviceTypeString "Primary"
AdornOps=set DEG_OEMDevGBASpaceString "Digest realm="
#AdornOps=setifnull DEG_OEMDevWwwauthenticateString ""
AdornOps=set DEG_OEMDevAlgorithmString "MD5"
AdornOps=set DEG_OEMDevGBAquotedstring """
AdornOps=setifnull DEG_AUTHENTICATION_SUBTYPE ""
AdornOps=setifnull DEG_AUTHENTICATION_TYPE ""
AdornOps=setifnull DEG_OEMDevQOPString ""
AdornOps=setifnull DEG_OEMDevRequestHA2String ""
AdornOps=setifnull DEG_OEMDevResponseHA2String ""
AdornOps=setifnull DEG_OEMDevRequestNCString ""
AdornOps=set DEG_OEMDevBTIDErrorFlagInteger 0
AdornOps=set DEG_OEMDevDigestChallengeFlagInteger 0
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GBA.0008"
AdornOps=set DEG_OEMDevMessageString "DEVICE TO DEG -> Received new http GBA request"


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/100.InitWorkingVariables/200.InitReqIdList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevRequestIdString
ListAttribute=DEG_OEMDevRequestIdList


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/100.InitWorkingVariables/210.InitReqActionList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevActionNameString
ListAttribute=DEG_OEMDevActionNameList

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/110.LogNewHttRequest]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHostnameString
Attributes=DEG_OEMDevAcceptString
Attributes=DEG_OEMDevUserAgentString
Attributes=DEG_OEMDevXProtocolVersionString
Attributes=DEG_OEMDevX3GPPIntendedIdentityString
Attributes=DEG_OEMDevAuthorizationString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
LogLevel=INFO
Message=DEVICE TO DEG -> Received new http GBA request: 
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=ValidateUserAgentHeader
TrueRuleChain=ValidateAuthorizationHeader
TrueRuleChain=UpdateSslSession

ValidateUserAgentHeader=100.ValidateUserAgentHeader
ValidateAuthorizationHeader=100.ValidateAuthorizationHeader
ValidateAuthorizationHeader=200.ValidateBTIDinAuthorizationHeader
UpdateSslSession=600.InitSslSessionLookup
UpdateSslSession=610.ExecuteSslSessionLookup
UpdateSslSession=CopyDAIFromSSLSessionTable
UpdateSslSession=620.CheckSslSessionLookupStatus


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/100.ValidateUserAgentHeader]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevUserAgentString,=,""
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
FalseRuleChain=120.CheckUserAgentValue

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/100.ValidateUserAgentHeader/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 400
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
#AdornOps=set DEG_CDevProcessingErrorIdString "DEG31.DEGT.16"
#AdornOps=set DEG_OEMDevErrorMessageString "Invalid header user agent value"
AdornOps=set DEG_OEMDevEncodingString "gzip"

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/100.ValidateUserAgentHeader/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevContentTypeString
Attributes=DEG_OEMDevAcceptString
Attributes=DEG_OEMDevXProtocolVersionString
#Attributes=DEG_CDevProcessingErrorIdString
#Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevUserAgentString
LogLevel=WARNING
Message=Invalid http headers in OEM request - user agent header is missing :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=http headers in OEM request - user agent header is missing. Contact HP Support.


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/100.ValidateUserAgentHeader/120.CheckUserAgentValue]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevUserAgentString,=,"3gpp-gba"
Conditions=DEG_OEMDevUserAgentString,=,"3gpp-uicc"
Operations=or
FalseRuleChain=100.SetHttpErrorResponse
FalseRuleChain=120.ErrorLog


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/100.ValidateUserAgentHeader/120.CheckUserAgentValue/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 501
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/100.ValidateUserAgentHeader/120.CheckUserAgentValue/120.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevContentTypeString
Attributes=DEG_OEMDevAcceptString
Attributes=DEG_OEMDevXProtocolVersionString
#Attributes=DEG_CDevProcessingErrorIdString
#Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevUserAgentString
Attributes=DEG_OEMDevHttpStatusInteger
LogLevel=WARNING
Message=Invalid http headers in OEM request - user-agent header must be 3gpp-gba or 3gpp-uicc: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=http headers in OEM request - user agent header value is incorrect. Contact HP Support.


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/100.ValidateAuthorizationHeader]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAuthorizationString,=,dummy
TrueRuleChain=120.SetAuthChallengeFlag


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/100.ValidateAuthorizationHeader/120.SetAuthChallengeFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevDigestChallengeFlagInteger 1


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/200.ValidateBTIDinAuthorizationHeader]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAuthorizationString,!contains,"username"
TrueRuleChain=100.SetEmptyBTIDFlag


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/200.ValidateBTIDinAuthorizationHeader/100.SetEmptyBTIDFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevBTIDErrorFlagInteger 1


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/600.InitSslSessionLookup]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=copy DEG_OEMDevUserAgentString DEG_AuditUserAgentString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/610.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_STATE,DEG_SSL_AAA_STATE
MapAttributes=DEG_SSL_DAI,DEG_SSL_DAI
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/CopyDAIFromSSLSessionTable]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull DEG_SSL_DAI ""
AdornOps=copy DEG_SSL_DAI DEG_OEMDevDAIString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/620.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_SSL_ID,=,DEG_SSL_ID

TrueRuleChain=SystemError
TrueRuleChain=NoSslSession
TrueRuleChain=SslSessionExists

SystemError=000.SystemError_SetHttpErrorResponse
SystemError=010.SystemErrorLog
SystemError=020.GenerateStartAudit
SystemError=030.GenerateErrorEndAudit

NoSslSession=100.NoSslSession_InitSslSessionCreate
NoSslSession=110.NoSslSession_ExecuteSslSessionCreate
NoSslSession=120.NoSslSession_CheckSslSessionCreateStatus

SslSessionExists=200.SslSessionExists_InitSslSessionUpdate


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/620.CheckSslSessionLookupStatus/000.SystemError_SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GBA.0009"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_SSL_SESSION table"


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/620.CheckSslSessionLookupStatus/010.SystemErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access DEG_SSL_SESSION table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/620.CheckSslSessionLookupStatus/020.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/620.CheckSslSessionLookupStatus/030.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/620.CheckSslSessionLookupStatus/100.NoSslSession_InitSslSessionCreate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation INSERT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_STATE "NEW"
AdornOps=set DEG_SSL_REQUEST_STATE "NEW"
AdornOps=set DEG_SSL_NAI ""
AdornOps=set DEG_SSL_IMSI ""
AdornOps=set DEG_SSL_MDN ""
AdornOps=set DEG_SSL_UNIQUE_ID ""
AdornOps=setsystime DEG_SSL_CREATETIMESTAMP
AdornOps=set DEG_SSL_AAA_SESSIONID ""
AdornOps=set DEG_SSL_AAA_STATE ""
AdornOps=set DEG_STR_FLAG 0
AdornOps=set DEG_SSL_ID_PROV_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=set DEG_SSL_GW_ADDR "NA"
AdornOps=set DEG_SSL_POSTDATA ""
AdornOps=set DEG_SSL_ADDRESS_UPDATE_URL ${DEVICE_SERVICE_MNGT_URL}
AdornOps=set DEG_SSL_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=set DEG_SSL_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=set DEG_SSL_EntitlementStatus ""
AdornOps=set DEG_SSL_MSCHAP_USERNAME ""
AdornOps=set DEG_SSL_MSCHAP_PASSWORD ""
AdornOps=set DEG_SSL_COMPANION_DEVICE_COUNT ""
AdornOps=set DEG_SSL_CUSTOM_FIELD ""
AdornOps=set DEG_SSL_DAI ""
AdornOps=set DEG_GETAUTH_CONTACTED_AAA ""

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/620.CheckSslSessionLookupStatus/110.NoSslSession_ExecuteSslSessionCreate]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/620.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
Operations=or
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/620.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GBA.0010"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to access or create entry in DEG_SSL_SESSION table"


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/620.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to access or create entry in DEG_SSL_SESSION table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/620.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/620.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/120.HeadersValidation/620.CheckSslSessionLookupStatus/200.SslSessionExists_InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_REQUEST_STATE "NEW"

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/301.GenerateAuthenticateHeaderRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateWwwAuthenticateHeader


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/301.GenerateAuthenticateHeaderRuleChain/100.GenerateWwwAuthenticateHeader]

ClassName=com.hp.siu.collector.rules.AdornmentRule
#AdornOps=+ DEG_OEMDevWwwauthenticateString "Digest" DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString DEG_OEMDevGBASpaceString DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString " DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString DEG_OEMDevGBARealmString DEG_OEMDevWwwauthenticateString
#AdornOps=+ DEG_OEMDevWwwauthenticateString DEG_OEMDevGBAquotedstring DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString ",nonce=" DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString DEG_OEMDevNONCEString DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString ",algorithm=" DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString DEG_OEMDevAlgorithmString DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString ",opaque=" DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString DEG_OEMDevOPAQUEString DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString ",qop=" DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString DEG_OEMDevQOPString DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString " DEG_OEMDevWwwauthenticateString

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/130.ExtractAuthorizationHeader]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAuthorizationString,!=,""
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Operations=and

TrueRuleChain=100.StringAuthorizationRule

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/130.ExtractAuthorizationHeader/100.StringAuthorizationRule]

ClassName=com.hp.siu.collector.rules.StringTokenizerRule
Delimiter=,
SourceAttribute=DEG_OEMDevAuthorizationString
TokenAttribute=DEG_OEMDevAuthorizationTempString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/130.ExtractAuthorizationHeader/100.StringAuthorizationRule/IterationRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogRule
RuleNames=200.CheckTypeofAttribute


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/130.ExtractAuthorizationHeader/100.StringAuthorizationRule/IterationRule/100.LogRule]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevAuthorizationString
Attributes=DEG_OEMDevAuthorizationTempString
LogLevel=DEBUG
Message=After extracting authorization header:
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/130.ExtractAuthorizationHeader/100.StringAuthorizationRule/IterationRule/200.CheckTypeofAttribute]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevAuthorizationTempString,contains,"qop"
Conditions=DEG_OEMDevAuthorizationTempString,contains,"nc="
Conditions=DEG_OEMDevAuthorizationTempString,contains,"cnonce"
Conditions=DEG_OEMDevAuthorizationTempString,contains,"nonce"
Conditions=DEG_OEMDevAuthorizationTempString,contains,"uri"
Conditions=DEG_OEMDevAuthorizationTempString,contains,"opaque"
Conditions=DEG_OEMDevAuthorizationTempString,contains,"algorithm"
Conditions=DEG_OEMDevAuthorizationTempString,contains,"username"
Conditions=DEG_OEMDevAuthorizationTempString,contains,"response"
Conditions=DEG_OEMDevAuthorizationTempString,contains,"realm"

Operations=None

TrueRuleChain=ExtractQOPValue
TrueRuleChain=ExtractNCValue
TrueRuleChain=ExtractCNONCEValue
TrueRuleChain=ExtractNONCEValue
TrueRuleChain=ExtractURLValue
TrueRuleChain=ExtractOPAQUEValue
TrueRuleChain=ExtractAlgorithmValue
TrueRuleChain=ExtractUsernameValue
TrueRuleChain=ExtractResponseValue
TrueRuleChain=ExtractREALMValue

ExtractQOPValue=100.ExtractQOPValue
ExtractNCValue=110.ExtractNCValue
ExtractCNONCEValue=120.ExtractCNONCEValue
ExtractNONCEValue=130.ExtractNONCEValue
ExtractURLValue=140.ExtractURLValue
ExtractOPAQUEValue=150.ExtractOPAQUEValue
ExtractAlgorithmValue=160.ExtractAlgorithmValue
ExtractUsernameValue=170.ExtractUsernameValue
ExtractResponseValue=180.ExtractResponseValue
ExtractREALMValue=190.ExtractREALMValue


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/130.ExtractAuthorizationHeader/100.StringAuthorizationRule/IterationRule/200.CheckTypeofAttribute/100.ExtractQOPValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr "=" length DEG_OEMDevAuthorizationTempString DEG_OEMDevQOPString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/130.ExtractAuthorizationHeader/100.StringAuthorizationRule/IterationRule/200.CheckTypeofAttribute/110.ExtractNCValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr "=" length DEG_OEMDevAuthorizationTempString DEG_OEMDevRequestNCString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/130.ExtractAuthorizationHeader/100.StringAuthorizationRule/IterationRule/200.CheckTypeofAttribute/120.ExtractCNONCEValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr "=" length DEG_OEMDevAuthorizationTempString DEG_OEMDevCNONCEString
AdornOps=substr 1 length-1 DEG_OEMDevCNONCEString DEG_OEMDevCNONCEString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/130.ExtractAuthorizationHeader/100.StringAuthorizationRule/IterationRule/200.CheckTypeofAttribute/130.ExtractNONCEValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr "=" length DEG_OEMDevAuthorizationTempString DEG_OEMDevNONCEString
AdornOps=substr 1 length-1 DEG_OEMDevNONCEString DEG_OEMDevNONCEString

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/130.ExtractAuthorizationHeader/100.StringAuthorizationRule/IterationRule/200.CheckTypeofAttribute/140.ExtractURLValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr "=" length DEG_OEMDevAuthorizationTempString DEG_OEMDevURLString
AdornOps=substr 1 length-1 DEG_OEMDevURLString DEG_OEMDevURLString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/130.ExtractAuthorizationHeader/100.StringAuthorizationRule/IterationRule/200.CheckTypeofAttribute/150.ExtractOPAQUEValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr "=" length DEG_OEMDevAuthorizationTempString DEG_OEMDevOPAQUEString
AdornOps=substr 1 length-1 DEG_OEMDevOPAQUEString DEG_OEMDevOPAQUEString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/130.ExtractAuthorizationHeader/100.StringAuthorizationRule/IterationRule/200.CheckTypeofAttribute/160.ExtractAlgorithmValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr "=" length DEG_OEMDevAuthorizationTempString DEG_OEMDevAlgorithmString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/130.ExtractAuthorizationHeader/100.StringAuthorizationRule/IterationRule/200.CheckTypeofAttribute/170.ExtractUsernameValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr "=" length DEG_OEMDevAuthorizationTempString DEG_OEMDevUsernameString
AdornOps=substr 1 length-1 DEG_OEMDevUsernameString DEG_OEMDevUsernameString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/130.ExtractAuthorizationHeader/100.StringAuthorizationRule/IterationRule/200.CheckTypeofAttribute/180.ExtractResponseValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr "=" length DEG_OEMDevAuthorizationTempString DEG_OEMDevResponseString
AdornOps=substr 1 length-1 DEG_OEMDevResponseString DEG_OEMDevResponseString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/201.ProcessGBARequestHeadersRuleChain/130.ExtractAuthorizationHeader/100.StringAuthorizationRule/IterationRule/200.CheckTypeofAttribute/190.ExtractREALMValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr "=" length DEG_OEMDevAuthorizationTempString DEG_OEMDevGBARequestRealmString 
AdornOps=substr 1 length-1 DEG_OEMDevGBARequestRealmString DEG_OEMDevGBARequestRealmString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.LookupHTTPGBARuleChain
RuleNames=050.LogRule
RuleNames=100.ProcessGBARequest
RuleNames=200.UpdateHTTPGBATable


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/200.UpdateHTTPGBATable]

ClassName=ConditionalRule
Conditions=DEG_OEMDevGBAResultFlagInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Operations=and
TrueRuleChain=UpdateHTTPGBA


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/200.UpdateHTTPGBATable/UpdateHTTPGBA]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/200.UpdateHTTPGBATable/UpdateHTTPGBA/100.InitUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_DI_HTTPGBA"
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=setifnull DEG_OEMDevUsernameString ""
AdornOps=copy DEG_OEMDevUsernameString DEG_BTID
AdornOps=copy DEG_OEMDevGBArspauthString DEG_RESPONSEAUTH
AdornOps=copy DEG_OEMDevQOPString DEG_QOP
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
#AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=copy DEG_OEMDevGBAKeyExpTimeString DEG_KEY_EXP_TIME
AdornOps=copy DEG_OEMDevGBABSTCreationTimeString DEG_BST_CREATION_TIME


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/200.UpdateHTTPGBATable/UpdateHTTPGBA/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_BTID,DEG_BTID
MapAttributes=DEG_RESPONSEAUTH,DEG_RESPONSEAUTH
MapAttributes=DEG_ME_KEY_MATERIAL,DEG_ME_KEY_MATERIAL
MapAttributes=DEG_UICC_KEY_MATERIAL,DEG_UICC_KEY_MATERIAL
MapAttributes=DEG_KEY_EXP_TIME,DEG_KEY_EXP_TIME
MapAttributes=DEG_BST_CREATION_TIME,DEG_BST_CREATION_TIME
#MapAttributes=DEG_QOP,DEG_QOP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DI_HTTPGBA_SessionStore


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/200.UpdateHTTPGBATable/UpdateHTTPGBA/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1

TrueRuleChain=100.SystemErrorLog


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/200.UpdateHTTPGBATable/UpdateHTTPGBA/300.CheckUpdateStatus/100.SystemErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
#AdornOps=set DEG_CDevProcessingErrorIdString "DEGv31.GA.57"
#AdornOps=set DEG_OEMDevErrorMessageString "Unable to update DEG_DI_HTTPGBA table"


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/050.LogRule]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevNONCEString
Attributes=DEG_OEMDevOPAQUEString
Attributes=DEG_NONCE
Attributes=DEG_OPAQUE
Attributes=DEG_SUBSTOKEN
Attributes=DEG_OEMDevTokenString
Attributes=DEG_REALM
Attributes=DEG_OEMDevGBARequestRealmString
LogLevel=DEBUG
Message=After look up from DEG_DI_HTTPGBA table :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/000.LookupHTTPGBARuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVaraibles
RuleNames=200.LookupHTTPGBA
RuleNames=300.CheckLookupStatus


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/000.LookupHTTPGBARuleChain/100.InitVaraibles]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_DI_HTTPGBA"
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/000.LookupHTTPGBARuleChain/200.LookupHTTPGBA]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_REALM,DEG_OEMDevGBARealmString
MapAttributes=DEG_NONCE,DEG_NONCE
MapAttributes=DEG_NC,DEG_NC
MapAttributes=DEG_OPAQUE,DEG_OPAQUE
MapAttributes=DEG_QOP,DEG_QOP
MapAttributes=DEG_CONTENTSTRING,DEG_CONTENTSTRING
MapAttributes=DEG_RESPONSEAUTH,DEG_RESPONSEAUTH
MapAttributes=DEG_BTID,DEG_BTID
MapAttributes=DEG_ME_KEY_MATERIAL,DEG_ME_KEY_MATERIAL
MapAttributes=DEG_UICC_KEY_MATERIAL,DEG_UICC_KEY_MATERIAL
MapAttributes=DEG_KEY_EXP_TIME,DEG_OEMDevGBAKeyExpTimeString
MapAttributes=DEG_BST_CREATION_TIME,DEG_OEMDevGBABSTCreationTimeString
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DI_HTTPGBA_SessionStore


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/000.LookupHTTPGBARuleChain/300.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.PrintError
FalseRuleChain=100.ValidateBTID


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/000.LookupHTTPGBARuleChain/300.CheckLookupStatus/100.ValidateBTID]

ClassName=ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
TrueRuleChain=CheckBTID


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/000.LookupHTTPGBARuleChain/300.CheckLookupStatus/100.ValidateBTID/CheckBTID]

ClassName=ConditionalRule
Conditions=DEG_BTID,!=,""
Conditions=DEG_BTID,!=,DEG_OEMDevUsernameString
Operations=and
TrueRuleChain=100.SetErrorResponse
TrueRuleChain=200.LogError


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/000.LookupHTTPGBARuleChain/300.CheckLookupStatus/100.ValidateBTID/CheckBTID/100.SetErrorResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=302.GenerateAndInserttoGBARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/000.LookupHTTPGBARuleChain/300.CheckLookupStatus/100.ValidateBTID/CheckBTID/200.LogError]

ClassName=LogNMERule
Message=Invalid BTID request value :
LogLevel=WARNING
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevAuthenticationInfoString
Attributes=DEG_OEMDevWwwauthenticateString
Attributes=DEG_OEMDevAuthorizationString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/000.LookupHTTPGBARuleChain/300.CheckLookupStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GBA.0011"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_DI_HTTPGBA table"

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/000.LookupHTTPGBARuleChain/300.CheckLookupStatus/110.PrintError]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_IMSI
Attributes=DEG_OEMDevUniqueIDString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: while looking up in DEG_DI_HTTPGBA table
UseProperty=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest]

ClassName=SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

Operations=DoAll

#TrueRuleChain=ValidateRealmValue
TrueRuleChain=ValidateAuthorizationHeaderAttributes
TrueRuleChain=ValidateNonce
TrueRuleChain=ValidateQOP
TrueRuleChain=ProcessGBARequestRuleChain

#ValidateRealmValue=100.ValidateRealmValue
ValidateAuthorizationHeaderAttributes=200.ValidateAuthorizationHeaderAttributes
ValidateNonce=100.ValidateNonce
ValidateQOP=150.ValidateQOP
ProcessGBARequestRuleChain=300.ProcessGBARequestRuleChain


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/150.ValidateQOP]

ClassName=ConditionalRule
Conditions=DEG_OEMDevAuthorizationString,contains,"qop"
TrueRuleChain=ValidateCnonceandNC


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/150.ValidateQOP/ValidateCnonceandNC]

ClassName=ConditionalRule
Conditions=DEG_OEMDevAuthorizationString,!contains,"cnonce"
Conditions=DEG_OEMDevAuthorizationString,!contains,"nc="
Operations=or
TrueRuleChain=100.SetErrorResponse
TrueRuleChain=200.LogErrorInfo
FalseRuleChain=LogRule


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/150.ValidateQOP/ValidateCnonceandNC/LogRule]

ClassName=LogNMERule
Message=Checking qop values :
Attributes=DEG_OEMDevAuthorizationString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/150.ValidateQOP/ValidateCnonceandNC/100.SetErrorResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=302.GenerateAndInserttoGBARuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/150.ValidateQOP/ValidateCnonceandNC/200.LogErrorInfo]

ClassName=LogNMERule
Message=Invalid Authorization header value, cnonce and nc are mandatory :
LogLevel=WARNING
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevAuthenticationInfoString
Attributes=DEG_OEMDevWwwauthenticateString
Attributes=DEG_OEMDevAuthorizationString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/100.ValidateNonce]

ClassName=ConditionalRule
Conditions=DEG_OEMDevGBANonceLifetimeLong,!=,-1
TrueRuleChain=100.SetNonceLifeTime
TrueRuleChain=200.CheckNonceLifeTime


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/100.ValidateNonce/100.SetNonceLifeTime]

ClassName=AdornmentRule
AdornOps=setsystime DEG_OEMDevGBACurrentTimeStampLong
AdornOps=- DEG_OEMDevGBACurrentTimeStampLong DEG_EVENTTIMESTAMP DEG_OEMDevGBANonceTimeStampDiffLong
AdornOps=* DEG_OEMDevGBANonceLifetimeLong 1000 DEG_OEMDevGBANonceLifetimeLong


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/100.ValidateNonce/200.CheckNonceLifeTime]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevGBANonceTimeStampDiffLong,<=,DEG_OEMDevGBANonceLifetimeLong
FalseRuleChain=100.SetErrorNonceExpiry
FalseRuleChain=200.NonceExpirationLog


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/100.ValidateNonce/200.CheckNonceLifeTime/100.SetErrorNonceExpiry]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=302.GenerateAndInserttoGBARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/100.ValidateNonce/200.CheckNonceLifeTime/200.NonceExpirationLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid action - Nonce is expired: 
PropertyName=LogRequestFlowLevel1
UseProperty=true
Attributes=DEG_OEMDevNONCEString
Attributes=DEG_OEMDevGBANonceLifetimeLong
Attributes=DEG_OEMDevGBACurrentTimeStampLong
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_OEMDevGBANonceTimeStampDiffLong


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/100.ValidateRealmValue]

ClassName=ConditionalRule
Conditions=DEG_OEMDevGBARequestRealmString,!=,DEG_REALM
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=200.LogInvalidRealm


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/100.ValidateRealmValue/100.SetHttpErrorResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=302.GenerateAndInserttoGBARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/100.ValidateRealmValue/200.LogInvalidRealm]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Invalid action - Realm value is invalid :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevAuthenticationInfoString
Attributes=DEG_OEMDevWwwauthenticateString
Attributes=DEG_OEMDevAuthorizationString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/200.ValidateAuthorizationHeaderAttributes]

ClassName=ConditionalRule
Conditions=DEG_OEMDevNONCEString,!=,DEG_NONCE
Conditions=DEG_OEMDevOPAQUEString,!=,DEG_OPAQUE
Conditions=DEG_OEMDevGBARequestRealmString,!=,DEG_OEMDevGBARealmString
Operations=or,or
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=200.LogInvalidHeaders


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/200.ValidateAuthorizationHeaderAttributes/100.SetHttpErrorResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=302.GenerateAndInserttoGBARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/200.ValidateAuthorizationHeaderAttributes/200.LogInvalidHeaders]
s
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Invalid action - Authorization header has invalid values, either nonce/opaque/realm values are not valid :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevAuthenticationInfoString
Attributes=DEG_OEMDevWwwauthenticateString
Attributes=DEG_OEMDevAuthorizationString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevFastAuthFlag,=,1
Conditions=DEG_TOKENSTATUS,=,"AE"
Conditions=DEG_OEMDevTokenString,=,DEG_SUBSTOKEN
Operations=and,and
TrueRuleChain=100.FastPathAuth
TrueRuleChain=120.copyresponseAuth
FalseRuleChain=102.SetCustValues
FalseRuleChain=103.SetCustomINvalues
FalseRuleChain=200.CallToBSF
FalseRuleChain=210.CopyCustToCoreNME
FalseRuleChain=205.SetKeyValues
FalseRuleChain=220.SetResponseBasedonCustom


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain/100.FastPathAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224B.DEG20FastPathAuthRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain/120.copyresponseAuth]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_RESPONSEAUTH DEG_OEMDevGBArspauthString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain/220.SetResponseBasedonCustom]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_OEMDevGBAResultFlagInteger,=,0
Conditions=DEG_OEMDevGBAResultFlagInteger,=,1
Conditions=DEG_OEMDevGBAResultFlagInteger,=,DEG_OEMDevGBAResultFlagInteger

TrueRuleChain=SetSuccessResponse
TrueRuleChain=SetFailureChallengeResponse
TrueRuleChain=SetFailureResponse

SetSuccessResponse=100.SetSuccessResponse
SetFailureChallengeResponse=200.SetFailureChallengeResponse
SetFailureResponse=300.SetFailureResponse


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain/220.SetResponseBasedonCustom/100.SetSuccessResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=303.GenerateResponseAuthValue
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain/220.SetResponseBasedonCustom/200.SetFailureChallengeResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=302.GenerateAndInserttoGBARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain/220.SetResponseBasedonCustom/300.SetFailureResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 503
AdornOps=set DEG_SSL_REQUEST_STATE "503C"
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain/102.SetCustValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull CUST_GBA_IN_USERNAME ""
AdornOps=setifnull CUST_GBA_IN_NAFID ""
AdornOps=setifnull CUST_GBA_IN_GSID ""
AdornOps=setifnull CUST_GBA_IN_GBAUNAWARE ""
#AdornOps=setifnull CUST_GBA_IN_IMSI ""
AdornOps=setifnull DEG_OEMDevGBAExtensionString ""
AdornOps=setifnull DEG_OEMDevUsernameString ""
AdornOps=setifnull CUST_GBA_IN_GBATYPE ""
AdornOps=setifnull CUST_GBA_IN_KeyMaterial ""
AdornOps=setifnull DEG_OEMDevGBAKeyExpTimeString ""
AdornOps=setifnull DEG_OEMDevGBABSTCreationTimeString ""
AdornOps=copy DEG_OEMDevUsernameString CUST_GBA_IN_USERNAME
AdornOps=set DEG_OEMDevGBA_Nafid ${DEVICE_DIAMETER_SERVER_HOST_NAME}
AdornOps=str2bin DEG_OEMDevGBA_Nafid CUST_GBA_IN_NAFID
AdornOps=set CUST_GBA_IN_GSID "0"
AdornOps=set CUST_GBA_IN_GBAUNAWARE "0"
#AdornOps=copy CUST_GSP_IN_IMSIString CUST_GBA_IN_IMSI
AdornOps=copy DEG_OEMDevX3GPPIntendedIdentityString CUST_GBA_IN_IMPU
AdornOps=copy DEG_OEMDevGBAExtensionString CUST_GBA_IN_EXTENSION
AdornOps=copy DEG_OEMDevGBAKeyExpTimeString CUST_GBA_IN_KeyExpTime
AdornOps=copy DEG_OEMDevGBABSTCreationTimeString CUST_GBA_IN_BSTCreTime


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain/103.SetCustomINvalues]

ClassName=SwitchConditionRule
Conditions=DEG_OEMDevUserAgentString,=,"3gpp-gba"
Conditions=DEG_OEMDevUserAgentString,=,"3gpp-uicc"

Operations=None

TrueRuleChain=SetMEGBAType
TrueRuleChain=SetUICCGBAType

SetMEGBAType=100.SetMEGBAType
SetUICCGBAType=200.SetUICCGBAType


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain/103.SetCustomINvalues/100.SetMEGBAType]

ClassName=AdornmentRule
AdornOps=set CUST_GBA_IN_GBATYPE "ME"
AdornOps=copy DEG_ME_KEY_MATERIAL DEG_OEMDevGBAPasswordString
AdornOps=copy DEG_OEMDevGBAPasswordString CUST_GBA_IN_KeyMaterial


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain/103.SetCustomINvalues/200.SetUICCGBAType]

ClassName=AdornmentRule
AdornOps=set CUST_GBA_IN_GBATYPE "UICC"
AdornOps=copy DEG_UICC_KEY_MATERIAL DEG_OEMDevGBAPasswordString
AdornOps=copy DEG_OEMDevGBAPasswordString CUST_GBA_IN_KeyMaterial


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain/200.CallToBSF]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_BSF_Connect_Custom
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain/210.CopyCustToCoreNME]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull CUST_GBA_OUT_meKeyBinary ""
AdornOps=setifnull CUST_GBA_OUT_uiccKeyBinary ""
AdornOps=setifnull CUST_GBA_OUT_ResultFlag 0
AdornOps=setifnull CUST_GBA_OUT_keyExpTimeString ""
AdornOps=setifnull CUST_GBA_OUT_BSTCreTimeString ""
AdornOps=copy CUST_GBA_OUT_ResultFlag DEG_OEMDevGBAResultFlagInteger
AdornOps=copy CUST_GBA_OUT_keyExpTimeString DEG_OEMDevGBAKeyExpTimeString
AdornOps=copy CUST_GBA_OUT_BSTCreTimeString DEG_OEMDevGBABSTCreationTimeString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain/205.SetKeyValues]

ClassName=SwitchConditionRule
Conditions=DEG_OEMDevUserAgentString,=,"3gpp-gba"
Conditions=DEG_OEMDevUserAgentString,=,"3gpp-uicc"

Operations=None

TrueRuleChain=CopyMEKeyValue
TrueRuleChain=CopyUICCKeyValue

CopyMEKeyValue=100.CopyMEKeyValue
CopyUICCKeyValue=200.CopyUICCKeyValue


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain/205.SetKeyValues/100.CopyMEKeyValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy CUST_GBA_OUT_meKeyBinary DEG_OEMDevGBAPasswordString
AdornOps=copy DEG_OEMDevGBAPasswordString DEG_ME_KEY_MATERIAL


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/300.BSFProcessingRuleChain/100.ProcessGBARequest/300.ProcessGBARequestRuleChain/205.SetKeyValues/200.CopyUICCKeyValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy CUST_GBA_OUT_uiccKeyBinary DEG_OEMDevGBAPasswordString
AdornOps=copy DEG_OEMDevGBAPasswordString DEG_UICC_KEY_MATERIAL


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateNonceandOpaquevalue
RuleNames=120.CreateSession
RuleNames=130.GenerateAuthenticateHeader
RuleNames=140.SetHttpErrorResponse


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain/100.GenerateNonceandOpaquevalue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevNCInteger 1
AdornOps=setsystime DEG_CDevProcessStartTimeLong
AdornOps=rand DEG_OEMDevGBARandomNumber 0 100000
AdornOps=+ DEG_CDevProcessStartTimeLong DEG_OEMDevGBARandomNumber DEG_OEMDevGBAnonceLong
AdornOps=copy DEG_OEMDevGBAnonceLong DEG_OEMDevNONCEString
AdornOps=digest "MD5" DEG_OEMDevNONCEString DEG_OEMDevNONCEBinary
AdornOps=copy DEG_OEMDevNONCEBinary DEG_OEMDevNONCEString
AdornOps=+ DEG_OEMDevGBARealmString DEG_OEMDevNONCEString DEG_OEMDevOPAQUEString
AdornOps=digest "MD5" DEG_OEMDevOPAQUEString DEG_OEMDevOPAQUEBinary
AdornOps=copy DEG_OEMDevOPAQUEBinary DEG_OEMDevOPAQUEString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain/120.CreateSession]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=101.CalcualteHexaNCcount
RuleNames=100.InitInsert2Db
RuleNames=105.LogRule
RuleNames=110.UpdateHTTPGBA
RuleNames=130.CheckCreateStatus


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain/120.CreateSession/105.LogRule]

ClassName=LogNMERule
Attributes=DEG_OEMDevImsiString
Attributes=DEG_IMSI
LogLevel=DEBUG
Message=After extracting IMSI from Subscriber-id :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain/120.CreateSession/101.CalcualteHexaNCcount]

ClassName=DecimalToHexRule
DecimalAttribute=DEG_OEMDevNCInteger
HexStringAttribute=DEG_OEMDevNCString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain/120.CreateSession/100.InitInsert2Db]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_DI_HTTPGBA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=copy DEG_OEMDevGBARealmString DEG_REALM
AdornOps=copy DEG_OEMDevNONCEString DEG_NONCE
#AdornOps=set DEG_OEMDevNCInteger 1
AdornOps=copy DEG_OEMDevNCString DEG_NC
AdornOps=copy DEG_OEMDevOPAQUEString DEG_OPAQUE
AdornOps=set DEG_OEMDevQOPString "auth"
AdornOps=copy DEG_OEMDevQOPString DEG_QOP
AdornOps=set DEG_OEMDevUsernameString ""
AdornOps=copy DEG_OEMDevUsernameString DEG_BTID
AdornOps=setifnull DEG_OEMDevRequestContentString ""
AdornOps=copy DEG_OEMDevRequestContentString DEG_CONTENTSTRING
AdornOps=set DEG_RESPONSEAUTH ""
AdornOps=set DEG_ME_KEY_MATERIAL ""
AdornOps=set DEG_UICC_KEY_MATERIAL ""
AdornOps=set DEG_KEY_EXP_TIME ""
AdornOps=set DEG_BST_CREATION_TIME ""
AdornOps=setsystime DEG_EVENTTIMESTAMP


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain/120.CreateSession/110.UpdateHTTPGBA]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_NONCE,DEG_NONCE
MapAttributes=DEG_NC,DEG_NC
MapAttributes=DEG_OPAQUE,DEG_OPAQUE
MapAttributes=DEG_QOP,DEG_QOP
MapAttributes=DEG_BTID,DEG_BTID
MapAttributes=DEG_CONTENTSTRING,DEG_CONTENTSTRING
MapAttributes=DEG_RESPONSEAUTH,DEG_RESPONSEAUTH
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DI_HTTPGBA_SessionStore

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain/120.CreateSession/130.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=SystemErrorLog
TrueRuleChain=RowNotExists

SystemErrorLog=95.SystemErrorInfo
SystemErrorLog=100.SystemErrorLog

RowNotExists=125.CreateRow
RowNotExists=200.CheckCreateStatus

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain/120.CreateSession/130.CheckCreateStatus/95.SystemErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GBA.0012"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: System error while Connecting DEG_DI_HTTPGBA store while Processing request"

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain/120.CreateSession/130.CheckCreateStatus/100.SystemErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_IMSI
LogLevel=CRITICAL
Message=Database Error: System error while Connecting DEG_DI_HTTPGBA store while Processing request
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain/120.CreateSession/130.CheckCreateStatus/125.CreateRow]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
SessionStore=DEG_DI_HTTPGBA_SessionStore

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain/120.CreateSession/130.CheckCreateStatus/200.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain/120.CreateSession/130.CheckCreateStatus/200.CheckCreateStatus/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 500
#AdornOps=set DEG_CDevProcessingErrorIdString "DEG31.DEGT.23"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to create an entry in DEG_DI_HTTPGBA table"
AdornOps=set DEG_OEMDevEncodingString "gzip"

[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain/120.CreateSession/130.CheckCreateStatus/200.CheckCreateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to create an entry in DEG_DI_HTTPGBA table:
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain/130.GenerateAuthenticateHeader]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull DEG_OEMDevWwwauthenticateString ""
AdornOps=+ DEG_OEMDevWwwauthenticateString DEG_OEMDevGBASpaceString DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString " DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString DEG_OEMDevGBARealmString DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString ",nonce=" DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString DEG_OEMDevNONCEString DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString ",algorithm=" DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString DEG_OEMDevAlgorithmString DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString ",opaque=" DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString DEG_OEMDevOPAQUEString DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString ",qop=" DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString DEG_OEMDevQOPString DEG_OEMDevWwwauthenticateString
AdornOps=+ DEG_OEMDevWwwauthenticateString " DEG_OEMDevWwwauthenticateString


[/templates/DEG/DeviceInterface/GBA_Common_Core/RuleChains/302.GenerateAndInserttoGBARuleChain/140.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 401
AdornOps=set DEG_SSL_REQUEST_STATE "401C"
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"

##Session stores

[/templates/DEG/DeviceInterface/GBA_Common_Core/SessionStores]

SessionStoreNames=DEG_DI_HTTPGBA_SessionStore


[/templates/DEG/DeviceInterface/GBA_Common_Core/SessionStores/DEG_DI_HTTPGBA_SessionStore]

Attributes=DEG_IMSI,key
Attributes=DEG_REALM
Attributes=DEG_NONCE
Attributes=DEG_NC
Attributes=DEG_OPAQUE
Attributes=DEG_QOP
Attributes=DEG_BTID
Attributes=DEG_CONTENTSTRING
Attributes=DEG_RESPONSEAUTH
Attributes=DEG_ME_KEY_MATERIAL
Attributes=DEG_UICC_KEY_MATERIAL
Attributes=DEG_KEY_EXP_TIME
Attributes=DEG_BST_CREATION_TIME
Attributes=DEG_EVENTTIMESTAMP
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DatabaseId=DEG_DI_HTTPGBA
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_DI_HTTPGBA}
SQLTypeMap=DEG_IMSI,VARCHAR(64)
SQLTypeMap=DEG_REALM,VARCHAR(64)
SQLTypeMap=DEG_NONCE,VARCHAR(256)
SQLTypeMap=DEG_NC,VARCHAR(100)
SQLTypeMap=DEG_OPAQUE,VARCHAR(100)
SQLTypeMap=DEG_QOP,VARCHAR(100)
SQLTypeMap=DEG_BTID,VARCHAR(256s)
SQLTypeMap=DEG_CONTENTSTRING,VARCHAR(1024)
SQLTypeMap=DEG_RESPONSEAUTH,VARCHAR(256)
SQLTypeMap=DEG_ME_KEY_MATERIAL,VARCHAR(128)
SQLTypeMap=DEG_UICC_KEY_MATERIAL,VARCHAR(128)
SQLTypeMap=DEG_KEY_EXP_TIME,VARCHAR(64)
SQLTypeMap=DEG_BST_CREATION_TIME,VARCHAR(64)
SQLTypeMap=DEG_EVENTTIMESTAMP,BIGINT
CommonPolicyID=Policy1
