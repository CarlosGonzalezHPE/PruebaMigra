
[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius]


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors]

ConnectorNames=700.RadiusAdapter


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter]

ClassName=com.hp.usage.radius.adapter.RadiusAdapter
Codec=RadiusCodec
IOCoreThreadPoolSize=${DEVICE_RADIUS_IOCORE_POOL_SIZE}
IOMaxThreadPoolSize=${DEVICE_RADIUS_IOMAX_POOL_SIZE}
ProcessorCoreThreadPoolSize=${DEVICE_RADIUS_PROC_CORE_POOL_SIZE}
ProcessorMaxThreadPoolSize=${DEVICE_RADIUS_PROC_MAX_POOL_SIZE}


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/Client]

AuthenticationMethod=eap
AuthPool=RadiusServer
ClassName=RadiusClient


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/HomeServerPools]

ClassName=com.hp.usage.radius.adapter.HomeServerPools
PoolNames=RadiusServer


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/HomeServerPools/RadiusServer]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadiusClient_Customize/Connectors/700.RadiusAdapter/HomeServerPools/RadiusServer


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/RadiusCodec]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/RadiusCodec/Decoder]

UseRepository=true
XfdList=radius.AccessRequest
XfdList=radius.AccessReject
XfdList=radius.AccessAccept
XfdList=radius.AccessChallenge
XfdList=radius.AccountingRequest
XfdList=radius.AccountingResponse


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/RadiusCodec/Decoder/radius.AccessAccept]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/RadiusCodec/Decoder/radius.AccessChallenge]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/RadiusCodec/Decoder/radius.AccessReject]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/RadiusCodec/Decoder/radius.AccessRequest]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/RadiusCodec/Decoder/radius.AccountingRequest]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/RadiusCodec/Decoder/radius.AccountingResponse]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/RadiusCodec/Encoder]

UseRepository=true
XfdList=radius.AccessRequest
XfdList=radius.AccessReject
XfdList=radius.AccessAccept
XfdList=radius.AccessChallenge
XfdList=radius.AccountingRequest
XfdList=radius.AccountingResponse


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/RadiusCodec/Encoder/radius.AccessAccept]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/RadiusCodec/Encoder/radius.AccessChallenge]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/RadiusCodec/Encoder/radius.AccessReject]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/RadiusCodec/Encoder/radius.AccessRequest]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/RadiusCodec/Encoder/radius.AccountingRequest]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/Connectors/700.RadiusAdapter/RadiusCodec/Encoder/radius.AccountingResponse]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/
[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains]

RuleChainNames=301.AAAProcessingRuleChain
RuleChainNames=301A.LookupSSLSessionTableRuleChain
RuleChainNames=301B.GenerateOrCopyAAASessionIDRuleChain
RuleChainNames=301C.SendRadiusRequestToAAARuleChain
RuleChainNames=301D.ValidateRadiusResponseFromAAARuleChain
RuleChainNames=312.RadiusErrorRuleChain
RuleChainNames=540.GenerateAAARadiusCallStartAuditDataRuleChain
RuleChainNames=541.GenerateAAARadiusCallEndErrorAuditDataRuleChain
RuleChainNames=542.GenerateAAARadiusCallEndOKAuditDataRuleChain
RuleChainNames=543.GenerateAAARadiusCallUnknownSubscriberEndErrorAuditDataRuleChain


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301.AAAProcessingRuleChain]

ClassName=RuleChain
RuleNames=100.LookupState
RuleNames=110.SetRequestParams
RuleNames=115.SetRequestParams
RuleNames=120.GetSessionId
RuleNames=125.RadiusErrorinfo
RuleNames=130.LogRadiusNMEs
RuleNames=200.SendRadiusRequest
RuleNames=300.SetOutReturnCodeIfErrorAttributeSet
RuleNames=400.ValidateRadiusResponse
RuleNames=450.SetErrorInfo
RuleNames=500.LogRadiusResponse


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301.AAAProcessingRuleChain/100.LookupState]

ClassName=LocalRuleChainInvoker
RuleChain=301A.LookupSSLSessionTableRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301.AAAProcessingRuleChain/115.SetRequestParams]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadiusClient_Customize/RuleChains/301.AAAProcessingRuleChain/115.SetRequestParams

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301.AAAProcessingRuleChain/110.SetRequestParams]

AdornOps=set DEG_SSL_STATE "WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA"
AdornOps=str2bin DEG_OEMDevImsiString DEG_OEMDevImsiBinary
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditTransactionTypeString "DER"
AdornOps=set DEG_OEMDevRadiusErrorString ""
AdornOps=set DEG_OEMDevRadiusCodeInteger 1
AdornOps=setsystime DEG_OEMDevAAAProcessStartTimeLong
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301.AAAProcessingRuleChain/120.GetSessionId]

ClassName=LocalRuleChainInvoker
RuleChain=301B.GenerateOrCopyAAASessionIDRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301.AAAProcessingRuleChain/125.RadiusErrorinfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0601"
AdornOps=set DEG_OEMDevMessageString "AccessRequest is sent from DEG TO AAA"

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301.AAAProcessingRuleChain/130.LogRadiusNMEs]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadiusClient_Customize/RuleChains/301.AAAProcessingRuleChain/130.LogRadiusNMEs


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301.AAAProcessingRuleChain/200.SendRadiusRequest]

ClassName=LocalRuleChainInvoker
RuleChain=301C.SendRadiusRequestToAAARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301.AAAProcessingRuleChain/300.SetOutReturnCodeIfErrorAttributeSet]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRadiusErrorString,!=,""
FalseRuleChain=200.DecodeAnswerType
TrueRuleChain=100.SetErrorParams


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301.AAAProcessingRuleChain/300.SetOutReturnCodeIfErrorAttributeSet/100.SetErrorParams]

AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=copy DEG_OEMDevRadiusErrorString DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301.AAAProcessingRuleChain/300.SetOutReturnCodeIfErrorAttributeSet/200.DecodeAnswerType]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadiusClient_Customize/RuleChains/301.AAAProcessingRuleChain/300.SetOutReturnCodeIfErrorAttributeSet/200.DecodeAnswerType


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301.AAAProcessingRuleChain/400.ValidateRadiusResponse]

ClassName=LocalRuleChainInvoker
RuleChain=301D.ValidateRadiusResponseFromAAARuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301.AAAProcessingRuleChain/450.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0602"
AdornOps=set DEG_OEMDevMessageString "RadiusProcessingRule - Response:"

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301.AAAProcessingRuleChain/500.LogRadiusResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_SSL_NAI
Attributes=DEG_MDN
Attributes=DEG_OEMDevRadiusAcctSessionIdString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevRATTypeInteger
Attributes=DEG_SSL_STATE
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=RadiusProcessingRule - Response:
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301A.LookupSSLSessionTableRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionLookup
RuleNames=110.ExecuteSslSessionLookup
RuleNames=120.CheckSslSessionLookupStatus


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301A.LookupSSLSessionTableRuleChain/100.InitSslSessionLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301A.LookupSSLSessionTableRuleChain/110.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_AAA_STATE,DEG_SSL_AAA_STATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301A.LookupSSLSessionTableRuleChain/120.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
Operations=DoAll
SetError=100.SetErrorInfo
SetError=110.ErrorLog
StateExist=300.SetStateBinary
StateNotPresent=200.SetStateEmpty
TrueRuleChain=SetError
TrueRuleChain=StateNotPresent
TrueRuleChain=StateExist


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301A.LookupSSLSessionTableRuleChain/120.CheckSslSessionLookupStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0603"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to access or create entry in DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301A.LookupSSLSessionTableRuleChain/120.CheckSslSessionLookupStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to access or create entry in DEG_SSL_SESSION table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301A.LookupSSLSessionTableRuleChain/120.CheckSslSessionLookupStatus/200.SetStateEmpty]

AdornOps=set DEG_OEMDevAuthSessionStateBinary 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301A.LookupSSLSessionTableRuleChain/120.CheckSslSessionLookupStatus/300.SetStateBinary]

#AdornOps=copy DEG_SSL_AAA_STATEID DEG_OEMDevAuthSessionStateStringTbl
#AdornOps=str2bin DEG_OEMDevAuthSessionStateStringTbl DEG_OEMDevAuthSessionStateBinary
AdornOps=copy DEG_SSL_AAA_STATE DEG_OEMDevAuthSessionStateBinary
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301B.GenerateOrCopyAAASessionIDRuleChain]

ClassName=RuleChain
RuleNames=100.CheckAAASessionId


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301B.GenerateOrCopyAAASessionIDRuleChain/100.CheckAAASessionId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_AAA_SESSIONID,!=,""
FalseRuleChain=200.NewSessionId
TrueRuleChain=100.CopySessionId


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301B.GenerateOrCopyAAASessionIDRuleChain/100.CheckAAASessionId/100.CopySessionId]

AdornOps=copy DEG_SSL_AAA_SESSIONID DEG_OEMDevRadiusAcctSessionIdString
AdornOps=copy DEG_SSL_AAA_STATE DEG_OEMDevAuthSessionStateBinary
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301B.GenerateOrCopyAAASessionIDRuleChain/100.CheckAAASessionId/200.NewSessionId]

AdornOps=setsystime DEG_OEMDevSessionIdTimeInMilliSecs
AdornOps=% DEG_OEMDevSessionIdTimeInMilliSecs 1000 DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=* DEG_OEMDevSessionIdTimeInNanoSecsLong 1000000 DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=/ DEG_OEMDevSessionIdTimeInMilliSecs 1000 DEG_OEMDevSessionIdTimeInSecs
AdornOps=set DEG_OEMDevRadiusAcctSessionIdString ${DEVICEINTERFACE_PROCESS_NAME}
AdornOps=+ DEG_OEMDevRadiusAcctSessionIdString ; DEG_OEMDevRadiusAcctSessionIdString
AdornOps=set DEG_OEMDevRadiusHostNameString ${DEVICE_DIAMETER_SERVER_HOST_NAME}
AdornOps=+ DEG_OEMDevRadiusAcctSessionIdString DEG_OEMDevRadiusHostNameString DEG_OEMDevRadiusAcctSessionIdString
AdornOps=+ DEG_OEMDevRadiusAcctSessionIdString ; DEG_OEMDevRadiusAcctSessionIdString
AdornOps=+ DEG_OEMDevRadiusAcctSessionIdString DEG_OEMDevSessionIdTimeInSecs DEG_OEMDevRadiusAcctSessionIdString
AdornOps=+ DEG_OEMDevRadiusAcctSessionIdString ; DEG_OEMDevRadiusAcctSessionIdString
AdornOps=+ DEG_OEMDevRadiusAcctSessionIdString DEG_OEMDevSessionIdTimeInNanoSecsLong DEG_OEMDevRadiusAcctSessionIdString
AdornOps=+ DEG_OEMDevRadiusAcctSessionIdString ; DEG_OEMDevRadiusAcctSessionIdString
AdornOps=+ DEG_OEMDevRadiusAcctSessionIdString DEG_OEMDevImsiString DEG_OEMDevRadiusAcctSessionIdString
AdornOps=+ DEG_OEMDevRadiusAcctSessionIdString ; DEG_OEMDevRadiusAcctSessionIdString
AdornOps=+ DEG_OEMDevRadiusAcctSessionIdString DEG_MDN DEG_OEMDevRadiusAcctSessionIdString
AdornOps=copy DEG_OEMDevRadiusAcctSessionIdString DEG_SSL_AAA_SESSIONID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301C.SendRadiusRequestToAAARuleChain]

RuleNames=100.RadiusNMEConversion
RuleNames=110.GenerateAAACallStartAuditData
RuleNames=120.SendRadiusRequest


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301C.SendRadiusRequestToAAARuleChain/100.RadiusNMEConversion]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadiusClient_Customize/RuleChains/301C.SendRadiusRequestToAAARuleChain/100.RadiusNMEConversion


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301C.SendRadiusRequestToAAARuleChain/110.GenerateAAACallStartAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=540.GenerateAAARadiusCallStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301C.SendRadiusRequestToAAARuleChain/120.SendRadiusRequest]

ClassName=RadiusClientRule
ConnectorName=700.RadiusAdapter
DecodeAttributes=radius:RadiusMessage,AAARadiusMessage
DecodedAttributeSpecifier=specifier
EncodeAttribute=AAARadiusMessage
ErrorCodeAttribute=DEG_OEMDevRadiusErrorString
ErrorRuleChain=312.RadiusErrorRuleChain
RootNMEType=radius:Umbrella
SynchronousMode=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckAnswerTypeAndProcess


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevAnswerTypeInteger,=,11
Conditions=DEG_OEMDevAnswerTypeInteger,=,3
Conditions=DEG_OEMDevAnswerTypeInteger,=,2
Operations=None
ProcessAccessAccept=803.ProcessAccessAccept
ProcessAccessChallenge=801.ProcessAccessChallenge
ProcessAccessReject=802.ProcessAccessReject
TrueRuleChain=ProcessAccessChallenge
TrueRuleChain=ProcessAccessReject
TrueRuleChain=ProcessAccessAccept


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.Initialise
RuleNames=110.ExtractChallengeAttbs
RuleNames=115.EAPMessagedecode
RuleNames=118.ATNotifParse
RuleNames=120.ConvertBinToStr
RuleNames=130.LogAccessChallengeReceived
RuleNames=200.ValidateRadiusState
RuleNames=210.ValidateATNotifValue


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/100.Initialise]

AdornOps=set DEG_OEMDevAuthSessionStateString ""
AdornOps=set DEG_OEMDevAuthSessionStateBinary 0
AdornOps=set DEG_OEMDevEAPPayloadString ""
AdornOps=set DEG_OEMDevEAPPayloadBinary 0
AdornOps=set DEG_OEMDevATNotificationValueInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/110.ExtractChallengeAttbs]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadiusClient_Customize/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/110.ExtractChallengeAttbs


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/115.EAPMessagedecode]

ClassName=com.hp.usage.nme.rules.NMEDecoderRule
DestinationAttribute=AAARadiusMessage.answer.accessChallenge.eapData
DestinationAttributeType=eap:eap
FormatId=eap.eap
SourceAttribute=AAARadiusMessage.answer.accessChallenge.EAPMessage
SourceAttributeType=byte[]
TransformerId=XFD_eap_to_SNME_eap.XFD_eap_to_SNME_eap


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/118.ATNotifParse]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadiusClient_Customize/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/118.ATNotifParse


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/120.ConvertBinToStr]

#AdornOps=bin2str DEG_OEMDevAuthSessionStateBinary DEG_OEMDevAuthSessionStateString
AdornOps=bin2str DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0604"
AdornOps=set DEG_OEMDevMessageString "AccessChallenge After Response:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/130.LogAccessChallengeReceived]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevATNotificationValueInteger
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=AAA TO DEG -> AccessChallenge After Response: 
NullAlso=true

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/210.ValidateATNotifValue]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevATNotificationValueInteger,within,[16384,1026,1031]
TrueRuleChain=100.SetUnknowSubscriberResponse
TrueRuleChain=001.LogUnknownSub
TrueRuleChain=002.GenerateAAARadiusCallUnknownSubscriberEndErrorAuditDataRuleChain
TrueRuleChain=003.SetTransactionType
TrueRuleChain=003.GenerateGetAuthenticationUnknownSubscriberEndAuditData

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/210.ValidateATNotifValue/100.SetUnknowSubscriberResponse]

AdornOps=set DEG_OEMDevRespStatusString 6004
AdornOps=set DEG_SSL_STATE "UNKNOWN_SUBSCRIBER"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0605"
AdornOps=set DEG_OEMDevErrorMessageString "STATUS_UNKNOWN_SUBSCRIBER"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/210.ValidateATNotifValue/001.LogUnknownSub]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Attributes=DEG_OEMDevRespStatusString
Attributes=DEG_SSL_STATE
Attributes=DEG_OEMDevATNotificationValueInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Message=AAA TO DEG -> AT_NotificationValue is STATUS_UNKNOWN_SUBSCRIBER


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/210.ValidateATNotifValue/002.GenerateAAARadiusCallUnknownSubscriberEndErrorAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=543.GenerateAAARadiusCallUnknownSubscriberEndErrorAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/210.ValidateATNotifValue/003.SetTransactionType]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevActionNameString DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "Device"

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/210.ValidateATNotifValue/003.GenerateGetAuthenticationUnknownSubscriberEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/200.ValidateRadiusState]

ClassName=com.hp.usage.script.rules.ExpressionConditionalRule
Expression=(DEG_OEMDevAuthSessionStateBinary != null) && (DEG_OEMDevEAPPayloadBinary != null)
FalseRuleChain=200.InvalidResponsefromAAA
FalseRuleChain=210.LogInvalidResponsefromAAA
TrueRuleChain=100.UpdateSSLSessionStore


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/200.ValidateRadiusState/100.UpdateSSLSessionStore]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevATNotificationValueInteger,!=,16384
TrueRuleChain=100.InitSslSessionUpdate
TrueRuleChain=200.ExecuteSslSessionUpdate
TrueRuleChain=300.CheckSslSessionUpdateStatus


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/200.ValidateRadiusState/100.UpdateSSLSessionStore/100.InitSslSessionUpdate]

#AdornOps=copy DEG_OEMDevAuthSessionStateString DEG_SSL_AAA_STATEID
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI
AdornOps=copy DEG_OEMDevImsiString DEG_SSL_IMSI
AdornOps=copy DEG_OEMDevAuthSessionStateBinary DEG_SSL_AAA_STATE
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/200.ValidateRadiusState/100.UpdateSSLSessionStore/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_AAA_STATE,DEG_SSL_AAA_STATE
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/200.ValidateRadiusState/100.UpdateSSLSessionStore/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
FalseRuleChain=200.SetSessionStatus
FalseRuleChain=300.GenerateAAACallEndOkAuditData
Operations=or
TrueRuleChain=080.SetErrorinfo
TrueRuleChain=100.LogError

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/200.ValidateRadiusState/100.UpdateSSLSessionStore/300.CheckSslSessionUpdateStatus/080.SetErrorinfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0606"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update State value in DEG_SSL_SESSION"

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/200.ValidateRadiusState/100.UpdateSSLSessionStore/300.CheckSslSessionUpdateStatus/100.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: while updating DEG_SSL_SESSION store for State value
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/200.ValidateRadiusState/100.UpdateSSLSessionStore/300.CheckSslSessionUpdateStatus/200.SetSessionStatus]

AdornOps=set DEG_SSL_STATE WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE
AdornOps=set DEG_CDevOutReturnCodeString 1001
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "EAP"
ClassName=com.hp.siu.collector.rules.AdornmentRule
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/200.ValidateRadiusState/100.UpdateSSLSessionStore/300.CheckSslSessionUpdateStatus/300.GenerateAAACallEndOkAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=542.GenerateAAARadiusCallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/200.ValidateRadiusState/200.InvalidResponsefromAAA]

AdornOps=set DEG_OEMDevErrorMessageString "Invalid response code from AAA"
AdornOps=set DEG_CDevOutReturnCodeString 5004
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0607"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/801.ProcessAccessChallenge/200.ValidateRadiusState/210.LogInvalidResponsefromAAA]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=AAA TO DEG -> AAA Invalid Response: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=AAA Response back with Invalid code.  Contact HP Support.


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/802.ProcessAccessReject]

ClassName=RuleChain
RuleNames=100.ExtractRadiusAccessRejectNMEs
RuleNames=110.ExtractEAPPayload
RuleNames=200.ValidateResponse
RuleNames=300.GenerateAAACallEndOkAuditData
RuleNames=350.SetErrorinfo
RuleNames=400.LogReject


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/802.ProcessAccessReject/100.ExtractRadiusAccessRejectNMEs]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadiusClient_Customize/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/802.ProcessAccessReject/100.ExtractRadiusAccessRejectNMEs


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/802.ProcessAccessReject/110.ExtractEAPPayload]

AdornOps=bin2str DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
AdornOps=setifnull DEG_OEMDevReplyMessageString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/802.ProcessAccessReject/200.ValidateResponse]

AdornOps=set DEG_OEMDevRespStatusString 6300
AdornOps=set DEG_SSL_STATE AKA_CHALLENGE_REJECTED_BY_AAA
AdornOps=set DEG_CDevOutReturnCodeString 4001
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "EAP"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/802.ProcessAccessReject/300.GenerateAAACallEndOkAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=542.GenerateAAARadiusCallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/802.ProcessAccessReject/350.SetErrorinfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0608"
AdornOps=set DEG_OEMDevErrorMessageString "Reject response from AAA TO DEG"

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/802.ProcessAccessReject/400.LogReject]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevRespStatusString
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevOutReturnCodeString
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevReplyMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=AAA TO DEG -> AccessReject Response: 
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept]

ClassName=RuleChain
RuleNames=001.Initialise
RuleNames=100.RadiusAcceptSNMEConversion
RuleNames=110.ExtractResponseAttributes
RuleNames=200.ValidateResponse


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/001.Initialise]

AdornOps=set DEG_OEMDevSubscriberIdString ""
AdornOps=set DEG_OEMDevEAPPayloadString ""
AdornOps=set DEG_OEMDevEAPPayloadBinary 0
AdornOps=set DEG_OEMDevAuthSessionStateString ""
AdornOps=set DEG_OEMDevAuthSessionStateBinary 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/100.RadiusAcceptSNMEConversion]

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadiusClient_Customize/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/100.RadiusAcceptSNMEConversion


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/110.ExtractResponseAttributes]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ValidateRadiusState


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/110.ExtractResponseAttributes/100.ValidateRadiusState]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAuthSessionStateBinary,!=,0
Conditions=DEG_OEMDevEAPPayloadBinary,!=,0
TrueRuleChain=100.ExtractResponseAttbs
TrueRuleChain=110.LogResponseAttributes


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/110.ExtractResponseAttributes/100.ValidateRadiusState/100.ExtractResponseAttbs]

#AdornOps=bin2str DEG_OEMDevAuthSessionStateBinary DEG_OEMDevAuthSessionStateString
#AdornOps=bin2str DEG_MDNBinary DEG_MDNString
AdornOps=bin2str DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0609"
AdornOps=set DEG_OEMDevMessageString "Access Accept request from AAA to DEG"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/110.ExtractResponseAttributes/100.ValidateRadiusState/110.LogResponseAttributes]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_OEMDevAuthSessionStateBinary
Attributes=DEG_OEMDevAuthSessionStateString
Attributes=DEG_MDNString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=AAA TO DEG -> AccessAccept Response: 
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/200.ValidateResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetSessionStatus
RuleNames=110.PostProcess
RuleNames=200.GenerateAAACallEndOKAuditData


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/200.ValidateResponse/100.SetSessionStatus]

AdornOps=set DEG_SSL_STATE AUTHENTICATED_BY_AAA
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "EAP"
AdornOps=setsystime DEG_FULLAUTHTIMESTAMP
AdornOps=set DEG_CDevOutReturnCodeString 2001
ClassName=com.hp.siu.collector.rules.AdornmentRule

### RFE#49  for customization improvements ###

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/200.ValidateResponse/110.PostProcess]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CopyBeforePostProcess
RuleNames=100.LogBeforePostProcess
RuleNames=200.ProcessPostProcess
RuleNames=300.CopyAfterPostProcess
RuleNames=300.LogAfterPostProcess

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/200.ValidateResponse/110.PostProcess/100.CopyBeforePostProcess]

ClassName=AdornmentRule
AdornOps=copy DEG_MDNString CUST_PPP_IN_MDNString
AdornOps=copy DEG_OEMDevImsiString CUST_PPP_IN_IMSIString
AdornOps=copy DEG_MDN CUST_PPP_OUT_MDN
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.06010"
AdornOps=set DEG_OEMDevMessageString "Customise attributes Before PPP :"


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/200.ValidateResponse/110.PostProcess/100.LogBeforePostProcess]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=CUST_PPP_IN_MDNString
Attributes=CUST_PPP_IN_IMSIString
Attributes=CUST_PPP_OUT_MDN
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
LogLevel=DEBUG2
Message=Customise attributes Before PPP :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/200.ValidateResponse/110.PostProcess/200.ProcessPostProcess]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=CUST_PPP_IN_MDNString
RequestAttributes=CUST_PPP_IN_IMSIString
RuleChain=CUSTRC_Apple_PC_PostProcess
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/200.ValidateResponse/110.PostProcess/300.CopyAfterPostProcess]

ClassName=AdornmentRule
AdornOps=copy CUST_PPP_IN_MDNString DEG_MDNString
AdornOps=copy CUST_PPP_IN_IMSIString DEG_OEMDevImsiString
AdornOps=copy CUST_PPP_OUT_MDN DEG_MDN
AdornOps=copy CUST_PPP_OUT_MDN DEG_CDevMobileNumberString
AdornOps=copy CUST_PPP_OUT_MDN DEG_SSL_MDN
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.06011"
AdornOps=set DEG_OEMDevMessageString "Customise attributes After PPP :"


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/200.ValidateResponse/110.PostProcess/300.LogAfterPostProcess]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=CUST_PPP_IN_MDNString
Attributes=CUST_PPP_IN_IMSIString
Attributes=CUST_PPP_OUT_MDN
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
LogLevel=DEBUG2
Message=Customise attributes After PPP :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/301D.ValidateRadiusResponseFromAAARuleChain/100.CheckAnswerTypeAndProcess/803.ProcessAccessAccept/200.ValidateResponse/200.GenerateAAACallEndOKAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=542.GenerateAAARadiusCallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/312.RadiusErrorRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=66.InitErrorLog
RuleNames=100.LogError
RuleNames=110.CheckEAPAKADefaultValue
RuleNames=200.GenerateAAACallEndErrorAuditData
RuleNames=300.GenerateAAAAkaRejectedEndAuditData

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/312.RadiusErrorRuleChain/66.InitErrorLog]
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.06012"
AdornOps=set DEG_OEMDevErrorMessageString "AAA Access Error:"

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/312.RadiusErrorRuleChain/100.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRadiusErrorString
Attributes=DEG_MDN
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=AAA Access Error:
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Check whether AAA can able to access.Please Contact HP Support.


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/312.RadiusErrorRuleChain/110.CheckEAPAKADefaultValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=210G.DEG21CheckEAPAKADefaultRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/312.RadiusErrorRuleChain/200.GenerateAAACallEndErrorAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=541.GenerateAAARadiusCallEndErrorAuditDataRuleChain
UseRuleChainManagerPool=true
#QXCM1001410528::NRB and Audit message not getting generated after AAA rejection
#When DFT supports version1 then version1 AkaRejectEndAuditDataRuleChain has to be included
[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/312.RadiusErrorRuleChain/300.GenerateAAAAkaRejectedEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,1

TrueRuleChain=100.AuditDataRule

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/312.RadiusErrorRuleChain/300.GenerateAAAAkaRejectedEndAuditData/100.AuditDataRule]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevXProtocolVersionString,=,2

TrueRuleChain=200.CreateEndAuditRecordV2
FalseRuleChain=100.CreateENDAuditRecordV1

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/312.RadiusErrorRuleChain/300.GenerateAAAAkaRejectedEndAuditData/100.AuditDataRule/200.CreateEndAuditRecordV2]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/312.RadiusErrorRuleChain/300.GenerateAAAAkaRejectedEndAuditData/100.AuditDataRule/100.CreateENDAuditRecordV1]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=505.GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/540.GenerateAAARadiusCallStartAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/540.GenerateAAARadiusCallStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=copy DEG_OEMDevAAAProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "DER"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/540.GenerateAAARadiusCallStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO AAA -> Sending AAA Radius message: "
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/540.GenerateAAARadiusCallStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
ClassName=AdornmentRule

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/540.GenerateAAARadiusCallStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/541.GenerateAAARadiusCallEndErrorAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/541.GenerateAAARadiusCallEndErrorAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_OEMDevAAAProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=setifnull DEG_CDevOutReturnCodeString 500
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "DER"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=setifnull DEG_OEMDevErrorMessageString ""
AdornOps=setifnull DEG_CDevProcessingErrorIdString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/541.GenerateAAARadiusCallEndErrorAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "After sending Radius message: "
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/541.GenerateAAARadiusCallEndErrorAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevProcessingErrorIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevProcessingErrorIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/541.GenerateAAARadiusCallEndErrorAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/541.GenerateAAARadiusCallEndErrorAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/542.GenerateAAARadiusCallEndOKAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/542.GenerateAAARadiusCallEndOKAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_OEMDevAAAProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "DER"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/542.GenerateAAARadiusCallEndOKAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO DEG -> After sending Radius message: "
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/542.GenerateAAARadiusCallEndOKAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/542.GenerateAAARadiusCallEndOKAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful execution of AAA call"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/542.GenerateAAARadiusCallEndOKAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/543.GenerateAAARadiusCallUnknownSubscriberEndErrorAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/543.GenerateAAARadiusCallUnknownSubscriberEndErrorAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_OEMDevAAAProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "IN"
#AdornOps=setifnull DEG_CDevOutReturnCodeString 500
AdornOps=copy DEG_OEMDevATNotificationValueInteger DEG_CDevOutReturnCodeString
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "DER"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=setifnull DEG_OEMDevErrorMessageString ""
AdornOps=setifnull DEG_CDevProcessingErrorIdString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=AdornmentRule

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/543.GenerateAAARadiusCallUnknownSubscriberEndErrorAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "After sending Radius message: "
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/543.GenerateAAARadiusCallUnknownSubscriberEndErrorAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevProcessingErrorIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevProcessingErrorIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/543.GenerateAAARadiusCallUnknownSubscriberEndErrorAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
#AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
AdornOps=set DEG_AuditNRBMessageString "Unknown Subscriber"

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorRadius/RuleChains/543.GenerateAAARadiusCallUnknownSubscriberEndErrorAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true