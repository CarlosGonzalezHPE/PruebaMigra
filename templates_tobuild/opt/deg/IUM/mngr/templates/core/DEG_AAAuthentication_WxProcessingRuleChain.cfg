
[/templates/DEG/AAAuthentication/WxProcessingRuleChain]

[/templates/DEG/AAAuthentication/WxProcessingRuleChain/Connectors]

ClassName=com.hp.siu.serverutils.ConnectorManager
ConnectorNames=100.DiameterClientAdapter

[/templates/DEG/AAAuthentication/WxProcessingRuleChain/Connectors/100.DiameterClientAdapter]

ApplicationId=16777219
ApplicationIdAttribute=DEG_AAAWxAppIdLong
AuthApplicationIds=16777219
ClassName=com.hp.usage.diameter.DiameterAdapter
CommandCodeAttribute=DEG_AAAWxCommandcodeInteger
E2EAttribute=DEG_AAAWxE2ELong
ErrorFlagAttribute=DEG_AAAWxErrorFlagInteger
HbHAttribute=DEG_AAAWxHbHLong
JNDIName=AAA Client
NeedResponseAttribute=DEG_AAAWxNeedResponseInteger
PersistentConnectionAddress=${AAA_WX_HSS_DIAMETER_SERVER_HOST_NAME},${AAA_WX_DIAMETER_CLIENT_REALM}
ProductName=AAA Session Server
ProxiableFlagAttribute=DEG_AAAWxProxiableFlagInteger
RemoteHostAttribute=DEG_AAAWxDesthostString
RemoteRealmAttribute=DEG_AAAWxDestRealmString
RequestFlagAttribute=DEG_AAAWxRequestFlagInteger
RetransmitFlagAttribute=DEG_AAAWxRetransmitFlagInteger
RetryTimeouts=3,20
ServerHost=${AAA_WX_DIAMETER_CLIENT_HOST_NAME}
ServerIP=${AAA_DIAMETER_HOST_IP}
ServerRealm=${AAA_WX_DIAMETER_CLIENT_REALM}
StopAttribute=DEG_AAAWxStopInteger


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/Connectors/100.DiameterClientAdapter/DecoderFactory]

ClassName=com.hp.usage.diameter.codec.AVPDecoderFactory
DecoderMap=303,0,WxDecoder
DecoderMap=303,1,WxDecoder


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/Connectors/100.DiameterClientAdapter/DecoderFactory/WxDecoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpDecoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterWx/MultimediaAuthAnswerWx


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/Connectors/100.DiameterClientAdapter/EncoderFactory]

ClassName=com.hp.usage.diameter.codec.AVPEncoderFactory
EncoderMap=303,0,WxEncoder
EncoderMap=303,1,WxEncoder


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/Connectors/100.DiameterClientAdapter/EncoderFactory/WxEncoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpEncoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterWx/MultimediaAuthRequestWx


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/Connectors/100.DiameterClientAdapter/StateMachinePool]

ClassName=com.hp.usage.diameter.StateMachinePool
ThreadPoolSize=10


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/Connectors/100.DiameterClientAdapter/StateMachinePool/StateMachine]

ClassName=com.hp.usage.diameter.GenericStateMachine
MessageCodeAttribute=DEG_AAAWxCommandcodeInteger
MessageDirectionAttribute=DEG_AAAWxRequestFlagInteger
RuleChainMapping=303,0,400.HSSMAPGWProcessingRuleChain
RuleChainMapping=303,1,400.HSSMAPGWProcessingRuleChain


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/Connectors/100.DiameterClientAdapter/Transport]

ClassName=com.hp.usage.diameter.DiameterTCPTransport
HostName=${AAA_DIAMETER_HOST_IP}
HostsMap=${AAA_WX_HSS_DIAMETER_SERVER_HOST_NAME},${AAA_WX_DIAMETER_CLIENT_REALM},${AAA_HSS_DIAMETER_SERVER_IP},${HSS_DIAMETER_SERVER_PORT}
PortNumber=${AAA_DIAMETER_CLIENT_PORT}


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains]

RuleChainNames=400.HSSMAPGWProcessingRuleChain


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain]

ClassName=RuleChain
RuleNames=100.Initialise
RuleNames=200.CheckIfNewSession
RuleNames=300.UpdateAAASession
RuleNames=400.ProcessWxRequest
RuleNames=500.ValidateWxRequest
RuleNames=600.GenerateDiameterWxCallEndAuditData


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/100.Initialise]

#AdornOps=set DEG_AAARATTypeInteger 2001
#AdornOps=set DEG_AAAANIDString ""
#AdornOps=set DEG_AAAHSSRATTypeInteger 0
AdornOps=copy DEG_EAPUserIdentityString DEG_AAASubscriberIdString
AdornOps=set DEG_AAAErrorProcessingFlagInteger 0
AdornOps=setifnull DEG_EAPUserIdentityString ""
AdornOps=setifnull DEG_EAPAKAAUTSBinary 0
AdornOps=set DEG_AAASessionIdString ""
AdornOps=set DEG_AAAVendorIdLong 16777219
AdornOps=set DEG_AAAAuthApplicationIdInteger 16777219
AdornOps=set DEG_AAAOriginHostString ${AAA_WX_DIAMETER_CLIENT_HOST_NAME}
AdornOps=set DEG_AAAOriginRealmString ${AAA_WX_DIAMETER_CLIENT_REALM}
AdornOps=set DEG_AAADesthostString ${AAA_WX_HSS_DIAMETER_SERVER_HOST_NAME}
AdornOps=set DEG_AAADestRealmString ${AAA_SWX_DIAMETER_CLIENT_REALM}
AdornOps=copy DEG_AAADesthostString DEG_AAAWxDesthostString
AdornOps=copy DEG_AAADestRealmString DEG_AAAWxDestRealmString
AdornOps=set DEG_AAAVisitedNetworkIdBinary 0
AdornOps=set DEG_AAAIMEIString ""
AdornOps=set DEG_AAAMEIDBinary 0
AdornOps=set DEG_AAASoftwareVersionString ""
AdornOps=set DEG_AAASIPItemNumberLong 0
AdornOps=set DEG_AAASIPAuthenticationSchemeString ""
AdornOps=set DEG_AAASIPAuthenticateBinary 0
AdornOps=set DEG_AAASIPAuthorizationBinary 0
AdornOps=set DEG_AAASIPAuthenticationContextBinary 0
AdornOps=set DEG_AAAConfidentialityKeyBinary 0
AdornOps=set DEG_AAAIntegrityKeyBinary 0
AdornOps=set DEG_AAASIPNumberAuthItemsLong 0
AdornOps=set DEG_AAAAuthSessionState 0
AdornOps=set DEG_AAAWxProxiableFlagInteger 1
AdornOps=set DEG_AAAWxRequestFlagInteger 1
AdornOps=set DEG_AAAWxAppIdLong 16777219
AdornOps=setsystime DEG_AAAHSSProcessStartTimeLong
AdornOps=copy DEG_AAASubscriberIdString DEG_AAAUserNameString
AdornOps=set DEG_AAAHSSsessionIDString ""
AdornOps=set DEG_AAAHSSResultCodeLong 0
AdornOps=set DEG_AAAHSSOriginHostString ""
AdornOps=set DEG_AAAHSSOriginRealmString ""
AdornOps=set DEG_AAAHSSSubscriberIdString ""
AdornOps=set DEG_AAAAuthSessionState 0
AdornOps=set DEG_AAAHSSSIPNumberAuthItemsLong 0
AdornOps=set DEG_AAAResultCodeString 0
AdornOps=set DEG_AAAHSSNASPortTypeInteger 0
AdornOps=set DEG_AAAHSSProxyHostString ""
AdornOps=set DEG_AAAHSSProxyStateBinary 0
AdornOps=set DEG_AAAHSSRouteRecordString ""
AdornOps=set DEG_HSSRANDList null
AdornOps=set DEG_AAARANDList null
AdornOps=set DEG_HSSCKList null
AdornOps=set DEG_AAACKList null
AdornOps=set DEG_HSSIKList null
AdornOps=set DEG_AAAIKList null
AdornOps=set DEG_HSSXRESList null
AdornOps=set DEG_AAAXRESList null
AdornOps=set DEG_HSSAUTNList null
AdornOps=set DEG_AAAAUTNList null
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/200.CheckIfNewSession]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_EAPAKAOperation,=,"RE_SYNC"
FalseRuleChain=100.GenerateAuthID
TrueRuleChain=200.SetWAIT_FOR_REAUTHVECTORS_FROM_AUC


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/200.CheckIfNewSession/100.GenerateAuthID]

AdornOps=setsystime DEG_AAAAUCSessionIdTimeInMilliSecs
AdornOps=% DEG_AAAAUCSessionIdTimeInMilliSecs 1000 DEG_AAAAUCSessionIdTimeInNanoSecsLong
AdornOps=* DEG_AAAAUCSessionIdTimeInNanoSecsLong 1000000 DEG_AAAAUCSessionIdTimeInNanoSecsLong
AdornOps=/ DEG_AAAAUCSessionIdTimeInMilliSecs 1000 DEG_AAAAUCSessionIdTimeInSecs
AdornOps=set DEG_AAASourceNameString ${AAA_PROCESS_NAME}
AdornOps=set DEG_AAAAUCSessionIdString ""
AdornOps=+ DEG_AAAAUCSessionIdString DEG_AAASourceNameString DEG_AAAAUCSessionIdString
AdornOps=+ DEG_AAAAUCSessionIdString ; DEG_AAAAUCSessionIdString
AdornOps=+ DEG_AAAAUCSessionIdString ${AAA_WX_DIAMETER_CLIENT_HOST_NAME} DEG_AAAAUCSessionIdString
AdornOps=+ DEG_AAAAUCSessionIdString ; DEG_AAAAUCSessionIdString
AdornOps=+ DEG_AAAAUCSessionIdString DEG_AAAAUCSessionIdTimeInSecs DEG_AAAAUCSessionIdString
AdornOps=+ DEG_AAAAUCSessionIdString ; DEG_AAAAUCSessionIdString
AdornOps=+ DEG_AAAAUCSessionIdString DEG_AAAAUCSessionIdTimeInNanoSecsLong DEG_AAAAUCSessionIdString
AdornOps=+ DEG_AAAAUCSessionIdString ; DEG_AAAAUCSessionIdString
AdornOps=+ DEG_AAAAUCSessionIdString DEG_AAAImsiString DEG_AAAAUCSessionIdString
AdornOps=copy DEG_EAPUserIdentityString DEG_USERIDENTITY
AdornOps=copy DEG_AAAAUCSessionIdString DEG_AAA_AUC_ID
AdornOps=set DEG_STATUS "WAIT_FOR_AUTHVECTORS_FROM_AUC"
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/200.CheckIfNewSession/200.SetWAIT_FOR_REAUTHVECTORS_FROM_AUC]

AdornOps=copy DEG_AAA_AUC_ID DEG_AAAAUCSessionIdString
AdornOps=copy DEG_EAPAKAAUTSBinary DEG_AAASIPAuthenticateBinary
AdornOps=copy DEG_EAPUserIdentityString DEG_USERIDENTITY
AdornOps=set DEG_STATUS "WAIT_FOR_REAUTHVECTORS_FROM_AUC"
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/300.UpdateAAASession]

ClassName=RuleChain
RuleNames=100.InitAAASessionUpdate
RuleNames=200.ExecuteAAASessionUpdate
RuleNames=300.CheckAAASessionUpdateStatus


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/300.UpdateAAASession/100.InitAAASessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_AAA_SESSIONS
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 0
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/300.UpdateAAASession/200.ExecuteAAASessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_USERIDENTITY,DEG_USERIDENTITY
MapAttributes=DEG_AAA_AUC_ID,DEG_AAA_AUC_ID
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=2.MatchByUserIdentity
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/300.UpdateAAASession/300.CheckAAASessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/300.UpdateAAASession/300.CheckAAASessionUpdateStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access entry in DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0801"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing SWx"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/300.UpdateAAASession/300.CheckAAASessionUpdateStatus/110.ErrorLog]

Attributes=DEG_USERIDENTITY
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing SWx
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.ProcessWxRequest]

ClassName=RuleChain
RuleNames=000.GetActiveMonitoringSessionByMDN
RuleNames=001.GenerateAAADiameterWxCallStartAuditData
RuleNames=100.NMEToSNMEConversion
RuleNames=110.DiameterClientRule
RuleNames=120.CheckForTimeOut
RuleNames=130.SNMEToNMEConversion


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.ProcessWxRequest/000.GetActiveMonitoringSessionByMDN]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
TrueRuleChain=100.InvokeReadMonitoringSessionRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.ProcessWxRequest/000.GetActiveMonitoringSessionByMDN/100.InvokeReadMonitoringSessionRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=008.ReadMonitoringSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.ProcessWxRequest/001.GenerateAAADiameterWxCallStartAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
TrueRuleChain=100.InvokeAAADiameterWxCallStartAuditData


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.ProcessWxRequest/001.GenerateAAADiameterWxCallStartAuditData/100.InvokeAAADiameterWxCallStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=909.GenerateAAADiameterHSSCallStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.ProcessWxRequest/100.NMEToSNMEConversion]

#NMEToStructuredNMEMap=DEG_AAAAcctApplicationIdInteger,vendorSpecificApplicationId[0].acctApplicationId
#NMEToStructuredNMEMap=DEG_AAARATTypeInteger,RAT_type
#NMEToStructuredNMEMap=DEG_AAAANIDString,ANID
#NMEToStructuredNMEMap=DEG_AAAIMEIString,terminalInformation[0].IMEI
#NMEToStructuredNMEMap=DEG_AAAMEIDBinary,terminalInformation[0].MEID
#NMEToStructuredNMEMap=DEG_AAASoftwareVersionString,terminalInformation[0].softwareVersion
#NMEToStructuredNMEMap=DEG_AAAHSSResultCodeLong,resultCode,0
ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAAAUCSessionIdString,sessionID
NMEToStructuredNMEMap=DEG_AAAVendorIdLong,vendorSpecificApplicationId[0].vendorId
NMEToStructuredNMEMap=DEG_AAAAuthApplicationIdInteger,vendorSpecificApplicationId[0].authApplicationId
NMEToStructuredNMEMap=DEG_AAAOriginHostString,originHost
NMEToStructuredNMEMap=DEG_AAAOriginRealmString,originRealm
NMEToStructuredNMEMap=DEG_AAADesthostString,destinationHost
NMEToStructuredNMEMap=DEG_AAADestRealmString,destinationRealm
NMEToStructuredNMEMap=DEG_EAPUserIdentityString,userName
NMEToStructuredNMEMap=DEG_AAAAuthSessionState,authSessionState
NMEToStructuredNMEMap=DEG_AAAVisitedNetworkIdBinary,visitedNetworkIdentifier
NMEToStructuredNMEMap=DEG_AAASIPItemNumberLong,SIPAuthDataItem[0].SIPItemNumber
NMEToStructuredNMEMap=DEG_AAASIPAuthenticationSchemeString,SIPAuthDataItem[0].SIPAuthenticationScheme
NMEToStructuredNMEMap=DEG_AAASIPAuthenticateBinary,SIPAuthDataItem[0].SIPAuthenticate
NMEToStructuredNMEMap=DEG_AAASIPAuthorizationBinary,SIPAuthDataItem[0].SIPAuthorization
NMEToStructuredNMEMap=DEG_AAASIPAuthenticationContextBinary,SIPAuthDataItem[0].SIPAuthenticationContext
NMEToStructuredNMEMap=DEG_AAAConfidentialityKeyBinary,SIPAuthDataItem[0].confidentialityKey
NMEToStructuredNMEMap=DEG_AAAIntegrityKeyBinary,SIPAuthDataItem[0].integrityKey
NMEToStructuredNMEMap=DEG_AAASIPNumberAuthItemsLong,SIPNumberAuthItems
NMEToStructuredNMEMap=DEG_AAAHSSNASPortTypeInteger,nasPortType,0
NMEToStructuredNMEMap=DEG_AAAHSSProxyHostString,proxyInfo[0].proxyHost,""
NMEToStructuredNMEMap=DEG_AAAHSSProxyStateBinary,proxyInfo[0].proxyState,0
NMEToStructuredNMEMap=DEG_AAAHSSRouteRecordString,routeRecord,""
SNMEType=diameterWx:MultimediaAuthRequestWx


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.ProcessWxRequest/110.DiameterClientRule]

ApplicationId=16777219
ClassName=com.hp.usage.diameter.DiameterClientRule
CommandCode=303
DCJNDIName=AAA Client
DestinationHostAttribute=DEG_AAAWxDesthostString
DestinationRealmAttribute=DEG_AAAWxDestRealmString
DisconnectAttribute=disc
E2EAttribute=DEG_AAAWxE2ELong
ErrorResultFlagAttribute=errFlag
HbHAttribute=DEG_AAAWxHbHLong
ProxiableFlagAttribute=DEG_AAAWxProxiableFlagInteger
RequestFlagAttribute=DEG_AAAWxRequestFlagInteger
Retries=0
TimeOut=5000
TimeOutFlagAttribute=toFlag
WaitForConnection=false


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.ProcessWxRequest/110.DiameterClientRule/Decoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpDecoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterWx/MultimediaAuthAnswerWx


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.ProcessWxRequest/110.DiameterClientRule/Encoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpEncoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterWx/MultimediaAuthRequestWx


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.ProcessWxRequest/120.CheckForTimeOut]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=toFlag,!=,0
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.LogError


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.ProcessWxRequest/120.CheckForTimeOut/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "HSS could not reply in configured timeout period"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0802"
AdornOps=set DEG_OEMDevErrorMessageString "HSS Request Timeout Error :"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.ProcessWxRequest/120.CheckForTimeOut/110.LogError]

Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAAExperimentalResultInteger
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=HSS Request Timeout Error :
NullAlso=true
#Action=Invalid Response From HSS . Please contact HP Admin

[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.ProcessWxRequest/130.SNMEToNMEConversion]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
TrueRuleChain=001.ExtractMandatoryWxAVPs


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/400.ProcessWxRequest/130.SNMEToNMEConversion/001.ExtractMandatoryWxAVPs]

#StructuredNMEToNMEMap=RAT_type,DEG_AAAHSSRATTypeInteger,0
#StructuredNMEToNMEMap=proxyInfo[0].proxyHost,DEG_AAAHSSProxyHostString,""
#StructuredNMEToNMEMap=proxyInfo[0].proxyState,DEG_AAAHSSProxyStateBinary,0
#StructuredNMEToNMEMap=routeRecord,DEG_AAAHSSRouteRecordString,""
ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=false
SNMEType=diameterWx:MultimediaAuthAnswerWx
StructuredNMEToNMEMap=sessionID,DEG_AAAHSSsessionIDString,""
StructuredNMEToNMEMap=resultCode,DEG_AAAHSSResultCodeLong,0
StructuredNMEToNMEMap=originHost,DEG_AAAHSSOriginHostString,""
StructuredNMEToNMEMap=originRealm,DEG_AAAHSSOriginRealmString,""
StructuredNMEToNMEMap=userName,DEG_AAAHSSSubscriberIdString,""
StructuredNMEToNMEMap=authSessionState,DEG_AAAAuthSessionState,0
StructuredNMEToNMEMap=SIPNumberAuthItems,DEG_AAAHSSSIPNumberAuthItemsLong,0


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
DecodeVectors=400.DecodeAuthVectors
ExtractAuthVectors=500.ValidateAuthVectors
Operations=DoAll
TrueRuleChain=WxProcessingResult
TrueRuleChain=ValidateWxAVPs
TrueRuleChain=DecodeVectors
TrueRuleChain=ExtractAuthVectors
ValidateWxAVPs=300.ValidateWxAVPs
WxProcessingResult=200.CheckWxResultCode


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/200.CheckWxResultCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAHSSResultCodeLong,!=,2001
Conditions=errFlag,!=,0
Operations=or
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.LogError


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/200.CheckWxResultCode/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0803"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid Respnse from HSS"
AdornOps=set DEG_AAAErrorMessageString "Invalid Response from HSS"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/200.CheckWxResultCode/110.LogError]

Attributes=DEG_AAAHSSResultCodeLong
Attributes=errFlag
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAAExperimentalResultInteger
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=Invalid Response From HSS :
NullAlso=true
#Action=Invalid Response From HSS .Contact HP Admin

[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Operations=DoAll
TrueRuleChain=ValidateSessionID
TrueRuleChain=ValidateOriginHost
TrueRuleChain=ValidateOriginRealm
TrueRuleChain=ValidateSubscriberID
TrueRuleChain=ValidateSessionState
ValidateOriginHost=110.ValidateOriginHost
ValidateOriginRealm=120.ValidateOriginRealm
ValidateSessionID=100.ValidateSessionId
ValidateSessionState=140.ValidateSessionState
ValidateSubscriberID=130.ValidateSubscriberID


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs/100.ValidateSessionId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAHSSsessionIDString,=,""
TrueRuleChain=100.SetValidationError
TrueRuleChain=110.LogValidationError


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs/100.ValidateSessionId/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Diameter Wx Session Id is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0804"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP Session Id not present in incoming response From HSS :"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs/100.ValidateSessionId/110.LogValidationError]

Attributes=DEG_AAAHSSsessionIDString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP Session Id not present in incoming response From HSS :
NullAlso=true
#Action=AVP Session Id not present in incoming response From HSS.

[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs/110.ValidateOriginHost]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAHSSOriginHostString,=,""
TrueRuleChain=100.SetValidationError
TrueRuleChain=110.LogValidationError


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs/110.ValidateOriginHost/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Diameter Wx Origin Host is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0805"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP Origin Host is not present in incoming response From HSS :"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs/110.ValidateOriginHost/110.LogValidationError]

Attributes=DEG_AAAHSSsessionIDString
Attributes=DEG_AAAHSSOriginHostString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP Origin Host is not present in incoming response From HSS :
NullAlso=true


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs/120.ValidateOriginRealm]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAHSSOriginRealmString,=,""
TrueRuleChain=100.SetValidationError
TrueRuleChain=110.LogValidationError


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs/120.ValidateOriginRealm/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Diameter Wx Origin Realm is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0806"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP Origin Realm is not present in incoming response From HSS :"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs/120.ValidateOriginRealm/110.LogValidationError]

Attributes=DEG_AAAHSSsessionIDString
Attributes=DEG_AAAHSSOriginRealmString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP Origin Realm is not present in incoming response From HSS :
NullAlso=true
#Action=AVP Origin Realm is not present in incoming response From HSS.

[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs/130.ValidateSubscriberID]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAHSSSubscriberIdString,=,""
TrueRuleChain=100.SetValidationError
TrueRuleChain=110.LogValidationError


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs/130.ValidateSubscriberID/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Diameter Wx AVP UserName is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0807"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP UserName is not present in incoming response From HSS :"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs/130.ValidateSubscriberID/110.LogValidationError]

Attributes=DEG_AAAHSSsessionIDString
Attributes=DEG_AAAHSSSubscriberIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP UserName is not present in incoming response From HSS :
NullAlso=true
#Action=AVP UserName is not present in incoming response From HSS .

[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs/140.ValidateSessionState]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAAuthSessionState,=,0
TrueRuleChain=100.SetValidationError
TrueRuleChain=110.LogValidationError


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs/140.ValidateSessionState/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Diameter Wx AVP Auth Session State is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0808"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP AuthSessionState is not present in incoming response From HSS :"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/300.ValidateWxAVPs/140.ValidateSessionState/110.LogValidationError]

Attributes=DEG_AAAHSSsessionIDString
Attributes=DEG_AAAAuthSessionState
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP AuthSessionState is not present in incoming response From HSS :
NullAlso=true
#Action=AVP AuthSessionState is not present in incoming response From HSS .

[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
TrueRuleChain=300.GenerateSIPAuthDataItemList
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=310.LogSIPAuthDataItemList


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList]

ClassName=SplitArrayRule
SplitAttribute=SIPAuthDataItem
SplitRules=001.Initialise
SplitRules=002.SNMEToNME
SplitRules=100.SetErrorInfo
SplitRules=003.LogNME
SplitRules=004.GenerateSIPItemNumberList
SplitRules=005.GenerateSIPAuthSchemeList
SplitRules=006.GenerateSIPAuthenticateList
SplitRules=007.GenerateSIPAuthorizationList
SplitRules=008.GenerateSIPAuthenticationContextList
SplitRules=009.GenerateSIPCKList
SplitRules=010.GenerateSIPIKList


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/001.Initialise]

AdornOps=set DEG_AAAHSSSIPItemNumberString ""
AdornOps=set DEG_AAAHSSSIPAuthenticationSchemeString ""
AdornOps=set DEG_AAAHSSSIPAuthenticateBinary 0
AdornOps=set DEG_AAAHSSSIPAuthorizationBinary 0
AdornOps=set DEG_AAAHSSSIPAuthenticationContextBinary 0
AdornOps=set DEG_AAAHSSConfidentialityKeyBinary 0
AdornOps=set DEG_AAAHSSIntegrityKeyBinary 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/002.SNMEToNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
SNMEType=diameterWx:MultimediaAuthAnswerWx
StructuredNMEToNMEMap=SIPAuthDataItem[0].SIPItemNumber,DEG_AAAHSSSIPItemNumberString,""
StructuredNMEToNMEMap=SIPAuthDataItem[0].SIPAuthenticationScheme,DEG_AAAHSSSIPAuthenticationSchemeString,""
StructuredNMEToNMEMap=SIPAuthDataItem[0].SIPAuthenticate,DEG_AAAHSSSIPAuthenticateBinary,0
StructuredNMEToNMEMap=SIPAuthDataItem[0].SIPAuthorization,DEG_AAAHSSSIPAuthorizationBinary,0
StructuredNMEToNMEMap=SIPAuthDataItem[0].SIPAuthenticationContext,DEG_AAAHSSSIPAuthenticationContextBinary,0
StructuredNMEToNMEMap=SIPAuthDataItem[0].confidentialityKey,DEG_AAAHSSConfidentialityKeyBinary,0
StructuredNMEToNMEMap=SIPAuthDataItem[0].integrityKey,DEG_AAAHSSIntegrityKeyBinary,0

[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0809"
AdornOps=set DEG_OEMDevMessageString "SIP Auth Data Item Attributes :"

[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/003.LogNME]

Attributes=DEG_AAAHSSSIPItemNumberString
Attributes=DEG_AAAHSSSIPAuthenticationSchemeString
Attributes=DEG_AAAHSSSIPAuthenticateBinary
Attributes=DEG_AAAHSSSIPAuthorizationBinary
Attributes=DEG_AAAHSSSIPAuthenticationContextBinary
Attributes=DEG_AAAHSSConfidentialityKeyBinary
Attributes=DEG_AAAHSSIntegrityKeyBinary
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=SIP Auth Data Item Attributes :


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/004.GenerateSIPItemNumberList]

ClassName=AddToListAttributeRule
InputAttribute=DEG_AAAHSSSIPItemNumberString
ListAttribute=DEG_AAAHSSSIPItemNumberList


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/005.GenerateSIPAuthSchemeList]

ClassName=AddToListAttributeRule
InputAttribute=DEG_AAAHSSSIPAuthenticationSchemeString
ListAttribute=DEG_AAAHSSSIPAuthenticationSchemeList


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/006.GenerateSIPAuthenticateList]

ClassName=RuleChain
RuleNames=001.CopyBinaryToString
RuleNames=002.AddRANDToList
RuleNames=003.AddAUTNToList


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/006.GenerateSIPAuthenticateList/001.CopyBinaryToString]

AdornOps=slice 0 16 DEG_AAAHSSSIPAuthenticateBinary DEG_HSSRANDBinary
AdornOps=slice 16 - DEG_AAAHSSSIPAuthenticateBinary DEG_HSSAUTNBinary
AdornOps=copy DEG_HSSRANDBinary DEG_AAARANDString
AdornOps=copy DEG_HSSAUTNBinary DEG_AAAAUTNString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/006.GenerateSIPAuthenticateList/002.AddRANDToList]

ClassName=AddToListAttributeRule
InputAttribute=DEG_AAARANDString
ListAttribute=DEG_HSSRANDList


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/006.GenerateSIPAuthenticateList/003.AddAUTNToList]

ClassName=AddToListAttributeRule
InputAttribute=DEG_AAAAUTNString
ListAttribute=DEG_HSSAUTNList


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/007.GenerateSIPAuthorizationList]

ClassName=RuleChain
RuleNames=001.CopyBinaryToString
RuleNames=002.AddXRESToList


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/007.GenerateSIPAuthorizationList/001.CopyBinaryToString]

AdornOps=copy DEG_AAAHSSSIPAuthorizationBinary DEG_AAAXRESString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/007.GenerateSIPAuthorizationList/002.AddXRESToList]

ClassName=AddToListAttributeRule
InputAttribute=DEG_AAAXRESString
ListAttribute=DEG_HSSXRESList


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/008.GenerateSIPAuthenticationContextList]

ClassName=RuleChain
RuleNames=001.CopyBinaryToString
RuleNames=002.AddAuthContextToList


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/008.GenerateSIPAuthenticationContextList/001.CopyBinaryToString]

AdornOps=copy DEG_AAAHSSSIPAuthenticationContextBinary DEG_AAAHSSSIPAuthenticationContextString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/008.GenerateSIPAuthenticationContextList/002.AddAuthContextToList]

ClassName=AddToListAttributeRule
InputAttribute=DEG_AAAHSSSIPAuthenticationContextString
ListAttribute=DEG_AAAHSSSIPAuthenticationContextList


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/009.GenerateSIPCKList]

ClassName=RuleChain
RuleNames=001.CopyBinaryToString
RuleNames=002.AddCKToList


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/009.GenerateSIPCKList/001.CopyBinaryToString]

AdornOps=copy DEG_AAAHSSConfidentialityKeyBinary DEG_AAACkString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/009.GenerateSIPCKList/002.AddCKToList]

ClassName=AddToListAttributeRule
InputAttribute=DEG_AAACkString
ListAttribute=DEG_HSSCKList


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/010.GenerateSIPIKList]

ClassName=RuleChain
RuleNames=001.CopyBinaryToString
RuleNames=002.AddIKToList


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/010.GenerateSIPIKList/001.CopyBinaryToString]

AdornOps=copy DEG_AAAHSSIntegrityKeyBinary DEG_AAAIkString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/300.GenerateSIPAuthDataItemList/010.GenerateSIPIKList/002.AddIKToList]

ClassName=AddToListAttributeRule
InputAttribute=DEG_AAAIkString
ListAttribute=DEG_HSSIKList

[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0810"
AdornOps=set DEG_OEMDevMessageString "SIP Auth Data Item Lists :"

[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/400.DecodeAuthVectors/310.LogSIPAuthDataItemList]

Attributes=DEG_AAAHSSSIPItemNumberList
Attributes=DEG_AAAHSSSIPAuthenticationSchemeList
Attributes=DEG_HSSRANDList
Attributes=DEG_HSSAUTNList
Attributes=DEG_HSSXRESList
Attributes=DEG_AAAHSSSIPAuthenticationContextList
Attributes=DEG_HSSCKList
Attributes=DEG_HSSIKList
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=SIP Auth Data Item Lists :


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/500.ValidateAuthVectors]

ClassName=RuleChain
RuleNames=100.InitialiseAuthVectors
RuleNames=200.CheckIfNull


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/500.ValidateAuthVectors/100.InitialiseAuthVectors]

AdornOps=setifnull DEG_HSSRANDList null
AdornOps=setifnull DEG_HSSCKList null
AdornOps=setifnull DEG_HSSIKList null
AdornOps=setifnull DEG_HSSXRESList null
AdornOps=setifnull DEG_HSSAUTNList null
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/500.ValidateAuthVectors/200.CheckIfNull]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_HSSRANDList,=,null
Conditions=DEG_HSSCKList,=,null
Conditions=DEG_HSSIKList,=,null
Conditions=DEG_HSSXRESList,=,null
Conditions=DEG_HSSAUTNList,=,null
FalseRuleChain=100.LogEAPAKAAuthVectors
FalseRuleChain=110.SetEAPAKAAuthVectors
Operations=or,or,or,or
TrueRuleChain=200.SetAAAErrorResponse

[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/500.ValidateAuthVectors/200.CheckIfNull/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0811"
AdornOps=set DEG_OEMDevMessageString "Valid EAP-AKA Auth Vectors From HSS :"

[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/500.ValidateAuthVectors/200.CheckIfNull/100.LogEAPAKAAuthVectors]

Attributes=DEG_HSSRANDList
Attributes=DEG_HSSCKList
Attributes=DEG_HSSIKList
Attributes=DEG_HSSXRESList
Attributes=DEG_HSSAUTNList
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Valid EAP-AKA Auth Vectors From HSS :
NullAlso=true


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/500.ValidateAuthVectors/200.CheckIfNull/110.SetEAPAKAAuthVectors]

AdornOps=copy DEG_HSSRANDList DEG_AAARANDList
AdornOps=copy DEG_HSSCKList DEG_AAACKList
AdornOps=copy DEG_HSSIKList DEG_AAAIKList
AdornOps=copy DEG_HSSXRESList DEG_AAAXRESList
AdornOps=copy DEG_HSSAUTNList DEG_AAAAUTNList
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/500.ValidateWxRequest/500.ValidateAuthVectors/200.CheckIfNull/200.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Invalid AKA Auth vectors from HSS"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/600.GenerateDiameterWxCallEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
FalseRuleChain=200.GenerateDiameterWxEndErrorAuditData
TrueRuleChain=100.GenerateDiameterWxEndOkAuditData


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/600.GenerateDiameterWxCallEndAuditData/100.GenerateDiameterWxEndOkAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=911.GenerateAAADiameterHSSCallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/WxProcessingRuleChain/RuleChains/400.HSSMAPGWProcessingRuleChain/600.GenerateDiameterWxCallEndAuditData/200.GenerateDiameterWxEndErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=910.GenerateAAADiameterHSSCallEndErrorAuditDataRuleChain
UseRuleChainManagerPool=true