

[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core]


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains]

RuleChainNames=350.DEG30ProcessOTPAuthStep2RuleChain
RuleChainNames=350A.DEG30ProcessOTPActionRuleChain
RuleChainNames=350B.DEG30UpdateSslSessionStateRuleChain
RuleChainNames=350C.DEG30ValidateAndProcessOTPRuleChain
RuleChainNames=350D.DEG30GenerateOEMResponseRuleChain
RuleChainNames=350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain
RuleChainNames=350F.DEG30ProcessOTPRuleChain
RuleChainNames=851.DEG30GenerateOTPChallengeStartAuditDataRuleChain
RuleChainNames=852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain
RuleChainNames=853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain
RuleChainNames=854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
RuleChainNames=855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain
RuleChainNames=856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain
RuleChainNames=857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckOTPValue
RuleNames=200.GenerateOTPPayloadEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevOTPLong,=,99999
FalseRuleChain=120.ValidationAndProcessOTP
FalseRuleChain=130.SetResponseHandler
TrueRuleChain=200.Set400Error
TrueRuleChain=170.SetResponseHandler
TrueRuleChain=180.SetErrorInfo
TrueRuleChain=220.LogError


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/120.ValidationAndProcessOTP]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350A.DEG30ProcessOTPActionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/130.SetResponseHandler]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,starts,200
FalseRuleChain=200.SetEmptyResponse
TrueRuleChain=100.SetTextResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/130.SetResponseHandler/100.SetTextResponse]

AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"
AdornOps=set DEG_OEMDevConnectionString "close"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/130.SetResponseHandler/200.SetEmptyResponse]

AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/170.SetResponseHandler]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,starts,200
FalseRuleChain=200.SetEmptyResponse
TrueRuleChain=100.SetTextResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/170.SetResponseHandler/100.SetTextResponse]

AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"
AdornOps=set DEG_OEMDevConnectionString "close"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/170.SetResponseHandler/200.SetEmptyResponse]

AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/180.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1401"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid Action -OTPPayload expected"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/200.Set400Error]

AdornOps=set DEG_SSL_REQUEST_STATE "400C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/220.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevOTPLong
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Request processed with error - Invalid Action - OTPPayload expected: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/200.GenerateOTPPayloadEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,1
TrueRuleChain=100.AuthenticationSMACRejected


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/200.GenerateOTPPayloadEndAuditData/100.AuthenticationSMACRejected]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.UpdateSslSessionState
RuleNames=210.CheckOTP
RuleNames=215.SetAuditTransactionType
RuleNames=220.LogOTPChallengeWait
RuleNames=400.GenerateOEMResponse
RuleNames=230.InitSslSessionAfterEAPAKA
RuleNames=300.UpdateSslSessionAfterEAPAKA
RuleNames=310.CheckSslSessionUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/110.UpdateSslSessionState]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350B.DEG30UpdateSslSessionStateRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/210.CheckOTP]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350C.DEG30ValidateAndProcessOTPRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/215.SetAuditTransactionType]

AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1402"
AdornOps=set DEG_OEMDevMessageString "Perform OTPChallengefor AkaWait"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/220.LogOTPChallengeWait]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Perform OTPChallengefor AkaWait: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/230.InitSslSessionAfterEAPAKA]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=setifnull DEGDROID_SSL_COOKIE_ID ""
AdornOps=setifnull DEGDROID_SSL_OTP 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/300.UpdateSslSessionAfterEAPAKA]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEGDROID_SSL_COOKIE_ID,DEGDROID_SSL_COOKIE_ID
MapAttributes=DEGDROID_SSL_OTP,DEGDROID_SSL_OTP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorMessage
TrueRuleChain=110.LogError


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus/100.SetErrorMessage]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1403"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_SSL_SESSION store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus/110.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus/120.GenerateEapAkaPayloadSystemErrorEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.GenerateAuditData


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus/120.GenerateEapAkaPayloadSystemErrorEndAuditData/100.GenerateAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorMessage
TrueRuleChain=110.LogError


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.SetErrorMessage]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1404"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus/200.CheckKeyExists/110.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/400.GenerateOEMResponse]

CheckTypeOfResponse=100.CheckTypeOfResponse
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
GenerateEAPAkaPayloadEndAuditData=200.GenerateEAPAkaPayloadEndAuditData
Operations=DoAll
TrueRuleChain=CheckTypeOfResponse
TrueRuleChain=GenerateEAPAkaPayloadEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/400.GenerateOEMResponse/100.CheckTypeOfResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350D.DEG30GenerateOEMResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/400.GenerateOEMResponse/200.GenerateEAPAkaPayloadEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=210.GetActiveMonitoringSessionsByIMSI
RuleNames=220.GetActiveMonitoringSessionsByMDN
RuleNames=300.GenerateEAPAKAPayloadStartAuditData
RuleNames=350.InitSslSessionUpdate
RuleNames=400.ExecuteSslSessionUpdate
RuleNames=410.CheckSslSessionUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/100.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_STATE WAIT_FOR_OTP_CHALLENGE_CHECK_FROM_DEG
AdornOps=copy DEG_SSL_NAI DEG_OEMDevSubscriberIdString
AdornOps=copy DEG_SSL_IMSI DEG_OEMDevImsiString
AdornOps=copy DEG_SSL_IMSI DEG_IMSI
AdornOps=copy DEG_SSL_MDN DEG_CDevMobileNumberString
AdornOps=copy DEG_SSL_MDN DEG_MDN
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/210.GetActiveMonitoringSessionsByIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitVariables
TrueRuleChain=110.CheckIfMonitoredSession


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/210.GetActiveMonitoringSessionsByIMSI/100.InitVariables]

AdornOps=copy DEG_IMSI DEG_MSESSIONKEY
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/210.GetActiveMonitoringSessionsByIMSI/110.CheckIfMonitoredSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessions


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/220.GetActiveMonitoringSessionsByMDN]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitVariables
TrueRuleChain=110.CheckIfMonitoredSession


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/220.GetActiveMonitoringSessionsByMDN/100.InitVariables]

AdornOps=copy DEG_MDN DEG_MSESSIONKEY
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/220.GetActiveMonitoringSessionsByMDN/110.CheckIfMonitoredSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessions


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/300.GenerateEAPAKAPayloadStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=851.DEG30GenerateOTPChallengeStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/350.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/400.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1406"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1407"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to find the row in DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVariables
RuleNames=200.CheckSubscriberIdentity


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/100.InitVariables]

AdornOps=set DEG_DevSubscriberIdentityString ${DEGDROID_SUBSCRIBER_IDENTITY}
AdornOps=lower DEG_DevSubscriberIdentityString DEG_DevSubscriberIdentityString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_DevSubscriberIdentityString,=,"msisdn"
Conditions=DEG_DevSubscriberIdentityString,=,"imsi"
Conditions=DEG_DevSubscriberIdentityString,=,DEG_DevSubscriberIdentityString
LookupByIMSI=200.InitSslSessionLookup
LookupByIMSI=210.ExecuteSslSessionLookup
LookupByIMSI=220.CheckSslSessionLookupStatus
LookupByMSISDN=100.InitSslSessionLookup
LookupByMSISDN=110.ExecuteSslSessionLookup
LookupByMSISDN=120.CheckSslSessionLookupStatus
Operations=None
TrueRuleChain=LookupByMSISDN
TrueRuleChain=LookupByIMSI
TrueRuleChain=UnknownSubscriberIdentity
UnknownSubscriberIdentity=250.SetErrorInfo
UnknownSubscriberIdentity=300.UnknownIdentityLog
UnknownSubscriberIdentity=310.SetSSLRequestState_500


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/100.InitSslSessionLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=setifnull DEGDROID_OTP 0
AdornOps=copy DEGDROID_OTP DEGDROID_SSL_OTP
AdornOps=copy DEG_MDN DEG_SSL_MDN
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/110.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEGDROID_SSL_OTP,DEGDROID_SSL_OTP
NativeCondition=MatchByMDN
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/120.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350F.DEG30ProcessOTPRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/200.InitSslSessionLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=copy DEG_OEMDevImsiString DEG_SSL_IMSI
AdornOps=setifnull DEGDROID_OTP 0
AdornOps=copy DEGDROID_OTP DEGDROID_SSL_OTP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/210.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEGDROID_SSL_OTP,DEGDROID_SSL_OTP
NativeCondition=MatchByIMSI
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/220.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350F.DEG30ProcessOTPRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/250.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1408"
AdornOps=set DEG_OEMDevErrorMessageString "Unknown Subscriber Identity"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/300.UnknownIdentityLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_SSL_MDN
Attributes=DEG_SSL_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Unknown Subscriber Identity:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/310.SetSSLRequestState_500]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckResponseType


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType]

AkaRejected=300.AkaRejected_InitResponse
AkaRejected=310.AkaRejected_DeactiveToken
AkaRejected=320.AkaRejected_GenerateResponse
AkaWait=200.AkaWait_InitResponse
AkaWait=201.AkaWait_GetResponseTemplate
AkaWait=210.AkaWait_GenerateResponse
Authenticated=400.Authenticated_InitResponse
Authenticated=401.Authenticated_GetResponseTemplate
Authenticated=410.Authenticated_TokenLookupForDFTCase
Authenticated=420.Authenticated_StoreToken
Authenticated=425.Authenticated_ResponseCustomization
Authenticated=430.Authenticated_ServiceConfiguration
Authenticated=440.Authenticated_GenerateResponse
BlackListedSubscriber=120.BlackListedSubscriber_InitResponse
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"OTP_CHALLENGE_REJECTED"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Conditions=DEG_SSL_STATE,starts,"AUTHENTICATED"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE
Operations=None
StatusDisallowed=600.DisallowedAction_InitResponse
TrueRuleChain=UnknownSubscriber
TrueRuleChain=BlackListedSubscriber
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=StatusDisallowed
TrueRuleChain=Authenticated
TrueRuleChain=Unknown
Unknown=500.Unknown_SetHttpErrorResponseTo500C
UnknownSubscriber=100.UnknownSubscriber_InitResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/100.UnknownSubscriber_InitResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_STATE "UNKNOWN_SUBSCRIBER"
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRespStatusString 403
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/120.BlackListedSubscriber_InitResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevRespStatusString 511
AdornOps=set  DEG_SSL_STATE "BLACKLISTED_SUBSCRIBER"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/200.AkaWait_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "200"
AdornOps=set DEG_OEMDevRespStatusString 200
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/210.AkaWait_GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodePayload
FalseRuleChain=203.InitVariableAuthXMLTemplate
FalseRuleChain=205.LookUpAuthXMLTemplate
FalseRuleChain=210.GenerateResponse
FalseRuleChain=215.AssignMessagetoResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/210.AkaWait_GenerateResponse/200.EncodePayload]

AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/210.AkaWait_GenerateResponse/203.InitVariableAuthXMLTemplate]

AdornOps=set DEGDROID_auth_step_Integer 1
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/210.AkaWait_GenerateResponse/205.LookUpAuthXMLTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/210.AkaWait_GenerateResponse/210.GenerateResponse]

ClassName=com.hp.usage.rules.transform.MessageFormatRule
Locale=en_US
MessageFormat=DEG_XML_TEMPLATES_FILE
ResultAttribute=DEG_XML_TEMPLATES_FILE
UseDynamicMessageFormat=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/210.AkaWait_GenerateResponse/215.AssignMessagetoResponse]

AdornOps=setifnull DEG_XML_TEMPLATES_FILE ""
AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/210.AkaWait_GenerateResponse/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/300.AkaRejected_InitResponse]

AdornOps=set DEG_TOKENSTATUS "DE"
AdornOps=set DEG_OEMDevRespStatusString 511
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/310.AkaRejected_DeactiveToken]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/320.AkaRejected_GenerateResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/400.Authenticated_InitResponse]

AdornOps=set DEG_APP_TOKEN_FLAG 1
AdornOps=set DEGDROID_auth_step_Integer 2
AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEG_OEMDevRespTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEG_CDevTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEGDROID_SSL_COOKIE_ID
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP
AdornOps=set DEG_AUTHENTICATION_TYPE "OTP"
AdornOps=set DEG_TOKEN_VALIDITY_SECONDS ${DEGDROID_DEVICE_TOKEN_VALIDITY}
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/401.Authenticated_GetResponseTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
Conditions=DEG_AUTHENTICATION_TYPE,=,"OTP"
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"DFT"
Operations=and,and
TrueRuleChain=100.InitValues
TrueRuleChain=110.Lookup
TrueRuleChain=120.CheckLookupStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/100.InitValues]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=copy DEG_MDN DEG_CDevMobileNumberString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/110.Lookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckTokenExist
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1405"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEG_TOKENS table"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_TOKENS table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/120.GeneratePostChallengeSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/200.CheckTokenExist]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
FalseRuleChain=200.SetAuthTimesTamp


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/200.CheckTokenExist/200.SetAuthTimesTamp]

AdornOps=setsystime DEG_FULLAUTHTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/420.Authenticated_StoreToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevMobileNumberString
RequestAttributes=DEG_IMSI
RequestAttributes=DEG_CDevTokenString
RequestAttributes=DEG_AUTHENTICATION_TYPE
RequestAttributes=DEG_AUTHENTICATION_SUBTYPE
RequestAttributes=DEG_APP_TOKEN_FLAG
RequestAttributes=DEG_FULLAUTHTIMESTAMP
ResponseAttributes=DEG_OEMDevErrorMessageString
ResponseAttributes=DEG_EVENTTIMESTAMP
RuleChain=005.DEG30StoreTokenRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/425.Authenticated_ResponseCustomization]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=180.ProcessResponseAttributeCustomization
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/430.Authenticated_ServiceConfiguration]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.DEG30ProcessServiceConfigurationRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckEAPPayload
RuleNames=150.CheckResponseXMLEmptyAfterServiceConfigProcess


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse/100.CheckEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodePayload
TrueRuleChain=100.GenerateNullPayloadResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse/100.CheckEAPPayload/100.GenerateNullPayloadResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse/100.CheckEAPPayload/200.EncodePayload]

AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse/100.CheckEAPPayload/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_XMLTemplateResponseString,!=,""
FalseRuleChain=20.AssignResponseFromAuthConfigTemplate
TrueRuleChain=10.AssignResponseFromServiceConfigTemplate


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess/10.AssignResponseFromServiceConfigTemplate]

AdornOps=copy DEG_XMLTemplateResponseString ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess/20.AssignResponseFromAuthConfigTemplate]

AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/500.Unknown_SetHttpErrorResponseTo500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/600.DisallowedAction_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevHttpStatusInteger "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateEAPAKAPayloadEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData]

AkaRejected=100.GenerateOPTChallengeRejectedEndAuditData
AkaWait=200.GenerateOTPChallengeWaitEndAuditData
AuthenticatedAAA=300.GenerateOTPChallengeAuthenticatedEndAuditData
AuthenticatedDEGToken=400.GenerateOPTDEGTokenAuthenticatedDefaultEndAuditData
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_OTP_CHALLENGE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"OTP_CHALLENGE_REJECTED"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_SMSC"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=None
StatusDisallowed=500.GenerateOTPChallengedDisallowedActionEndAuditData
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=AuthenticatedAAA
TrueRuleChain=AuthenticatedDEGToken
TrueRuleChain=StatusDisallowed


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/100.GenerateOPTChallengeRejectedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/200.GenerateOTPChallengeWaitEndAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/300.GenerateOTPChallengeAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/400.GenerateOPTDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/500.GenerateOTPChallengedDisallowedActionEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckSslSessionLookupStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckIfSessionKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEG_SSL_SESSION table"
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1409"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEGDROID_SSL_OTP
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_SSL_SESSION table: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
FalseRuleChain=200.RecordFound
TrueRuleChain=100.RecordNotFound


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/100.RecordNotFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorInfo
RuleNames=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/100.RecordNotFound/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "Unable to get the record from DEG_SSL_SESSION table"
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1410"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/100.RecordNotFound/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEGDROID_SSL_OTP
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to get the record from DEG_SSL_SESSION table: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckDBOTP


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEGDROID_SSL_OTP,=,0
FalseRuleChain=100.CompareOTPWithRequestOTP
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP/100.CompareOTPWithRequestOTP]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEGDROID_SSL_OTP,=,DEG_OEMDevOTPLong
FalseRuleChain=100.SetErrorInfo
FalseRuleChain=110.ErrorLog
TrueRuleChain=100.SetSSLState
TrueRuleChain=110.LogResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP/100.CompareOTPWithRequestOTP/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "Forbidden response"
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_SSL_STATE "OTP_CHALLENGE_REJECTED"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1412"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP/100.CompareOTPWithRequestOTP/100.SetSSLState]

AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_TYPE "OTP"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "EAP"
AdornOps=setsystime DEG_FULLAUTHTIMESTAMP
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1413"
AdornOps=set DEG_OEMDevMessageString "DEGDROID_SSL_OTP is Same from the request OTP"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP/100.CompareOTPWithRequestOTP/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEGDROID_SSL_OTP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_MDN
Attributes=DEG_IMSI
ClassName=LogNMERule
LogLevel=INFO
Message=DEGDROID_SSL_OTP is different from the request OTP:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP/100.CompareOTPWithRequestOTP/110.LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEGDROID_SSL_OTP
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=INFO
Message=DEGDROID_SSL_OTP is Same from the request OTP:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "DEGDROID_SSL_OTP is null from DEG_SSL_SESSION table"
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1411"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEGDROID_SSL_OTP
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=WARNING
Message=Database Error: DEGDROID_SSL_OTP is null from DEG_SSL_SESSION table: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/851.DEG30GenerateOTPChallengeStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/851.DEG30GenerateOTPChallengeStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=copy DEG_CDevProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/851.DEG30GenerateOTPChallengeStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Received "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/851.DEG30GenerateOTPChallengeStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/851.DEG30GenerateOTPChallengeStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/851.DEG30GenerateOTPChallengeStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by AAA,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sent EAP-AKA message to Device,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by default,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "503"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Authentication attempt rejected,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_CDevOutReturnCodeString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Status Disallowed Action,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true
