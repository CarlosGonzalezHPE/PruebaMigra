

[/templates/DEG/DEGDROID_DeviceInterface]


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core]


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors]

ClassName=ConnectorManager
ConnectorNames=100.DEGDROIDDeviceHttpsConnector
ConnectorNames=100.RefreshCacheConnector
ConnectorNames=130.LoadBalancerHeartBeatHttpConnector
ConnectorNames=202.HttpRequestClient


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/100.DEGDROIDDeviceHttpsConnector]

AcceptCount=${DEVICE_HTTP_ACCEPT_COUNT}
ClassName=HttpConnector
ConnectionTimeout=5000
Context=DEGDROIDInterface
KeyStoreFile=${DEGDROID_SERVER_CERT_KEYSTORE_FILE}
KeyStorePassword=${DEGDROID_SERVER_CERT_SIGNATURE_PASSWORD}
Managed=true
MaxKeepAliveRequests=5
MaxProcessors=${DEVICE_HTTP_CON_MAX_PROCESSORS}
MaxSpareProcessors=${DEVICE_HTTP_CON_MIN_PROCESSORS}
MinProcessors=${DEVICE_HTTP_CON_MIN_PROCESSORS}
Port=${DEGDROID_SERVER_PORT}
Secured=true
ServerXMLTemplate=${SERVER_XML_TEMPLATE}
UseContextIdentifierOnly=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/100.DEGDROIDDeviceHttpsConnector/DEGDROIDInterface]

ClassName=com.hp.usage.soap.TextContextProvider
ClientAddressAttribute=DEG_OEMDevSourceIPAddressString
ContextIdentifier=DEGDROIDInterface
ErrorMessageAttribute=DEG_OEMDevHttpErrorMessageString
ErrorNameAttribute=DEG_OEMDevHttpErrorNameString
ErrorRuleChain=120.DEG30ProcessOEMParsingErrorRuleChain
NoLogExceptions=com.hp.usage.listoperations.CustomRuleException
QueryStringAttribute=DEG_OEMDevRequestAttributeString
RequestAttributeMap=IMSI_EAP,DEG_OEMDevEAPSubscriberIdString,dummy
RequestAttributeMap=EAP_PAYLD,DEG_OEMDevEAPPayloadString,dummy
RequestAttributeMap=IMSI,DEG_OEMDevSubscriberIdString,dummy
RequestAttributeMap=OTP,DEG_OEMDevOTPLong,99999
RequestAttributeMap=token,DEG_OEMDevTokenString,dummy
RequestAttributeMap=service_name,DEG_OEMDevServiceNameList,com.hp.siu.utils.StringAttribute|1|64756d6d79
RequestAttributeMap=version,DEG_OEMDevVersionInteger,-1
RequestAttributeMap=terminal_vendor,DEG_OEMDevTerminalVendorString,dummy
RequestAttributeMap=terminal_model,DEG_OEMDevTerminalModelString,dummy
RequestAttributeMap=terminal_sw_version,DEG_OEMDevTermianlSWversionString,dummy
RequestAttributeMap=terminal_id,DEGDROID_TerminalUniqueIdString,dummy
RequestAttributeMap=friendly_device_name,DEG_OEMDevFriendlyDeviceString,-99DEGINVALID-99
RequestAttributeMap=sip_username,DEG_OEMDevSipUserNameString,-99DEGINVALID-99
RequestAttributeMap=ACTION_NAME,DEG_OEMDevActionNameString,dummy
RequestHeaderMap=x-up-calling-line-id,DEG_OEMDevMsisdnString,dummy
RequestHeaderMap=Cookie,DEG_OEMDevCookieList,null
RequestURIAttribute=DEG_OEMDevRequestURIString
ResponseHandlerAttribute=DEG_OEMDevResponseHandlerString
ResponseHandlers=EmptyResponseHandler
ResponseHandlers=TextResponseHandler
ResponseHeaderMap=Content-Type,ResponseMessageHeader,"text/xml;charset=UTF-8"
ResponseHeaderMap=Connection,DEG_OEMDevConnectionString
ResponseHeaderMap=Content-Encoding,DEG_OEMDevEncodingString
ResponseHeaderMap=Retry-After,ResponseHeaderRetryAfterInteger,0
ResponseHeaderMap=Set-Cookie,DEGDROID_SSL_COOKIE_ID
ResponseStatusAttribute=DEG_OEMDevHttpStatusInteger
RuleChainName=100.DEG30ProcessAndroidRequestRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/100.DEGDROIDDeviceHttpsConnector/DEGDROIDInterface/EmptyResponseHandler]

ClassName=EmptyResponseGenerator


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/100.DEGDROIDDeviceHttpsConnector/DEGDROIDInterface/TextResponseHandler]

ClassName=PlainHttpResponseGenerator
SourceAttribute=ResponseMessage


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/100.RefreshCacheConnector]

ClassName=com.hp.siu.plugins.dna.collector.rules.SocketConnector
ListenPort=${DEGDROID_LISTEN_PORT}


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/130.LoadBalancerHeartBeatHttpConnector]

AcceptCount=${DEGDROID_HTTP_ACCEPT_COUNT}
ClassName=com.hp.siu.plugins.tomcat.HttpConnector
ConnectionTimeout=${DEGDROID_HEARTBEAT_CONN_TIMEOUT}
Context=GETStatus
Managed=${MANAGED_SETUP}
MaxKeepAliveRequests=1
MaxProcessors=${DEGDROID_HTTP_HEARTBEAT_CON_MAX_PROCESSORS}
MaxSpareProcessors=${DEGDROID_HTTP_HEARTBEAT_CON_MIN_PROCESSORS}
MinProcessors=${DEGDROID_HTTP_HEARTBEAT_CON_MIN_PROCESSORS}
Port=${DEGDROID_HEARTBEAT_HTTP_PORT}
UseContextIdentifierOnly=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/130.LoadBalancerHeartBeatHttpConnector/GETStatus]

ClassName=TextContextProvider
ContextIdentifier=GETStatus
RuleChainName=170.GenerateResponseForLoadBalancerHeartBeat


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/130.LoadBalancerHeartBeatHttpConnector/GETStatus/ResponseHandler]

ClassName=PlainHttpResponseGenerator
SourceAttribute=DEGDROID_OEMDevLoadBalRespMsgString


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/202.HttpRequestClient]

ClassName=HttpClientConnector
Requests=HttpRequestPost


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/202.HttpRequestClient/EndPoints]

ClassName=DynamicEndPointSelector
KeyAttributeName=RemoteHostURL


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/202.HttpRequestClient/EndPoints/EndPoint]

ClassName=HttpEndPoint
ConnectionTimeout=${DEGDROID_CONNECTION_TIMEOUT}
KeyStoreFile=${DEGDROID_SERVER_CERT_KEYSTORE_FILE}
KeyStorePassword=${DEGDROID_SERVER_CERT_SIGNATURE_PASSWORD}
NumConnections=${DEGDROID_NUM_CONNECTIONS}
RemoteHostURL=${DEGDROID_HEALTHCHECK_REQUEST_URL}
SocketTimeout=${DEGDROID_SOCKET_TIMEOUT}


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/202.HttpRequestClient/HttpRequestPost]

ClassName=com.hp.usage.http.client.PlainHttpRequest
HttpMethod=POST
RequestAttributeMap=ACTION_NAME,DEG_OEMDevActionNameString,"healthCheck"
ResponseHandlers=HttpResponseHandler
ResultCodeAttribute=DEG_OEMDevHttpStatusInteger


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/202.HttpRequestClient/HttpRequestPost/HttpResponseHandler]

ClassName=com.hp.usage.http.client.PlainHttpResponseHandler
DestinationAttribute=DEG_OEMDevHttpStatusString


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService]

ClassName=com.hp.siu.serverutils.RefDataServiceManager
QueryNames=DEG_MONITORINGID_GENERATOR
QueryNames=DEG_MONITORING_SESSIONS_ActiveSessions
QueryNames=DEG_MONITORING_SESSIONS_ActiveSessionsV2
QueryNames=DEG_SYS_PARAMETER_PARA2VAL
QueryNames=DEG_LIC_LIMITS_TokenLifeTime


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime]

ClassName=com.hp.usage.refdatasrv.CachedQuery
ResultAttribute=DEG_CDevMatchFoundInteger
ResultIndexAttribute=DEG_CDevIndexInteger


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/Cache]

CacheAttributes=DEG_TKN_LIFETIME
CacheAttributes=DEG_AUTHTHRESHOLD_COUNT
CacheKeyAttributes=DEG_LIC_TYPE
ClassName=com.hp.usage.refdatasrv.HashMapLookupCache
NMEKeyAttributes=DEG_OEMDevLicenseTypeString


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=150.SetErrorInfo
RuleNames=100.LogAlarming
RuleNames=200.SetErrorFlag


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/ErrorRule/100.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_JsonEncodeAttribute
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/ErrorRule/150.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0004"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/ErrorRule/200.SetErrorFlag]

AdornOps=set DEG_CDevDBErrorFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/FinalRule]

AdornOps=copy DEG_CDevMatchFoundInteger DEG_CDevMatchFoundInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/InitialRule]

AdornOps=set DEG_CDevMatchFoundInteger 0
AdornOps=set DEG_CDevIndexInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_LIC_LIMITS"
AdornOps=set DEG_TKN_LIFETIME 0
AdornOps=set DEG_LIC_TYPE ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/Loader]

ClassName=com.hp.usage.refdatasrv.JDBCLoader
CommonPolicyID=Policy1
FieldExtracted=DEG_LIC_TYPE,DEG_LIC_TYPE
FieldExtracted=DEG_TKN_LIFETIME,DEG_TKN_LIFETIME
FieldExtracted=DEG_AUTHTHRESHOLD_COUNT,DEG_AUTHTHRESHOLD_COUNT
QueryString=select %FIELDS from DEG_LIC_LIMITS


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/RefreshPolicy]

ClassName=com.hp.siu.plugins.dna.collector.rules.CronIntervalRefreshPolicy
RefreshCronInterval=0 * * * *


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/ResultRowRule]

AdornOps=set DEG_CDevMatchFoundInteger 1
AdornOps=copy DEG_TKN_LIFETIME DEG_OEMDevTokenLifetimeLong
AdornOps=copy DEG_AUTHTHRESHOLD_COUNT DEG_OEMDevAuthThresholdCountInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
CommonPolicyID=Policy2
FieldExtracted=DEG_MSESSIONTRANSID,DEG_MSESSIONTRANSID
QueryString=SELECT SEQUENCE_NEXTVAL('DEG_MONITORINGID_GENERATOR') AS DEG_MSESSIONTRANSID
ResultAttribute=DEG_NrbMatchFoundInteger
ResultIndexAttribute=DEG_NrbIndexInteger


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=99.InitErrorLog
RuleNames=100.LogAlarming


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/ErrorRule/100.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to lookup DEG_MONITORINGID_GENERATOR table :
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/ErrorRule/99.InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0000"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup DEG_MONITORINGID_GENERATOR table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/FinalRule]

AdornOps=copy DEG_NrbMatchFoundInteger DEG_NrbMatchFoundInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/InitialRule]

AdornOps=set DEG_NrbMatchFoundInteger 0
AdornOps=set DEG_NrbIndexInteger 0
AdornOps=set DEG_MSESSIONTRANSID 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_MONITORINGID_GENERATOR.NEXTVAL"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/ResultRowRule]

AdornOps=set DEG_NrbMatchFoundInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
CommonPolicyID=Policy2
FieldExtracted=DEG_MSESSIONID,DEG_MSESSIONID
QueryString=SELECT %FIELDS  FROM DEG_MONITORING_SESSIONS WHERE DEG_MSESSIONTYPE in ('MDN','IMSI') AND DEG_MSESSIONSTATUS='AE' AND DEG_MSESSIONKEY=%DEG_MSESSIONKEY
ResultAttribute=DEG_NrbMatchFoundInteger
ResultIndexAttribute=DEG_NrbIndexInteger


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=99.InitErrorLog
RuleNames=100.LogAlarming


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ErrorRule/100.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to lookup DEG_MONITORING_SESSIONS table :
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ErrorRule/99.InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0001"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup DEG_MONITORING_SESSIONS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/FinalRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.Copy_MatchFoundFlag
RuleNames=200.CheckMSessionKey


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/FinalRule/100.Copy_MatchFoundFlag]

AdornOps=copy DEG_NrbMatchFoundInteger DEG_NrbMatchFoundInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/FinalRule/200.CheckMSessionKey]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_MSESSIONKEY,=,0
TrueRuleChain=100.Set_MSessionKeyFlag


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/FinalRule/200.CheckMSessionKey/100.Set_MSessionKeyFlag]

AdornOps=set DEG_SessionKeyInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/InitialRule]

AdornOps=set DEG_NrbMatchFoundInteger 0
AdornOps=set DEG_MSESSIONID ""
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_MONITORING_SESSIONS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ResultRowRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.Set_MatchFound
RuleNames=200.PopulateMonitoringSessionIdsList


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ResultRowRule/100.Set_MatchFound]

AdornOps=set DEG_NrbMatchFoundInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ResultRowRule/200.PopulateMonitoringSessionIdsList]

ClassName=AddToListAttributeRule
Delimiters=,
InputAttribute=DEG_MSESSIONID
ListAttribute=DEG_NrbMonitoringSessionIdList


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
CommonPolicyID=Policy2
FieldExtracted=DEG_MSESSIONID,DEG_MSESSIONID
QueryString=SELECT %FIELDS  FROM DEG_MONITORING_SESSIONS WHERE DEG_MSESSIONTYPE in ('MDN','IMSI','UNIQ') AND DEG_MSESSIONSTATUS='AE' AND DEG_MSESSIONKEY=%DEG_MSESSIONKEY
ResultAttribute=DEG_NrbMatchFoundInteger
ResultIndexAttribute=DEG_NrbIndexInteger


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=99.InitErrorLog
RuleNames=100.LogAlarming


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ErrorRule/100.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to lookup DEG_MONITORING_SESSIONS table :
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ErrorRule/99.InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0002"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup DEG_MONITORING_SESSIONS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/FinalRule]

AdornOps=copy DEG_NrbMatchFoundInteger DEG_NrbMatchFoundInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/InitialRule]

AdornOps=set DEG_NrbMatchFoundInteger 0
AdornOps=set DEG_MSESSIONID ""
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_MONITORING_SESSIONS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ResultRowRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.Set_MatchFound
RuleNames=200.PopulateMonitoringSessionIdsList


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ResultRowRule/100.Set_MatchFound]

AdornOps=set DEG_NrbMatchFoundInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ResultRowRule/200.PopulateMonitoringSessionIdsList]

ClassName=AddToListAttributeRule
Delimiters=,
InputAttribute=DEG_MSESSIONID
ListAttribute=DEG_NrbMonitoringSessionIdList


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL]

ClassName=com.hp.usage.refdatasrv.CachedQuery
ResultAttribute=DEG_CDevMatchFoundInteger
ResultIndexAttribute=DEG_CDevIndexInteger


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/Cache]

CacheAttributes=DEG_SYSVALUE
CacheKeyAttributes=DEG_SYSPARAMETER
ClassName=com.hp.usage.refdatasrv.HashMapLookupCache
NMEKeyAttributes=DEG_CDevSysParameter


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=99.InitErrorLog
RuleNames=100.LogAlarming
RuleNames=200.SetErrorFlag


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule/100.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to lookup DEG_SYS_PARAMETER table :
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule/200.SetErrorFlag]

AdornOps=set DEG_CDevDBErrorFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule/99.InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0003"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup DEG_SYS_PARAMETER table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/FinalRule]

AdornOps=copy DEG_CDevMatchFoundInteger DEG_CDevMatchFoundInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/InitialRule]

AdornOps=set DEG_CDevMatchFoundInteger 0
AdornOps=set DEG_CDevIndexInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_SYS_PARAMETERS"
AdornOps=set DEG_SYSVALUE ""
AdornOps=set DEG_SYSPARAMETER ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/Loader]

ClassName=com.hp.usage.refdatasrv.JDBCLoader
CommonPolicyID=Policy1
FieldExtracted=DEG_SYSPARAMETER,DEG_SYSPARAMETER
FieldExtracted=DEG_SYSVALUE,DEG_SYSVALUE
QueryString=select %FIELDS from DEG_SYS_PARAMETERS


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/RefreshPolicy]

ClassName=com.hp.siu.plugins.dna.collector.rules.CronIntervalRefreshPolicy
RefreshCronInterval=0 * * * *


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ResultRowRule]

AdornOps=set DEG_CDevMatchFoundInteger 1
AdornOps=copy DEG_SYSVALUE DEG_CDevSysValueString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains]

ClassName=com.hp.siu.sessionserver.RuleChainManager
RuleChainNames=100.DEG30ProcessAndroidRequestRuleChain
RuleChainNames=110.DEG30ValidateInitialRequestRuleChain
RuleChainNames=120.DEG30ProcessOEMParsingErrorRuleChain
RuleChainNames=130.DEG30CheckTokenTimeStampRuleChain
RuleChainNames=140.DEG30GenerateBlackListedResponseRuleChain
RuleChainNames=150.DEG30BlackListeSubscriberRuleChain
RuleChainNames=160.DEG30GetResponseTemplatesRuleChain
RuleChainNames=170.GenerateResponseForLoadBalancerHeartBeat
RuleChainNames=000.SessionStoreDefaultErrorRuleChain
RuleChainNames=001.SessionStoreKeyNotExistsRuleChain
RuleChainNames=002.SessionStoreDuplicateKeyRuleChain
RuleChainNames=003.ReadSystemParameterRuleChain
RuleChainNames=170.DEG30CheckEAPAKADefaultRuleChain
RuleChainNames=005.DEG30StoreTokenRuleChain
RuleChainNames=300.DEG30ProcessOTPRuleChain
RuleChainNames=400.DEG30PrcessNONERuleChain
RuleChainNames=600.GenerateAuditAndNRBEventsRuleChain
RuleChainNames=601.DumpMonitoringTransactionsRuleChain
RuleChainNames=650.DEG20GenerateAuditAndNRBEventsRuleChain
RuleChainNames=651.DEG20DumpMonitoringTransactionsRuleChain
RuleChainNames=705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain
RuleChainNames=180.ProcessResponseAttributeCustomization
RuleChainNames=CUSTRC_RCSInitialConnectCustomize
RuleChainNames=004.ReadTokenLifeTimeRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/000.SessionStoreDefaultErrorRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetLookupErrorFlag
RuleNames=200.LogAlarming


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/000.SessionStoreDefaultErrorRuleChain/100.SetLookupErrorFlag]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0015"
AdornOps=set DEG_OEMDevErrorMessageString "Error while accessing database table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/000.SessionStoreDefaultErrorRuleChain/200.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/001.SessionStoreKeyNotExistsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ClearDuplicateKeyFlag


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/001.SessionStoreKeyNotExistsRuleChain/100.ClearDuplicateKeyFlag]

AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/002.SessionStoreDuplicateKeyRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetDuplicateKeyFlag


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/002.SessionStoreDuplicateKeyRuleChain/100.SetDuplicateKeyFlag]

AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/003.ReadSystemParameterRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReadSystemParameter


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/003.ReadSystemParameterRuleChain/100.ReadSystemParameter]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_SYS_PARAMETER_PARA2VAL


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/003.ReadSystemParameterRuleChain/100.ReadSystemParameter/ErrorRule]

AdornOps=set DEG_CDevDBErrorFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/003.ReadSystemParameterRuleChain/100.ReadSystemParameter/NoMatchRule]

AdornOps=set DEG_CDevDBNoMatchFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/004.ReadTokenLifeTimeRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReadTokenLifeTime


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/004.ReadTokenLifeTimeRuleChain/100.ReadTokenLifeTime]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_LIC_LIMITS_TokenLifeTime


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/004.ReadTokenLifeTimeRuleChain/100.ReadTokenLifeTime/ErrorRule]

AdornOps=set DEG_CDevDBErrorFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/004.ReadTokenLifeTimeRuleChain/100.ReadTokenLifeTime/NoMatchRule]

AdornOps=set DEG_CDevDBNoMatchFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitLookup
RuleNames=200.Lookup
RuleNames=300.CheckLookupStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/100.InitLookup]

AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=set CUST_VOWIFI_IN_PrevUniqueIDString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/200.Lookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_UNIQUE_ID,CUST_VOWIFI_IN_PrevUniqueIDString
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckIfSessionKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0009"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEGDROID_TOKENS table"
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEGDROID_TOKENS table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
FalseRuleChain=200.TokenFound
TrueRuleChain=100.TokenNotFound


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitCreate
RuleNames=200.Create
RuleNames=300.CheckCreateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/100.InitCreate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=copy DEG_CDevTokenString DEG_SUBSTOKEN
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=set DEG_TOKENSTATUS "AE"
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set DEG_AUTH_COUNT 1
AdornOps=set DEG_BLACKLIST_FLAG 0
AdornOps=set log_DB_Operation "CREATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=set DEG_PUSH_TOKEN ""
AdornOps=setifnull DEG_OEMDevUniqueIDString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_UNIQUE_ID
AdornOps=setsystime DEG_BLACKLISTWINDOW_STARTTIME
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/200.Create]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckDuplicateKeyError
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0010"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to create entry in DEGDROID_TOKENS table"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to create entry in DEGDROID_TOKENS session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
TrueRuleChain=100.UpdateRecentlyCreatedToken


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/100.InitUpdate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=copy DEG_CDevTokenString DEG_SUBSTOKEN
AdornOps=set DEG_TOKENSTATUS "AE"
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_AUTHENTICATION_TYPE,DEG_AUTHENTICATION_TYPE
MapAttributes=DEG_AUTHENTICATION_SUBTYPE,DEG_AUTHENTICATION_SUBTYPE
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0011"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEGDROID_TOKENS table"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEGDROID_TOKENS session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0012"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEGDROID_TOKENS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEGDROID_TOKENS session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/100.InitUpdate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=copy DEG_CDevTokenString DEG_SUBSTOKEN
AdornOps=copy DEG_OEMDevUniqueIDString DEG_UNIQUE_ID
AdornOps=set DEG_TOKENSTATUS "AE"
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_AUTHENTICATION_TYPE,DEG_AUTHENTICATION_TYPE
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
MapAttributes=DEG_AUTHENTICATION_SUBTYPE,DEG_AUTHENTICATION_SUBTYPE
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
MapAttributes=DEG_APP_TOKEN_FLAG,DEG_APP_TOKEN_FLAG
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0013"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEGDROID_TOKENS table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevUniqueIDString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEGDROID_TOKENS table : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0014"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEGDROID_TOKENS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEGDROID_TOKENS table : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=110.CheckHealthCheckDetails
RuleNames=001.Environmetalvalidation
RuleNames=200.CheckRequestProcessedInteger


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/001.Environmetalvalidation]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDeviceTokenValidityLong,<,DEG_OEMDeviceFullAuthMustWindowLong
FalseRuleChain=100.SetErrorInfo
FalseRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/001.Environmetalvalidation/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0016"
AdornOps=set DEG_OEMDevErrorMessageString "Network Authentication Required"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/001.Environmetalvalidation/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDeviceTokenValidityLong
Attributes=DEG_OEMDeviceFullAuthMustWindowLong
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error:DEGDROID_FULL_AUTH_MUST_WINDOW must be more than the DEGDROID_DEVICE_TOKEN_VALIDITY
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/100.InitWorkingVariables]

AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=set DEG_OEMDevHttpStatusInteger 200
AdornOps=set DEG_OEMDevResponseHandlerString "dummy"
AdornOps=set DEG_OEMDevSSLSSDeletedInteger 0
AdornOps=setsystime DEG_CDevProcessStartTimeLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditTransactionTypeString "initial-connect"
AdornOps=setifnull DEGDROID_TerminalUniqueIdString ""
AdornOps=copy DEGDROID_TerminalUniqueIdString DEG_OEMDevUniqueIDString
AdornOps=set DEG_DevAuthTypeString ${DEGDROID_AUTH_TYPE}
AdornOps=set DEG_OEMDevSslSessionIdString ""
AdornOps=set DEG_OEMDeviceTypeString "Android"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_OEMDevDeviceTypeString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_OEMDeviceTokenValidityLong ${DEGDROID_DEVICE_TOKEN_VALIDITY}
AdornOps=* DEG_OEMDeviceTokenValidityLong 1000 DEG_OEMDeviceTokenValidityLong
AdornOps=set DEG_OEMDeviceFullAuthMustWindowLong ${DEGDROID_FULL_AUTH_MUST_WINDOW}
AdornOps=* DEG_OEMDeviceFullAuthMustWindowLong 1000 DEG_OEMDeviceFullAuthMustWindowLong
AdornOps=set DEG_TOKEN_VALIDITY_SECONDS ${DEGDROID_DEVICE_TOKEN_VALIDITY}
AdornOps=copy DEG_TOKEN_VALIDITY_SECONDS DEG_TOKEN_VALIDITY_SECONDSString
AdornOps=set DEG_DevRowExistsFlagInteger 0
AdornOps=set DEG_OEMDevCookieExistInteger 0
AdornOps=setifnull DEG_SSL_ID ""
AdornOps=setifnull DEG_MDN 0
AdornOps=setifnull DEG_OEMDevImsiString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/110.CheckHealthCheckDetails]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,"healthCheck"
TrueRuleChain=100.InitResponse


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/110.CheckHealthCheckDetails/100.InitResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 200
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.SetAuditTranscationType
TrueRuleChain=110.GetOrGenerateCookie
TrueRuleChain=115.InitLog
TrueRuleChain=115.LogNewHttRequest
TrueRuleChain=120.InsertSession
TrueRuleChain=130.CheckForAuthType
TrueRuleChain=140.SetParametersOfHttpsResponse
TrueRuleChain=150.CheckIfDeleteSSLSession


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/100.SetAuditTranscationType]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestAttributeString,contains,"IMSI_EAP="
Conditions=DEG_OEMDevRequestAttributeString,contains,"IMSI="
Conditions=DEG_OEMDevRequestAttributeString,contains,"EAP_PAYLD="
Conditions=DEG_OEMDevRequestAttributeString,=,"DEG_OEMDevRequestAttributeString"
Operations=None
SetChallengeTranscationtype=300.SetChallengeTranscationtype
SetFastAuthTranscationtype=200.SetFastAuthTranscationtype
SetFullAuthTranscationtype=100.SetFullAuthTranscationtype
setInitialConnectTransactiontype=400.setInitialConnectTransactiontype
TrueRuleChain=SetFullAuthTranscationtype
TrueRuleChain=SetFastAuthTranscationtype
TrueRuleChain=SetChallengeTranscationtype
TrueRuleChain=setInitialConnectTransactiontype


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/100.SetAuditTranscationType/100.SetFullAuthTranscationtype]

AdornOps=set DEG_AuditTransactionTypeString "full-auth-init"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/100.SetAuditTranscationType/200.SetFastAuthTranscationtype]

AdornOps=set DEG_AuditTransactionTypeString "fast-auth"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/100.SetAuditTranscationType/300.SetChallengeTranscationtype]

AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/100.SetAuditTranscationType/400.setInitialConnectTransactiontype]

AdornOps=set DEG_AuditTransactionTypeString "initial-connect"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=100.IterateCookieList
FalseRuleChain=110.CheckIfDEGCookieExists
TrueRuleChain=110.CheckIfDEGCookieExists


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/100.IterateCookieList]

ClassName=ListAttributeIterator
ListAttributeName=DEG_OEMDevCookieList
RuleChain=100.CheckCookieList
TmpAttributeName=DEG_OEMDevCookieTmpString


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/100.IterateCookieList/100.CheckCookieList]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevCookieTmpString,contains,"DEGCID="
TrueRuleChain=100.SetDEGCookie
TrueRuleChain=200.CheckCookieLength


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/100.IterateCookieList/100.CheckCookieList/100.SetDEGCookie]

AdornOps=copy DEG_OEMDevCookieTmpString DEGDROID_SSL_COOKIE_ID
AdornOps=copy DEGDROID_SSL_COOKIE_ID DEG_SSL_ID
AdornOps=copy DEGDROID_SSL_COOKIE_ID DEG_OEMDevSslSessionIdString
AdornOps=set DEG_OEMDevCookieExistInteger 1
AdornOps=length DEG_OEMDevSslSessionIdString DEG_OEMDevSslSessionIdLengthInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/100.IterateCookieList/100.CheckCookieList/200.CheckCookieLength]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSslSessionIdLengthInteger,>,64
TrueRuleChain=100.SetErrorResponse
TrueRuleChain=200.SetErrorLog
TrueRuleChain=300.StartAudit


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/100.IterateCookieList/100.CheckCookieList/200.CheckCookieLength/100.SetErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0018"
AdornOps=set DEG_OEMDevErrorMessageString "Cookie length in the request is exceeded than expected length."
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/100.IterateCookieList/100.CheckCookieList/200.CheckCookieLength/200.SetErrorLog]

Attributes=DEG_OEMDevSslSessionIdLengthInteger
Attributes=DEGDROID_SSL_COOKIE_ID
Attributes=DEG_SSL_ID
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=Cookie length in the request is exceeded than expected length. Cannot process the request : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/100.IterateCookieList/100.CheckCookieList/200.CheckCookieLength/300.StartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/110.CheckIfDEGCookieExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevCookieExistInteger,=,0
TrueRuleChain=100.GenerateCookie


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/110.CheckIfDEGCookieExists/100.GenerateCookie]

AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEGDROID_SSL_COOKIE_ID
AdornOps=set DEG_SSL_ID "DEGCID="
AdornOps=+ DEG_SSL_ID DEGDROID_SSL_COOKIE_ID DEG_SSL_ID
AdornOps=copy DEG_SSL_ID DEGDROID_SSL_COOKIE_ID
AdornOps=copy DEGDROID_SSL_COOKIE_ID DEG_OEMDevSslSessionIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevCookieList == null


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/115.InitLog]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0017"
AdornOps=set DEG_OEMDevMessageString "Received new https request for AndroidDEVICE"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/115.LogNewHttRequest]

Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevTokenString
Attributes=DEGDROID_TerminalUniqueIdString
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEGDROID_SSL_COOKIE_ID
Attributes=DEG_OEMDevOTPLong
Attributes=DEG_OEMDevSourceIPAddressString
Attributes=DEG_OEMDevVersionInteger
Attributes=DEG_OEMDevTerminalVendorString
Attributes=DEG_OEMDevTerminalModelString
Attributes=DEG_OEMDevTermianlSWversionString
Attributes=DEG_OEMDevFriendlyDeviceString
Attributes=DEG_OEMDevSipUserNameString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=AndroidDEVICE TO DEG -> Received new https request:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
InsertSslSession=100.InitSslSessionLookup
InsertSslSession=110.ExecuteSslSessionLookup
InsertSslSession=120.CheckSslSessionLookupStatus
Operations=DoAll
TrueRuleChain=InsertSslSession


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/100.InitSslSessionLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/110.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_STATE,DEG_SSL_AAA_STATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/115.CheckCookieIDExist]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEGDROID_SSL_COOKIE_ID,contains,"none"
Conditions=DEGDROID_SSL_COOKIE_ID,=,""
FalseRuleChain=150.CopyCookiefromRequest
Operations=or
TrueRuleChain=100.CreateCookie


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/115.CheckCookieIDExist/100.CreateCookie]

AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEGDROID_SSL_COOKIE_ID
AdornOps=copy DEGDROID_SSL_COOKIE_ID DEG_SSL_ID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/115.CheckCookieIDExist/150.CopyCookiefromRequest]

AdornOps=copy DEGDROID_SSL_COOKIE_ID DEG_SSL_ID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_SSL_ID,=,DEG_SSL_ID
NoSslSession=100.NoSslSession_InitSslSessionCreate
NoSslSession=110.NoSslSession_ExecuteSslSessionCreate
NoSslSession=120.NoSslSession_CheckSslSessionCreateStatus
Operations=None
SslSessionExists=200.SslSessionExists_InitSslSessionUpdate
SystemError=000.SystemError_SetHttpErrorResponse
SystemError=010.SystemErrorLog
SystemError=020.StartAuditRuleChain
TrueRuleChain=SystemError
TrueRuleChain=NoSslSession
TrueRuleChain=SslSessionExists


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/000.SystemError_SetHttpErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0019"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_SSL_SESSION table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/010.SystemErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access DEG_SSL_SESSION table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/020.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/100.NoSslSession_InitSslSessionCreate]

AdornOps=set log_DB_Operation INSERT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_STATE "NEW"
AdornOps=set DEG_SSL_REQUEST_STATE "NEW"
AdornOps=set DEG_SSL_NAI ""
AdornOps=set DEG_SSL_IMSI ""
AdornOps=set DEG_SSL_MDN ""
AdornOps=set DEG_SSL_UNIQUE_ID ""
AdornOps=setsystime DEG_SSL_CREATETIMESTAMP
AdornOps=copy DEG_SSL_ID DEG_SSL_AAA_SESSIONID
AdornOps=set DEG_SSL_AAA_STATE ""
AdornOps=set DEG_STR_FLAG 0
AdornOps=set DEG_SSL_ID_PROV_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=set DEG_SSL_GW_ADDR "NA"
AdornOps=set DEG_SSL_POSTDATA ""
AdornOps=set DEG_SSL_ADDRESS_UPDATE_URL ${DEVICE_SERVICE_MNGT_URL}
AdornOps=set DEG_SSL_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=set DEG_SSL_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=set DEG_SSL_EntitlementStatus ""
AdornOps=set DEGDROID_SSL_OTP 0
AdornOps=set DEG_GETAUTH_CONTACTED_AAA ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/110.NoSslSession_ExecuteSslSessionCreate]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
Operations=or
TrueRuleChain=000.GenerateStartAudit
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus/000.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus/100.SetHttpErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0020"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to access or create entry in DEG_SSL_SESSION table"
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to access or create entry in DEG_SSL_SESSION table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/200.SslSessionExists_InitSslSessionUpdate]

AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_REQUEST_STATE "NEW"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/130.CheckForAuthType]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.CallProcesses


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/130.CheckForAuthType/100.CallProcesses]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_DevAuthTypeString,=,"EAP_AKA"
Conditions=DEG_DevAuthTypeString,=,"OTP"
Conditions=DEG_DevAuthTypeString,=,"NONE"
Operations=None
ProcessEAP_AKARuleChain=100.ProcessEAP_AKARuleChain
ProcessNONERuleChain=300.ProcessNONERuleChain
ProcessOTPRuleChain=200.ProcessOTPRuleChain
TrueRuleChain=ProcessEAP_AKARuleChain
TrueRuleChain=ProcessOTPRuleChain
TrueRuleChain=ProcessNONERuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/130.CheckForAuthType/100.CallProcesses/100.ProcessEAP_AKARuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200.DEG30ProcessRequestRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/130.CheckForAuthType/100.CallProcesses/200.ProcessOTPRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300.DEG30ProcessOTPRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/130.CheckForAuthType/100.CallProcesses/300.ProcessNONERuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400.DEG30PrcessNONERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_REQUEST_STATE,=,"200"
Conditions=DEG_SSL_REQUEST_STATE,=,"200C"
Conditions=DEG_SSL_REQUEST_STATE,=,"403C"
Conditions=DEG_SSL_REQUEST_STATE,=,"500C"
Conditions=DEG_SSL_REQUEST_STATE,=,"511C"
Conditions=DEG_SSL_REQUEST_STATE,=,"503C"
Conditions=DEG_SSL_REQUEST_STATE,=,DEG_SSL_REQUEST_STATE
Http200=100.Http200_SetHttpResponse
Http200=104.Http200_InitErrorLog
Http200=110.Http200_LogResponse
Http200C=200.Http200C_SetHttpResponse
Http200C=205.Http200C_InitErrorLog
Http200C=210.Http200C_LogResponse
Http403C=255.Http403C_InitErrorLog
Http403C=300.Http403C_LogResponse
Http403C=310.Http403C_RaiseException
Http500C=350.Http500C_InitErrorLog
Http500C=400.Http500C_LogResponse
Http500C=410.Http500C_RaiseException
Http503C=655.Http503C_InitErrorLog
Http503C=700.Http503C_LogResponse
Http503C=710.Http503C_RaiseException
Http511C=550.Http511C_InitErrorLog
Http511C=600.Http511C_LogResponse
Http511C=610.Http511C_RaiseException
HttpUnknown=450.HttpUnknown_InitErrorLog
HttpUnknown=500.HttpUnknown_LogResponse
HttpUnknown=510.HttpUnknown_RaiseException
Operations=None
TrueRuleChain=Http200
TrueRuleChain=Http200C
TrueRuleChain=Http403C
TrueRuleChain=Http500C
TrueRuleChain=Http511C
TrueRuleChain=Http503C
TrueRuleChain=HttpUnknown


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/100.Http200_SetHttpResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger 200
AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/104.Http200_InitErrorLog]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0021"
AdornOps=set DEG_OEMDevMessageString "Action processed successfully"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/110.Http200_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevRespPhoneNumberString
Attributes=DEG_OEMDevRespStatusString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Action processed successfully - http status set to 200 and http session not closed: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/200.Http200C_SetHttpResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger 200
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/205.Http200C_InitErrorLog]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0022"
AdornOps=set DEG_OEMDevMessageString "Action processed successfully"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/210.Http200C_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevRespPhoneNumberString
Attributes=DEG_OEMDevRespStatusString
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Action processed successfully - http status set to 200 and http session closed: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/255.Http403C_InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0023"
AdornOps=setifnull DEG_OEMDevErrorMessageString "OEM action is invalid"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/300.Http403C_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=OEM action is invalid - http status is set to 403 and http session closed: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/310.Http403C_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=403C
ErrorMessage=Http Request is rejected with http status 403


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/350.Http500C_InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0024"
AdornOps=setifnull DEG_OEMDevErrorMessageString "Http status is set to 500 and http session closed"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/400.Http500C_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Internal error during OEM action processing - http status set to 500 and http session closed: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/410.Http500C_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=500C
ErrorMessage=Http Request is rejected with http status 500


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/450.HttpUnknown_InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0025"
AdornOps=set DEG_OEMDevErrorMessageString "Unknown internal error during OEM action processing"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/500.HttpUnknown_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Unknown internal error during OEM action processing - http status set to 500 and http session closed: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/510.HttpUnknown_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=500C
ErrorMessage=Http Request is rejected with http status 500


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/550.Http511C_InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0026"
AdornOps=set DEG_OEMDevErrorMessageString "Internal error during OEM action processing"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/600.Http511C_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Internal error during OEM action processing - http status set to 511 and http session closed: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/610.Http511C_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=511C
ErrorMessage=Http Request is rejected with http status 511


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/655.Http503C_InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0027"
AdornOps=set DEG_OEMDevErrorMessageString "Internal error during OEM action processing"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/700.Http503C_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Internal error during OEM action processing - http status set to 503 and http session closed: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/710.Http503C_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=503C
ErrorMessage=Http Request is rejected with http status 503


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/150.CheckIfDeleteSSLSession]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSSLSSDeletedInteger,=,0
TrueRuleChain=100.CheckSSLSessionStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/150.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"NEW"
Conditions=DEG_SSL_STATE,=,UNKNOWN_SUBSCRIBER
Conditions=DEG_SSL_STATE,=,AUTHENTICATED_BY_DEG_TOKEN
Conditions=DEG_SSL_STATE,=,AUTHENTICATED_BY_AAA
Conditions=DEG_SSL_STATE,=,AKA_CHALLENGE_REJECTED_BY_AAA
Operations=or,or,or,or
TrueRuleChain=100.InitSslSessionDelete
TrueRuleChain=110.ExecuteSslSessionDelete


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/150.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus/100.InitSslSessionDelete]

AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_OEMDevSSLSSDeletedInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/150.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus/110.ExecuteSslSessionDelete]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ValidateRequest


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPSubscriberIdString,=,dummy
Conditions=DEG_OEMDevEAPPayloadString,=,dummy
Conditions=DEG_OEMDevSubscriberIdString,=,dummy
Conditions=DEG_OEMDevTokenString,=,dummy
Conditions=DEG_OEMDevServiceNameList,=,com.hp.siu.utils.StringAttribute|1|64756d6d79
Conditions=DEG_OEMDevVersionInteger,=,-1
Conditions=DEG_OEMDevTerminalVendorString,=,dummy
Conditions=DEG_OEMDevTerminalModelString,=,dummy
Conditions=DEG_OEMDevTermianlSWversionString,=,dummy
Conditions=DEGDROID_TerminalUniqueIdString,=,dummy
Conditions=DEG_OEMDevFriendlyDeviceString,=,-99DEGINVALID-99
Conditions=DEG_OEMDevSipUserNameString,=,-99DEGINVALID-99
Conditions=DEG_OEMDevOTPLong,=,99999
FalseRuleChain=200.ValidateRequestParameters
Operations=and,and,and,and,and,and,and,and,and,and,and,and
TrueRuleChain=100.CallForRCSLogic


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/100.CallForRCSLogic]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=150.DEG30RCSInitialConnectRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/150.GenerateStartAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Operations=DoAll
TrueRuleChain=ValidateEAPSubscriberId
TrueRuleChain=ValidateIMSISubscriberId
TrueRuleChain=ValidateEAPPayload
TrueRuleChain=ValidateToken
TrueRuleChain=ValidateServiceName
TrueRuleChain=ValidateVersion
TrueRuleChain=ValidateOTP
TrueRuleChain=ValidateIMSIEAPandIMSI
TrueRuleChain=ValidateIMSIEAPandToken
TrueRuleChain=ValidateEAPPayloadandIMSI
TrueRuleChain=ValidateEAPPayloadandToken
TrueRuleChain=ValidateIMSIEAPandEAPPayload
TrueRuleChain=ValidateIMSIandToken
TrueRuleChain=ValidateServiceNameandVersion
TrueRuleChain=ValidateTerminalUniqueId
ValidateEAPPayload=200.ValidateEAPPayload
ValidateEAPPayloadandIMSI=800.ValidateEAPPayloadandIMSI
ValidateEAPPayloadandToken=900.ValidateEAPPayloadandToken
ValidateEAPSubscriberId=100.ValidateEAPSubscriberId
ValidateIMSIandToken=1100.ValidateIMSIEAPandEAPPayload
ValidateIMSIEAPandEAPPayload=1000.ValidateIMSIEAPandEAPPayload
ValidateIMSIEAPandIMSI=600.ValidateIMSIEAPandIMSI
ValidateIMSIEAPandToken=700.ValidateIMSIEAPandToken
ValidateIMSISubscriberId=110.ValidateIMSISubscriberId
ValidateOTP=310.ValidateOTP
ValidateServiceName=400.ValidateServiceName
ValidateServiceNameandVersion=1200.ValidateServiceNameandVersion
ValidateTerminalUniqueId=1300.ValidateTerminalUniqueId
ValidateToken=300.ValidateToken
ValidateVersion=500.ValidateVersion


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/100.ValidateEAPSubscriberId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPSubscriberIdString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/100.ValidateEAPSubscriberId/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0030"
AdornOps=set DEG_OEMDevErrorMessageString "EAP SubscriberId is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/100.ValidateEAPSubscriberId/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request : EAP SubscriberId is empty: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/100.ValidateEAPSubscriberId/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1000.ValidateIMSIEAPandEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevEAPPayloadString,!=,dummy
Operations=and
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1000.ValidateIMSIEAPandEAPPayload/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0041"
AdornOps=set DEG_OEMDevErrorMessageString "Both EAP SubscriberId and EAPPayload should not come inthe request"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1000.ValidateIMSIEAPandEAPPayload/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request : Both EAP SubscriberId and EAPPayload should not come in the request:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1000.ValidateIMSIEAPandEAPPayload/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/110.ValidateIMSISubscriberId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/110.ValidateIMSISubscriberId/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0031"
AdornOps=set DEG_OEMDevErrorMessageString "SubscriberId is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/110.ValidateIMSISubscriberId/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request : SubscriberId is empty: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/110.ValidateIMSISubscriberId/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1100.ValidateIMSIEAPandEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevTokenString,=,dummy
Conditions=DEG_DevAuthTypeString,!=,NONE
Operations=and,and
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1100.ValidateIMSIEAPandEAPPayload/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0042"
AdornOps=set DEG_OEMDevErrorMessageString "Token is required in the request"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1100.ValidateIMSIEAPandEAPPayload/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request : Token is required in the request:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1100.ValidateIMSIEAPandEAPPayload/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1200.ValidateServiceNameandVersion]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevServiceNameList,!=,com.hp.siu.utils.StringAttribute|1|
Conditions=DEG_OEMDevServiceNameList,!=,com.hp.siu.utils.StringAttribute|1|64756d6d79
Conditions=DEG_OEMDevVersionInteger,=,-1
Operations=and,and
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1200.ValidateServiceNameandVersion/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0029"
AdornOps=set DEG_OEMDevErrorMessageString "Both Servicename and Version should come inthe request"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1200.ValidateServiceNameandVersion/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevServiceNameList
Attributes=DEG_OEMDevVersionInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request : Both Service name and Version should come in the request:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1200.ValidateServiceNameandVersion/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1300.ValidateTerminalUniqueId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEGDROID_TerminalUniqueIdString,=,""
Conditions=DEGDROID_TerminalUniqueIdString,=,dummy
Operations=or
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1300.ValidateTerminalUniqueId/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0028"
AdornOps=set DEG_OEMDevErrorMessageString "Terminal ID is mandatory"
AdornOps=set DEG_OEMDevUniqueIDString ""
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1300.ValidateTerminalUniqueId/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevServiceNameList
Attributes=DEG_OEMDevVersionInteger
Attributes=DEGDROID_TerminalUniqueIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request : Terminal ID is empty:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1300.ValidateTerminalUniqueId/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/200.ValidateEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPPayloadString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/200.ValidateEAPPayload/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0032"
AdornOps=set DEG_OEMDevErrorMessageString "EAPPayload is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/200.ValidateEAPPayload/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request : EAPPayload is empty: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/200.ValidateEAPPayload/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/300.ValidateToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/300.ValidateToken/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0033"
AdornOps=set DEG_OEMDevErrorMessageString "Token is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/300.ValidateToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request : Token is empty: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/300.ValidateToken/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/310.ValidateOTP]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevOTPLong,=,-1
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/310.ValidateOTP/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0034"
AdornOps=set DEG_OEMDevErrorMessageString "OTP is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/310.ValidateOTP/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request : OTP is empty: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/310.ValidateOTP/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/400.ValidateServiceName]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevServiceNameList,=,com.hp.siu.utils.StringAttribute|1|
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/400.ValidateServiceName/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0035"
AdornOps=set DEG_OEMDevErrorMessageString "service_name is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/400.ValidateServiceName/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevServiceNameList
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request : service_name is empty: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/400.ValidateServiceName/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/500.ValidateVersion]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevVersionInteger,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/500.ValidateVersion/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0036"
AdornOps=set DEG_OEMDevErrorMessageString "version is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/500.ValidateVersion/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevVersionInteger
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request : version is empty: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/500.ValidateVersion/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/600.ValidateIMSIEAPandIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy
Operations=and
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/600.ValidateIMSIEAPandIMSI/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0037"
AdornOps=set DEG_OEMDevErrorMessageString "Both EAP SubscriberId and SubscriberId should not come in the request"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/600.ValidateIMSIEAPandIMSI/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request : Both EAP SubscriberId and SubscriberId should not come in the request:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/600.ValidateIMSIEAPandIMSI/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/700.ValidateIMSIEAPandToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevTokenString,!=,dummy
Operations=and
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/700.ValidateIMSIEAPandToken/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0038"
AdornOps=set DEG_OEMDevErrorMessageString "Both EAP SubscriberId and token should not come inthe request"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/700.ValidateIMSIEAPandToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request : Both EAP SubscriberId and token should not come inthe request:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/700.ValidateIMSIEAPandToken/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/800.ValidateEAPPayloadandIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPPayloadString,!=,dummy
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy
Operations=and
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/800.ValidateEAPPayloadandIMSI/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0039"
AdornOps=set DEG_OEMDevErrorMessageString "Both EAPPayload  and SubscriberId should not come inthe request"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/800.ValidateEAPPayloadandIMSI/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request : Both EAPPayload  and SubscriberId should not come in the request:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/800.ValidateEAPPayloadandIMSI/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/900.ValidateEAPPayloadandToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPPayloadString,!=,dummy
Conditions=DEG_OEMDevTokenString,!=,dummy
Operations=and
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/900.ValidateEAPPayloadandToken/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0040"
AdornOps=set DEG_OEMDevErrorMessageString "Both EAPPayload  and token should not come inthe request"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/900.ValidateEAPPayloadandToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request : Both EAPPayload  and token should not come inthe request:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/900.ValidateEAPPayloadandToken/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetParametersOfHttpResponse
RuleNames=200.CheckIfDeleteSSLSession


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_REQUEST_STATE,=,"NEW"
Conditions=DEG_OEMDevHttpErrorNameString,contains,DecodeException
Conditions=DEG_OEMDevHttpErrorNameString,contains,XMLStreamException
Conditions=DEG_SSL_REQUEST_STATE,=,"403C"
Conditions=DEG_SSL_REQUEST_STATE,=,"500C"
Conditions=DEG_SSL_REQUEST_STATE,=,"503C"
Conditions=DEG_SSL_REQUEST_STATE,=,"511C"
Conditions=DEG_SSL_REQUEST_STATE,=,DEG_SSL_REQUEST_STATE
GzipParseError=100.GzipParseError_SetHttpResponse
GzipParseError=110.GzipParseError_LogResponse
Http403C=300.Http403C_SetHttpResponse
Http403C=305.Http403C_EndAudit
Http403C=310.Http403C_LogResponse
Http500C=400.Http500C_SetHttpResponse
Http500C=405.Http500C_EndAudit
Http500C=410.Http500C_LogResponse
Http503C=600.Http503C_SetHttpResponse
Http503C=610.Http503C_LogResponse
Http511C=700.Http511C_SetHttpResponse
Http511C=710.Http511C_LogResponse
HttpUnknown=500.HttpUnknown_SetHttpResponse
HttpUnknown=510.HttpUnknown_LogResponse
JsonParseError=200.JsonParseError_SetHttpResponse
JsonParseError=210.JsonParseError_LogResponse
JsonParseError2=200.JsonParseError_SetHttpResponse
JsonParseError2=210.JsonParseError_LogResponse
Operations=None
TrueRuleChain=GzipParseError
TrueRuleChain=JsonParseError
TrueRuleChain=JsonParseError2
TrueRuleChain=Http403C
TrueRuleChain=Http500C
TrueRuleChain=Http503C
TrueRuleChain=Http511C
TrueRuleChain=HttpUnknown


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/100.GzipParseError_SetHttpResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger 403
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0043"
AdornOps=set DEG_OEMDevErrorMessageString "GZIP decopmressing error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/110.GzipParseError_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=GZIP decopmressing error - request processed with http status 403 and http session closed: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/200.JsonParseError_SetHttpResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger 403
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0044"
AdornOps=set DEG_OEMDevErrorMessageString "JSON parsing error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/210.JsonParseError_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=JSON parsing error - request processed with http status 403 and http session closed: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/300.Http403C_SetHttpResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger 403
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0045"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/305.Http403C_EndAudit]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,!=,"UNKNOWN_SUBSCRIBER"
TrueRuleChain=InvokeEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/305.Http403C_EndAudit/InvokeEndAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/310.Http403C_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request – Response is http status 403 and http session closed
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/400.Http500C_SetHttpResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0046"
AdornOps=setifnull DEG_OEMDevErrorMessageString "Internal error, http status 500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/405.Http500C_EndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/410.Http500C_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Internal error Response is http status 500 and http session closed
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/500.HttpUnknown_SetHttpResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0049"
AdornOps=set DEG_OEMDevErrorMessageString "Unrecognized internal state"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/510.HttpUnknown_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Unrecognized internal state - request processed with http status 500 and http session closed: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/600.Http503C_SetHttpResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger 503
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0047"
AdornOps=set DEG_OEMDevErrorMessageString "Internal error, http status 503"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/610.Http503C_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Internal error Response is http status 503 and http session closed
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/700.Http511C_SetHttpResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger 511
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0048"
AdornOps=set DEG_OEMDevErrorMessageString "Internal error, http status 511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/710.Http511C_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Internal error Response is http status 511 and http session closed
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/200.CheckIfDeleteSSLSession]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSSLSSDeletedInteger,=,0
TrueRuleChain=100.CheckSSLSessionStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/200.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"NEW"
Conditions=DEG_SSL_STATE,=,UNKNOWN_SUBSCRIBER
Conditions=DEG_SSL_STATE,=,AUTHENTICATED_BY_DEG_TOKEN
Conditions=DEG_SSL_STATE,=,AUTHENTICATED_BY_AAA
Conditions=DEG_SSL_STATE,=,AKA_CHALLENGE_REJECTED_BY_AAA
Operations=or,or,or,or
TrueRuleChain=100.InitSslSessionDelete
TrueRuleChain=110.ExecuteSslSessionDelete


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/200.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus/100.InitSslSessionDelete]

AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_OEMDevSSLSSDeletedInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/200.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus/110.ExecuteSslSessionDelete]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckTokenTimeStamp


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
FalseRuleChain=200.SetFullAuthTimeStamp
TrueRuleChain=100.GetDifference
TrueRuleChain=110.SetTokenLifeTime
TrueRuleChain=110.CheckTokenLifeTime
TrueRuleChain=115.SetErrorInfo
TrueRuleChain=120.TokenExpirationLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/100.GetDifference]

AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_FULLAUTHTIMESTAMP DEG_OEMDevTokenTimeStampDiffLong
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.CheckTokenLifeTime]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenTimeStampDiffLong,<=,DEG_OEMDevEAPTokenLifetimeLong
FalseRuleChain=200.CheckRequestIMSI
TrueRuleChain=100.SetFastAuthFlag


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.CheckTokenLifeTime/100.SetFastAuthFlag]

AdornOps=set DEG_OEMDevFastAuthFlag 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.CheckTokenLifeTime/200.CheckRequestIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy
TrueRuleChain=200.SetErrorInfo
TrueRuleChain=210.ErrorLog
TrueRuleChain=220.GenerateInitialAuthSystemErrorEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.CheckTokenLifeTime/200.CheckRequestIMSI/200.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0050"
AdornOps=set DEG_SSL_STATE "NEW"
AdornOps=set DEG_CDevOutReturnCodeString "511"
AdornOps=set DEG_OEMDevErrorMessageString "Network Authentication Required"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.CheckTokenLifeTime/200.CheckRequestIMSI/210.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_FULLAUTHTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Token Expired : Network Authentication Required : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.CheckTokenLifeTime/200.CheckRequestIMSI/220.GenerateInitialAuthSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.SetTokenLifeTime]

AdornOps=set DEG_OEMDevEAPTokenLifetimeLong ${DEGDROID_FULL_AUTH_MUST_WINDOW}
AdornOps=* DEG_OEMDevEAPTokenLifetimeLong 1000 DEG_OEMDevEAPTokenLifetimeLong
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/115.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0051"
AdornOps=set DEG_OEMDevErrorMessageString "Token Expire"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/120.TokenExpirationLog]

Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevCurrentTimeStampLong
Attributes=DEG_OEMDevTokenTimeStampDiffLong
Attributes=DEG_FULLAUTHTIMESTAMP
Attributes=DEG_OEMDevFastAuthFlag
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_TOKENSTATUS
Attributes=DEG_OEMDevTokenString
Attributes=DEG_SUBSTOKEN
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_OEMDevEAPTokenLifetimeLong
Attributes=DEG_CDevDBErrorFlagInteger
Attributes=DEG_CDevDBNoMatchFlagInteger
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=TokenExpiration Log:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/200.SetFullAuthTimeStamp]

AdornOps=setsystime DEG_FULLAUTHTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.BlackListSubscriber_InitResponse
RuleNames=200.UpdateSslSessionState


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/100.BlackListSubscriber_InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 511
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 511
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=300.CheckSslSessionUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/100.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_SSL_STATE "BLACKLISTED_SUBSCRIBER"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=120.StartAuditRuleChain
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0052"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_SSL_SESSION table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_SSL_SESSION table : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
FalseRuleChain=100.GenerateEndAuditForBlackListSubsciber
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.GenerateEndAuditForBlackListSubsciber]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0053"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_SSL_SESSION session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain]

ClassName=RuleChain
RuleNames=100.InitVariables
RuleNames=200.CheckIfBlackListEnabled


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/100.InitVariables]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=setifnull DEG_MDN 0
AdornOps=setifnull DEG_BLACKLIST_FLAG 0
AdornOps=setifnull DEG_AUTH_COUNT 0
AdornOps=set DEG_EVENTTIMESTAMP 0
AdornOps=set DEG_FULLAUTHTIMESTAMP 0
AdornOps=set DEG_BLACKLISTWINDOW_STARTTIME 0
AdornOps=set DEG_OEMDevBlacklistStatusString ${DEG_BLACKLIST_STATUS}
AdornOps=lower DEG_OEMDevBlacklistStatusString DEG_OEMDevBlacklistStatusString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled]

ClassName=ConditionalRule
Conditions=DEG_OEMDevBlacklistStatusString,=,"enabled"
TrueRuleChain=200.LookupDEGDROIDToken
TrueRuleChain=300.CheckDEGToken
TrueRuleChain=400.UpdateDEGToken


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/200.LookupDEGDROIDToken]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
MapAttributes=DEG_BLACKLISTWINDOW_STARTTIME,DEG_BLACKLISTWINDOW_STARTTIME
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckIfSessionKeyExists
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0054"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEGDROID_TOKENS table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
FalseRuleChain=200.TokenFound
TrueRuleChain=100.TokenNotFound


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/100.TokenNotFound]

AdornOps=set DEG_AUTH_COUNT 0
AdornOps=setsystime DEG_BLACKLISTWINDOW_STARTTIME
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckIfSubscriberIsBlacklisted
RuleNames=200.CheckAndUpdateAuthCount


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted]

ClassName=ConditionalRule
Conditions=DEG_BLACKLIST_FLAG,=,1
TrueRuleChain=100.SetBlackListedResponse


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GetDifference
RuleNames=200.CheckDOAWindow


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/100.GetDifference]

AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=set DEG_OEMDevDenialOfActionWindowLong ${DENIAL_OF_ACTION_WINDOW}
AdornOps=copy DEG_BLACKLISTWINDOW_STARTTIME DEG_OEMDevDOAStartTimeLong
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_OEMDevDOAStartTimeLong DEG_OEMDevTimeStampDiffLong
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/200.CheckDOAWindow]

ClassName=ConditionalRule
Conditions=DEG_OEMDevTimeStampDiffLong,<,DEG_OEMDevDenialOfActionWindowLong
FalseRuleChain=200.ResetAuthCount
TrueRuleChain=100.GenerateBlackListedResponse
TrueRuleChain=101.SetErrorResponse
TrueRuleChain=200.LogBlackListSubscriber


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/200.CheckDOAWindow/100.GenerateBlackListedResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=140.DEG30GenerateBlackListedResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/200.CheckDOAWindow/101.SetErrorResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0055"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber is blacklisted"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/200.CheckDOAWindow/200.LogBlackListSubscriber]

Attributes=DEG_AUTH_COUNT
Attributes=DEG_OEMDevImsiString
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_BLACKLISTWINDOW_STARTTIME
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=Subscriber is blacklisted :
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/200.CheckDOAWindow/200.ResetAuthCount]

AdornOps=set DEG_BLACKLIST_FLAG 0
AdornOps=set DEG_AUTH_COUNT 0
AdornOps=setsystime DEG_BLACKLISTWINDOW_STARTTIME
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount]

ClassName=ConditionalRule
Conditions=DEG_BLACKLIST_FLAG,=,0
TrueRuleChain=VerifyIfSubscriberBlacklisted


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted]

ClassName=RuleChain
RuleNames=100.GetDifference
RuleNames=200.CheckEventTimeStamp


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/100.GetDifference]

AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=copy DEG_BLACKLISTWINDOW_STARTTIME DEG_OEMDevBlackListWindowStartTimeLong
AdornOps=set DEG_OEMDevBlackListWindowLong ${BLACKLIST_TIMEWINDOW}
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_OEMDevBlackListWindowStartTimeLong DEG_OEMDevTimeStampDiffLong
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTimeStampDiffLong,<,DEG_OEMDevBlackListWindowLong
FalseRuleChain=200.ResetAuthCount
TrueRuleChain=000.GetAuthThresholdCount
TrueRuleChain=100.UpdateAuthCount
TrueRuleChain=200.CheckAuthCount


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequest
RuleNames=110.ReadValue
RuleNames=120.CheckErrorAndNoMatchFlag


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/100.InitRequest]

AdornOps=set DEG_OEMDevLicenseTypeString "EAP"
AdornOps=set DEG_OEMDevAuthThresholdCountInteger 0
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_OEMDevLicenseTypeString
ResponseAttributes=DEG_OEMDevAuthThresholdCountInteger
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=004.ReadTokenLifeTimeRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
FalseRuleChain=210.SetErrorForLog
FalseRuleChain=220.ErrorLog
TrueRuleChain=100.CheckIfKeyExist


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
FalseRuleChain=210.SetErrorForLog
FalseRuleChain=220.RowNotExistsLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/210.SetErrorForLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0057"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/220.RowNotExistsLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=No Row Found in DEG_LIC_LIMITS cache: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag/210.SetErrorForLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0056"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag/220.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to access DEG_LIC_LIMITS cache
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/100.UpdateAuthCount]

AdornOps=+ DEG_AUTH_COUNT 1 DEG_AUTH_COUNT
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.CheckAuthCount]

ClassName=ConditionalRule
Conditions=DEG_AUTH_COUNT,>,DEG_OEMDevAuthThresholdCountInteger
TrueRuleChain=100.SetBlackListed
TrueRuleChain=200.SendBlacklistResponse
TrueRuleChain=210.SetErrorResponse
TrueRuleChain=300.LogBlackListSubscriber


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.CheckAuthCount/100.SetBlackListed]

AdornOps=set DEG_BLACKLIST_FLAG 1
AdornOps=setsystime DEG_BLACKLISTWINDOW_STARTTIME
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.CheckAuthCount/200.SendBlacklistResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=140.DEG30GenerateBlackListedResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.CheckAuthCount/210.SetErrorResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0058"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber is blacklisted"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.CheckAuthCount/300.LogBlackListSubscriber]

Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_BLACKLISTWINDOW_STARTTIME
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=Subscriber is blacklisted :
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.ResetAuthCount]

AdornOps=set DEG_AUTH_COUNT 1
AdornOps=setsystime DEG_BLACKLISTWINDOW_STARTTIME
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.LogRule
RuleNames=010.SetErrorResponse
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/000.LogRule]

Attributes=DEG_IMSI
Attributes=DEG_BLACKLISTWINDOW_STARTTIME
Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=While updating DEGDROID_TOKENS table :
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/010.SetErrorResponse]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0059"
AdornOps=set DEG_OEMDevMessageString "While updating DEGDROID_TOKENS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/100.InitUpdate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/200.Update]

ClassName=ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
TrueRuleChain=UpdateTokenstable


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/200.Update/UpdateTokenstable]

ClassName=UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_BLACKLISTWINDOW_STARTTIME,DEG_BLACKLISTWINDOW_STARTTIME
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=000.SetErrorInfo
TrueRuleChain=100.SystemErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/300.CheckUpdateStatus/000.SetErrorInfo]

AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEGDROID_TOKENS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/300.CheckUpdateStatus/100.SystemErrorLog]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while updating DEGDROID_TOKENS table :
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ExecuteResponseTemplateLookup
RuleNames=200.CheckLookupStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/100.ExecuteResponseTemplateLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AUTH_TYPE,DEG_AUTH_TYPE
MapAttributes=DEG_AUTH_STEP,DEG_AUTH_STEP
MapAttributes=DEG_XML_TEMPLATES_FILE,DEG_XML_TEMPLATES_FILE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_AUTH_XML_TEMPLATES_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/200.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/200.CheckLookupStatus/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0061"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEGDROID_AUTH_XML_TEMPLATES table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/200.CheckLookupStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEGDROID_AUTH_XML_TEMPLATES table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/200.CheckLookupStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
FalseRuleChain=200.MessageFormatRule
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/200.CheckLookupStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0062"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find a row in DEGDROID_AUTH_XML_TEMPLATES table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/200.CheckLookupStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=Database Error: Unable to find the record in DEGDROID_AUTH_XML_TEMPLATES table : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/200.CheckLookupStatus/200.CheckKeyExists/200.MessageFormatRule]

ClassName=com.hp.usage.rules.transform.MessageFormatRule
Locale=en_US
MessageFormat=DEG_XML_TEMPLATES_FILE
ResultAttribute=DEG_XML_TEMPLATES_FILE
UseDynamicMessageFormat=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequestVariables
RuleNames=110.ReadValue
RuleNames=120.CheckErrorAndNoMatchFlag


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/100.InitRequestVariables]

AdornOps=set DEG_CDevSysParameter "EAPAKADefaultAuthWhenError"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
Conditions=DEG_CDevSysValueString,=,"Enabled"
FalseRuleChain=200.InitResponse
Operations=and,and
TrueRuleChain=100.SetSessionStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag/100.SetSessionStatus]

AdornOps=set DEG_AUTHENTICATION_SUBTYPE "DFT"
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_SSL_STATE AUTHENTICATED_BY_DEG_TOKEN
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag/200.InitResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=errFlag,=,2
FalseRuleChain=200.SetErrorFromAAAResponse
TrueRuleChain=100.SetAAACommunicationFailureResponse


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag/200.InitResponse/100.SetAAACommunicationFailureResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set  DEG_SSL_STATE "AKA_CHALLENGE_REJECTED_BY_AAA"
AdornOps=set ResponseHeaderRetryAfterInteger ${DEGDROID_DEVICE_HTTP_RETRY_WINDOW}
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=set DEG_OEMDevErrorMessageString "Authentication attempt rejected by AAA"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag/200.InitResponse/200.SetErrorFromAAAResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "503C"
AdornOps=set  DEG_SSL_STATE "AKA_CHALLENGE_REJECTED_BY_AAA"
AdornOps=set ResponseHeaderRetryAfterInteger ${DEGDROID_DEVICE_HTTP_RETRY_WINDOW}
AdornOps=set DEG_CDevOutReturnCodeString "503"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag/210.SetErrorResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckDBStatus
RuleNames=100.InitializeRequestVariables
RuleNames=110.InvokeHttpRequest
RuleNames=120.CheckResultCode
RuleNames=121.SetErrorResponse
RuleNames=200.LogResponse


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdateAttributes
RuleNames=200.UpdateHCData
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/100.InitUpdateAttributes]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_CDevHCDBCheckInteger 0
AdornOps=set DEG_HC_PROCESS_NAME ${DEGDROID_DEVICEINTERFACE_PROCESS_NAME}
AdornOps=setsystime DEG_HC_LASTUPDATE
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/200.UpdateHCData]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_HC_LASTUPDATE,DEG_HC_LASTUPDATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_HC_DATA_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevHCDBCheckInteger 500
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.InitCreate
TrueRuleChain=200.InsertHCData
TrueRuleChain=300.CheckCreateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/200.CheckKeyExists/100.InitCreate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_CDevHCDBCheckInteger 0
AdornOps=set DEG_HC_PROCESS_NAME ${DEGDROID_DEVICEINTERFACE_PROCESS_NAME}
AdornOps=setsystime DEG_HC_LASTUPDATE
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/200.CheckKeyExists/200.InsertHCData]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_HC_DATA_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/200.CheckKeyExists/300.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Operations=or
TrueRuleChain=100.SetErrorInfo


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/200.CheckKeyExists/300.CheckCreateStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevHCDBCheckInteger 500
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.InitializeRequestVariables]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=setifnull DEG_OEMDevRespStatusString 0
AdornOps=set DEG_OEMDevEAPSubscriberIdString "AgAAOwEwMzEwMTI5ODIwMDQwMDAxQG5haS5lcGMubW5jMTI5Lm1jYzMxMC4zZ3BwbmV0d29yay5vcmc="
AdornOps=set DEG_OEMDevActionNameString "healthCheck"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/110.InvokeHttpRequest]

ClassName=com.hp.usage.lookup.SynchronousLookupRule
ConnectorName=202.HttpRequestClient
ErrorCodeAttribute=DEG_CDevProcessingErrorIdString
ErrorMessageAttribute=DEG_OEMDevErrorMessageString


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/110.InvokeHttpRequest/ErrorRule]

Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=HttpRequestClient-ErrorRule
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/110.InvokeHttpRequest/NoMatchRule]

Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=HttpRequestClient-NoMatchRule
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/110.InvokeHttpRequest/SetErrorResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0063"
AdornOps=set DEG_OEMDevErrorMessageString "HttpRequestClient-ErrorRule"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/110.InvokeHttpRequest/SetErrorResponseFlag]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0064"
AdornOps=set DEG_OEMDevErrorMessageString "HttpRequestClient-NoMatchRule"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/120.CheckResultCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevHttpStatusInteger,=,200
Conditions=DEG_CDevHCDBCheckInteger,=,0
FalseRuleChain=200.SetFailureResponse
Operations=and
TrueRuleChain=100.SetSuccessResponse


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/120.CheckResultCode/100.SetSuccessResponse]

AdornOps=set DEGDROID_OEMDevLoadBalRespMsgString "DEGDROID_DeviceInterface Status:UP AND RUNNING"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/120.CheckResultCode/200.SetFailureResponse]

AdornOps=set DEGDROID_OEMDevLoadBalRespMsgString "DEGDROID_DeviceInterface Status:Down or Hanging"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/121.SetErrorResponse]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0065"
AdornOps=set DEG_OEMDevMessageString "F5 HeartBeat"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/200.LogResponse]

Attributes=DEGDROID_OEMDevLoadBalRespMsgString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=F5 HeartBeat: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVariables
RuleNames=200.CopyBeforeResponseAttributeCustomize
RuleNames=250.SetResponseAttributeCustomize
RuleNames=300.LogBeforeResponseAttributeCustomize
RuleNames=400.ProcessResponseAttributeCustomize
RuleNames=500.CopyAfterResponseAttributeCustomize
RuleNames=550.SetAfterResponseAttributeCustomize
RuleNames=600.LogAfterResponseAttributeCustomize


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/100.InitVariables]

AdornOps=setifnull DEG_DevAuthTypeString ""
AdornOps=setifnull DEG_OEMDevSslSessionIdString ""
AdornOps=setifnull DEG_OEMDevImsiString ""
AdornOps=setifnull CUST_DDRPP_OUT_Status 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/200.CopyBeforeResponseAttributeCustomize]

AdornOps=copy DEG_DevAuthTypeString CUST_DDRPP_IN_AuthTypeString
AdornOps=copy DEG_OEMDevSslSessionIdString CUST_DDRPP_IN_SslSessionIdString
AdornOps=copy DEG_OEMDevImsiString CUST_DDRPP_IN_IMSIString
AdornOps=copy DEG_OEMDevRequestProcessedInteger CUST_DDRPP_OUT_Status
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/250.SetResponseAttributeCustomize]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0066"
AdornOps=set DEG_OEMDevMessageString "before response attribute customization"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/300.LogBeforeResponseAttributeCustomize]

Attributes=CUST_DDRPP_IN_AuthTypeString
Attributes=CUST_DDRPP_IN_SslSessionIdString
Attributes=CUST_DDRPP_IN_IMSIString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Log before response attribute customization::
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/400.ProcessResponseAttributeCustomize]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_Android_Response_Custom_Values
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/500.CopyAfterResponseAttributeCustomize]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=CUST_DDRPP_OUT_Status,=,1
TrueRuleChain=100.SetCustomAttribute


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/500.CopyAfterResponseAttributeCustomize/100.SetCustomAttribute]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/550.SetAfterResponseAttributeCustomize]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0067"
AdornOps=set DEG_OEMDevMessageString "after response attribute customization"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/600.LogAfterResponseAttributeCustomize]

Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Attributes=CUST_DDRPP_OUT_Status
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Log after response attribute customization::
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/600.GenerateAuditAndNRBEventsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpAuditRecord
RuleNames=200.DumpMonitoringTransactions


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/600.GenerateAuditAndNRBEventsRuleChain/100.DumpAuditRecord]

ClassName=com.hp.siu.sessionserver.rules.NMEStoreRule
NMEStore=AuditNmeStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/600.GenerateAuditAndNRBEventsRuleChain/200.DumpMonitoringTransactions]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_NrbMonitoringSessionIdList
RequestAttributes=DEG_AuditProcessingNodeString
RequestAttributes=DEG_AuditTimestampLong
RequestAttributes=DEG_AuditInterfaceString
RequestAttributes=DEG_AuditInOutString
RequestAttributes=DEG_AuditResultCodeString
RequestAttributes=DEG_AuditMdnString
RequestAttributes=DEG_AuditIMSIString
RequestAttributes=DEG_AuditTransactionTypeString
RequestAttributes=DEG_AuditSourceDestinationString
RequestAttributes=DEG_AuditNRBMessageString
RequestAttributes=DEG_AuditMessageString
RuleChain=601.DumpMonitoringTransactionsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpMonitoringTransactions


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.DumpMonitoringTransactions


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_NrbMonitoringSessionIdList
RuleChain=100.InsertMonitoringTransactionToDb
TmpAttributeName=DEG_NrbMonitoringSessionIdString


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORINGID_GENERATOR


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateTransactionId
RuleNames=110.PopulateMonitoringTransactionAttributes
RuleNames=120.InitInsert2Db
RuleNames=200.Insert2Db
RuleNames=300.CheckCreateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/100.GenerateTransactionId]

AdornOps=setsystime DEG_Tmp1Long
AdornOps=copy DEG_Tmp1Long DEG_Tmp1String
AdornOps=+ DEG_Tmp1String DEG_MSESSIONTRANSID DEG_MSESSIONTRANSID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/110.PopulateMonitoringTransactionAttributes]

AdornOps=copy DEG_AuditProcessingNodeString DEG_MSESSIONPROCID
AdornOps=copy DEG_AuditTimestampLong DEG_MSESSIONTIMESTAMP
AdornOps=copy DEG_AuditInterfaceString DEG_MSESSIONINTERFACE
AdornOps=copy DEG_AuditInOutString DEG_MSESSIONINOUT
AdornOps=copy DEG_AuditResultCodeString DEG_MSESSIONRESULTCODE
AdornOps=copy DEG_AuditMdnString DEG_MSESSIONMDN
AdornOps=copy DEG_AuditIMSIString DEG_MSESSIONIMSI
AdornOps=copy DEG_AuditTransactionTypeString DEG_MSESSIONTRANSACTIONTYPE
AdornOps=copy DEG_AuditSourceDestinationString DEG_MSESSIONSOURCEDESTINATION
AdornOps=copy DEG_AuditNRBMessageString DEG_MSESSIONMESSAGE
AdornOps=set DEG_MSESSIONUNIQUE_ID ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/120.InitInsert2Db]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_NrbMonitoringSessionIdString DEG_MSESSIONID
AdornOps=set log_DB_Operation "CREATE"
AdornOps=set log_Table_Name "DEG_MONITORING_TRANSACTIONS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/200.Insert2Db]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_MONITORING_TRANSACTIONS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
Operations=or
TrueRuleChain=99.InitErrorLog
TrueRuleChain=100.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus/100.ErrorLog]

Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_MSESSIONID
Attributes=DEG_MSESSIONTRANSID
Attributes=DEG_MSESSIONPROCID
Attributes=DEG_MSESSIONTIMESTAMP
Attributes=DEG_MSESSIONINTERFACE
Attributes=DEG_MSESSIONINOUT
Attributes=DEG_MSESSIONRESULTCODE
Attributes=DEG_MSESSIONMDN
Attributes=DEG_MSESSIONTRANSACTIONTYPE
Attributes=DEG_MSESSIONSOURCEDESTINATION
Attributes=DEG_MSESSIONMESSAGE
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=Database Error: Unable to create entry in DEG_MONITORING_TRANSACTIONS session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus/99.InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0007"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to create entry in DEG_MONITORING_TRANSACTIONS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetEmptyTransactionId
RuleNames=200.Log


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/100.SetEmptyTransactionId]

AdornOps=set DEG_MSESSIONTRANSID ""
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0008"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to generate unique value of monitoring transaction id"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/200.Log]

Attributes=DEG_MSESSIONTRANSID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=Unable to generate unique value of monitoring transaction id: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_NrbMonitoringSessionIdList != null


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/650.DEG20GenerateAuditAndNRBEventsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpAuditRecord
RuleNames=200.DumpMonitoringTransactions


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/650.DEG20GenerateAuditAndNRBEventsRuleChain/100.DumpAuditRecord]

ClassName=com.hp.siu.sessionserver.rules.NMEStoreRule
NMEStore=AuditNmeStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/650.DEG20GenerateAuditAndNRBEventsRuleChain/200.DumpMonitoringTransactions]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_NrbMonitoringSessionIdList
RequestAttributes=DEG_AuditProcessingNodeString
RequestAttributes=DEG_AuditTimestampLong
RequestAttributes=DEG_AuditInterfaceString
RequestAttributes=DEG_AuditInOutString
RequestAttributes=DEG_AuditResultCodeString
RequestAttributes=DEG_AuditMdnString
RequestAttributes=DEG_AuditIMSIString
RequestAttributes=DEG_AuditTransactionTypeString
RequestAttributes=DEG_AuditSourceDestinationString
RequestAttributes=DEG_AuditNRBMessageString
RequestAttributes=DEG_AuditMessageString
RequestAttributes=DEG_AuditEntitlementNameString
RequestAttributes=DEG_AuditUniqueIDString
RequestAttributes=DEG_AuditSourceDestinationVersionString
RuleChain=651.DEG20DumpMonitoringTransactionsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpMonitoringTransactions


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.DumpMonitoringTransactions


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_NrbMonitoringSessionIdList
RuleChain=100.InsertMonitoringTransactionToDb
TmpAttributeName=DEG_NrbMonitoringSessionIdString


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORINGID_GENERATOR


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateTransactionId
RuleNames=110.PopulateMonitoringTransactionAttributes
RuleNames=120.InitInsert2Db
RuleNames=200.Insert2Db
RuleNames=300.CheckCreateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/100.GenerateTransactionId]

AdornOps=setsystime DEG_Tmp1Long
AdornOps=copy DEG_Tmp1Long DEG_Tmp1String
AdornOps=+ DEG_Tmp1String DEG_MSESSIONTRANSID DEG_MSESSIONTRANSID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/110.PopulateMonitoringTransactionAttributes]

AdornOps=copy DEG_AuditProcessingNodeString DEG_MSESSIONPROCID
AdornOps=copy DEG_AuditTimestampLong DEG_MSESSIONTIMESTAMP
AdornOps=copy DEG_AuditInterfaceString DEG_MSESSIONINTERFACE
AdornOps=copy DEG_AuditInOutString DEG_MSESSIONINOUT
AdornOps=copy DEG_AuditResultCodeString DEG_MSESSIONRESULTCODE
AdornOps=copy DEG_AuditMdnString DEG_MSESSIONMDN
AdornOps=copy DEG_AuditIMSIString DEG_MSESSIONIMSI
AdornOps=copy DEG_AuditTransactionTypeString DEG_MSESSIONTRANSACTIONTYPE
AdornOps=copy DEG_AuditSourceDestinationString DEG_MSESSIONSOURCEDESTINATION
AdornOps=copy DEG_AuditNRBMessageString DEG_MSESSIONMESSAGE
AdornOps=copy DEG_AuditUniqueIDString DEG_MSESSIONUNIQUE_ID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/120.InitInsert2Db]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_NrbMonitoringSessionIdString DEG_MSESSIONID
AdornOps=set log_DB_Operation "CREATE"
AdornOps=set log_Table_Name "DEG_MONITORING_TRANSACTIONS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/200.Insert2Db]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_MONITORING_TRANSACTIONS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
Operations=or
TrueRuleChain=99.InitErrorLog
TrueRuleChain=100.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus/100.ErrorLog]

Attributes=DEG_MSESSIONID
Attributes=DEG_MSESSIONTRANSID
Attributes=DEG_MSESSIONPROCID
Attributes=DEG_MSESSIONTIMESTAMP
Attributes=DEG_MSESSIONINTERFACE
Attributes=DEG_MSESSIONINOUT
Attributes=DEG_MSESSIONRESULTCODE
Attributes=DEG_MSESSIONMDN
Attributes=DEG_MSESSIONTRANSACTIONTYPE
Attributes=DEG_MSESSIONSOURCEDESTINATION
Attributes=DEG_MSESSIONMESSAGE
Attributes=DEG_MSESSIONUNIQUE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to create entry in DEG_MONITORING_TRANSACTIONS session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus/99.InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0005"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to create entry in DEG_MONITORING_TRANSACTIONS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetEmptyTransactionId
RuleNames=200.Log


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/100.SetEmptyTransactionId]

AdornOps=set DEG_MSESSIONTRANSID ""
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0006"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to generate unique value of monitoring transaction id"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/200.Log]

Attributes=DEG_MSESSIONTRANSID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=Unable to generate unique value of monitoring transaction id: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_NrbMonitoringSessionIdList != null


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CallGenrateEapAkaAuthRejectRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain/100.CallGenrateEapAkaAuthRejectRule]

ClassName=LocalRuleChainInvoker
RuleChain=705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores]

ClassName=com.hp.siu.sessionserver.SessionStoreManager
SessionStoreNames=DEG_MONITORING_TRANSACTIONS_SessionStore
SessionStoreNames=DEG_SSL_SESSION_SessionStore
SessionStoreNames=DEGDROID_TOKENS_SessionStore
SessionStoreNames=DEGDROID_AUTH_XML_TEMPLATES_SessionStore
SessionStoreNames=DEG_DEVICE_DATA_SessionStore
SessionStoreNames=DEG_HC_DATA_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEGDROID_AUTH_XML_TEMPLATES_SessionStore]

Attributes=DEG_AUTH_TYPE,key
Attributes=DEG_AUTH_STEP,key
Attributes=DEG_XML_TEMPLATES_FILE
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy1
DatabaseId=DEGDROID_AUTH_XML_TEMPLATES
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
NativeConditions=10.MatchBasedonAuthType
SQLTypeMap=DEG_AUTH_TYPE,VARCHAR(32)
SQLTypeMap=DEG_AUTH_STEP,TINYINT
SQLTypeMap=DEG_XML_TEMPLATES_FILE,VARCHAR(2000)


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEGDROID_AUTH_XML_TEMPLATES_SessionStore/10.MatchBasedonAuthType]

Condition=where DEG_AUTH_TYPE=%DEG_AUTH_TYPE


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEGDROID_TOKENS_SessionStore]

Attributes=DEG_IMSI,key
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_APP_TOKEN_FLAG
Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_FULLAUTHTIMESTAMP
Attributes=DEG_UNIQUE_ID
Attributes=DEG_BLACKLISTWINDOW_STARTTIME
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy1
DatabaseId=DEGDROID_TOKENS
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
NativeConditions=1.MatchingByMDN
SQLTypeMap=DEG_IMSI,VARCHAR(64)
SQLTypeMap=DEG_MDN,BIGINT
SQLTypeMap=DEG_SUBSTOKEN,CHAR(28)
SQLTypeMap=DEG_TOKENSTATUS,CHAR(2)
SQLTypeMap=DEG_AUTHENTICATION_TYPE,CHAR(4)
SQLTypeMap=DEG_AUTHENTICATION_SUBTYPE,CHAR(3)
SQLTypeMap=DEG_UNIQUE_ID,VARCHAR(64)
SQLTypeMap=DEG_APP_TOKEN_FLAG,TINYINT
SQLTypeMap=DEG_AUTH_COUNT,BIGINT
SQLTypeMap=DEG_BLACKLIST_FLAG,BIGINT
SQLTypeMap=DEG_EVENTTIMESTAMP,BIGINT
SQLTypeMap=DEG_FULLAUTHTIMESTAMP,BIGINT
SQLTypeMap=DEG_BLACKLISTWINDOW_STARTTIME,BIGINT


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEGDROID_TOKENS_SessionStore/1.MatchingByMDN]

Condition=where DEG_MDN=%DEG_MDN


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_DEVICE_DATA_SessionStore]

Attributes=DEG_UNIQUE_ID,key
Attributes=DEG_ENTITLEMENT_NAME,key
Attributes=DEG_IMSI
Attributes=DEG_APNS_TOKEN
Attributes=DEG_OLD_APNS_TOKEN
Attributes=DEG_PROVISIONING_STATUS
Attributes=DEG_PUSH_NOTIFICATION_STATUS
Attributes=DEG_SERVICE_MGMT_POSTDATA
Attributes=DEG_DISPLAY_NAME
Attributes=DEG_ADDRESS_STATUS
Attributes=DEG_TC_STATUS
Attributes=DEG_ADDR_UPDATE_POSTDATA
Attributes=DEG_ADDR_REFID
Attributes=DEG_ADDR_REFID_EXP_DATE
Attributes=DEG_LASTUPDATE
Attributes=DEG_SIP_USERNAME
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy1
DatabaseId=DEG_DEVICE_DATA
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
NativeConditions=1.MatchByIMSI
NativeConditions=2.MatchByUniqueId
NativeConditions=3.MatchByUniqueIdAndVoWiFiEntitelementNames
NativeConditions=4.MatchByIMSIAndEntitelementName
SQLTypeMap=DEG_UNIQUE_ID,VARCHAR(64)
SQLTypeMap=DEG_ENTITLEMENT_NAME,VARCHAR(32)
SQLTypeMap=DEG_IMSI,VARCHAR(64)
SQLTypeMap=DEG_APNS_TOKEN,VARCHAR(100)
SQLTypeMap=DEG_OLD_APNS_TOKEN,VARCHAR(100)
SQLTypeMap=DEG_PROVISIONING_STATUS,BIGINT
SQLTypeMap=DEG_PUSH_NOTIFICATION_STATUS,BIGINT
SQLTypeMap=DEG_SERVICE_MGMT_POSTDATA,VARCHAR(256)
SQLTypeMap=DEG_DISPLAY_NAME,VARCHAR(128)
SQLTypeMap=DEG_ADDRESS_STATUS,TINYINT
SQLTypeMap=DEG_TC_STATUS,TINYINT
SQLTypeMap=DEG_ADDR_UPDATE_POSTDATA,VARCHAR(8192)
SQLTypeMap=DEG_ADDR_REFID,VARCHAR(64)
SQLTypeMap=DEG_ADDR_REFID_EXP_DATE,DATE
SQLTypeMap=DEG_LASTUPDATE,DATE
SQLTypeMap=DEG_SIP_USERNAME,VARCHAR(256)


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_DEVICE_DATA_SessionStore/1.MatchByIMSI]

Condition=where DEG_IMSI=%DEG_IMSI


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_DEVICE_DATA_SessionStore/2.MatchByUniqueId]

Condition=where DEG_UNIQUE_ID=%DEG_UNIQUE_ID


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_DEVICE_DATA_SessionStore/3.MatchByUniqueIdAndVoWiFiEntitelementNames]

Condition=where DEG_ENTITLEMENT_NAME IN('Android_VoWiFi') and DEG_UNIQUE_ID=%DEG_UNIQUE_ID


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_DEVICE_DATA_SessionStore/4.MatchByIMSIAndEntitelementName]

Condition=where DEG_IMSI=%DEG_IMSI and DEG_ENTITLEMENT_NAME=%DEG_ENTITLEMENT_NAME


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_HC_DATA_SessionStore]

Attributes=DEG_HC_LASTUPDATE
Attributes=DEG_HC_PROCESS_NAME,key
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy1
DatabaseId=DEG_HC_DATA
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
SQLTypeMap=DEG_HC_PROCESS_NAME,VARCHAR(256)
SQLTypeMap=DEG_HC_LASTUPDATE,DATE


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_MONITORING_TRANSACTIONS_SessionStore]

Attributes=DEG_MSESSIONID,key
Attributes=DEG_MSESSIONTRANSID,key
Attributes=DEG_MSESSIONIMSI
Attributes=DEG_MSESSIONPROCID
Attributes=DEG_MSESSIONTIMESTAMP
Attributes=DEG_MSESSIONINTERFACE
Attributes=DEG_MSESSIONINOUT
Attributes=DEG_MSESSIONRESULTCODE
Attributes=DEG_MSESSIONMDN
Attributes=DEG_MSESSIONTRANSACTIONTYPE
Attributes=DEG_MSESSIONSOURCEDESTINATION
Attributes=DEG_MSESSIONMESSAGE
Attributes=DEG_MSESSIONUNIQUE_ID
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy2
DatabaseId=DEG_MONITORING_TRANSACTIONS
DbSchema=${DBSCHEMA_NRB}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_MONI_TRANS}
SQLTypeMap=DEG_MSESSIONID,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONTRANSID,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONPROCID,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONTIMESTAMP,BIGINT
SQLTypeMap=DEG_MSESSIONINTERFACE,VARCHAR(10)
SQLTypeMap=DEG_MSESSIONINOUT,VARCHAR(3)
SQLTypeMap=DEG_MSESSIONRESULTCODE,VARCHAR(15)
SQLTypeMap=DEG_MSESSIONMDN,BIGINT
SQLTypeMap=DEG_MSESSIONTRANSACTIONTYPE,VARCHAR(50)
SQLTypeMap=DEG_MSESSIONSOURCEDESTINATION,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONMESSAGE,VARCHAR(512)
SQLTypeMap=DEG_MSESSIONIMSI,VARCHAR(64)
SQLTypeMap=DEG_MSESSIONUNIQUE_ID,VARCHAR(64)


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_SSL_SESSION_SessionStore]

Attributes=DEG_SSL_ID,key
Attributes=DEG_SSL_STATE
Attributes=DEG_SSL_AAA_STATE
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_SSL_NAI
Attributes=DEG_SSL_IMSI
Attributes=DEG_SSL_MDN
Attributes=DEG_SSL_UNIQUE_ID
Attributes=DEG_SSL_CREATETIMESTAMP
Attributes=DEG_STR_FLAG
Attributes=DEG_SSL_GW_ADDR
Attributes=DEG_SSL_ID_PROV_STATUS
Attributes=DEG_SSL_POSTDATA
Attributes=DEG_SSL_ADDRESS_UPDATE_URL
Attributes=DEG_SSL_ADDRESS_STATUS
Attributes=DEG_SSL_TC_STATUS
Attributes=DEGDROID_SSL_COOKIE_ID
Attributes=DEGDROID_SSL_OTP
Attributes=DEG_SSL_EntitlementStatus
Attributes=DEG_GETAUTH_CONTACTED_AAA
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy1
DatabaseId=DEG_SSL_SESSION
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_SSL_SESSION}
NativeConditions=MatchingSession
NativeConditions=MatchingSessionID
NativeConditions=MatchByIMSI
NativeConditions=MatchByMDN
NativeConditions=MatchByCookieID
SQLTypeMap=DEG_SSL_ID,VARCHAR(256)
SQLTypeMap=DEG_SSL_STATE,VARCHAR(256)
SQLTypeMap=DEG_SSL_AAA_SESSIONID,VARCHAR(256)
SQLTypeMap=DEG_SSL_AAA_STATE,VARBINARY(50)
SQLTypeMap=DEG_SSL_NAI,VARCHAR(256)
SQLTypeMap=DEG_SSL_IMSI,VARCHAR(256)
SQLTypeMap=DEG_SSL_MDN,VARCHAR(256)
SQLTypeMap=DEG_SSL_UNIQUE_ID,VARCHAR(256)
SQLTypeMap=DEG_SSL_CREATETIMESTAMP,BIGINT
SQLTypeMap=DEG_STR_FLAG,TINYINT
SQLTypeMap=DEG_SSL_GW_ADDR,VARCHAR(256)
SQLTypeMap=DEG_SSL_ID_PROV_STATUS,TINYINT
SQLTypeMap=DEG_SSL_POSTDATA,VARCHAR(1024)
SQLTypeMap=DEG_SSL_ADDRESS_UPDATE_URL,VARCHAR(1024)
SQLTypeMap=DEG_SSL_ADDRESS_STATUS,TINYINT
SQLTypeMap=DEG_SSL_TC_STATUS,TINYINT
SQLTypeMap=DEG_SSL_EntitlementStatus,VARCHAR(256)
SQLTypeMap=DEGDROID_SSL_COOKIE_ID,VARCHAR(64)
SQLTypeMap=DEGDROID_SSL_OTP,BIGINT
SQLTypeMap=DEG_GETAUTH_CONTACTED_AAA,VARCHAR(256)


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_SSL_SESSION_SessionStore/MatchByCookieID]

Condition=where DEGDROID_SSL_COOKIE_ID = %DEGDROID_SSL_COOKIE_ID


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_SSL_SESSION_SessionStore/MatchByIMSI]

Condition=where DEG_SSL_IMSI = %DEG_SSL_IMSI and DEG_SSL_ID=%DEG_SSL_ID


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_SSL_SESSION_SessionStore/MatchByMDN]

Condition=where DEG_SSL_MDN = %DEG_SSL_MDN and DEG_SSL_ID=%DEG_SSL_ID


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_SSL_SESSION_SessionStore/MatchingSession]

Condition=where DEG_SSL_AAA_SESSIONID = %DEG_SSL_AAA_SESSIONID


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_SSL_SESSION_SessionStore/MatchingSessionID]

Condition=where DEG_SSL_ID = %DEG_SSL_ID


[/templates/DEG/DEGDROID_DeviceInterface/Common_Customize]


[/templates/DEG/DEGDROID_DeviceInterface/Common_Customize/PoolService]

ClassName=com.hp.usage.jdbc.poolservice.JDBCConnectionPoolService
ConnectionPools=DEG_DSN_TT_Rem_Pool
ConnectionPools=SecondaryJDBCQueryExclusivePool
ConnectionPools=NRB_DSN_TT_Pool


[/templates/DEG/DEGDROID_DeviceInterface/Common_Customize/PoolService/CommonConnectionPolicies]

ClassName=com.hp.usage.jdbc.poolservice.client.ConnectionPolicies
Policies=Policy1
Policies=JDBCQueryExclusivePolicy
Policies=Policy2


[/templates/DEG/DEGDROID_DeviceInterface/Common_Customize/PoolService/CommonConnectionPolicies/JDBCQueryExclusivePolicy]

ClassName=com.hp.usage.jdbc.poolservice.client.SimpleConnectionPolicy
Pools=SecondaryJDBCQueryExclusivePool


[/templates/DEG/DEGDROID_DeviceInterface/Common_Customize/PoolService/CommonConnectionPolicies/Policy1]

ClassName=com.hp.usage.jdbc.poolservice.client.SimpleConnectionPolicy
Pools=DEG_DSN_TT_Rem_Pool


[/templates/DEG/DEGDROID_DeviceInterface/Common_Customize/PoolService/CommonConnectionPolicies/Policy2]

ClassName=com.hp.usage.jdbc.poolservice.client.SimpleConnectionPolicy
Pools=NRB_DSN_TT_Pool


[/templates/DEG/DEGDROID_DeviceInterface/Common_Customize/PoolService/DEG_DSN_TT_Pool]

ClassName=com.hp.usage.jdbc.poolservice.pool.JDBCConnectionPool
ConnectionTestQuery=select 1 from dual
Database=${DEG_DIRECT_STRING_CONNECTION}
DatabaseClass=${JDBC_DIRECT_DRIVER}
MaxIdleTime=0
Password=${PASSWD_DEG_DSN}
User=${USER_DEG_DSN}


[/templates/DEG/DEGDROID_DeviceInterface/Common_Customize/PoolService/DEG_DSN_TT_Rem_Pool]

ClassName=com.hp.usage.jdbc.poolservice.pool.JDBCConnectionPool
ConnectionTestQuery=select 1 from dual
Database=${DEG_CLIENT_STRING_CONNECTION}
DatabaseClass=${JDBC_CLIENT_DRIVER}
MaxIdleTime=0
Password=${PASSWD_DEG_DSN}
User=${USER_DEG_DSN}


[/templates/DEG/DEGDROID_DeviceInterface/Common_Customize/PoolService/JDBCQueryExclusivePool]

ClassName=com.hp.usage.jdbc.poolservice.pool.JDBCConnectionPool
ConnectionTestQuery=select 1 from dual
Database=${DEG_DIRECT_STRING_CONNECTION}
DatabaseClass=${JDBC_DIRECT_DRIVER}
MaxIdleTime=0
Password=${PASSWD_DEG_DSN}
User=${USER_DEG_DSN}


[/templates/DEG/DEGDROID_DeviceInterface/Common_Customize/PoolService/NRB_DSN_TT_Pool]

ClassName=com.hp.usage.jdbc.poolservice.pool.JDBCConnectionPool
ConnectionTestQuery=select 1 from dual
Database=${NRB_CLIENT_STRING_CONNECTION}
DatabaseClass=${JDBC_CLIENT_DRIVER}
MaxIdleTime=0
Password=${PASSWD_NRB_DSN}
RetryCount=1
RetryInterval=0
User=${USER_NRB_DSN}


[/templates/DEG/DEGDROID_DeviceInterface/Common_Customize/PoolService/SecondaryJDBCQueryExclusivePool]

ClassName=com.hp.usage.jdbc.poolservice.pool.JDBCConnectionPool
ConnectionTestQuery=select 1 from dual
Database=${DEG_CLIENT_STRING_CONNECTION}
DatabaseClass=${JDBC_CLIENT_DRIVER}
MaxIdleTime=0
Password=${PASSWD_DEG_DSN}
User=${USER_DEG_DSN}


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter]


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors]

ConnectorNames=300.DEGDROIDDiameterAdapter


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter]

ApplicationId=${DEG_DAIMETER_APLLICATION_ID}
ApplicationIdAttribute=DEG_OEMDevAppIdLong
AuthApplicationIds=${DEG_DAIMETER_APLLICATION_ID}
ClassName=com.hp.usage.diameter.DiameterAdapter
CommandCodeAttribute=DEG_OEMDevCommandcodeInteger
E2EAttribute=DEG_OEMDevE2ELong
ErrorFlagAttribute=DEG_OEMDevErrorFlagInteger
HbHAttribute=DEG_OEMDevHbHLong
JNDIName=DEGDROIDDevice
Managed=${MANAGED_SETUP}
MaxMessageSize=8192
NeedResponseAttribute=DEG_OEMDevNeedResponseInteger
PersistentConnectionAddress=${PRIMARY_AAA_HOST_NAME},${AAA_SERVER_REALM}
PersistentConnectionAddress=${SECONDARY_AAA_HOST_NAME},${AAA_SERVER_REALM}
ProductName=Diameter HSS Client
ProxiableFlagAttribute=DEG_OEMDevProxiableFlagInteger
RemoteHostAttribute=DEG_OEMDevDesthostString
RemoteRealmAttribute=DEG_OEMDevDestRealmString
RequestFlagAttribute=DEG_OEMDevRequestFlagInteger
RetransmitFlagAttribute=DEG_OEMDevRetransmitFlagInteger
RetryTimeouts=3,20
ServerHost=${DEGDROID_DEVICE_DIAMETER_SERVER_HOST_NAME}
ServerIP=${DEVICE_DIAMETER_SERVER_HOST_IP}
ServerRealm=${DEVICE_SERVER_REALM}
StopAttribute=DEG_OEMDevStopInteger


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter/DecoderFactory]

ClassName=com.hp.usage.diameter.codec.AVPDecoderFactory
DecoderMap=275,0,SWADecoder


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter/DecoderFactory/SWADecoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpDecoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWa/SessionTerminationAnswerSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter/EncoderFactory]

ClassName=com.hp.usage.diameter.codec.AVPEncoderFactory
EncoderMap=275,0,SWAEncoder


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter/EncoderFactory/SWAEncoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpEncoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWa/SessionTerminationRequestSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter/StateMachinePool]

ClassName=com.hp.usage.diameter.StateMachinePool
ThreadPoolSize=10


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter/StateMachinePool/StateMachine]

ClassName=com.hp.usage.diameter.GenericStateMachine
MessageCodeAttribute=DEG_OEMDevCommandcodeInteger
MessageDirectionAttribute=DEG_OEMDevRequestFlagInteger
RuleChainMapping=268,1,301.DEG30AAAProcessingRuleChain
RuleChainMapping=275,0,304.STAProcessingRuleChain
RuleChainMapping=275,1,303.STRProcessingRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/Connectors/300.DEGDROIDDiameterAdapter/Transport]

ClassName=com.hp.usage.diameter.DiameterTCPTransport
HostName=${DEVICE_DIAMETER_SERVER_HOST_IP}
HostsMap=${PRIMARY_AAA_HOST_NAME},${AAA_SERVER_REALM},${PRIMARY_AAA_HOST_IP},${PRIMARY_AAA_HOST_PORT}
HostsMap=${SECONDARY_AAA_HOST_NAME},${AAA_SERVER_REALM},${SECONDARY_AAA_HOST_IP},${SECONDARY_AAA_HOST_PORT}
PortNumber=${DEGDROID_DEVICE_DIAMETER_SERVER_PORT}


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains]

RuleChainNames=301.DEG30AAAProcessingRuleChain
RuleChainNames=301A.GenerateOrCopyAAASessionIDRuleChain
RuleChainNames=301B.SendDERToAAARuleChain
RuleChainNames=301C.ReceiveDEAFromAAARuleChain
RuleChainNames=301D.ValidateResponseFromAAARuleChain
RuleChainNames=303.STRProcessingRuleChain
RuleChainNames=304.STAProcessingRuleChain
RuleChainNames=275.GenerateAAASTRCallStartAuditDataRuleChain
RuleChainNames=276.GenerateAAASTRCallEndErrorAuditDataRuleChain
RuleChainNames=277.GenerateAAASTACallEndOKAuditDataRuleChain
RuleChainNames=533.GenerateAAADERCallStartAuditDataRuleChain
RuleChainNames=534.GenerateAAADERCallEndErrorAuditDataRuleChain
RuleChainNames=535.GenerateAAADERCallEndOKAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=copy DEG_OEMDevAAAProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DROID-STR"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO AAA -> Sending AAA STR message: "
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString ""
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/275.GenerateAAASTRCallStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=410.CallMonitoringSessionLookup
RuleNames=500.GenerateAuditAndNRBEvents
RuleNames=600.ResetNRBList


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_AuditResultCodeString
AdornOps=copy DEG_SSL_MDN DEG_AuditMdnString
AdornOps=copy DEG_SSL_IMSI DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DROID-STR"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=setifnull DEG_OEMDevErrorMessageString ""
AdornOps=setifnull DEG_CDevProcessingErrorIdString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=copy DEG_SSL_IMSI DEG_AuditChannelNameString
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=copy DEG_SSL_MDN DEG_MDN
AdornOps=copy DEG_SSL_IMSI DEG_OEMDevImsiString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_OEMDevUniqueIDString
AdornOps=copy DEG_SSL_MDN DEG_OEMDevRespPhoneNumberString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
ClassName=AdornmentRule
_AdornOps=- DEG_AuditTimestampLong DEG_OEMDevAAAProcessStartTimeLong DEG_AuditDurationString


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "After sending STR message: "
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevProcessingErrorIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevProcessingErrorIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevResultCodeInteger DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
AdornOps=set DEG_AuditNRBMessageString "AAA to DEG response, ReturnCode is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevResultCodeInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/410.CallMonitoringSessionLookup]

ClassName=LocalRuleChainInvoker
RuleChain=400A.ProcessSubscriberExistsResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/276.GenerateAAASTRCallEndErrorAuditDataRuleChain/600.ResetNRBList]

AdornOps=set DEG_NrbMonitoringSessionIdList null
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=410.CallMonitoringSessionLookup
RuleNames=500.GenerateAuditAndNRBEvents
RuleNames=600.ResetNRBList


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_AuditResultCodeString
AdornOps=copy DEG_SSL_MDN DEG_AuditMdnString
AdornOps=copy DEG_SSL_IMSI DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DROID-STR"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=copy DEG_SSL_IMSI DEG_AuditChannelNameString
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=copy DEG_SSL_MDN DEG_MDN
AdornOps=copy DEG_SSL_IMSI DEG_OEMDevImsiString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_OEMDevUniqueIDString
AdornOps=copy DEG_SSL_MDN DEG_OEMDevRespPhoneNumberString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO DEG -> After sending STA message: "
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_IMSI DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevResultCodeInteger DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful execution of AAA call,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevResultCodeInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/410.CallMonitoringSessionLookup]

ClassName=LocalRuleChainInvoker
RuleChain=400A.ProcessSubscriberExistsResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/277.GenerateAAASTACallEndOKAuditDataRuleChain/600.ResetNRBList]

AdornOps=set DEG_NrbMonitoringSessionIdList null
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain]

ClassName=RuleChain
RuleNames=100.ExtractVisitedNetId
RuleNames=110.SetRequestParams
RuleNames=120.GetSessionID
RuleNames=200.SendDERToAAA
RuleNames=300.ReceiveDEAFromAAA
RuleNames=400.ValidateResponse
RuleNames=410.SetDEAInfo
RuleNames=500.LogDEAResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/100.ExtractVisitedNetId]

ClassName=com.hp.siu.collector.rules.SplitStringRule
DstAttribute=DEG_OEMDevVisitedNetworkIdString
LeftSplitString=@
SrcAttribute=DEG_SSL_NAI


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/110.SetRequestParams]

AdornOps=set disc 0
AdornOps=set DEG_OEMDevProxiableFlagInteger 1
AdornOps=set DEG_OEMDevRequestFlagInteger 1
AdornOps=setsystime DEG_OEMDevSessionIdTimeInMilliSecs
AdornOps=/ DEG_OEMDevSessionIdTimeInMilliSecs 1000 DEG_OEMDevSessionIdTimeInSecs
AdornOps=- DEG_OEMDevSessionIdTimeInMilliSecs DEG_OEMDevSessionIdTimeInSecs DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=* DEG_OEMDevSessionIdTimeInNanoSecsLong 1000000 DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=set DEG_OEMDevOriginRealmString ${DEVICE_SERVER_REALM}
AdornOps=set DEG_OEMDevOriginHostString ${DEGDROID_DEVICE_DIAMETER_SERVER_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDesthostString ${PRIMARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=set DEG_OEMDevSecondaryDesthostString ${SECONDARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevSecondaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=set DEG_OEMDevAuthApplicationIdInteger ${DEG_DAIMETER_APLLICATION_ID}
AdornOps=set DEG_OEMDevAuthRequestTypeInteger 3
AdornOps=set DEG_OEMDevRATTypeInteger 2001
AdornOps=str2bin DEG_OEMDevVisitedNetworkIdString DEG_OEMDevVisitedNetworkIdBinary
AdornOps=set DEG_OEMDevAuthLifeTime 2592000
AdornOps=set DEG_OEMDevAuthGracePeriod 7200
AdornOps=set DEG_OEMDevAuthSessionState 0
AdornOps=set DEG_OEMDevANIDString NSN
AdornOps=set DEG_SSL_STATE WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA
AdornOps=copy DEG_SSL_AAA_STATE DEG_OEMDevDiameterStateBinary
AdornOps=setsystime DEG_OEMDevAAAProcessStartTimeLong
AdornOps=setifnull DEG_AuditUniqueIDString ""
AdornOps=copy DEG_AuditUniqueIDString DEG_MSESSIONUNIQUE_ID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/120.GetSessionID]

ClassName=LocalRuleChainInvoker
RuleChain=301A.GenerateOrCopyAAASessionIDRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/200.SendDERToAAA]

ClassName=LocalRuleChainInvoker
RuleChain=301B.SendDERToAAARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/300.ReceiveDEAFromAAA]

ClassName=LocalRuleChainInvoker
RuleChain=301C.ReceiveDEAFromAAARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/400.ValidateResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=301D.ValidateResponseFromAAARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/410.SetDEAInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0605"
AdornOps=setifnull DEG_OEMDevMessageString "Response of DEA"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301.DEG30AAAProcessingRuleChain/500.LogDEAResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_SSL_NAI
Attributes=DEG_MDN
Attributes=DEG_OEMDevDiameterSessionIdString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevRATTypeInteger
Attributes=DEG_SSL_STATE
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevDiameterStateBinary
Attributes=DEG_SSL_AAA_STATE
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=DERProcessingRule - DEAResponse: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301A.GenerateOrCopyAAASessionIDRuleChain]

ClassName=RuleChain
RuleNames=100.CheckAAASessionId


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301A.GenerateOrCopyAAASessionIDRuleChain/100.CheckAAASessionId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_AAA_SESSIONID,!=,DEG_SSL_ID
FalseRuleChain=200.NewSessionId
TrueRuleChain=100.CopySessionId


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301A.GenerateOrCopyAAASessionIDRuleChain/100.CheckAAASessionId/100.CopySessionId]

AdornOps=copy DEG_SSL_AAA_SESSIONID DEG_OEMDevDiameterSessionIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301A.GenerateOrCopyAAASessionIDRuleChain/100.CheckAAASessionId/200.NewSessionId]

AdornOps=setsystime DEG_OEMDevSessionIdTimeInMilliSecs
AdornOps=% DEG_OEMDevSessionIdTimeInMilliSecs 1000 DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=* DEG_OEMDevSessionIdTimeInNanoSecsLong 1000000 DEG_OEMDevSessionIdTimeInNanoSecsLong
AdornOps=/ DEG_OEMDevSessionIdTimeInMilliSecs 1000 DEG_OEMDevSessionIdTimeInSecs
AdornOps=set DEG_OEMDevDiameterSessionIdString ${DEGDROID_DEVICEINTERFACE_PROCESS_NAME}
AdornOps=+ DEG_OEMDevDiameterSessionIdString ; DEG_OEMDevDiameterSessionIdString
AdornOps=set DEG_OEMDevDiameterHostNameString ${DEGDROID_DEVICE_DIAMETER_SERVER_HOST_NAME}
AdornOps=+ DEG_OEMDevDiameterSessionIdString DEG_OEMDevDiameterHostNameString DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString ; DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString DEG_OEMDevSessionIdTimeInSecs DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString ; DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString DEG_OEMDevSessionIdTimeInNanoSecsLong DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString ; DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString DEG_OEMDevImsiString DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString ; DEG_OEMDevDiameterSessionIdString
AdornOps=+ DEG_OEMDevDiameterSessionIdString DEG_MDN DEG_OEMDevDiameterSessionIdString
AdornOps=copy DEG_OEMDevDiameterSessionIdString DEG_SSL_AAA_SESSIONID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain]

RuleNames=100.DERNMEConversion
RuleNames=110.GenerateAAACallStartAuditData
RuleNames=120.SendDERRequest
RuleNames=130.LogIfRequestTimeOutFlagSet


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/100.DERNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_SSL_AAA_SESSIONID,session_id
NMEToStructuredNMEMap=DEG_OEMDevAuthApplicationIdInteger,auth_application_id
NMEToStructuredNMEMap=DEG_OEMDevOriginHostString,origin_Host
NMEToStructuredNMEMap=DEG_OEMDevOriginRealmString,origin_Realm
NMEToStructuredNMEMap=DEG_OEMDevPrimaryDestRealmString,destination_Realm
NMEToStructuredNMEMap=DEG_OEMDevAuthRequestTypeInteger,auth_request_type
NMEToStructuredNMEMap=DEG_OEMDevEAPPayloadBinary,eap_payload
NMEToStructuredNMEMap=DEG_OEMDevSubscriberIdString,user_Name
NMEToStructuredNMEMap=DEG_OEMDevImsiString,calling_station_id
NMEToStructuredNMEMap=DEG_OEMDevRATTypeInteger,RAT_type
NMEToStructuredNMEMap=DEG_OEMDevVisitedNetworkIdBinary,visited_network_identifier
NMEToStructuredNMEMap=DEG_OEMDevAuthLifeTime,authorization_lifeTime
NMEToStructuredNMEMap=DEG_OEMDevAuthGracePeriod,auth_grace_period
NMEToStructuredNMEMap=DEG_OEMDevAuthSessionState,auth_session_state
NMEToStructuredNMEMap=DEG_OEMDevANIDString,ANID
NMEToStructuredNMEMap=DEG_OEMDevDiameterStateBinary,state
SNMEType=diameterSWa:DiameterEAPRequestSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/110.GenerateAAACallStartAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=533.GenerateAAADERCallStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/120.SendDERRequest]

ApplicationId=${DEG_DAIMETER_APLLICATION_ID}
ClassName=com.hp.usage.diameter.DiameterClientRule
CommandCode=268
DCJNDIName=DEGDROIDDevice
DestinationHostAttribute=DEG_OEMDevPrimaryDesthostString
DestinationRealmAttribute=DEG_OEMDevPrimaryDestRealmString
DisconnectAttribute=disc
E2EAttribute=DEG_OEMDevE2ELong
ErrorResultFlagAttribute=errFlag
HbHAttribute=DEG_OEMDevHbHLong
ProxiableFlagAttribute=DEG_OEMDevProxiableFlagInteger
RequestFlagAttribute=DEG_OEMDevRequestFlagInteger
Retries=0
SecondaryDestinationHostAttribute=DEG_OEMDevSecondaryDesthostString
SecondaryDestinationRealmAttribute=DEG_OEMDevSecondaryDestRealmString
TimeOut=5000
TimeOutFlagAttribute=toFlag
WaitForConnection=false


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/120.SendDERRequest/Decoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpDecoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWa/DiameterEAPAnswerSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/120.SendDERRequest/Encoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpEncoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWa/DiameterEAPRequestSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/130.LogIfRequestTimeOutFlagSet]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=toFlag,!=,0
TrueRuleChain=100.SetErrorParams
TrueRuleChain=110.Log


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/130.LogIfRequestTimeOutFlagSet/100.SetErrorParams]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0601"
AdornOps=set DEG_OEMDevErrorMessageString "AAA could not reply in configured timeout period"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301B.SendDERToAAARuleChain/130.LogIfRequestTimeOutFlagSet/110.Log]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=AAA Request Timeout Error : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain]

RuleNames=100.DEASNMEConversion
RuleNames=110.LogIfInvalidResponse
RuleNames=120.SetOutReturnCodeIfErrorFlagSet


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/100.DEASNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
SNMEType=diameterSWa:DiameterEAPAnswerSWa
StructuredNMEToNMEMap=session_id,DEG_SSL_AAA_SESSIONID
StructuredNMEToNMEMap=auth_application_id,DEG_OEMDevAuthApplicationIdInteger
StructuredNMEToNMEMap=result_Code,DEG_OEMDevResultCodeInteger
StructuredNMEToNMEMap=experimental_result[0].vendor_id,DEG_OEMDevVendorIdInteger
StructuredNMEToNMEMap=experimental_result[0].experimental_result_code,DEG_OEMDevExperimentalResultCodeInteger
StructuredNMEToNMEMap=origin_Host,DEG_OEMDevOriginHostString
StructuredNMEToNMEMap=origin_Realm,DEG_OEMDevOriginRealmString
StructuredNMEToNMEMap=auth_request_type,DEG_OEMDevAuthRequestTypeInteger
StructuredNMEToNMEMap=eap_payload,DEG_OEMDevEAPPayloadBinary
StructuredNMEToNMEMap=user_Name,DEG_SSL_NAI
StructuredNMEToNMEMap=error_message,DEG_OEMDevErrorMessageString
StructuredNMEToNMEMap=state,DEG_OEMDevDiameterStateBinary


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/110.LogIfInvalidResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,within,[3001-3010]
Conditions=DEG_OEMDevResultCodeInteger,within,[5002,5004-5017,5241]
Operations=or
TrueRuleChain=100.SetErrorParams
TrueRuleChain=110.Log


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/110.LogIfInvalidResponse/100.SetErrorParams]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0602"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid response code from AAA"
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_CDevOutReturnCodeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/110.LogIfInvalidResponse/110.Log]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=AAA Invalid Response: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/120.SetOutReturnCodeIfErrorFlagSet]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=errFlag,!=,0
TrueRuleChain=100.SetErrorParams


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301C.ReceiveDEAFromAAARuleChain/120.SetOutReturnCodeIfErrorFlagSet/100.SetErrorParams]

AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain]

ClassName=RuleChain
RuleNames=100.CheckAAAResultCode


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,=,2001
FalseRuleChain=200.CheckIfDiameterMultiRoundAuth
TrueRuleChain=100.setSessionStatus
TrueRuleChain=110.GenerateAAACallEndOKAuditData
TrueRuleChain=120.STRProcessingRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/100.setSessionStatus]

AdornOps=set DEG_SSL_STATE AUTHENTICATED_BY_AAA
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "EAP"
AdornOps=setsystime DEG_FULLAUTHTIMESTAMP
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_CDevOutReturnCodeString
AdornOps=set DEG_AuditNRBMessageString "Successful execution of AAA call,Return code from AAA is "
AdornOps=+ DEG_AuditNRBMessageString DEG_CDevOutReturnCodeString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/110.GenerateAAACallEndOKAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=535.GenerateAAADERCallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequest
RuleNames=110.ReadValue
RuleNames=120.CheckErrorAndNoMatchFlag
RuleNames=130.ExecuteDependingOnSysParameterValue


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/100.InitRequest]

AdornOps=set DEG_CDevSysParameter "DEG_AAA_CONNECTIONTYPE"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevGetAAAConnectionTypeValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
FalseRuleChain=200.DefaultValue
Operations=and
TrueRuleChain=100.SetSysValue


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/120.CheckErrorAndNoMatchFlag/100.SetSysValue]

AdornOps=copy DEG_CDevSysValueString DEG_CDevGetAAAConnectionTypeValueString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/120.CheckErrorAndNoMatchFlag/200.DefaultValue]

AdornOps=set DEG_CDevGetAAAConnectionTypeValueString "Internal"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevGetAAAConnectionTypeValueString,=,"Internal"
Conditions=DEG_CDevGetAAAConnectionTypeValueString,=,"External"
InvokeSTRProcessingRuleChain=100.InvokeSTRProcessingRuleChain
Operations=None
TrueRuleChain=UpdateSTRFlag
TrueRuleChain=InvokeSTRProcessingRuleChain
UpdateSTRFlag=001.setSTRFlag
UpdateSTRFlag=100.UpdateSession
UpdateSTRFlag=105.SetFlagResponse
UpdateSTRFlag=110.LogUpdate


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue/001.setSTRFlag]

AdornOps=set DEG_STR_FLAG 1
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=copy DEG_OEMDevDiameterSessionIdString DEG_SSL_AAA_SESSIONID
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue/100.InvokeSTRProcessingRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_SSL_AAA_SESSIONID
RequestAttributes=DEG_OEMDevAuthApplicationIdInteger
RequestAttributes=DEG_SSL_NAI
ResponseAttributes=DEG_OEMDevDiameterSessionIdString
ResponseAttributes=DEG_OEMDevResultCodeInteger
RuleChain=303.STRProcessingRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue/100.UpdateSession]

ClassName=UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_STR_FLAG,DEG_STR_FLAG
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue/105.SetFlagResponse]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0603"
AdornOps=set DEG_OEMDevMessageString "Update STR Flag for Internal AAA"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/120.STRProcessingRule/130.ExecuteDependingOnSysParameterValue/110.LogUpdate]

Attributes=DEG_OEMDevDiameterSessionIdString
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_OEMDevOriginHostString
Attributes=DEG_OEMDevOriginRealmString
Attributes=DEG_SSL_ID
Attributes=DEG_OEMDevMessageString
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Update STR Flag for Internal AAA : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,=,1001
FalseRuleChain=200.CheckIfDiameterAuthRejected
TrueRuleChain=100.setSessionStatus
TrueRuleChain=110.GenerateAAACallEndOKAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/100.setSessionStatus]

AdornOps=set DEG_SSL_STATE WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE
AdornOps=copy DEG_OEMDevDiameterStateBinary DEG_SSL_AAA_STATE
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_CDevOutReturnCodeString
AdornOps=set DEG_AuditNRBMessageString "Successful execution of AAA call, NEED_AKA_CHALLENGE_RESPONSE_FROM_DEVICE,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevResultCodeInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/110.GenerateAAACallEndOKAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=535.GenerateAAADERCallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,=,4001
Conditions=DEG_OEMDevResultCodeInteger,within,[5001,5003]
FalseRuleChain=200.isDiameterError
Operations=or
TrueRuleChain=100.setSessionStatus
TrueRuleChain=110.GenerateAAACallEndOKAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/100.setSessionStatus]

AdornOps=set DEG_SSL_STATE AKA_CHALLENGE_REJECTED_BY_AAA
AdornOps=copy DEG_OEMDevResultCodeInteger DEG_CDevOutReturnCodeString
AdornOps=set DEG_AuditNRBMessageString "Successful execution of AAA call,Return code from AAA is "
AdornOps=+ DEG_AuditNRBMessageString DEG_CDevOutReturnCodeString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/110.GenerateAAACallEndOKAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=535.GenerateAAADERCallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=errFlag,!=,0
Conditions=DEG_OEMDevResultCodeInteger,within,[3001-3010]
Conditions=DEG_OEMDevResultCodeInteger,within,[5002,5004-5017,5241]
Operations=or,or
TrueRuleChain=001.SetErrorResponse
TrueRuleChain=000.LogAAAError
TrueRuleChain=100.CheckEAPAKADefaultValue
TrueRuleChain=120.GenerateAAACallEndErrorAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/000.LogAAAError]

Attributes=DEG_OEMDevResultCodeInteger
Attributes=errFlag
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=WARNING
Message=Default internal authentication is called as error response is sent from AAA.
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/001.SetErrorResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0604"
AdornOps=set DEG_OEMDevErrorMessageString "Default internal authentication is called as error response is sent from AAA"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/100.CheckEAPAKADefaultValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=170.DEG30CheckEAPAKADefaultRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/120.GenerateAAACallEndErrorAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=534.GenerateAAADERCallEndErrorAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/130.GenerateAAAAkaRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,1
TrueRuleChain=100.AuditDataRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError/130.GenerateAAAAkaRejectedEndAuditDataRuleChain/100.AuditDataRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetRequestParams
RuleNames=275.STRCallStartAuditDataRule
RuleNames=110.STRNMEConversion
RuleNames=115.SetSTRInfo
RuleNames=200.LogSTRRequest
RuleNames=300.SendSTRRequest


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/100.SetRequestParams]

AdornOps=set DEG_OEMDevSSLSSDeletedInteger 1
AdornOps=set disc 0
AdornOps=set DEG_OEMDevRequestFlagInteger 1
AdornOps=set DEG_OEMDevTerminationCauseInteger 8
AdornOps=set DEG_OEMDevOriginRealmString ${DEVICE_SERVER_REALM}
AdornOps=set DEG_OEMDevOriginHostString ${DEGDROID_DEVICE_DIAMETER_SERVER_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDesthostString ${PRIMARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevPrimaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=set DEG_OEMDevSecondaryDesthostString ${SECONDARY_AAA_HOST_NAME}
AdornOps=set DEG_OEMDevSecondaryDestRealmString ${AAA_SERVER_REALM}
AdornOps=copy DEG_SSL_AAA_SESSIONID DEG_OEMDevDiameterSessionIdString
AdornOps=copy DEG_SSL_NAI DEG_OEMDevSubscriberIdString
AdornOps=set DEG_OEMDevAuthApplicationIdInteger ${DEG_DAIMETER_APLLICATION_ID}
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/110.STRNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevDiameterSessionIdString,session_id
NMEToStructuredNMEMap=DEG_OEMDevOriginHostString,origin_Host
NMEToStructuredNMEMap=DEG_OEMDevOriginRealmString,origin_Realm
NMEToStructuredNMEMap=DEG_OEMDevPrimaryDestRealmString,destination_Realm
NMEToStructuredNMEMap=DEG_OEMDevAuthApplicationIdInteger,auth_application_id
NMEToStructuredNMEMap=DEG_OEMDevTerminationCauseInteger,termination_cause
NMEToStructuredNMEMap=DEG_OEMDevSubscriberIdString,user_Name
SNMEType=diameterSWa:SessionTerminationRequestSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/115.SetSTRInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0606"
AdornOps=set DEG_OEMDevMessageString "STR Process"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/200.LogSTRRequest]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevDiameterSessionIdString
Attributes=DEG_OEMDevOriginHostString
Attributes=DEG_OEMDevOriginRealmString
Attributes=DEG_OEMDevPrimaryDestRealmString
Attributes=DEG_OEMDevTerminationCauseInteger
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevPrimaryDesthostString
Attributes=DEG_SSL_ID
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=STRProcessingRule - STRRequest:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/275.STRCallStartAuditDataRule]

ClassName=LocalRuleChainInvoker
RuleChain=275.GenerateAAASTRCallStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/300.SendSTRRequest]

ApplicationId=${DEG_DAIMETER_APLLICATION_ID}
ClassName=com.hp.usage.diameter.DiameterClientRule
CommandCode=275
DCJNDIName=DEGDROIDDevice
DestinationHostAttribute=DEG_OEMDevPrimaryDesthostString
DestinationRealmAttribute=DEG_OEMDevPrimaryDestRealmString
DisconnectAttribute=disc
E2EAttribute=DEG_OEMDevE2ELong
ErrorResultFlagAttribute=errFlag
HbHAttribute=DEG_OEMDevHbHLong
SecondaryDestinationHostAttribute=DEG_OEMDevSecondaryDesthostString
SecondaryDestinationRealmAttribute=DEG_OEMDevSecondaryDestRealmString
TimeOut=0
TimeOutFlagAttribute=toFlag
WaitForConnection=false


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/300.SendSTRRequest/Decoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpDecoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWa/SessionTerminationAnswerSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/303.STRProcessingRuleChain/300.SendSTRRequest/Encoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpEncoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWa/SessionTerminationRequestSWa


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain]

ClassName=RuleChain
RuleNames=100.SetResponseParams
RuleNames=200.STASNMEConversion
RuleNames=210.InitLookup
RuleNames=220.LookupSessionTable
RuleNames=230.CheckLookupStatus
RuleNames=231.SetErrorResponse
RuleNames=400.LogAfterSTAResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/100.SetResponseParams]

AdornOps=set DEG_OEMDevNeedResponseInteger 0
AdornOps=set DEG_OEMDevErrorMessageString ""
AdornOps=set DEG_OEMDevOriginHostString ""
AdornOps=set DEG_OEMDevOriginRealmString ""
AdornOps=set DEG_OEMDevDiameterSessionIdString ""
AdornOps=set DEG_OEMDevResultCodeInteger 0
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/200.STASNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
SNMEType=diameterSWa:SessionTerminationAnswerSWa
StructuredNMEToNMEMap=session_id,DEG_OEMDevDiameterSessionIdString
StructuredNMEToNMEMap=result_Code,DEG_OEMDevResultCodeInteger
StructuredNMEToNMEMap=origin_Host,DEG_OEMDevOriginHostString
StructuredNMEToNMEMap=origin_Realm,DEG_OEMDevOriginRealmString
StructuredNMEToNMEMap=error_message,DEG_OEMDevErrorMessageString


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/210.InitLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevDiameterSessionIdString DEG_SSL_AAA_SESSIONID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/220.LookupSessionTable]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExistFlag
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.PrintError


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0607"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/110.PrintError]

Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while looking up in DEG_SSL_SESSION table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
FalseRuleChain=50.SetErrorInfo
FalseRuleChain=100.ErrorLog
TrueRuleChain=300.GenAudit
TrueRuleChain=400.DelSession


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/100.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to get data from DEG_SSL_SESSION table:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/300.GenAudit]

ClassName=ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,within,[2001,5002]
FalseRuleChain=275.STRCallEndErrorAuditDataRule
TrueRuleChain=275.STACallEndOKAuditDataRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/300.GenAudit/275.STACallEndOKAuditDataRule]

ClassName=LocalRuleChainInvoker
RuleChain=277.GenerateAAASTACallEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/300.GenAudit/275.STRCallEndErrorAuditDataRule]

ClassName=LocalRuleChainInvoker
RuleChain=276.GenerateAAASTRCallEndErrorAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/400.DelSession]

ClassName=RuleChain
RuleNames=100.InitialDel
RuleNames=200.DeleteSession


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/400.DelSession/100.InitialDel]

AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=copy DEG_OEMDevDiameterSessionIdString DEG_SSL_AAA_SESSIONID
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/400.DelSession/200.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
ContinueAfterErrorFixed=false
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/230.CheckLookupStatus/200.CheckKeyExistFlag/50.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0608"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to get data from DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/231.SetErrorResponse]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0609"
AdornOps=set DEG_OEMDevMessageString "STAResponse"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/304.STAProcessingRuleChain/400.LogAfterSTAResponse]

Attributes=DEG_OEMDevDiameterSessionIdString
Attributes=DEG_OEMDevResultCodeInteger
Attributes=DEG_OEMDevOriginHostString
Attributes=DEG_OEMDevOriginRealmString
Attributes=DEG_SSL_ID
Attributes=DEG_OEMDevMessageString
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=STAResponse : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=copy DEG_OEMDevAAAProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DROID-DER"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO AAA -> Sending AAA DER message: "
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString ""
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/533.GenerateAAADERCallStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_OEMDevAAAProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=setifnull DEG_CDevOutReturnCodeString "500"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DROID-DER"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=setifnull DEG_OEMDevErrorMessageString ""
AdornOps=setifnull DEG_CDevProcessingErrorIdString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "After sending DER message: "
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevProcessingErrorIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevProcessingErrorIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
AdornOps=set DEG_AuditNRBMessageString "AAA to DEG response, Return Code from AAA is "
AdornOps=+ DEG_AuditNRBMessageString DEG_CDevOutReturnCodeString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/534.GenerateAAADERCallEndErrorAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_OEMDevAAAProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DROID-DER"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditSourceDestinationVersionString "NA"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO DEG -> After sending DER message: "
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_CDevMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAPAKAAuthenticatorDiameter/RuleChains/535.GenerateAAADERCallEndOKAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core]


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains]

ClassName=com.hp.siu.sessionserver.RuleChainManager
RuleChainNames=200.DEG30ProcessRequestRuleChain
RuleChainNames=200a.DEG30PrcessEAP_AKAAuthRuleChain
RuleChainNames=200A.DEG30ValidationAndProcessRequestRuleChain
RuleChainNames=200D.DEG30InvalidToken
RuleChainNames=200D.DEG30FullAuthRuleChain
RuleChainNames=200E.DEG30FastPathAuthRuleChain
RuleChainNames=200F.DEG30GenerateOEMResponseRuleChain
RuleChainNames=200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain
RuleChainNames=200I.DEG30ProcessActionRuleChain
RuleChainNames=200J.DEG30SslSessionLookupStatusRuleChain
RuleChainNames=200K.DEG30NewRequest_CheckSslSessionStatusRuleChain
RuleChainNames=200L.DEG30RequestOk_CheckSslSessionStatusRuleChain
RuleChainNames=200M.DEG30DeviceDataLookupRuleChain
RuleChainNames=200N.DEG30DeviceDataProcessRuleChain
RuleChainNames=200P.DEG30ImsiBasedDeviceDataLookupRuleChain
RuleChainNames=701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain
RuleChainNames=702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain
RuleChainNames=703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain
RuleChainNames=704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
RuleChainNames=705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain
RuleChainNames=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
RuleChainNames=708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain
RuleChainNames=709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain
RuleChainNames=710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=99.SetResponseAction
RuleNames=100.LogActionDetails
RuleNames=200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber
RuleNames=300.ValidateBody
RuleNames=400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber
RuleNames=500.ResetSSLSessionStatus
RuleNames=700.ProcessAction


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/100.LogActionDetails]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevRespTokenString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Processing OEM action: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=or,or


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber/TrueRule]

AdornOps=set DEG_OEMDevRequestProcessedInteger 0
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/300.ValidateBody]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=110.DEG30ValidateInitialRequestRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=or,or


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber/TrueRule]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/500.ResetSSLSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,!=,0
Conditions=DEG_SSL_STATE,!=,"WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA"
Conditions=DEG_SSL_STATE,!=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,!=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,!=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,!=,"DISALLOWED_ACTION"
Operations=and,and,and,and,and
TrueRuleChain=100.ResetSslStateToNew


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/500.ResetSSLSessionStatus/100.ResetSslStateToNew]

AdornOps=set DEG_SSL_STATE "NEW"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/700.ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200I.DEG30ProcessActionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/99.SetResponseAction]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0201"
AdornOps=set DEG_OEMDevMessageString "Processing OEM action"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ProcessRequest


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest]

CallInitialValidationCustom=150.CallInitialValidationCustom
CheckIfDeviceDataExists=310.CheckIfDeviceDataExists
CheckIfSubscriberBlackListed=300.CheckIfSubscriberBlackListed
CheckIfSubscriberProvisioned=400.CheckIfSubscriberProvisioned
CheckIfSubscriberProvisioned=410.CopyEntitlementValues
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
ExtractNAIFromSubscriberIdAttribute=110.DecodePayload
ExtractNAIFromSubscriberIdAttribute=120.CheckPlayloadIfBase64
ExtractNAIFromSubscriberIdAttribute=130.SetLogInfo
ExtractNAIFromSubscriberIdAttribute=130.Log
GenerateEapAkaInitialEndAuditData=700.GenerateEapAkaInitialEndAuditData
GenerateOEMResponse=600.GenerateOEMResponse
GenerateStartAuditData=125.MonitorSessionRuleChain
GenerateStartAuditData=130.GenerateStartAuditData
Operations=DoAll
ProcessPerAuthType=500.InitVariables
ProcessPerAuthType=510.LookupDEGToken
ProcessPerAuthType=520.CheckDEGToken
TrueRuleChain=ExtractNAIFromSubscriberIdAttribute
TrueRuleChain=ValidateToken
TrueRuleChain=GenerateStartAuditData
TrueRuleChain=CallInitialValidationCustom
TrueRuleChain=CheckIfSubscriberBlackListed
TrueRuleChain=CheckIfDeviceDataExists
TrueRuleChain=CheckIfSubscriberProvisioned
TrueRuleChain=ProcessPerAuthType
TrueRuleChain=GenerateEapAkaInitialEndAuditData
TrueRuleChain=GenerateOEMResponse
ValidateToken=140.ValidateToken


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/110.DecodePayload]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevEAPSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy
DecodeSubscriberId=200.DecodeSubscriberId
DecpdeEAPSubscriberId=100.DecodeEAPSubscriberId
Operations=None
TrueRuleChain=DecpdeEAPSubscriberId
TrueRuleChain=DecodeSubscriberId


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/110.DecodePayload/100.DecodeEAPSubscriberId]

AdornOps=decBase64 DEG_OEMDevEAPSubscriberIdString DEG_OEMDevEAPPayloadBinary
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/110.DecodePayload/200.DecodeSubscriberId]

AdornOps=decBase64 DEG_OEMDevSubscriberIdString DEG_OEMDevEAPPayloadBinary
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.ConvertPayload2String
FalseRuleChain=210.DecodeNAI
TrueRuleChain=000.GenerateStartAudit
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/000.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/100.SetHTTPErrorResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0211"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber-id is empty or Unable to Extract NAI From Subscriber-id"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_OEMDevTempSubscriberIdString
Attributes=DEG_OEMDevSubscriberIdLengthInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Either Subscriber-id is empty or Unable to Extract NAI From Subscriber-id : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/200.ConvertPayload2String]

AdornOps=bin2str DEG_OEMDevEAPPayloadBinary DEG_OEMDevTempSubscriberIdString "ISO8859_1"
AdornOps=length DEG_OEMDevTempSubscriberIdString DEG_OEMDevSubscriberIdLengthInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdLengthInteger,>=,6
TrueRuleChain=100.ExtractNAI


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevEAPSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy
ExtractEAPSubscriberId=100.ExtractEAPSubscriberId
ExtractEAPSubscriberId=130.ValidateEAPSubscriberIdAttribute
ExtractEAPSubscriberId=145.ExtractImsiFromEAPSubscriberIdAttribute
ExtractSubscriberId=200.ExtractSubscriberId
ExtractSubscriberId=135.ValidateSubscriberIdAttribute
ExtractSubscriberId=150.ExtractImsiFromSubscriberIdAttribute
Operations=None
TrueRuleChain=ExtractEAPSubscriberId
TrueRuleChain=ExtractSubscriberId


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/100.ExtractEAPSubscriberId]

AdornOps=substr 5 length DEG_OEMDevTempSubscriberIdString DEG_OEMDevEAPSubscriberIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/130.ValidateEAPSubscriberIdAttribute]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
FalseRuleChain=000.GenerateStartAudit
FalseRuleChain=200.SetHttpErrorResponse
FalseRuleChain=210.ErrorLog
Operation=match
RegExPattern=${SUBSCRIBERID_PATTERN}
SourceAttribute=DEG_OEMDevEAPSubscriberIdString


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/130.ValidateEAPSubscriberIdAttribute/000.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/130.ValidateEAPSubscriberIdAttribute/200.SetHttpErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0212"
AdornOps=set DEG_OEMDevErrorMessageString "EAP-Subscriber-id attribute not NAI format"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/130.ValidateEAPSubscriberIdAttribute/210.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request - EAP-subscriber-id attribute must be in NAI format: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/135.ValidateSubscriberIdAttribute]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
FalseRuleChain=200.SetHttpErrorResponse
FalseRuleChain=210.ErrorLog
Operation=match
RegExPattern=${SUBSCRIBERID_PATTERN}
SourceAttribute=DEG_OEMDevSubscriberIdString


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/135.ValidateSubscriberIdAttribute/200.SetHttpErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0213"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber-id attribute not NAI format"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/135.ValidateSubscriberIdAttribute/210.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request - subscriber-id attribute must be in NAI format: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/145.ExtractImsiFromEAPSubscriberIdAttribute]

AdornOps=substr "0" "@" DEG_OEMDevEAPSubscriberIdString DEG_OEMDevImsiString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/150.ExtractImsiFromSubscriberIdAttribute]

AdornOps=substr "0" "@" DEG_OEMDevSubscriberIdString DEG_OEMDevImsiString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/200.ExtractSubscriberId]

AdornOps=copy DEG_OEMDevTempSubscriberIdString DEG_OEMDevSubscriberIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=(DEG_OEMDevEAPPayloadBinary =="") || (DEG_OEMDevEAPPayloadBinary == null)


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/125.MonitorSessionRuleChain]

ClassName=LocalRuleChainInvoker
RuleChain=400A.ProcessSubscriberExistsResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/130.GenerateStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/130.Log]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_OEMDevSubscriberIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Subscriber-id in the incoming request: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/130.SetLogInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0237"
AdornOps=set DEG_OEMDevMessageString "Subscriber-id in the incoming request"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/140.ValidateToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/140.ValidateToken/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0214"
AdornOps=set DEG_OEMDevErrorMessageString "Token is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/140.ValidateToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request - token is empty: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom]

ClassName=RuleChain
RuleNames=200.CopyBeforeInitialValidation
RuleNames=300.LogBeforeInitialValidation
RuleNames=400.ProcessInitialValidation
RuleNames=401.SetLogInfo
RuleNames=402.LogAfterInitialValidation
RuleNames=500.CheckCustomStatus


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/200.CopyBeforeInitialValidation]

AdornOps=setifnull CUST_DDIV_OUT_Status 0
AdornOps=setifnull CUST_DDIV_OUT_RespHttpStatusInteger 0
AdornOps=copy DEG_OEMDevEAPSubscriberIdString CUST_DDIV_IN_SubscriberIdString
AdornOps=copy DEG_OEMDevSipUserNameString CUST_DDIV_IN_SipUserNameString
AdornOps=copy DEG_OEMDevTerminalVendorString CUST_DDIV_IN_TerminalVendorString
AdornOps=copy DEG_OEMDevImsiString CUST_DDIV_IN_IMSIString
AdornOps=copy DEG_OEMDevRequestProcessedInteger CUST_DDIV_OUT_Status
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0215"
AdornOps=set DEG_OEMDevMessageString "before processing Initial validation"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/300.LogBeforeInitialValidation]

Attributes=CUST_DDIV_IN_SubscriberIdString
Attributes=CUST_DDIV_IN_SipUserNameString
Attributes=CUST_DDIV_IN_TerminalVendorString
Attributes=CUST_DDIV_IN_IMSIString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Log before processing Initial validation
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/400.ProcessInitialValidation]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_Android_InputValidation
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/401.SetLogInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0216"
AdornOps=set DEG_OEMDevMessageString "after processing Initial validation"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/402.LogAfterInitialValidation]

Attributes=CUST_DDIV_OUT_Status
Attributes=CUST_DDIV_OUT_RespHttpStatusInteger
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Log after processing Initial validation
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/500.CheckCustomStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=CUST_DDIV_OUT_Status,=,1
TrueRuleChain=100.CopyAfterInitialValidation
TrueRuleChain=200.SetStatusValues


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/500.CheckCustomStatus/100.CopyAfterInitialValidation]

AdornOps=copy CUST_DDIV_OUT_RespHttpStatusInteger DEG_OEMDevHttpStatusInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/500.CheckCustomStatus/200.SetStatusValues]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevHttpStatusInteger,=,"403"
Conditions=DEG_OEMDevHttpStatusInteger,=,"500"
Conditions=DEG_OEMDevHttpStatusInteger,=,DEG_OEMDevHttpStatusInteger
Http403=100.Set403Error
Http403=101.Log403Error
Http500=200.Set500Error
Http500=201.Log500Error
Operations=None
TrueRuleChain=Http403
TrueRuleChain=Http500
TrueRuleChain=Http500


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/500.CheckCustomStatus/200.SetStatusValues/100.Set403Error]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "Degdroid Initial Validation Custom Configuration Http403 Failure"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0217"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/500.CheckCustomStatus/200.SetStatusValues/101.Log403Error]

Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Degdroid Initial Validation Custom Configuration Http403 Failure : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/500.CheckCustomStatus/200.SetStatusValues/200.Set500Error]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "Degdroid Initial Validation Custom Configuration Http500 Failure"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0218"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/500.CheckCustomStatus/200.SetStatusValues/201.Log500Error]

Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=Degdroid Initial Validation Custom Configuration Http500 Failure : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/300.CheckIfSubscriberBlackListed]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=150.DEG30BlackListeSubscriberRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/310.CheckIfDeviceDataExists]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200M.DEG30DeviceDataLookupRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/400.CheckIfSubscriberProvisioned]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400.GetSubscriberProfileRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/410.CopyEntitlementValues]

AdornOps=copy DEG_EntitlementStatus DEG_SSL_EntitlementStatus
AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDRESS_UPDATE_URL ""
AdornOps=copy DEG_TC_STATUS DEGDROID_XML_TC_STATUS
AdornOps=copy DEG_ADDRESS_STATUS DEGDROID_XML_ADDRESS_STATUS
AdornOps=copy DEG_PROVISIONING_STATUS DEGDROID_XML_PROVISIONING_STATUS
AdornOps=copy DEG_ADDR_UPDATE_POSTDATA DEGDROID_XML_ADDR_UPDATE_POSTDATA
AdornOps=copy DEG_ADDRESS_UPDATE_URL DEGDROID_XML_ADDRESS_UPDATE_URL
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/500.InitVariables]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=copy DEG_MDN DEG_CDevMobileNumberString
AdornOps=set DEG_CDevTokenString ""
AdornOps=set DEG_OEMDevFastAuthFlag 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/510.LookupDEGToken]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_AUTHENTICATION_TYPE,DEG_AUTHENTICATION_TYPE
MapAttributes=DEG_AUTHENTICATION_SUBTYPE,DEG_AUTHENTICATION_SUBTYPE
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckTokenTimeStamp
FalseRuleChain=210.CheckProcessIntegerFlag
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/100.SetHTTPErrorResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0219"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_TOKENS table"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_TOKENS table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/120.GenerateEapAkaInitialSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/200.CheckTokenTimeStamp]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=130.DEG30CheckTokenTimeStampRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=210.GetToken


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
FalseRuleChain=200.CheckIMSI
TrueRuleChain=100.CheckSubType


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"DFT"
Conditions=DEG_OEMDevFastAuthFlag,=,0
FalseRuleChain=200.CheckAuthToken
Operations=or
TrueRuleChain=100.CheckIMSI


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/100.CheckIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,=,"dummy"
FalseRuleChain=100.InvalidToken
TrueRuleChain=200.EAPAKAAuth


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/100.CheckIMSI/100.InvalidToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200D.DEG30InvalidToken
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/100.CheckIMSI/200.EAPAKAAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200D.DEG30FullAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/200.CheckAuthToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevFastAuthFlag,=,1
Conditions=DEG_TOKENSTATUS,=,"AE"
Conditions=DEG_OEMDevTokenString,=,DEG_SUBSTOKEN
FalseRuleChain=200.CheckIMSI
Operations=and,and
TrueRuleChain=100.FastPathAuth


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/200.CheckAuthToken/100.FastPathAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200E.DEG30FastPathAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/200.CheckAuthToken/200.CheckIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,=,"dummy"
FalseRuleChain=100.InvalidToken
TrueRuleChain=200.EAPAKAAuth


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/200.CheckAuthToken/200.CheckIMSI/100.InvalidToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200D.DEG30InvalidToken
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/200.CheckAuthToken/200.CheckIMSI/200.EAPAKAAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200D.DEG30FullAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/200.CheckIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,=,"dummy"
FalseRuleChain=100.InvalidToken
TrueRuleChain=200.EAPAKAAuth


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/200.CheckIMSI/100.InvalidToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200D.DEG30InvalidToken
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/200.CheckIMSI/200.EAPAKAAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200D.DEG30FullAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/530.ProcessDeviceData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200N.DEG30DeviceDataProcessRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/600.GenerateOEMResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200F.DEG30GenerateOEMResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/700.GenerateEapAkaInitialEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=200.ValidationAndProcessRequest
RuleNames=300.UpdateSSLSessionStore
RuleNames=400.SetResponseHandler


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/100.InitWorkingVariables]

AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_OEMDevImsiString ""
AdornOps=set DEG_MDN 0
AdornOps=set DEG_IMSI ""
AdornOps=set DEG_OEMDevRespPhoneNumberString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/200.ValidationAndProcessRequest]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200A.DEG30ValidationAndProcessRequestRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"NEW"
FalseRuleChain=200.UpdateSslSessionState


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState]

ClassName=RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=300.CheckSslSessionUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/100.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI
AdornOps=copy DEG_OEMDevImsiString DEG_SSL_IMSI
AdornOps=copy DEG_OEMDevUniqueIDString DEG_SSL_UNIQUE_ID
AdornOps=copy DEG_MDN DEG_SSL_MDN
AdornOps=set DEG_SSL_GW_ADDR ""
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDRESS_UPDATE_URL ""
AdornOps=setifnull DEG_EntitlementStatus ""
AdornOps=copy DEG_PROVISIONING_STATUS DEG_SSL_ID_PROV_STATUS
AdornOps=copy DEG_ADDR_UPDATE_POSTDATA DEG_SSL_POSTDATA
AdornOps=copy DEG_ADDRESS_STATUS DEG_SSL_ADDRESS_STATUS
AdornOps=copy DEG_TC_STATUS DEG_SSL_TC_STATUS
AdornOps=copy DEG_ADDRESS_UPDATE_URL DEG_SSL_ADDRESS_UPDATE_URL
AdornOps=copy DEG_EntitlementStatus DEG_SSL_EntitlementStatus
AdornOps=setifnull DEGDROID_SSL_COOKIE_ID ""
AdornOps=setifnull DEGDROID_SSL_OTP 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_STATE,DEG_SSL_AAA_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
MapAttributes=DEG_SSL_ID_PROV_STATUS,DEG_SSL_ID_PROV_STATUS
MapAttributes=DEG_SSL_GW_ADDR,DEG_SSL_GW_ADDR
MapAttributes=DEG_SSL_POSTDATA,DEG_SSL_POSTDATA
MapAttributes=DEG_SSL_ADDRESS_STATUS,DEG_SSL_ADDRESS_STATUS
MapAttributes=DEG_SSL_TC_STATUS,DEG_SSL_TC_STATUS
MapAttributes=DEG_SSL_ADDRESS_UPDATE_URL,DEG_SSL_ADDRESS_UPDATE_URL
MapAttributes=DEG_SSL_EntitlementStatus,DEG_SSL_EntitlementStatus
MapAttributes=DEGDROID_SSL_COOKIE_ID,DEGDROID_SSL_COOKIE_ID
MapAttributes=DEGDROID_SSL_OTP,DEGDROID_SSL_OTP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=99.InitErrorLog
TrueRuleChain=100.LogError


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/100.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=99.InitErrorLog
TrueRuleChain=100.LogError


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/99.InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0210"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update row in DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/99.InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0209"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update row in DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/400.SetResponseHandler]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,within,[200,200C]
FalseRuleChain=200.SetEmptyResponseHandler
TrueRuleChain=100.SetTextResponseHandler


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/400.SetResponseHandler/100.SetTextResponseHandler]

AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/400.SetResponseHandler/200.SetEmptyResponseHandler]

AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain]

ClassName=RuleChain
RuleNames=100.CheckEAPSubscriberID
RuleNames=200.CheckProcessIntegerFlag


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/100.CheckEAPSubscriberID]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPSubscriberIdString,=,dummy
FalseRuleChain=200.InitRequestVariables
TrueRuleChain=100.InitRequestVariables


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/100.CheckEAPSubscriberID/100.InitRequestVariables]

AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevHttpStatusInteger "511"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/100.CheckEAPSubscriberID/200.InitRequestVariables]

AdornOps=set DEG_CDevSysParameter "EAPAKAAuth"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
AdornOps=copy DEG_OEMDevEAPSubscriberIdString DEG_SSL_NAI
AdornOps=copy DEG_OEMDevEAPSubscriberIdString DEG_OEMDevSubscriberIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=200.ReadValue
TrueRuleChain=300.CheckErrorAndNoMatchFlag


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/200.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
Conditions=DEG_CDevSysValueString,=,"Enabled"
FalseRuleChain=200.SetSessionStatus
FalseRuleChain=210.LogEAPAKAAtuhDisabled
Operations=and,and
TrueRuleChain=100.AAAProcessingRule
TrueRuleChain=109.SetLogInfo
TrueRuleChain=110.LogEAPAKAAtuhEnabled
TrueRuleChain=120.UpdateTokenTable


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/100.AAAProcessingRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_OEMDevSubscriberIdString
RequestAttributes=DEG_OEMDevEAPPayloadBinary
RequestAttributes=DEG_SSL_NAI
ResponseAttributes=DEG_OEMDevRequestIdString
ResponseAttributes=DEG_SSL_STATE
ResponseAttributes=DEG_SSL_AAA_STATE
ResponseAttributes=DEG_AUTHENTICATION_TYPE
ResponseAttributes=DEG_AUTHENTICATION_SUBTYPE
ResponseAttributes=DEG_OEMDevEAPPayloadBinary
RuleChain=301.DEG30AAAProcessingRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/109.SetLogInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0221"
AdornOps=setifnull DEG_OEMDevMessageString "Perform EAPAKAAtuh Enable"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/110.LogEAPAKAAtuhEnabled]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_DevAuthTypeString
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_SSL_STATE
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Perform EAPAKAAtuh Enable: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
FalseRuleChain=400.SetAuditTransactionType
TrueRuleChain=100.InitUpdate
TrueRuleChain=200.Update
TrueRuleChain=300.CheckUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/100.InitUpdate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=setifnull DEG_BLACKLIST_FLAG 0
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=set DEG_AuditTransactionTypeString "full-auth-init"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0222"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS table during blacklist processing"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_TOKENS session store during blacklist processing
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0223"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_TOKENS BLACKLISTED session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/400.SetAuditTransactionType]

AdornOps=set DEG_AuditTransactionTypeString "full-auth-init"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/200.SetSessionStatus]

AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "DFT"
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0224"
AdornOps=set DEG_OEMDevErrorMessageString "EAPAKAAtuh Disabled or Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/210.LogEAPAKAAtuhDisabled]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Perform EAPAKAAtuh Disabled:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30InvalidToken]

ClassName=RuleChain
RuleNames=100.SetErrorInfo
RuleNames=110.ErrorLog
RuleNames=120.GenerateInvalidTokenErrorEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30InvalidToken/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0220"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevErrorMessageString "Network Authentication Required"
AdornOps=set DEG_CDevOutReturnCodeString "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30InvalidToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_OEMDevTokenString
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Invalid Input Token: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30InvalidToken/120.GenerateInvalidTokenErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetSystemTime
RuleNames=110.CheckTokenValidity


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/100.SetSystemTime]

AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_EVENTTIMESTAMP DEG_OEMDevTokenTimeStampDiffLong
AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_FULLAUTHTIMESTAMP DEG_OEMDevFullAuthTimeStampDiffLong
AdornOps=set DEG_AuditTransactionTypeString "fast-auth"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenTimeStampDiffLong,<=,DEG_OEMDeviceTokenValidityLong
Conditions=DEG_OEMDevFullAuthTimeStampDiffLong,<=,DEG_OEMDeviceFullAuthMustWindowLong
FalseRuleChain=200.SetErrorInfo
FalseRuleChain=210.ErrorLog
FalseRuleChain=220.GenerateInitialAuthSystemErrorEndAuditData
Operations=and
TrueRuleChain=100.SetSessionStatus
TrueRuleChain=200.LogFastPathAuth


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/100.SetSessionStatus]

AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "TKN"
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0226"
AdornOps=set DEG_OEMDevMessageString "Perform FastPathAuth"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/200.LogFastPathAuth]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_AUTH_COUNT
Attributes=DEG_OEMDevAuthThresholdCountInteger
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Perform FastPathAuth: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/200.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0225"
AdornOps=set DEG_SSL_STATE "NEW"
AdornOps=set DEG_CDevOutReturnCodeString "511"
AdornOps=set DEG_OEMDevErrorMessageString "Network Authentication Required"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/210.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevCurrentTimeStampLong
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_OEMDevTokenTimeStampDiffLong
Attributes=DEG_OEMDeviceTokenValidityLong
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Database Error: Token Expired Network Authentication Required
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/220.GenerateInitialAuthSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/300.CheckCounter]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTH_COUNT,>,DEG_OEMDevAuthThresholdCountInteger
TrueRuleChain=100.SetBlackListed


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/300.CheckCounter/100.SetBlackListed]

AdornOps=set DEG_BLACKLIST_FLAG 1
AdornOps=set DEG_AUTH_COUNT 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/100.InitUpdate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=setifnull DEG_AUTH_COUNT 0
AdornOps=setifnull DEG_BLACKLIST_FLAG 0
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0227"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_TOKENS session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0228"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_TOKENS session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/500.GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_BLACKLIST_FLAG,=,1
TrueRuleChain=100.GenerateBlackListedResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/500.GenerateResponse/100.GenerateBlackListedResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=140.DEG30GenerateBlackListedResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateOEMResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse]

AkaRejected=400.AkaRejected_InitResponse
AkaRejected=410.AkaRejected_DeactiveToken
AkaRejected=420.AkaRejected_GenerateEndAuditData
AkaWait=300.AkaWait_InitResponse
AkaWait=310.AkaWait_GenerateResponse
Authenticated=500.Authenticated_InitResponse
Authenticated=501.Authenticated_GetResponseTemplate
Authenticated=502.Authenticated_CheckProcessedInteger
BlacListedSubscriber=200.BlackListedSubscriber_InitResponse
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Conditions=DEG_SSL_STATE,starts,"AUTHENTICATED"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE
Operations=None
StatusDisallowed=700.DisallowedAction_InitResponse
TrueRuleChain=UnknownSubscriber
TrueRuleChain=BlacListedSubscriber
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=StatusDisallowed
TrueRuleChain=Authenticated
TrueRuleChain=Unknown
Unknown=600.Unknown_SetHttpErrorResponseTo500C
UnknownSubscriber=100.UnknownSubscriber_InitResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/100.UnknownSubscriber_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRespStatusString 403
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/200.BlackListedSubscriber_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevRespStatusString 511
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/300.AkaWait_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "200"
AdornOps=set DEG_OEMDevRespStatusString 200
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodePayload
FalseRuleChain=203.InitVariableAuthXMLTemplate
FalseRuleChain=205.LookUpAuthXMLTemplate
FalseRuleChain=215.AssignMessagetoResponse
FalseRuleChain=220.GenerateAKAWaitEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/100.GenerateNullPayloadResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/200.EncodePayload]

AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/203.InitVariableAuthXMLTemplate]

AdornOps=set DEGDROID_auth_step_Integer 1
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/205.LookUpAuthXMLTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/215.AssignMessagetoResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.AssignResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/215.AssignMessagetoResponse/100.AssignResponse]

AdornOps=setifnull DEG_XML_TEMPLATES_FILE ""
AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/220.GenerateAKAWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,!=,"500C"
TrueRuleChain=100.GenerateEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/220.GenerateAKAWaitEndAuditDataRuleChain/100.GenerateEndAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/400.AkaRejected_InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 503
AdornOps=set DEG_SSL_REQUEST_STATE "503C"
AdornOps=set DEG_TOKENSTATUS "DE"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/410.AkaRejected_DeactiveToken]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/420.AkaRejected_GenerateEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,!=,"500C"
TrueRuleChain=100.GenerateEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/420.AkaRejected_GenerateEndAuditData/100.GenerateEndAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/420.AkaRejected_GenerateResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/500.Authenticated_InitResponse]

AdornOps=set DEG_APP_TOKEN_FLAG 1
AdornOps=setifnull DEGDROID_SSL_COOKIE_ID ""
AdornOps=set DEGDROID_auth_step_Integer 3
AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEG_OEMDevRespTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEG_CDevTokenString
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP
AdornOps=set DEG_TOKEN_VALIDITY_SECONDS ${DEGDROID_DEVICE_TOKEN_VALIDITY}
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/501.Authenticated_GetResponseTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger]

Authenticated_DeviceData=530.Authenticated_DeviceData
Authenticated_GenerateEndAuditDataRuleChain=540.Authenticated_GenerateEndAuditDataRuleChain
Authenticated_GenerateResponse=560.Authenticated_GenerateResponse
Authenticated_ResponseCustomization=520.Authenticated_ResponseCustomization
Authenticated_ServiceConfiguration=550.Authenticated_ServiceConfiguration
Authenticated_StoreToken=510.Authenticated_StoreToken
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Operations=DoAll
TrueRuleChain=Authenticated_StoreToken
TrueRuleChain=Authenticated_ResponseCustomization
TrueRuleChain=Authenticated_DeviceData
TrueRuleChain=Authenticated_GenerateEndAuditDataRuleChain
TrueRuleChain=Authenticated_ServiceConfiguration
TrueRuleChain=Authenticated_GenerateResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/510.Authenticated_StoreToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevMobileNumberString
RequestAttributes=DEG_IMSI
RequestAttributes=DEG_CDevTokenString
RequestAttributes=DEG_AUTHENTICATION_TYPE
RequestAttributes=DEG_AUTHENTICATION_SUBTYPE
RequestAttributes=DEG_APP_TOKEN_FLAG
RequestAttributes=DEG_FULLAUTHTIMESTAMP
ResponseAttributes=DEG_OEMDevErrorMessageString
ResponseAttributes=DEG_EVENTTIMESTAMP
RuleChain=005.DEG30StoreTokenRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/520.Authenticated_ResponseCustomization]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=180.ProcessResponseAttributeCustomization
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/530.Authenticated_DeviceData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200N.DEG30DeviceDataProcessRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/540.Authenticated_GenerateEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,!=,"500C"
TrueRuleChain=100.GenerateEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/540.Authenticated_GenerateEndAuditDataRuleChain/100.GenerateEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
GenerateAAAAuthenticatedEndAuditData=100.GenerateEapAkaInitialAAAAuthenticatedEndAuditData
GenerateDEGTokenAuthenticatedEndAuditData=200.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData
Operations=None
TrueRuleChain=GenerateAAAAuthenticatedEndAuditData
TrueRuleChain=GenerateDEGTokenAuthenticatedEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/540.Authenticated_GenerateEndAuditDataRuleChain/100.GenerateEndAuditDataRuleChain/100.GenerateEapAkaInitialAAAAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/540.Authenticated_GenerateEndAuditDataRuleChain/100.GenerateEndAuditDataRuleChain/200.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"TKN"
FalseRuleChain=200.GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditData
TrueRuleChain=100.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/540.Authenticated_GenerateEndAuditDataRuleChain/100.GenerateEndAuditDataRuleChain/200.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData/100.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/540.Authenticated_GenerateEndAuditDataRuleChain/100.GenerateEndAuditDataRuleChain/200.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData/200.GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/550.Authenticated_ServiceConfiguration]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.DEG30ProcessServiceConfigurationRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckEAPPayload
RuleNames=150.CheckResponseXMLEmptyAfterServiceConfigProcess


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse/100.CheckEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodePayload
TrueRuleChain=100.GenerateNullPayloadResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse/100.CheckEAPPayload/100.GenerateNullPayloadResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse/100.CheckEAPPayload/200.EncodePayload]

AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse/100.CheckEAPPayload/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_XMLTemplateResponseString,!=,""
FalseRuleChain=20.AssignResponseFromAuthConfigTemplate
TrueRuleChain=10.AssignResponseFromServiceConfigTemplate


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess/10.AssignResponseFromServiceConfigTemplate]

AdornOps=copy DEG_XMLTemplateResponseString ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess/20.AssignResponseFromAuthConfigTemplate]

AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/600.Unknown_SetHttpErrorResponseTo500C]

AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevHttpStatusInteger "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/700.DisallowedAction_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevHttpStatusInteger "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateEapAkaInitialEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,!=,UNKNOWN_SUBSCRIBER
Description=Unknown Subscriber case already Handled
Operations=or
TrueRuleChain=000.SetTranscationType
TrueRuleChain=100.CheckAuthenticationState


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/000.SetTranscationType]

ClassName=ConditionalRule
Conditions=DEG_OEMDevRequestAttributeString,contains,"IMSI_EAP"
FalseRuleChain=SetTranscationType
TrueRuleChain=SetFullAuthTranscationType


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/000.SetTranscationType/SetFullAuthTranscationType]

AdornOps=set DEG_AuditTransactionTypeString "full-auth-init"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/000.SetTranscationType/SetTranscationType]

AdornOps=set DEG_AuditTransactionTypeString "fast-auth"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState]

BlackListSubscriber=500.GenerateEapAkaInitialBlackListSubscriberEndAuditData
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=None
StatusDisallowed=600.GenerateEapAkaInitialDisallowedActionEndAuditData
TrueRuleChain=BlackListSubscriber
TrueRuleChain=StatusDisallowed


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/100.GenerateEapAkaInitialRejectedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/200.GenerateEapAkaInitialWaitEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/300.GenerateEapAkaInitialAAAAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/400.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"TKN"
FalseRuleChain=200.GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditData
TrueRuleChain=100.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/400.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData/100.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/400.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData/200.GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/500.GenerateEapAkaInitialBlackListSubscriberEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/600.GenerateEapAkaInitialDisallowedActionEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200I.DEG30ProcessActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ProcessAction


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200I.DEG30ProcessActionRuleChain/100.ProcessAction]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitSslSessionLookup
TrueRuleChain=110.ExecuteSslSessionLookup
TrueRuleChain=120.CheckSslSessionLookupStatus


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200I.DEG30ProcessActionRuleChain/100.ProcessAction/100.InitSslSessionLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200I.DEG30ProcessActionRuleChain/100.ProcessAction/110.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
MapAttributes=DEG_SSL_ID_PROV_STATUS,DEG_SSL_ID_PROV_STATUS
MapAttributes=DEG_SSL_GW_ADDR,DEG_SSL_GW_ADDR
MapAttributes=DEG_SSL_ADDRESS_UPDATE_URL,DEG_SSL_ADDRESS_UPDATE_URL
MapAttributes=DEG_SSL_ADDRESS_STATUS,DEG_SSL_ADDRESS_STATUS
MapAttributes=DEG_SSL_TC_STATUS,DEG_SSL_TC_STATUS
MapAttributes=DEG_SSL_POSTDATA,DEG_SSL_POSTDATA
MapAttributes=DEG_SSL_EntitlementStatus,DEG_SSL_EntitlementStatus
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200I.DEG30ProcessActionRuleChain/100.ProcessAction/120.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200J.DEG30SslSessionLookupStatusRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SslSessionLookup


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_SSL_REQUEST_STATE,=,"NEW"
Conditions=DEG_SSL_REQUEST_STATE,within,[403C,500C]
Conditions=DEG_SSL_REQUEST_STATE,within,[200,200C]
Conditions=DEG_SSL_REQUEST_STATE,=,DEG_SSL_REQUEST_STATE
NewRequest=300.NewRequest_CheckSslSessionStatus
NoSslSession=200.SetSslRequestState_500C
NoSslSession=210.NoSslSessionLog
Operations=None
RequestError=350.RequestErrorInfo
RequestError=400.RequestErrorLog
RequestOk=500.RequestOk_CheckSslSessionStatus
SystemError=100.SetSslRequestState_500C
SystemError=110.SystemErrorLog
SystemError=120.GenerateStartAuditDataRuleChain
TrueRuleChain=SystemError
TrueRuleChain=NoSslSession
TrueRuleChain=NewRequest
TrueRuleChain=RequestError
TrueRuleChain=RequestOk
TrueRuleChain=UnknownStatus
UnknownStatus=600.SetSslRequestState_500C
UnknownStatus=610.UnknownStatusLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/100.SetSslRequestState_500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0202"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/110.SystemErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access DEG_SSL_SESSION table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/120.GenerateStartAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/200.SetSslRequestState_500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0203"
AdornOps=set DEG_OEMDevErrorMessageString "Internal system error as SSL Session does exist in DEG_SSL_SESSION store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/210.NoSslSessionLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Internal system error as SSL Session does exist in DEG_SSL_SESSION store: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/300.NewRequest_CheckSslSessionStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200K.DEG30NewRequest_CheckSslSessionStatusRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/350.RequestErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0204"
AdornOps=set DEG_OEMDevErrorMessageString "Skipping processing OEM action"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/400.RequestErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Skipping processing OEM action - request is in error state: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/500.RequestOk_CheckSslSessionStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200L.DEG30RequestOk_CheckSslSessionStatusRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/600.SetSslRequestState_500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0205"
AdornOps=set DEG_OEMDevErrorMessageString "SSL SESSION is in unrecognized state"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/610.UnknownStatusLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Action processed with error - SSL SESSION is in unrecognized state: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.NewRequest_Check


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check]

AkaWait=200.AkaWait_ProcessAction
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"NEW"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE
NewSslSession=100.NewSslSession_ProcessAction
Operations=None
TrueRuleChain=NewSslSession
TrueRuleChain=AkaWait
TrueRuleChain=UnknownSslSessionState
UnknownSslSessionState=300.Unknown_UpdateRequestStateTo500C


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/100.NewSslSession_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200a.DEG30PrcessEAP_AKAAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/200.AkaWait_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=250.DEG30ProcessEAPAKAPayloadRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.GenerateStartAudit
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=210.CheckSslSessionUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/000.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/100.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=95.SetErrorInfo
TrueRuleChain=100.SystemErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/100.SystemErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=99.InitErrorLog
TrueRuleChain=100.RowNotFound


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.RowNotFound]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists/99.InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0207"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/95.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0206"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_SSL_SESSION store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200L.DEG30RequestOk_CheckSslSessionStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=098.SetInfo
RuleNames=100.LogNMERule20


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200L.DEG30RequestOk_CheckSslSessionStatusRuleChain/098.SetInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0208"
AdornOps=set DEG_OEMDevMessageString "Inside Customize 200L.DEG30RequestOk_CheckSslSessionStatusRuleChain"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200L.DEG30RequestOk_CheckSslSessionStatusRuleChain/100.LogNMERule20]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=entired Inside Customize 200L.DEG30RequestOk_CheckSslSessionStatusRuleChain
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.InitDeviceDataLookup
RuleNames=120.ExecuteDeviceDataLookup
RuleNames=130.CheckDeviceDataLookupStatus


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/110.InitDeviceDataLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_DevAndroidEntitlementNameString ${ANDROIDVOWIFI_ENTITLEMENT_NAME}
AdornOps=copy DEG_DevAndroidEntitlementNameString DEG_ENTITLEMENT_NAME
AdornOps=copy DEGDROID_TerminalUniqueIdString DEG_UNIQUE_ID
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/120.ExecuteDeviceDataLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
MapAttributes=DEG_ENTITLEMENT_NAME,DEG_ENTITLEMENT_NAME
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_APNS_TOKEN,DEG_APNS_TOKEN
MapAttributes=DEG_OLD_APNS_TOKEN,DEG_OLD_APNS_TOKEN
MapAttributes=DEG_PROVISIONING_STATUS,DEG_PROVISIONING_STATUS
MapAttributes=DEG_PUSH_NOTIFICATION_STATUS,DEG_PUSH_NOTIFICATION_STATUS
MapAttributes=DEG_SERVICE_MGMT_POSTDATA,DEG_SERVICE_MGMT_POSTDATA
MapAttributes=DEG_DISPLAY_NAME,DEG_DISPLAY_NAME
MapAttributes=DEG_ADDRESS_STATUS,DEG_ADDRESS_STATUS
MapAttributes=DEG_TC_STATUS,DEG_TC_STATUS
MapAttributes=DEG_ADDR_UPDATE_POSTDATA,DEG_ADDR_UPDATE_POSTDATA
MapAttributes=DEG_ADDR_REFID,DEG_ADDR_REFID
MapAttributes=DEG_ADDR_REFID_EXP_DATE,DEG_ADDR_REFID_EXP_DATE
MapAttributes=DEG_LASTUPDATE,DEG_LASTUPDATE
MapAttributes=DEG_SIP_USERNAME,DEG_SIP_USERNAME
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/130.CheckDeviceDataLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExistsFlag
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.PrintError


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/130.CheckDeviceDataLookupStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0229"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_DEVICE_DATA table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/130.CheckDeviceDataLookupStatus/110.PrintError]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_UNIQUE_ID
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_DevAndroidEntitlementNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: in looking up DEG_DEVICE_DATA table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/130.CheckDeviceDataLookupStatus/200.CheckKeyExistsFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
FalseRuleChain=200.RowNotFound
TrueRuleChain=100.RowFound


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/130.CheckDeviceDataLookupStatus/200.CheckKeyExistsFlag/100.RowFound]

AdornOps=set DEG_DevRowExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/130.CheckDeviceDataLookupStatus/200.CheckKeyExistsFlag/200.RowNotFound]

AdornOps=set DEG_DevRowExistsFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=85.InitErrorLog
RuleNames=100.Log
RuleNames=100.Initialise
RuleNames=100.CheckRowExistsFlag


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_DevRowExistsFlagInteger,=,0
Conditions=DEG_DevRowExistsFlagInteger,=,1
InsertDeviceData=100.CopyRequestImsiToPrevImsi
InsertDeviceData=110.ImsiandEntitlementLookup
InsertDeviceData=100.InitInsertDeviceDataLookup
InsertDeviceData=110.InsertDeviceData
InsertDeviceData=120.CheckDBErrorFlag
Operations=None
TrueRuleChain=InsertDeviceData
TrueRuleChain=UpdateDeviceData
UpdateDeviceData=200.CheckImsiValue
UpdateDeviceData=200.InitUpdate
UpdateDeviceData=210.UpdateDeviceData
UpdateDeviceData=220.CheckUpdateStatus
UpdateDeviceData=230.ImsiandEntitlementLookup


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/100.CopyRequestImsiToPrevImsi]

AdornOps=copy DEG_OEMDevImsiString DEG_OEMDevPrevImsiString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/100.InitInsertDeviceDataLookup]

AdornOps=set log_DB_Operation INSERT
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=copy DEGDROID_TerminalUniqueIdString DEG_UNIQUE_ID
AdornOps=set DEG_DevAndroidEntitlementNameString ${ANDROIDVOWIFI_ENTITLEMENT_NAME}
AdornOps=copy DEG_DevAndroidEntitlementNameString DEG_ENTITLEMENT_NAME
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=setifnull DEG_APNS_TOKEN ""
AdornOps=setifnull DEG_OLD_APNS_TOKEN ""
AdornOps=setifnull DEG_SUB_STATUS 0
AdornOps=setifnull DEG_PUSH_NOTIFICATION_STATUS 0
AdornOps=setifnull DEG_SERVICE_MGMT_POSTDATA ""
AdornOps=setifnull DEG_DISPLAY_NAME ""
AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDR_REFID ""
AdornOps=setsystime DEG_ADDR_REFID_EXP_DATE
AdornOps=setsystime DEG_LASTUPDATE
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_SIP_USERNAME ""
AdornOps=setifnull DEG_SSL_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_SSL_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_SSL_POSTDATA ""
AdornOps=setifnull DEG_SSL_ID_PROV_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=copy DEG_SIP_USERNAME DEG_SIP_USERNAME
AdornOps=copy DEG_SSL_ADDRESS_STATUS DEG_ADDRESS_STATUS
AdornOps=copy DEG_SSL_TC_STATUS DEG_TC_STATUS
AdornOps=copy DEG_SSL_POSTDATA DEG_ADDR_UPDATE_POSTDATA
AdornOps=copy DEG_SSL_ID_PROV_STATUS DEG_PROVISIONING_STATUS
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/110.ImsiandEntitlementLookup]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200P.DEG30ImsiBasedDeviceDataLookupRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/110.InsertDeviceData]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
SessionStore=DEG_DEVICE_DATA_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/120.CheckDBErrorFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.PrintError


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/120.CheckDBErrorFlag/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0234"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to access or create entry in DEG_DEVICE_DATA table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/120.CheckDBErrorFlag/110.PrintError]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: unable to add row in DEG_DEVICE_DATA table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/200.CheckImsiValue]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevImsiString,=,DEG_IMSI
FalseRuleChain=100.CopyTableImsiToPrevImsi


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/200.CheckImsiValue/100.CopyTableImsiToPrevImsi]

AdornOps=copy DEG_IMSI DEG_OEMDevPrevImsiString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/200.InitUpdate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_DEVICE_DATA"
AdornOps=copy DEGDROID_TerminalUniqueIdString DEG_UNIQUE_ID
AdornOps=copy DEG_DevAndroidEntitlementNameString DEG_ENTITLEMENT_NAME
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=setifnull DEG_APNS_TOKEN ""
AdornOps=setifnull DEG_OLD_APNS_TOKEN ""
AdornOps=setifnull DEG_SUB_STATUS 0
AdornOps=setifnull DEG_PUSH_NOTIFICATION_STATUS 0
AdornOps=setifnull DEG_SERVICE_MGMT_POSTDATA ""
AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDR_REFID ""
AdornOps=setsystime DEG_ADDR_REFID_EXP_DATE
AdornOps=setsystime DEG_LASTUPDATE
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_SIP_USERNAME ""
AdornOps=copy DEG_SIP_USERNAME DEG_SIP_USERNAME
AdornOps=copy DEG_SSL_ID_PROV_STATUS DEG_PROVISIONING_STATUS
AdornOps=copy DEG_SSL_ADDRESS_STATUS DEG_ADDRESS_STATUS
AdornOps=copy DEG_SSL_TC_STATUS DEG_TC_STATUS
AdornOps=copy DEG_SSL_POSTDATA DEG_ADDR_UPDATE_POSTDATA
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/210.UpdateDeviceData]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
MapAttributes=DEG_ENTITLEMENT_NAME,DEG_ENTITLEMENT_NAME
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_APNS_TOKEN,DEG_APNS_TOKEN
MapAttributes=DEG_OLD_APNS_TOKEN,DEG_OLD_APNS_TOKEN
MapAttributes=DEG_PROVISIONING_STATUS,DEG_PROVISIONING_STATUS
MapAttributes=DEG_PUSH_NOTIFICATION_STATUS,DEG_PUSH_NOTIFICATION_STATUS
MapAttributes=DEG_SERVICE_MGMT_POSTDATA,DEG_SERVICE_MGMT_POSTDATA
MapAttributes=DEG_DISPLAY_NAME,DEG_DISPLAY_NAME
MapAttributes=DEG_ADDRESS_STATUS,DEG_ADDRESS_STATUS
MapAttributes=DEG_TC_STATUS,DEG_TC_STATUS
MapAttributes=DEG_ADDR_UPDATE_POSTDATA,DEG_ADDR_UPDATE_POSTDATA
MapAttributes=DEG_ADDR_REFID,DEG_ADDR_REFID
MapAttributes=DEG_ADDR_REFID_EXP_DATE,DEG_ADDR_REFID_EXP_DATE
MapAttributes=DEG_LASTUPDATE,DEG_LASTUPDATE
MapAttributes=DEG_SIP_USERNAME,DEG_SIP_USERNAME
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/220.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/220.CheckUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0235"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_DEVICE_DATA table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/220.CheckUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_DEVICE_DATA session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/220.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/220.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0236"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_DEVICE_DATA table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/220.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_DEVICE_DATA session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/230.ImsiandEntitlementLookup]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200P.DEG30ImsiBasedDeviceDataLookupRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.Initialise]

AdornOps=set DEG_OEMDevPrevImsiString ""
AdornOps=set DEG_OEMPrevUniqueId ""
AdornOps=set DEG_OEMCurrUniqueId ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.Log]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_IMSI
Attributes=DEG_OEMDevPrevImsiString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Device Data process rule chain is called : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/200.ImsiConditionCheck]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevImsiString,=,DEG_IMSI
FalseRuleChain=100.DeleteRowMatchingCurrentUniqueId
TrueRuleChain=200.SetPrevAndCurrentUniqueIdAttribute


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/200.ImsiConditionCheck/200.SetPrevAndCurrentUniqueIdAttribute]

AdornOps=copy DEG_UNIQUE_ID DEG_OEMPrevUniqueId
AdornOps=copy DEGDROID_TerminalUniqueIdString DEG_OEMCurrUniqueId
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/85.InitErrorLog]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0230"
AdornOps=set DEG_OEMDevMessageString "Device Data process rule chain is called"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.InitDeviceDataLookup
RuleNames=120.ExecuteDeviceDataLookup
RuleNames=130.CheckDBErrorFlag


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/110.InitDeviceDataLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevPrevImsiString DEG_IMSI
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/120.ExecuteDeviceDataLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
MapAttributes=DEG_ENTITLEMENT_NAME,DEG_ENTITLEMENT_NAME
MapAttributes=DEG_APNS_TOKEN,DEG_APNS_TOKEN
MapAttributes=DEG_PUSH_NOTIFICATION_STATUS,DEG_PUSH_NOTIFICATION_STATUS
NativeCondition=4.MatchByIMSIAndEntitelementName
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExistFlag
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.PrintError


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0231"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_DEVICE_DATA table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/110.PrintError]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevUniqueIDString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while looking up in DEG_DEVICE_DATA table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.CheckRowExistFlag


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
FalseRuleChain=200.RowNotFound
TrueRuleChain=110.RowFound
TrueRuleChain=120.DeleteRowMatchingCurrentImsi


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/110.RowFound]

AdornOps=set DEG_OEMPrevUniqueId DEG_UNIQUE_ID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitDeviceDataUpdate
RuleNames=200.DeleteDeviceDataTable
RuleNames=300.CheckDeleteStatus


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/100.InitDeviceDataUpdate]

AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/200.DeleteDeviceDataTable]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
NativeCondition=4.MatchByIMSIAndEntitelementName
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/300.CheckDeleteStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SystemError_SetResponse
TrueRuleChain=110.SystemError_Log


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/300.CheckDeleteStatus/100.SystemError_SetResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0232"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform delete a row in DEG_DEVICE_DATA table"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/300.CheckDeleteStatus/110.SystemError_Log]

Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Unable to perform delete operation on DEG_DEVICE_DATA table: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/300.CheckDeleteStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/300.CheckDeleteStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0233"
AdornOps=set DEG_OEMDevErrorMessageString "No data in DEG_DEVICE_DATA table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/300.CheckDeleteStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Database Error: No data in DEG_DEVICE_DATA session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/200.RowNotFound]

AdornOps=set DEG_OEMPrevUniqueId ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by AAA,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sent EAP-AKA message to Device,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by DEG_TOKEN,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by default,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=setifnull DEG_CDevOutReturnCodeString "500"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Authentication attempt rejected by AAA,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=setifnull DEG_AuditTransactionTypeStringtemp ""
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "511"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "BlackListed Subscriber,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "511"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Status Disallowed Action,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " error response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core]


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains]

RuleChainNames=250.DEG30ProcessEAPAKAPayloadRuleChain
RuleChainNames=250A.DEG30ProcessActionRuleChain
RuleChainNames=250B.DEG30UpdateSslSessionStateRuleChain
RuleChainNames=250C.DEG30GenerateOEMResponseRuleChain
RuleChainNames=250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain
RuleChainNames=751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain
RuleChainNames=752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain
RuleChainNames=753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain
RuleChainNames=754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
RuleChainNames=755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain
RuleChainNames=756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain
RuleChainNames=757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckEAPPayload
RuleNames=200.GenerateEapAkaPayloadEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPPayloadString,=,dummy
FalseRuleChain=110.DecodePayload
FalseRuleChain=120.CheckPlayloadIfBase64
FalseRuleChain=170.SetResponseHandler
TrueRuleChain=150.GenerateStartAudit
TrueRuleChain=200.Set403Error
TrueRuleChain=170.SetResponseHandler
TrueRuleChain=220.LogError


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/110.DecodePayload]

AdornOps=decBase64 DEG_OEMDevEapPayloadString DEG_OEMDevEAPPayloadBinary
AdornOps=set DEG_SSL_REQUEST_STATE "200"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/120.CheckPlayloadIfBase64]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.ProcessAction
TrueRuleChain=000.GenerateStartAudit
TrueRuleChain=100.SetHTTPError
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/120.CheckPlayloadIfBase64/000.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/120.CheckPlayloadIfBase64/100.SetHTTPError]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0402"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid EAPPayload"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/120.CheckPlayloadIfBase64/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevEapPayloadString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Request processed with error - Invalid Payload - Unable to Perform Base64 decoding: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/120.CheckPlayloadIfBase64/200.ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=250A.DEG30ProcessActionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/120.CheckPlayloadIfBase64/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=(DEG_OEMDevEapPayloadString =="") || (DEG_OEMDevEAPPayloadBinary == null)


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/150.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/170.SetResponseHandler]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,starts,200
FalseRuleChain=200.SetEmptyResponse
TrueRuleChain=100.SetTextResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/170.SetResponseHandler/100.SetTextResponse]

AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"
AdornOps=set DEG_OEMDevConnectionString "close"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/170.SetResponseHandler/200.SetEmptyResponse]

AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/200.Set403Error]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0401"
AdornOps=set DEG_OEMDevErrorMessageString "Empty EAPPayload"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/220.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Request processed with error - Invalid Action - EAPPayload expected: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/200.GenerateEapAkaPayloadEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,1
Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
Operations=and
TrueRuleChain=100.AuthenticationAkaRejected


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/200.GenerateEapAkaPayloadEndAuditData/100.AuthenticationAkaRejected]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.UpdateSslSessionState
RuleNames=200.AAAProcessingRule
RuleNames=205.SetAuditTransactionType
RuleNames=210.CheckPayload
RuleNames=220.LogEAPAKAWait
RuleNames=230.InitSslSessionAfterEAPAKA
RuleNames=300.UpdateSslSessionAfterEAPAKA
RuleNames=310.CheckSslSessionUpdateStatus
RuleNames=400.GenerateOEMResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/110.UpdateSslSessionState]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=250B.DEG30UpdateSslSessionStateRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/200.AAAProcessingRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_OEMDevSubscriberIdString
RequestAttributes=DEG_OEMDevEAPPayloadBinary
RequestAttributes=DEG_OEMDevSslSessionIdString
RequestAttributes=DEG_SSL_AAA_STATE
RequestAttributes=DEG_SSL_AAA_SESSIONID
RequestAttributes=DEG_SSL_NAI
ResponseAttributes=DEG_SSL_STATE
ResponseAttributes=DEG_SSL_AAA_STATE
ResponseAttributes=DEG_AUTHENTICATION_TYPE
ResponseAttributes=DEG_AUTHENTICATION_SUBTYPE
ResponseAttributes=DEG_OEMDevEAPPayloadBinary
RuleChain=301.DEG30AAAProcessingRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/205.SetAuditTransactionType]

AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/210.CheckPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodeEAPPayload


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/210.CheckPayload/200.EncodeEAPPayload]

AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0403"
AdornOps=set DEG_OEMDevMessageString "Perform EAPAKAAtuh for AkaWait"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/210.CheckPayload/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/220.LogEAPAKAWait]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_SSL_STATE
Attributes=DEG_OEMDevEapPayloadString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Perform EAPAKAAtuh for AkaWait: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/230.InitSslSessionAfterEAPAKA]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=setifnull DEGDROID_SSL_COOKIE_ID ""
AdornOps=setifnull DEGDROID_SSL_OTP 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/300.UpdateSslSessionAfterEAPAKA]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEGDROID_SSL_COOKIE_ID,DEGDROID_SSL_COOKIE_ID
MapAttributes=DEGDROID_SSL_OTP,DEGDROID_SSL_OTP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorMessage
TrueRuleChain=110.LogError


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/100.SetErrorMessage]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0404"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_SSL_SESSION table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/110.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/120.GenerateEapAkaPayloadSystemErrorEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.GenerateAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/120.GenerateEapAkaPayloadSystemErrorEndAuditData/100.GenerateAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorMessage
TrueRuleChain=110.LogError


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.SetErrorMessage]

AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION table"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0405"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/200.CheckKeyExists/110.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/400.GenerateOEMResponse]

CheckTypeOfResponse=100.CheckTypeOfResponse
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
GenerateEAPAkaPayloadEndAuditData=200.GenerateEAPAkaPayloadEndAuditData
Operations=DoAll
TrueRuleChain=GenerateEAPAkaPayloadEndAuditData
TrueRuleChain=CheckTypeOfResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/400.GenerateOEMResponse/100.CheckTypeOfResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=250C.DEG30GenerateOEMResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/400.GenerateOEMResponse/200.GenerateEAPAkaPayloadEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=210.GetActiveMonitoringSessionsByIMSI
RuleNames=220.GetActiveMonitoringSessionsByMDN
RuleNames=230.GetActiveMonitoringSessionsByUNIQUEID
RuleNames=300.GenerateEAPAKAPayloadStartAuditData
RuleNames=350.InitSslSessionUpdate
RuleNames=400.ExecuteSslSessionUpdate
RuleNames=410.CheckSslSessionUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/100.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_STATE WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA
AdornOps=copy DEG_SSL_NAI DEG_OEMDevSubscriberIdString
AdornOps=copy DEG_SSL_IMSI DEG_OEMDevImsiString
AdornOps=copy DEG_SSL_IMSI DEG_IMSI
AdornOps=copy DEG_SSL_MDN DEG_CDevMobileNumberString
AdornOps=copy DEG_SSL_MDN DEG_MDN
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/210.GetActiveMonitoringSessionsByIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitVariables
TrueRuleChain=110.CheckIfMonitoredSession


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/210.GetActiveMonitoringSessionsByIMSI/100.InitVariables]

AdornOps=copy DEG_IMSI DEG_MSESSIONKEY
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/210.GetActiveMonitoringSessionsByIMSI/110.CheckIfMonitoredSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessionsV2


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/220.GetActiveMonitoringSessionsByMDN]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitVariables
TrueRuleChain=110.CheckIfMonitoredSession


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/220.GetActiveMonitoringSessionsByMDN/100.InitVariables]

AdornOps=copy DEG_MDN DEG_MSESSIONKEY
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/220.GetActiveMonitoringSessionsByMDN/110.CheckIfMonitoredSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessionsV2


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/230.GetActiveMonitoringSessionsByUNIQUEID]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitVariables
TrueRuleChain=110.CheckIfMonitoredSession


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/230.GetActiveMonitoringSessionsByUNIQUEID/100.InitVariables]

AdornOps=copy DEG_SSL_UNIQUE_ID DEG_MSESSIONKEY
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/230.GetActiveMonitoringSessionsByUNIQUEID/110.CheckIfMonitoredSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessionsV2


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/300.GenerateEAPAKAPayloadStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/350.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/400.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0412"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_SSL_SESSION table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0413"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to find the row in DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckResponseType


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType]

AkaRejected=300.AkaRejected_InitResponse
AkaRejected=310.AkaRejected_DeactiveToken
AkaRejected=320.AkaRejected_GenerateEapAkaPayloadRejectedEndAuditData
AkaWait=200.AkaWait_InitResponse
AkaWait=201.AkaWait_GetResponseTemplate
AkaWait=202.AkaWait_GenerateEapAkaPayloadWaitEndAuditData
Authenticated=400.Authenticated_InitResponse
Authenticated=401.Authenticated_GetResponseTemplate
Authenticated=402.Authenticated_CheckProcessedInteger
BlackListedSubscriber=120.BlackListedSubscriber_InitResponse
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Conditions=DEG_SSL_STATE,starts,"AUTHENTICATED"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE
Operations=None
StatusDisallowed=600.DisallowedAction_InitResponse
TrueRuleChain=UnknownSubscriber
TrueRuleChain=BlackListedSubscriber
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=StatusDisallowed
TrueRuleChain=Authenticated
TrueRuleChain=Unknown
Unknown=500.Unknown_SetHttpErrorResponseTo500C
UnknownSubscriber=100.UnknownSubscriber_InitResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/100.UnknownSubscriber_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRespStatusString 403
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0406"
AdornOps=set DEG_OEMDevErrorMessageString "UnknownSubscriber"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/120.BlackListedSubscriber_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevRespStatusString 511
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0407"
AdornOps=set DEG_OEMDevErrorMessageString "Network Authentication Required"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/200.AkaWait_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "200"
AdornOps=set DEG_OEMDevRespStatusString 200
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodePayload
FalseRuleChain=203.InitVariableAuthXMLTemplate
FalseRuleChain=205.LookUpAuthXMLTemplate
FalseRuleChain=215.AssignMessagetoResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate/200.EncodePayload]

AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate/203.InitVariableAuthXMLTemplate]

AdornOps=set DEGDROID_auth_step_Integer 1
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate/205.LookUpAuthXMLTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate/215.AssignMessagetoResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.AssignResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate/215.AssignMessagetoResponse/100.AssignResponse]

AdornOps=setifnull DEG_XML_TEMPLATES_FILE ""
AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/202.AkaWait_GenerateEapAkaPayloadWaitEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,!=,"500C"
TrueRuleChain=100.GenerateEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/202.AkaWait_GenerateEapAkaPayloadWaitEndAuditData/100.GenerateEndAuditDataRuleChain]

ClassName=LocalRuleChainInvoker
RuleChain=753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/300.AkaRejected_InitResponse]

AdornOps=set DEG_TOKENSTATUS "DE"
AdornOps=set DEG_SSL_REQUEST_STATE "503C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0408"
AdornOps=set DEG_OEMDevErrorMessageString "AAA returns error.Check at device side and retry"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/310.AkaRejected_DeactiveToken]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/320.AkaRejected_GenerateEapAkaPayloadRejectedEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,!=,"500C"
TrueRuleChain=100.GenerateEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/320.AkaRejected_GenerateEapAkaPayloadRejectedEndAuditData/100.GenerateEndAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/400.Authenticated_InitResponse]

AdornOps=set DEG_APP_TOKEN_FLAG 1
AdornOps=set DEGDROID_auth_step_Integer 2
AdornOps=setifnull DEGDROID_SSL_COOKIE_ID ""
AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEG_OEMDevRespTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEG_CDevTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEGDROID_SSL_COOKIE_ID
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP
AdornOps=set DEG_TOKEN_VALIDITY_SECONDS ${DEGDROID_DEVICE_TOKEN_VALIDITY}
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/401.Authenticated_GetResponseTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger]

Authenticated_DeviceData=440.Authenticated_DeviceData
Authenticated_DeviceDataLookUp=430.Authenticated_DeviceDataLookUp
Authenticated_GenerateEapAkaPayloadAuthenticatedEndAuditData=460.Authenticated_GenerateEapAkaPayloadAuthenticatedEndAuditData
Authenticated_GenerateResponse=480.Authenticated_GenerateResponse
Authenticated_ResponseCustomization=450.Authenticated_ResponseCustomization
Authenticated_ServiceConfiguration=470.Authenticated_ServiceConfiguration
Authenticated_StoreToken=420.Authenticated_StoreToken
Authenticated_TokenLookupForDFTCase=410.Authenticated_TokenLookupForDFTCase
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Operations=DoAll
TrueRuleChain=Authenticated_TokenLookupForDFTCase
TrueRuleChain=Authenticated_StoreToken
TrueRuleChain=Authenticated_DeviceDataLookUp
TrueRuleChain=Authenticated_DeviceData
TrueRuleChain=Authenticated_ResponseCustomization
TrueRuleChain=Authenticated_GenerateEapAkaPayloadAuthenticatedEndAuditData
TrueRuleChain=Authenticated_ServiceConfiguration
TrueRuleChain=Authenticated_GenerateResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
Conditions=DEG_AUTHENTICATION_TYPE,=,"EAP"
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"DFT"
Operations=and,and
TrueRuleChain=100.InitValues
TrueRuleChain=110.Lookup
TrueRuleChain=120.CheckLookupStatus


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/100.InitValues]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=copy DEG_MDN DEG_CDevMobileNumberString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/110.Lookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckTokenExist
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0409"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEGDROID_TOKENS table"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEGDROID_TOKENS table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/120.GeneratePostChallengeSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/200.CheckTokenExist]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
FalseRuleChain=200.SetAuthTimesTamp


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/200.CheckTokenExist/200.SetAuthTimesTamp]

AdornOps=setsystime DEG_FULLAUTHTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/420.Authenticated_StoreToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevMobileNumberString
RequestAttributes=DEG_IMSI
RequestAttributes=DEG_CDevTokenString
RequestAttributes=DEG_AUTHENTICATION_TYPE
RequestAttributes=DEG_AUTHENTICATION_SUBTYPE
RequestAttributes=DEG_APP_TOKEN_FLAG
RequestAttributes=DEG_FULLAUTHTIMESTAMP
ResponseAttributes=DEG_OEMDevErrorMessageString
ResponseAttributes=DEG_EVENTTIMESTAMP
RuleChain=005.DEG30StoreTokenRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/430.Authenticated_DeviceDataLookUp]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200M.DEG30DeviceDataLookupRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/440.Authenticated_DeviceData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200N.DEG30DeviceDataProcessRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/450.Authenticated_ResponseCustomization]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=180.ProcessResponseAttributeCustomization
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/460.Authenticated_GenerateEapAkaPayloadAuthenticatedEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,!=,"500C"
TrueRuleChain=100.GenerateEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/460.Authenticated_GenerateEapAkaPayloadAuthenticatedEndAuditData/100.GenerateEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
GenerateEapAkaPayloadAAAAuthenticatedEndAuditData=100.GenerateEapAkaPayloadAAAAuthenticatedEndAuditData
GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditData=100.GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditData
Operations=None
TrueRuleChain=GenerateEapAkaPayloadAAAAuthenticatedEndAuditData
TrueRuleChain=GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/460.Authenticated_GenerateEapAkaPayloadAuthenticatedEndAuditData/100.GenerateEndAuditDataRuleChain/100.GenerateEapAkaPayloadAAAAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/460.Authenticated_GenerateEapAkaPayloadAuthenticatedEndAuditData/100.GenerateEndAuditDataRuleChain/100.GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/470.Authenticated_ServiceConfiguration]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.DEG30ProcessServiceConfigurationRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/480.Authenticated_GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_XMLTemplateResponseString,!=,""
FalseRuleChain=20.AssignResponseFromAuthConfigTemplate
TrueRuleChain=10.AssignResponseFromServiceConfigTemplate


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/480.Authenticated_GenerateResponse/10.AssignResponseFromServiceConfigTemplate]

AdornOps=copy DEG_XMLTemplateResponseString ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/480.Authenticated_GenerateResponse/20.AssignResponseFromAuthConfigTemplate]

AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/500.Unknown_SetHttpErrorResponseTo500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0410"
AdornOps=set DEG_OEMDevErrorMessageString "Unknown DEG_SSL_STATE"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/600.DisallowedAction_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevHttpStatusInteger "511"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0411"
AdornOps=set DEG_OEMDevErrorMessageString "Network Authentication Required"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateEAPAKAPayloadEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=None
StatusDisallowed=500.GenerateEapAkaPayloadDisallowedActionEndAuditData
TrueRuleChain=StatusDisallowed


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/100.GenerateEapAkaPayloadRejectedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/200.GenerateEapAkaPayloadWaitEndAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/300.GenerateEapAkaPayloadAAAAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/400.GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/500.GenerateEapAkaPayloadDisallowedActionEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=copy DEG_CDevProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Received "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by AAA,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sent EAP-AKA message to Device,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by default,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "503"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Authentication attempt rejected by AAA"
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "511"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Status Disallowed Action,Return code is"
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core]


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors]

ClassName=ConnectorManager
ConnectorNames=ESMEConnector
ConnectorNames=scheduler


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors/ESMEConnector]

ClassName=com.hp.usage.smpp.ESMEConnector
Connections=conn1
IncomingQueueSize=100
JNDIName=ESMEConnector
Managed=true


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors/ESMEConnector/conn1]

AddressRange=
BindAtStartup=true
ClassName=com.hp.usage.smpp.ESMEConnection
EnquireLinkInterval=5
HostName=${ESME_HOST_IP}
Managed=true
MaxRetryAttempts=3
Password=password
PortNumber=${ESME_PORT}
RebindIntervalInSeconds=10
RetryDelayInSeconds=2
RetryIfStatus=0x58
RetryIfStatus=0x504
RetryIfStatus=0x14
SystemId=smppclient1
SystemType=cp
ThrottlingThreshold=1


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors/ESMEConnector/conn2]

AddressRange=
BindAtStartup=true
ClassName=com.hp.usage.smpp.ESMEConnection
EnquireLinkInterval=5
HostName=${ESME_HOST_IP}
Managed=true
MaxRetryAttempts=3
Password=password
PortNumber=${ESME_PORT}
RebindIntervalInSeconds=10
RetryDelayInSeconds=2
RetryIfStatus=0x58
RetryIfStatus=0x504
RetryIfStatus=0x14
SystemId=smppclient1
SystemType=cp
ThrottlingThreshold=1


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors/ESMEConnector/Decoder]

ClassName=com.hp.usage.smpp.codec.DeliverSmDecoder
DataCodingAttribute=SMPP_data_coding
DataEncodingMappings=3,ISO-8859-1
DataEncodingMappings=1,US-ASCII
DestAddressAttribute=SMPP_destination_addr
DestAddrNpiAttribute=SMPP_dest_addr_npi
DestAddrTonAttribute=SMPP_dest_addr_ton
EsmClassAttribute=SMPP_esm_class
OptionalParameters=SMPP__dest_addr_subunit,5,0,BYTE
OptionalParameters=SMPP__dest_network_type,6,0,BYTE
OptionalParameters=SMPP__dest_bearer_type,7,0,BYTE
OptionalParameters=SMPP__dest_telematics_id,8,0,SHORT
OptionalParameters=SMPP__source_addr_subunit,13,0,BYTE
OptionalParameters=SMPP__source_network_type,14,0,BYTE
OptionalParameters=SMPP__source_bearer_type,15,0,BYTE
OptionalParameters=SMPP__source_telematics_id,16,0,BYTE
OptionalParameters=SMPP__qos_time_to_live,23,0,IntegerCodec
OptionalParameters=SMPP__payload_type,25,0,BYTE
OptionalParameters=SMPP__additional_status_info_text,29,,CSTRING
OptionalParameters=SMPP__receipted_message_id,30,,CSTRING
OptionalParameters=SMPP__ms_msg_wait_facilities,48,0,BYTE
OptionalParameters=SMPP__privacy_indicator,513,0,BYTE
OptionalParameters=SMPP__source_subaddress,514,,STRING
OptionalParameters=SMPP__dest_subaddress,515,,STRING
OptionalParameters=SMPP__user_message_reference,516,0,SHORT
OptionalParameters=SMPP__user_response_code,517,0,BYTE
OptionalParameters=SMPP__source_port,522,0,SHORT
OptionalParameters=SMPP__destination_port,523,0,SHORT
OptionalParameters=SMPP__sar_msg_ref_num,524,0,SHORT
OptionalParameters=SMPP__language_indicator,525,0,BYTE
OptionalParameters=SMPP__sar_total_segments,526,0,BYTE
OptionalParameters=SMPP__sar_segment_seqnum,527,0,BYTE
OptionalParameters=SMPP__sc_interface_version,528,0,BYTE
OptionalParameters=SMPP__callback_num_pres_ind,770,0,BYTE
OptionalParameters=SMPP__callback_num_atag,771,,STRING
OptionalParameters=SMPP__number_of_messages,772,0,BYTE
OptionalParameters=SMPP__callback_num,897,,STRING
OptionalParameters=SMPP__dpf_result,1056,0,BYTE
OptionalParameters=SMPP__set_dpf,1057,0,BYTE
OptionalParameters=SMPP__ms_availability_status,1058,0,BYTE
OptionalParameters=SMPP__network_error_code,1059,,STRING
OptionalParameters=SMPP__message_payload,1060,,STRING
OptionalParameters=SMPP__delivery_failure_reason,1061,0,BYTE
OptionalParameters=SMPP__more_messages_to_send,1062,0,BYTE
OptionalParameters=SMPP__message_state,1063,0,BYTE
OptionalParameters=SMPP__ussd_service_op,1281,,STRING
OptionalParameters=SMPP__display_time,4609,0,BYTE
OptionalParameters=SMPP__sms_signal,4611,0,SHORT
OptionalParameters=SMPP__ms_validity,4612,0,BYTE
OptionalParameters=SMPP__alert_on_message_delivery,4876,,STRING
OptionalParameters=SMPP__its_reply_type,4992,0,BYTE
OptionalParameters=SMPP__its_session_info,4995,,STRING
PriorityFlagAttribute=SMPP_priority_flag
ProtocolIdAttribute=SMPP_protocol_id
RegisteredDeliveryAttribute=SMPP_registered_delivery
ReplaceIfPresentAttribute=SMPP_replace_if_present_flag
ScheduleDeliveryTimeAttribute=SMPP_schedule_delivery_time
ServiceTypeAttribute=SMPP_service_type
ShortMessageAttribute=SMPP_short_message
SmDefaultMsgIdAttribute=SMPP_sm_default_msg_id
SourceAddressAttribute=SMPP_source_addr
SourceAddrNpiAttribute=SMPP_source_addr_npi
SourceAddrTonAttribute=SMPP_source_addr_ton
ValidityPeriodAttribute=SMPP_validity_period


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors/ESMEConnector/Decoder/BYTE]

ClassName=IntegerCodec
Size=1


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors/ESMEConnector/Decoder/CSTRING]

ClassName=com.hp.usage.smpp.attrcodec.CStringCodec


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors/ESMEConnector/Decoder/SHORT]

ClassName=IntegerCodec
Size=2


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors/ESMEConnector/Decoder/STRING]

ClassName=com.hp.usage.smpp.attrcodec.StringCodec


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors/ESMEConnector/RequestExecutorPool]

ClassName=com.hp.usage.smpp.RequestExecutorPool
ThreadPoolSize=5


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors/ESMEConnector/RequestExecutorPool/Executor]

ClassName=com.hp.usage.smpp.SMPPRequestExecutor
DeliverSmRuleChains=conn1,smppIncomingProcessorRuleChain1
DeliverSmRuleChains=conn2,smppIncomingProcessorRuleChain1


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors/scheduler]

ClassName=com.hp.siu.scheduler.Scheduler
ScheduledJobs=job1


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors/scheduler/job1]

MaxExecutions=1
PollIntervalClassName=com.hp.siu.utils.SecondsInterval
QueryInterval=60
Tasks=task1


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors/scheduler/job1/task1]

ClassName=InvokeRuleChainTask
InputNMEAttributes=str,test
RuleChain=smppOutgoingRuleChain1


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors/scheduler/job2]

PollIntervalClassName=com.hp.siu.utils.SecondsInterval
QueryInterval=60
Tasks=task1


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Connectors/scheduler/job2/task1]

ClassName=InvokeRuleChainTask
InputNMEAttributes=str,test
RuleChain=smppOutgoingRuleChain2


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/License]


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/ManagementService]

ClassName=com.hp.usage.management.ManagementService
ConfigureHttpAdapter=true
HttpPort=8089
RmiPort=1299


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/Properties]

JVMOPTS=%DEFAULTS%
JVMOPTS=-Xms512m
JVMOPTS=-Xmx512m
PROCESSARGS=-l 4
STARTUPMODE=Manual


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains]

ClassName=RuleChainManager
RuleChainNames=smppOutgoingRuleChain1
RuleChainNames=smppIncomingProcessorRuleChain1
RuleChainNames=smppOutgoingRuleChain2
RuleChainNames=smppIncomingProcessorRuleChain2


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppIncomingProcessorRuleChain1]

ClassName=RuleChain
RuleNames=100.log


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppIncomingProcessorRuleChain1/100.log]

ClassName=LogNMERule


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppIncomingProcessorRuleChain2]

ClassName=RuleChain
RuleNames=100.log


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppIncomingProcessorRuleChain2/100.log]

ClassName=LogNMERule


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain1]

ClassName=RuleChain
RuleNames=100.SetSMPPAttributes
RuleNames=200.checkSMPPParameter
RuleNames=300.logSentSMPPParameters


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain1/100.SetSMPPAttributes]

AdornOps=setifnull DEGDROID_OTP 0
AdornOps=rand DEGDROID_OTP 111111 999999 
AdornOps=copy DEGDROID_OTP SMPP_short_message
AdornOps=set SMPP_service_type stype
AdornOps=set SMPP_source_addr_ton 2
AdornOps=set SMPP_source_addr_npi 4
AdornOps=set SMPP_dest_addr_ton 6
AdornOps=set SMPP_dest_addr_npi 16
AdornOps=set SMPP_source_addr source_addr
AdornOps=set SMPP_destination_addr destination_addr
AdornOps=set SMPP_esm_class 3
AdornOps=set SMPP_protocol_id 2008
AdornOps=set SMPP_priority_flag 2
AdornOps=set SMPP_schedule_delivery_time 020610233429000R
AdornOps=set SMPP_validity_period 011110233429000R
AdornOps=set SMPP_registered_delivery 14
AdornOps=set SMPP_replace_if_present_flag 1
AdornOps=set SMPP_data_coding 3
AdornOps=set SMPP_sm_default_msg_id 254
AdornOps=set SMPP__qos_time_to_live 31415
AdornOps=set SMPP__additional_status_info_text additional_status_info_text_data
AdornOps=set SMPP__dest_telematics_id 1234
AdornOps=set SMPP__alert_on_message_delivery ""
AdornOps=set SMPP__dest_addr_subunit 127
AdornOps=setifnull DEG_OEMDevImsiString 0
AdornOps=copy DEG_OEMDevImsiString SMPP__message_payload 
AdornOps=+ SMPP__message_payload SMPP_short_message SMPP__message_payload
AdornOps=set CheckSMPP 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain1/200.checkSMPPParameter]

ClassName=ConditionalRule
Conditions=CheckSMPP,=,0
FalseRuleChain=100.SendSMPPParameters
TrueRuleChain=200.log


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain1/200.checkSMPPParameter/100.SendSMPPParameters]

ClassName=com.hp.usage.smpp.SMPPSendRule
CommandStatusAttribute=SMPP_command_status
Connection=conn1
MessageIdAttribute=SMPP_message_id
ResponseTimeout=10
SendResultAttribute=SMPP_ESME_send_result
SmppAdapterJNDIName=ESMEConnector
SmppCommand=SUBMIT_SM


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain1/200.checkSMPPParameter/100.SendSMPPParameters/Encoder]

ClassName=com.hp.usage.smpp.codec.SubmitSmEncoder
DataCodingAttribute=SMPP_data_coding
DataEncodingMappings=3,ISO-8859-1
DataEncodingMappings=1,US-ASCII
DestAddressAttribute=SMPP_destination_addr
DestAddrNpiAttribute=SMPP_dest_addr_npi
DestAddrTonAttribute=SMPP_dest_addr_ton
EsmClassAttribute=SMPP_esm_class
OptionalParameters=SMPP__dest_addr_subunit,5,BYTE
OptionalParameters=SMPP__dest_network_type,6,BYTE
OptionalParameters=SMPP__dest_bearer_type,7,BYTE
OptionalParameters=SMPP__dest_telematics_id,8,SHORT
OptionalParameters=SMPP__source_addr_subunit,13,BYTE
OptionalParameters=SMPP__source_network_type,14,BYTE
OptionalParameters=SMPP__source_bearer_type,15,BYTE
OptionalParameters=SMPP__source_telematics_id,16,BYTE
OptionalParameters=SMPP__qos_time_to_live,23,IntegerCodec
OptionalParameters=SMPP__payload_type,25,BYTE
OptionalParameters=SMPP__additional_status_info_text,29,CSTRING
OptionalParameters=SMPP__receipted_message_id,30,CSTRING
OptionalParameters=SMPP__ms_msg_wait_facilities,48,BYTE
OptionalParameters=SMPP__privacy_indicator,513,BYTE
OptionalParameters=SMPP__source_subaddress,514,StringCodec
OptionalParameters=SMPP__dest_subaddress,515,StringCodec
OptionalParameters=SMPP__user_message_reference,516,SHORT
OptionalParameters=SMPP__user_response_code,517,BYTE
OptionalParameters=SMPP__source_port,522,SHORT
OptionalParameters=SMPP__destination_port,523,SHORT
OptionalParameters=SMPP__sar_msg_ref_num,524,SHORT
OptionalParameters=SMPP__language_indicator,525,BYTE
OptionalParameters=SMPP__sar_total_segments,526,BYTE
OptionalParameters=SMPP__sar_segment_seqnum,527,BYTE
OptionalParameters=SMPP__sc_interface_version,528,BYTE
OptionalParameters=SMPP__callback_num_pres_ind,770,BYTE
OptionalParameters=SMPP__callback_num_atag,771,StringCodec
OptionalParameters=SMPP__number_of_messages,772,BYTE
OptionalParameters=SMPP__callback_num,897,StringCodec
OptionalParameters=SMPP__dpf_result,1056,BYTE
OptionalParameters=SMPP__set_dpf,1057,BYTE
OptionalParameters=SMPP__ms_availability_status,1058,BYTE
OptionalParameters=SMPP__network_error_code,1059,StringCodec
OptionalParameters=SMPP__message_payload,1060,StringCodec
OptionalParameters=SMPP__delivery_failure_reason,1061,BYTE
OptionalParameters=SMPP__more_messages_to_send,1062,BYTE
OptionalParameters=SMPP__message_state,1063,BYTE
OptionalParameters=SMPP__ussd_service_op,1281,StringCodec
OptionalParameters=SMPP__display_time,4609,BYTE
OptionalParameters=SMPP__sms_signal,4611,SHORT
OptionalParameters=SMPP__ms_validity,4612,BYTE
OptionalParameters=SMPP__alert_on_message_delivery,4876,StringCodec
OptionalParameters=SMPP__its_reply_type,4992,BYTE
OptionalParameters=SMPP__its_session_info,4995,StringCodec
PriorityFlagAttribute=SMPP_priority_flag
ProtocolIdAttribute=SMPP_protocol_id
RegisteredDeliveryAttribute=SMPP_registered_delivery
ReplaceIfPresentAttribute=SMPP_replace_if_present_flag
ScheduleDeliveryTimeAttribute=SMPP_schedule_delivery_time
ServiceTypeAttribute=SMPP_service_type
ShortMessageAttribute=SMPP_short_message
SmDefaultMsgIdAttribute=SMPP_sm_default_msg_id
SourceAddressAttribute=SMPP_source_addr
SourceAddrNpiAttribute=SMPP_source_addr_npi
SourceAddrTonAttribute=SMPP_source_addr_ton
UserDefinedHeader=060504157A0000
ValidityPeriodAttribute=SMPP_validity_period


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain1/200.checkSMPPParameter/100.SendSMPPParameters/Encoder/BYTE]

ClassName=IntegerCodec
Size=1


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain1/200.checkSMPPParameter/100.SendSMPPParameters/Encoder/CSTRING]

ClassName=com.hp.usage.smpp.attrcodec.CStringCodec


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain1/200.checkSMPPParameter/100.SendSMPPParameters/Encoder/SHORT]

ClassName=IntegerCodec
Size=2


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain1/200.checkSMPPParameter/200.log]

Attributes=CheckSMPP
ClassName=LogNMERule


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain1/300.logSentSMPPParameters]

ClassName=LogNMERule


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain2]

ClassName=RuleChain
RuleNames=100.SetSMPPAttributes
RuleNames=200.checkSMPPParameter
RuleNames=300.logSentSMPPParameters


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain2/100.SetSMPPAttributes]

AdornOps=setifnull DEGDROID_OTP 0
AdornOps=rand DEGDROID_OTP 111111 999999 
AdornOps=copy DEGDROID_OTP SMPP_short_message
AdornOps=set SMPP_service_type stype
AdornOps=set SMPP_source_addr_ton 2
AdornOps=set SMPP_source_addr_npi 4
AdornOps=set SMPP_dest_addr_ton 6
AdornOps=set SMPP_dest_addr_npi 16
AdornOps=set SMPP_source_addr source_addr
AdornOps=set SMPP_destination_addr destination_addr
AdornOps=set SMPP_esm_class 3
AdornOps=set SMPP_protocol_id 2008
AdornOps=set SMPP_priority_flag 2
AdornOps=set SMPP_schedule_delivery_time 020610233429000R
AdornOps=set SMPP_validity_period 011110233429000R
AdornOps=set SMPP_registered_delivery 14
AdornOps=set SMPP_replace_if_present_flag 1
AdornOps=set SMPP_data_coding 3
AdornOps=set SMPP_sm_default_msg_id 254
AdornOps=set SMPP__qos_time_to_live 31415
AdornOps=set SMPP__additional_status_info_text additional_status_info_text_data
AdornOps=set SMPP__dest_telematics_id 1234
AdornOps=set SMPP__alert_on_message_delivery ""
AdornOps=set SMPP__dest_addr_subunit 127
AdornOps=setifnull DEG_OEMDevImsiString 0
AdornOps=copy DEG_OEMDevImsiString SMPP__message_payload 
AdornOps=+ SMPP__message_payload SMPP_short_message SMPP__message_payload
AdornOps=set CheckSMPP 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain2/200.checkSMPPParameter]

ClassName=ConditionalRule
Conditions=CheckSMPP,=,0
FalseRuleChain=100.SendSMPPParameters
TrueRuleChain=200.log


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain2/200.checkSMPPParameter/100.SendSMPPParameters]

ClassName=com.hp.usage.smpp.SMPPSendRule
CommandStatusAttribute=SMPP_command_status
Connection=conn1
MessageIdAttribute=SMPP_message_id
ResponseTimeout=10
SendResultAttribute=SMPP_ESME_send_result
SmppAdapterJNDIName=ESMEConnector
SmppCommand=SUBMIT_SM


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain2/200.checkSMPPParameter/100.SendSMPPParameters/Encoder]

ClassName=com.hp.usage.smpp.codec.SubmitSmEncoder
DataCodingAttribute=SMPP_data_coding
DataEncodingMappings=3,ISO-8859-1
DataEncodingMappings=1,US-ASCII
DestAddressAttribute=SMPP_destination_addr
DestAddrNpiAttribute=SMPP_dest_addr_npi
DestAddrTonAttribute=SMPP_dest_addr_ton
EsmClassAttribute=SMPP_esm_class
OptionalParameters=SMPP__dest_addr_subunit,5,BYTE
OptionalParameters=SMPP__dest_network_type,6,BYTE
OptionalParameters=SMPP__dest_bearer_type,7,BYTE
OptionalParameters=SMPP__dest_telematics_id,8,SHORT
OptionalParameters=SMPP__source_addr_subunit,13,BYTE
OptionalParameters=SMPP__source_network_type,14,BYTE
OptionalParameters=SMPP__source_bearer_type,15,BYTE
OptionalParameters=SMPP__source_telematics_id,16,BYTE
OptionalParameters=SMPP__qos_time_to_live,23,IntegerCodec
OptionalParameters=SMPP__payload_type,25,BYTE
OptionalParameters=SMPP__additional_status_info_text,29,CSTRING
OptionalParameters=SMPP__receipted_message_id,30,CSTRING
OptionalParameters=SMPP__ms_msg_wait_facilities,48,BYTE
OptionalParameters=SMPP__privacy_indicator,513,BYTE
OptionalParameters=SMPP__source_subaddress,514,StringCodec
OptionalParameters=SMPP__dest_subaddress,515,StringCodec
OptionalParameters=SMPP__user_message_reference,516,SHORT
OptionalParameters=SMPP__user_response_code,517,BYTE
OptionalParameters=SMPP__source_port,522,SHORT
OptionalParameters=SMPP__destination_port,523,SHORT
OptionalParameters=SMPP__sar_msg_ref_num,524,SHORT
OptionalParameters=SMPP__language_indicator,525,BYTE
OptionalParameters=SMPP__sar_total_segments,526,BYTE
OptionalParameters=SMPP__sar_segment_seqnum,527,BYTE
OptionalParameters=SMPP__sc_interface_version,528,BYTE
OptionalParameters=SMPP__callback_num_pres_ind,770,BYTE
OptionalParameters=SMPP__callback_num_atag,771,StringCodec
OptionalParameters=SMPP__number_of_messages,772,BYTE
OptionalParameters=SMPP__callback_num,897,StringCodec
OptionalParameters=SMPP__dpf_result,1056,BYTE
OptionalParameters=SMPP__set_dpf,1057,BYTE
OptionalParameters=SMPP__ms_availability_status,1058,BYTE
OptionalParameters=SMPP__network_error_code,1059,StringCodec
OptionalParameters=SMPP__message_payload,1060,StringCodec
OptionalParameters=SMPP__delivery_failure_reason,1061,BYTE
OptionalParameters=SMPP__more_messages_to_send,1062,BYTE
OptionalParameters=SMPP__message_state,1063,BYTE
OptionalParameters=SMPP__ussd_service_op,1281,StringCodec
OptionalParameters=SMPP__display_time,4609,BYTE
OptionalParameters=SMPP__sms_signal,4611,SHORT
OptionalParameters=SMPP__ms_validity,4612,BYTE
OptionalParameters=SMPP__alert_on_message_delivery,4876,StringCodec
OptionalParameters=SMPP__its_reply_type,4992,BYTE
OptionalParameters=SMPP__its_session_info,4995,StringCodec
PriorityFlagAttribute=SMPP_priority_flag
ProtocolIdAttribute=SMPP_protocol_id
RegisteredDeliveryAttribute=SMPP_registered_delivery
ReplaceIfPresentAttribute=SMPP_replace_if_present_flag
ScheduleDeliveryTimeAttribute=SMPP_schedule_delivery_time
ServiceTypeAttribute=SMPP_service_type
ShortMessageAttribute=SMPP_short_message
SmDefaultMsgIdAttribute=SMPP_sm_default_msg_id
SourceAddressAttribute=SMPP_source_addr
SourceAddrNpiAttribute=SMPP_source_addr_npi
SourceAddrTonAttribute=SMPP_source_addr_ton
UserDefinedHeader=060504157A0000
ValidityPeriodAttribute=SMPP_validity_period


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain2/200.checkSMPPParameter/100.SendSMPPParameters/Encoder/BYTE]

ClassName=IntegerCodec
Size=1


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain2/200.checkSMPPParameter/100.SendSMPPParameters/Encoder/CSTRING]

ClassName=com.hp.usage.smpp.attrcodec.CStringCodec


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain2/200.checkSMPPParameter/100.SendSMPPParameters/Encoder/SHORT]

ClassName=IntegerCodec
Size=2


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain2/200.checkSMPPParameter/200.log]

Attributes=CheckSMPP
ClassName=LogNMERule


[/templates/DEG/DEGDROID_DeviceInterface/ESME_Interface_Core/RuleChains/smppOutgoingRuleChain2/300.logSentSMPPParameters]

ClassName=LogNMERule


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize]


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains]

RuleChainNames=000.CUST_SessionStoreDefaultErrorRuleChain
RuleChainNames=001.CUST_SessionStoreKeyNotExistsRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/000.CUST_SessionStoreDefaultErrorRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetLookupErrorFlag
RuleNames=200.LogAlarming


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/000.CUST_SessionStoreDefaultErrorRuleChain/100.SetLookupErrorFlag]

AdornOps=set CUST_GSP_OUT_ErrorFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/000.CUST_SessionStoreDefaultErrorRuleChain/200.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/001.CUST_SessionStoreKeyNotExistsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ClearDuplicateKeyFlag


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/001.CUST_SessionStoreKeyNotExistsRuleChain/100.ClearDuplicateKeyFlag]

AdornOps=set CUST_GSP_OUT_SubscriberExistsFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=80.LogIncomingAttribute
RuleNames=100.CheckIfImsiOrMsisdn
RuleNames=200.DbLookupInServiceData


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/100.CheckIfImsiOrMsisdn]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=CUST_GSP_IN_IMSIString,!=,""
Conditions=CUST_GSP_IN_MDNString,!=,""
Operations=None
RetriveSubscriberDataByImsi=100.InitDbLookupByImsi
RetriveSubscriberDataByImsi=100.ExecuteInternalDBLookupByImsi
RetriveSubscriberDataByMsisdn=100.InitDbLookupByMsisdn
RetriveSubscriberDataByMsisdn=100.ExecuteInternalDBLookupByMsisdn
TrueRuleChain=RetriveSubscriberDataByImsi
TrueRuleChain=RetriveSubscriberDataByMsisdn


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/100.CheckIfImsiOrMsisdn/100.ExecuteInternalDBLookupByImsi]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.CUST_SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_MDN,CUST_GSP_OUT_MDN
MapAttributes=DEG_IMSI,CUST_GSP_IN_IMSIString
MapAttributes=DEG_CUSTSTATUS,CUST_GSP_OUT_EntitlementStatus
MapAttributes=DEG_ENTITLEMENT_LIST,CUST_GSP_OUT_EntitlementStatus
NativeCondition=1.MatchingByImsi
NotExistsErrorRuleChain=001.CUST_SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SUBSCRIBERS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/100.CheckIfImsiOrMsisdn/100.ExecuteInternalDBLookupByMsisdn]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.CUST_SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_IMSI,CUST_GSP_IN_IMSIString
MapAttributes=DEG_CUSTSTATUS,DEG_CUSTSTATUS
MapAttributes=DEG_ENTITLEMENT_LIST,CUST_GSP_OUT_EntitlementStatus
NativeCondition=2.MatchingByMsisdn
NotExistsErrorRuleChain=001.CUST_SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SUBSCRIBERS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/100.CheckIfImsiOrMsisdn/100.InitDbLookupByImsi]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SUBSCRIBERS
AdornOps=set CUST_GSP_OUT_ErrorFlagInteger 0
AdornOps=set CUST_GSP_OUT_SubscriberExistsFlagInteger 1
AdornOps=copy CUST_GSP_IN_IMSIString DEG_IMSI
AdornOps=set DEG_CDevMobileNumberString 0
AdornOps=setifnull DEG_CUSTSTATUS ""
AdornOps=setifnull CUST_GSP_OUT_EntitlementStatus ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/100.CheckIfImsiOrMsisdn/100.InitDbLookupByMsisdn]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SUBSCRIBERS
AdornOps=set CUST_GSP_OUT_ErrorFlagInteger 0
AdornOps=set CUST_GSP_OUT_SubscriberExistsFlagInteger 1
AdornOps=copy CUST_GSP_IN_MDNString DEG_MDN
AdornOps=set DEG_CDevMobileNumberString 0
AdornOps=setifnull DEG_CUSTSTATUS ""
AdornOps=setifnull CUST_GSP_OUT_EntitlementStatus ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/200.DbLookupInServiceData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=CUST_GSP_OUT_EntitlementStatus,contains,"Android_VoWiFi"
Conditions=CUST_GSP_IN_IMSIString,!=,null
Operations=and
TrueRuleChain=LookUpServiceDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/200.DbLookupInServiceData/LookUpServiceDataRuleChain]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=CUST_GSP_OUT_ErrorFlagInteger,=,0
Conditions=CUST_GSP_OUT_SubscriberExistsFlagInteger,=,1
Operations=and
TrueRuleChain=10.ExecuteLookupInServiceData


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/200.DbLookupInServiceData/LookUpServiceDataRuleChain/10.ExecuteLookupInServiceData]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVar
RuleNames=110.LookupProvServTable
RuleNames=120.CheckDBStatus


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/200.DbLookupInServiceData/LookUpServiceDataRuleChain/10.ExecuteLookupInServiceData/100.InitVar]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_PROV_SERV_DATA
AdornOps=set CUST_GSP_OUT_ErrorFlagInteger 0
AdornOps=set CUST_GSP_OUT_SubscriberExistsFlagInteger 1
AdornOps=copy CUST_GSP_IN_IMSIString DEG_IMSI
AdornOps=+ CUST_GSP_IN_IMSIString 00 DEG_OEMDevTmpDeviceIDString
AdornOps=copy DEG_OEMDevTmpDeviceIDString DEG_DEVICE_ID
AdornOps=set DEG_OEMDevTmpEntitlementString ${ANDROIDVOWIFI_ENTITLEMENT_NAME}
AdornOps=copy DEG_OEMDevTmpEntitlementString DEG_ENTITLEMENT_NAME
AdornOps=setifnull DEG_PROV_GATEWAY_ADDRESS ""
AdornOps=setifnull DEG_PROV_ADDR_UPDATE_POST_DATA ""
AdornOps=setifnull DEG_PROV_ADDR_UPDATE_URL ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/200.DbLookupInServiceData/LookUpServiceDataRuleChain/10.ExecuteLookupInServiceData/110.LookupProvServTable]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.CUST_SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,CUST_GSP_IN_IMSIString
MapAttributes=DEG_PROV_TC_STATUS,CUST_GSP_OUT_VoWiFi_TC_STATUS
MapAttributes=DEG_PROV_ADDRESS_STATUS,CUST_GSP_OUT_VoWiFi_ADDR_STATUS
MapAttributes=DEG_PROV_PROVISIONING_STATUS,CUST_GSP_OUT_VoWiFi_PROVISIONING_STATUS
MapAttributes=DEG_PROV_GATEWAY_ADDRESS,CUST_GSP_OUT_GatewayAddrString
MapAttributes=DEG_PROV_ADDR_UPDATE_POST_DATA,CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_POSTDATA
MapAttributes=DEG_PROV_ADDR_UPDATE_URL,CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_URL
NotExistsErrorRuleChain=001.CUST_SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_PROV_SERV_DATA_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/200.DbLookupInServiceData/LookUpServiceDataRuleChain/10.ExecuteLookupInServiceData/120.CheckDBStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=CUST_GSP_OUT_ErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExistsWithSessionStoreKeyExistsFlag
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/200.DbLookupInServiceData/LookUpServiceDataRuleChain/10.ExecuteLookupInServiceData/120.CheckDBStatus/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEG_PROV_SERV_DATA table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/200.DbLookupInServiceData/LookUpServiceDataRuleChain/10.ExecuteLookupInServiceData/120.CheckDBStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=CUST_GSP_IN_IMSIString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_PROV_SERV_DATA table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/200.DbLookupInServiceData/LookUpServiceDataRuleChain/10.ExecuteLookupInServiceData/120.CheckDBStatus/200.CheckKeyExistsWithSessionStoreKeyExistsFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=CUST_GSP_OUT_SubscriberExistsFlagInteger,=,0
TrueRuleChain=100.LogRule
TrueRuleChain=100.keyReInitialization


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/200.DbLookupInServiceData/LookUpServiceDataRuleChain/10.ExecuteLookupInServiceData/120.CheckDBStatus/200.CheckKeyExistsWithSessionStoreKeyExistsFlag/100.keyReInitialization]

AdornOps=set CUST_GSP_OUT_SubscriberExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/200.DbLookupInServiceData/LookUpServiceDataRuleChain/10.ExecuteLookupInServiceData/120.CheckDBStatus/200.CheckKeyExistsWithSessionStoreKeyExistsFlag/100.LogRule]

Attributes=CUST_GSP_OUT_SubscriberExistsFlagInteger
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=No row exists in DEG_PROV_SERV_DATA table::


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/RuleChains/CUSTRC_GetSubscriberProfile/80.LogIncomingAttribute]

Attributes=CUST_GSP_IN_MDNString
Attributes=CUST_GSP_IN_IMSIString
Attributes=CUST_GSP_IN_IMS_Count
Attributes=CUST_GSP_OUT_ErrorFlagInteger
Attributes=CUST_GSP_OUT_SubscriberExistsFlagInteger
Attributes=CUST_GSP_OUT_MDN
Attributes=CUST_GSP_OUT_CUSTACTFEATURELIST
Attributes=CUST_GSP_OUT_VoWiFi_PROVISIONING_STATUS
Attributes=CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_POSTDATA
Attributes=CUST_GSP_OUT_VoWiFi_ADDR_STATUS
Attributes=CUST_GSP_OUT_VoWiFi_TC_STATUS
Attributes=CUST_GSP_OUT_VoWiFi_ADDR_UPDATE_URL
Attributes=CUST_GSP_OUT_EntitlementStatus
Attributes=CUST_GSP_OUT_GatewayAddrString
Attributes=CUST_GSP_OUT_COMPANIONDEVICE_COUNT
Attributes=CUST_GSP_OUT_SIP_USERNAME
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Attributes within custom GSPCustomTemplate :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/SessionStores]

SessionStoreNames=DEG_SUBSCRIBERS_SessionStore
SessionStoreNames=DEG_PROV_SERV_DATA_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/SessionStores/DEG_PROV_SERV_DATA_SessionStore]

Attributes=DEG_IMSI,key
Attributes=DEG_DEVICE_ID,key
Attributes=DEG_ENTITLEMENT_NAME,key
Attributes=DEG_PROV_TC_STATUS
Attributes=DEG_PROV_ADDRESS_STATUS
Attributes=DEG_PROV_PROVISIONING_STATUS
Attributes=DEG_PROV_GATEWAY_ADDRESS
Attributes=DEG_PROV_ADDR_UPDATE_POST_DATA
Attributes=DEG_PROV_ADDR_UPDATE_URL
Attributes=DEG_PROV_LASTUPDATE
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy1
DatabaseId=DEG_PROV_SERV_DATA
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_SUBS}
SQLTypeMap=DEG_IMSI,VARCHAR(64)
SQLTypeMap=DEG_DEVICE_ID,VARCHAR(64)
SQLTypeMap=DEG_ENTITLEMENT_NAME,VARCHAR(32)
SQLTypeMap=DEG_PROV_TC_STATUS,INTEGER
SQLTypeMap=DEG_PROV_ADDRESS_STATUS,INTEGER
SQLTypeMap=DEG_PROV_PROVISIONING_STATUS,INTEGER
SQLTypeMap=DEG_PROV_GATEWAY_ADDRESS,VARCHAR(256)
SQLTypeMap=DEG_PROV_ADDR_UPDATE_POST_DATA,VARCHAR(2048)
SQLTypeMap=DEG_PROV_ADDR_UPDATE_URL,VARCHAR(1024)
SQLTypeMap=DEG_PROV_LASTUPDATE,TIMESTAMP


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/SessionStores/DEG_SUBSCRIBERS_SessionStore]

Attributes=DEG_IMSI,key
Attributes=DEG_MDN,key
Attributes=DEG_MIN
Attributes=DEG_CustIdInt
Attributes=DEG_CustCatIdInt
Attributes=DEG_EVENTTIMESTAMPINTEGER
Attributes=DEG_ESN
Attributes=DEG_MEID
Attributes=DEG_IMEI
Attributes=DEG_ICCID
Attributes=DEG_CUSTSTATUS
Attributes=DEG_PROVTIME
Attributes=DEG_PROVCHANGETIME
Attributes=DEG_LASTUPDATE
Attributes=DEG_ENTITLEMENT_LIST
Attributes=DEG_COMPANION_DEVICE_COUNT
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy1
DatabaseId=DEG_SUBSCRIBERS
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_SUBS}
NativeConditions=1.MatchingByImsi
NativeConditions=2.MatchingByMsisdn
SQLTypeMap=DEG_IMSI,VARCHAR(64)
SQLTypeMap=DEG_MDN,BIGINT
SQLTypeMap=DEG_MIN,BIGINT
SQLTypeMap=DEG_CUSTIDINT,VARCHAR(64)
SQLTypeMap=DEG_CUSTCATIDINT,TINYINT
SQLTypeMap=DEG_EventTimeStampInteger,VARCHAR(64)
SQLTypeMap=DEG_ESN,VARCHAR(64)
SQLTypeMap=DEG_MEID,VARCHAR(64)
SQLTypeMap=DEG_IMEI,VARCHAR(64)
SQLTypeMap=DEG_ICCID,VARCHAR(64)
SQLTypeMap=DEG_CUSTSTATUS,VARCHAR(64)
SQLTypeMap=DEG_PROVTIME,TIMESTAMP
SQLTypeMap=DEG_PROVCHANGETIME,TIMESTAMP
SQLTypeMap=DEG_LASTUPDATE,TIMESTAMP
SQLTypeMap=DEG_ENTITLEMENT_LIST,VARCHAR(512)
SQLTypeMap=DEG_COMPANION_DEVICE_COUNT,VARCHAR(64)


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/SessionStores/DEG_SUBSCRIBERS_SessionStore/1.MatchingByImsi]

Condition=where DEG_IMSI = %DEG_IMSI and DEG_CustCatIdInt=3 and DEG_CustStatus in ('AE','RE')


[/templates/DEG/DEGDROID_DeviceInterface/GetSubscriberProfileCustomize/SessionStores/DEG_SUBSCRIBERS_SessionStore/2.MatchingByMsisdn]

Condition=where DEG_MDN = %DEG_MDN


[/templates/DEG/DEGDROID_DeviceInterface/Initial_Validation_Customize]


[/templates/DEG/DEGDROID_DeviceInterface/Initial_Validation_Customize/RuleChains]

RuleChainNames=CUSTRC_Android_InputValidation


[/templates/DEG/DEGDROID_DeviceInterface/Initial_Validation_Customize/RuleChains/CUSTRC_Android_InputValidation]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogRequestAttributeDetails


[/templates/DEG/DEGDROID_DeviceInterface/Initial_Validation_Customize/RuleChains/CUSTRC_Android_InputValidation/100.LogRequestAttributeDetails]

Attributes=CUST_DDIV_IN_SubscriberIdString
Attributes=CUST_DDIV_IN_SipUserNameString
Attributes=CUST_DDIV_IN_TerminalVendorString
Attributes=CUST_DDIV_IN_IMSIString
Attributes=CUST_DDIV_OUT_Status
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Processing Initial validation under Customize template::
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core]


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains]

RuleChainNames=400.DEG30PrcessNONERuleChain
RuleChainNames=400A.DEG30ProcessActionRuleChain
RuleChainNames=400B.DEG30SslSessionLookupStatusRuleChain
RuleChainNames=400C.DEG30NewRequest_CheckSslSessionStatusRuleChain
RuleChainNames=400D.DEG30RequestOk_CheckSslSessionStatusRuleChain
RuleChainNames=400E.DEG30PrcessNoneAuthRuleChain
RuleChainNames=400F.DEG30ValidationAndProcessRequestRuleChain
RuleChainNames=400G.DEG30FastPathAuthRuleChain
RuleChainNames=400H.DEG30FullAuthRuleChain
RuleChainNames=400I.DEG30GenerateOEMResponseRuleChain
RuleChainNames=400J.DEG30GenerateNoneInitialEndAuditDataRuleChain
RuleChainNames=903.DEG30GenerateNoneInitialDEGTokenAuthenticatedEndAuditDataRuleChain
RuleChainNames=904.DEG30GenerateNoneInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
RuleChainNames=908.DEG30GenerateNoneInitialBlackListSubscriberEndAuditDataRuleChain
RuleChainNames=909.DEG30GenerateNoneInitialDisallowedActionEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400.DEG30PrcessNONERuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=099.SetLogInfo
RuleNames=100.LogActionDetails
RuleNames=200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber
RuleNames=300.ValidateBody
RuleNames=400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber
RuleNames=500.ResetSSLSessionStatus
RuleNames=600.ProcessAction


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400.DEG30PrcessNONERuleChain/099.SetLogInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1001"
AdornOps=set DEG_OEMDevMessageString "Processing OEM action"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400.DEG30PrcessNONERuleChain/100.LogActionDetails]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevRespTokenString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Processing OEM action: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400.DEG30PrcessNONERuleChain/200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=or,or


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400.DEG30PrcessNONERuleChain/200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber/TrueRule]

AdornOps=set DEG_OEMDevRequestProcessedInteger 0
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400.DEG30PrcessNONERuleChain/300.ValidateBody]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=110.DEG30ValidateInitialRequestRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400.DEG30PrcessNONERuleChain/400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=or,or


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400.DEG30PrcessNONERuleChain/400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber/TrueRule]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400.DEG30PrcessNONERuleChain/500.ResetSSLSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,!=,0
Conditions=DEG_SSL_STATE,!=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,!=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,!=,"DISALLOWED_ACTION"
Operations=and,and,and
TrueRuleChain=100.ResetSslStateToNew


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400.DEG30PrcessNONERuleChain/500.ResetSSLSessionStatus/100.ResetSslStateToNew]

AdornOps=set DEG_SSL_STATE "NEW"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400.DEG30PrcessNONERuleChain/600.ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400A.DEG30ProcessActionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400A.DEG30ProcessActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ProcessAction


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400A.DEG30ProcessActionRuleChain/100.ProcessAction]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitSslSessionLookup
TrueRuleChain=110.ExecuteSslSessionLookup
TrueRuleChain=120.CheckSslSessionLookupStatus


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400A.DEG30ProcessActionRuleChain/100.ProcessAction/100.InitSslSessionLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400A.DEG30ProcessActionRuleChain/100.ProcessAction/110.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
MapAttributes=DEG_SSL_ID_PROV_STATUS,DEG_SSL_ID_PROV_STATUS
MapAttributes=DEG_SSL_GW_ADDR,DEG_SSL_GW_ADDR
MapAttributes=DEG_SSL_ADDRESS_UPDATE_URL,DEG_SSL_ADDRESS_UPDATE_URL
MapAttributes=DEG_SSL_ADDRESS_STATUS,DEG_SSL_ADDRESS_STATUS
MapAttributes=DEG_SSL_TC_STATUS,DEG_SSL_TC_STATUS
MapAttributes=DEG_SSL_POSTDATA,DEG_SSL_POSTDATA
MapAttributes=DEG_SSL_EntitlementStatus,DEG_SSL_EntitlementStatus
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400A.DEG30ProcessActionRuleChain/100.ProcessAction/120.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400B.DEG30SslSessionLookupStatusRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400B.DEG30SslSessionLookupStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SslSessionLookup


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_SSL_REQUEST_STATE,=,"NEW"
Conditions=DEG_SSL_REQUEST_STATE,within,[403C,500C]
Conditions=DEG_SSL_REQUEST_STATE,within,[200,200C]
Conditions=DEG_SSL_REQUEST_STATE,=,DEG_SSL_REQUEST_STATE
NewRequest=300.NewRequest_CheckSslSessionStatus
NoSslSession=200.SetSslRequestState_500C
NoSslSession=210.NoSslSessionLog
Operations=None
RequestError=355.InitErrorLog
RequestError=400.RequestErrorLog
RequestOk=500.RequestOk_CheckSslSessionStatus
SystemError=100.SetSslRequestState_500C
SystemError=110.SystemErrorLog
TrueRuleChain=SystemError
TrueRuleChain=NoSslSession
TrueRuleChain=NewRequest
TrueRuleChain=RequestError
TrueRuleChain=RequestOk
TrueRuleChain=UnknownStatus
UnknownStatus=600.SetSslRequestState_500C
UnknownStatus=610.UnknownStatusLog


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/100.SetSslRequestState_500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1002"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/110.SystemErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access DEG_SSL_SESSION table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/200.SetSslRequestState_500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1003"
AdornOps=set DEG_OEMDevErrorMessageString "Internal system error as SSL Session does exist in DEG_SSL_SESSION store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/210.NoSslSessionLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Internal system error as SSL Session does exist in DEG_SSL_SESSION store: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/300.NewRequest_CheckSslSessionStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400C.DEG30NewRequest_CheckSslSessionStatusRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/355.InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1004"
AdornOps=set DEG_OEMDevErrorMessageString "Request is in error state"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/400.RequestErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Skipping processing OEM action - request is in error state: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/500.RequestOk_CheckSslSessionStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400D.DEG30RequestOk_CheckSslSessionStatusRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/600.SetSslRequestState_500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1005"
AdornOps=set DEG_OEMDevErrorMessageString "SSL SESSION is in unrecognized state"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/610.UnknownStatusLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Action processed with error - SSL SESSION is in unrecognized state: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400C.DEG30NewRequest_CheckSslSessionStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.NewRequest_Check


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"NEW"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE
NewSslSession=100.NewSslSession_ProcessAction
Operations=None
TrueRuleChain=NewSslSession
TrueRuleChain=UnknownSslSessionState
UnknownSslSessionState=300.Unknown_UpdateRequestStateTo500C


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/100.NewSslSession_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400E.DEG30PrcessNoneAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=210.CheckSslSessionUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/100.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=99.InitErrorLog
TrueRuleChain=100.SystemErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/100.SystemErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=99.InitErrorLog
TrueRuleChain=100.RowNotFound


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.RowNotFound]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists/99.InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1007"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/99.InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1006"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update row in DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400D.DEG30RequestOk_CheckSslSessionStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=098.SetInfoStatus
RuleNames=100.LogNMERule20


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400D.DEG30RequestOk_CheckSslSessionStatusRuleChain/098.SetInfoStatus]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1008"
AdornOps=set DEG_OEMDevMessageString "entired Inside Customize 400D.DEG30RequestOk_CheckSslSessionStatusRuleChain"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400D.DEG30RequestOk_CheckSslSessionStatusRuleChain/100.LogNMERule20]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=entired Inside Customize 400D.DEG30RequestOk_CheckSslSessionStatusRuleChain
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=200.ValidationAndProcessRequest
RuleNames=300.UpdateSSLSessionStore
RuleNames=400.SetResponseHandler


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain/100.InitWorkingVariables]

AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_OEMDevImsiString ""
AdornOps=set DEG_MDN 0
AdornOps=set DEG_IMSI ""
AdornOps=set DEG_OEMDevRespPhoneNumberString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain/200.ValidationAndProcessRequest]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400F.DEG30ValidationAndProcessRequestRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain/300.UpdateSSLSessionStore]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"NEW"
FalseRuleChain=200.UpdateSslSessionState


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState]

ClassName=RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=300.CheckSslSessionUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/100.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI
AdornOps=copy DEG_OEMDevImsiString DEG_SSL_IMSI
AdornOps=copy DEG_OEMDevUniqueIDString DEG_SSL_UNIQUE_ID
AdornOps=copy DEG_MDN DEG_SSL_MDN
AdornOps=set DEG_SSL_GW_ADDR ""
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDRESS_UPDATE_URL ""
AdornOps=setifnull DEG_EntitlementStatus ""
AdornOps=copy DEG_PROVISIONING_STATUS DEG_SSL_ID_PROV_STATUS
AdornOps=copy DEG_ADDR_UPDATE_POSTDATA DEG_SSL_POSTDATA
AdornOps=copy DEG_ADDRESS_STATUS DEG_SSL_ADDRESS_STATUS
AdornOps=copy DEG_TC_STATUS DEG_SSL_TC_STATUS
AdornOps=copy DEG_ADDRESS_UPDATE_URL DEG_SSL_ADDRESS_UPDATE_URL
AdornOps=copy DEG_EntitlementStatus DEG_SSL_EntitlementStatus
AdornOps=setifnull DEGDROID_SSL_COOKIE_ID ""
AdornOps=setifnull DEGDROID_SSL_OTP 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_STATE,DEG_SSL_AAA_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
MapAttributes=DEG_SSL_ID_PROV_STATUS,DEG_SSL_ID_PROV_STATUS
MapAttributes=DEG_SSL_GW_ADDR,DEG_SSL_GW_ADDR
MapAttributes=DEG_SSL_POSTDATA,DEG_SSL_POSTDATA
MapAttributes=DEG_SSL_ADDRESS_STATUS,DEG_SSL_ADDRESS_STATUS
MapAttributes=DEG_SSL_TC_STATUS,DEG_SSL_TC_STATUS
MapAttributes=DEG_SSL_ADDRESS_UPDATE_URL,DEG_SSL_ADDRESS_UPDATE_URL
MapAttributes=DEG_SSL_EntitlementStatus,DEG_SSL_EntitlementStatus
MapAttributes=DEGDROID_SSL_COOKIE_ID,DEGDROID_SSL_COOKIE_ID
MapAttributes=DEGDROID_SSL_OTP,DEGDROID_SSL_OTP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=99.InitErrorLog
TrueRuleChain=100.LogError


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/100.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=99.InitErrorLog
TrueRuleChain=100.LogError


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/99.InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1010"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/99.InitErrorLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1009"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain/400.SetResponseHandler]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,within,[200,200C]
FalseRuleChain=200.SetEmptyResponseHandler
TrueRuleChain=100.SetTextResponseHandler


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain/400.SetResponseHandler/100.SetTextResponseHandler]

AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400E.DEG30PrcessNoneAuthRuleChain/400.SetResponseHandler/200.SetEmptyResponseHandler]

AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ProcessRequest


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest]

CheckIfSubscriberBlackListed=300.CheckIfSubscriberBlackListed
CheckIfSubscriberProvisioned=400.CheckIfSubscriberProvisioned
CheckIfSubscriberProvisioned=410.CopyEntitlementValues
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
ExtractImsiFromSubscriberIdAttribute=200.ExtractImsiFromSubscriberIdAttribute
ExtractNAIFromSubscriberIdAttribute=110.DecodePayload
ExtractNAIFromSubscriberIdAttribute=120.CheckPlayloadIfBase64
GenerateEapAkaInitialEndAuditData=600.GenerateEapAkaInitialEndAuditData
GenerateOEMResponse=700.GenerateOEMResponse
GenerateStartAuditData=400.GenerateStartAuditData
Operations=DoAll
ProcessPerAuthType=500.InitVariables
ProcessPerAuthType=510.LookupDEGToken
ProcessPerAuthType=520.CheckDEGToken
TrueRuleChain=ExtractNAIFromSubscriberIdAttribute
TrueRuleChain=ValidateSubscriberIdAttribute
TrueRuleChain=ValidateToken
TrueRuleChain=ExtractImsiFromSubscriberIdAttribute
TrueRuleChain=GenerateStartAuditData
TrueRuleChain=CheckIfSubscriberBlackListed
TrueRuleChain=CheckIfSubscriberProvisioned
TrueRuleChain=ProcessPerAuthType
TrueRuleChain=GenerateEapAkaInitialEndAuditData
TrueRuleChain=GenerateOEMResponse
ValidateSubscriberIdAttribute=130.ValidateSubscriberIdAttribute
ValidateToken=140.ValidateToken


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/110.DecodePayload]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevEAPSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy
DecodeEAPSubscriberId=100.DecodeEAPSubscriberId
DecodeSubscriberId=200.DecodeSubscriberId
Operations=None
TrueRuleChain=DecodeEAPSubscriberId
TrueRuleChain=DecodeSubscriberId


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/110.DecodePayload/100.DecodeEAPSubscriberId]

AdornOps=decBase64 DEG_OEMDevEAPSubscriberIdString DEG_OEMDevEAPPayloadBinary
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/110.DecodePayload/200.DecodeSubscriberId]

AdornOps=decBase64 DEG_OEMDevSubscriberIdString DEG_OEMDevEAPPayloadBinary
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.ConvertPayload2String
FalseRuleChain=210.DecodeNAI
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/100.SetHTTPErrorResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1011"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to Extract NAI From SubscriberId"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevTempSubscriberIdString
Attributes=DEG_OEMDevSubscriberIdLengthInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Data Error in EAP Payload
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/200.ConvertPayload2String]

AdornOps=bin2str DEG_OEMDevEAPPayloadBinary DEG_OEMDevTempSubscriberIdString "ISO8859_1"
AdornOps=length DEG_OEMDevTempSubscriberIdString DEG_OEMDevSubscriberIdLengthInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdLengthInteger,>=,6
TrueRuleChain=100.ExtractNAI


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI]

AdornOps=copy DEG_OEMDevTempSubscriberIdString DEG_OEMDevSubscriberIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=(DEG_OEMDevEAPPayloadBinary =="") || (DEG_OEMDevEAPPayloadBinary == null)


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/130.ValidateSubscriberIdAttribute]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
FalseRuleChain=200.SetHttpErrorResponse
FalseRuleChain=210.ErrorLog
Operation=match
RegExPattern=${SUBSCRIBERID_PATTERN}
SourceAttribute=DEG_OEMDevSubscriberIdString


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/130.ValidateSubscriberIdAttribute/200.SetHttpErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevOutReturnCodeString "403"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1012"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber-id attribute not NAI format"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/130.ValidateSubscriberIdAttribute/210.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request - subscriber-id attribute must be in NAI format: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/140.ValidateToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/140.ValidateToken/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1013"
AdornOps=set DEG_OEMDevErrorMessageString "Token is empty"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/140.ValidateToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request - token is empty: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/200.ExtractImsiFromSubscriberIdAttribute]

AdornOps=substr "0" "@" DEG_OEMDevSubscriberIdString DEG_OEMDevImsiString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/300.CheckIfSubscriberBlackListed]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=150.DEG30BlackListeSubscriberRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/400.CheckIfSubscriberProvisioned]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400.GetSubscriberProfileRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/400.GenerateStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/410.CopyEntitlementValues]

AdornOps=copy DEG_EntitlementStatus DEG_SSL_EntitlementStatus
AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDRESS_UPDATE_URL ""
AdornOps=copy DEG_TC_STATUS DEGDROID_XML_TC_STATUS
AdornOps=copy DEG_ADDRESS_STATUS DEGDROID_XML_ADDRESS_STATUS
AdornOps=copy DEG_PROVISIONING_STATUS DEGDROID_XML_PROVISIONING_STATUS
AdornOps=copy DEG_ADDR_UPDATE_POSTDATA DEGDROID_XML_ADDR_UPDATE_POSTDATA
AdornOps=copy DEG_ADDRESS_UPDATE_URL DEGDROID_XML_ADDRESS_UPDATE_URL
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/500.InitVariables]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=copy DEG_MDN DEG_CDevMobileNumberString
AdornOps=set DEG_CDevTokenString ""
AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_OEMDevFastAuthFlag 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/510.LookupDEGToken]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_AUTHENTICATION_TYPE,DEG_AUTHENTICATION_TYPE
MapAttributes=DEG_AUTHENTICATION_SUBTYPE,DEG_AUTHENTICATION_SUBTYPE
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckTokenTimeStamp
FalseRuleChain=210.CheckProcessIntegerFlag
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/100.SetHTTPErrorResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1014"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEG_TOKENS table"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_TOKENS table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/200.CheckTokenTimeStamp]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=130.DEG30CheckTokenTimeStampRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=210.GetToken


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
Conditions=DEG_OEMDevFastAuthFlag,=,1
Conditions=DEG_TOKENSTATUS,=,"AE"
Conditions=DEG_OEMDevTokenString,=,DEG_SUBSTOKEN
FalseRuleChain=200.EAPAKAAuth
Operations=and,and,and
TrueRuleChain=100.FastPathAuth


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.FastPathAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400G.DEG30FastPathAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/200.EAPAKAAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400H.DEG30FullAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/600.GenerateEapAkaInitialEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400I.DEG30GenerateOEMResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400F.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/700.GenerateOEMResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400J.DEG30GenerateNoneInitialEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetSystemTime
RuleNames=110.CheckTokenValidity


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/100.SetSystemTime]

AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_EVENTTIMESTAMP DEG_OEMDevTokenTimeStampDiffLong
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenTimeStampDiffLong,<=,DEG_OEMDeviceTokenValidityLong
FalseRuleChain=200.SetErrorInfo
FalseRuleChain=210.ErrorLog
TrueRuleChain=100.SetSessionStatus
TrueRuleChain=200.LogFastPathAuth
TrueRuleChain=300.CheckCounter
TrueRuleChain=400.UpdateAsBlackListed
TrueRuleChain=500.GenerateResponse


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/100.SetSessionStatus]

AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_TYPE "NONE"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "TKN"
AdornOps=+ DEG_AUTH_COUNT 1 DEG_AUTH_COUNT
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1016"
AdornOps=set DEG_OEMDevMessageString "Perform FastPathAuth"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/200.LogFastPathAuth]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_AUTH_COUNT
Attributes=DEG_OEMDevAuthThresholdCountInteger
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Perform FastPathAuth: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/200.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1015"
AdornOps=set DEG_OEMDevErrorMessageString "Network Authentication Required"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/210.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevCurrentTimeStampLong
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_OEMDevTokenTimeStampDiffLong
Attributes=DEG_OEMDeviceTokenValidityLong
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Database Error: Token Expired Network Authentication Required
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/300.CheckCounter]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTH_COUNT,>,DEG_OEMDevAuthThresholdCountInteger
TrueRuleChain=100.SetBlackListed


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/300.CheckCounter/100.SetBlackListed]

AdornOps=set DEG_BLACKLIST_FLAG 1
AdornOps=set DEG_AUTH_COUNT 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/100.InitUpdate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=setifnull DEG_AUTH_COUNT 0
AdornOps=setifnull DEG_BLACKLIST_FLAG 0
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1017"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS session store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_TOKENS session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1018"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS session store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_TOKENS session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/500.GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_BLACKLIST_FLAG,=,1
TrueRuleChain=100.GenerateBlackListedResponse


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400G.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/500.GenerateResponse/100.GenerateBlackListedResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=140.DEG30GenerateBlackListedResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400H.DEG30FullAuthRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetSessionStatus
RuleNames=100.LogNMEFullAuth


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400H.DEG30FullAuthRuleChain/100.LogNMEFullAuth]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Fullauth is not required in case of NONE auth type
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400H.DEG30FullAuthRuleChain/100.SetSessionStatus]

AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "DFT"
AdornOps=set DEG_AUTHENTICATION_TYPE "NONE"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1019"
AdornOps=set DEG_OEMDevErrorMessageString "Fullauth is not required in case of NONE auth type"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateOEMResponse


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse]

Authenticated=500.Authenticated_InitResponse
Authenticated=501.Authenticated_GetResponseTemplate
Authenticated=510.Authenticated_StoreToken
Authenticated=520.Authenticated_ServiceConfiguration
Authenticated=530.Authenticated_GenerateResponse
BlacListedSubscriber=200.BlackListedSubscriber_InitResponse
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Conditions=DEG_SSL_STATE,starts,"AUTHENTICATED"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE
Operations=None
StatusDisallowed=700.DisallowedAction_InitResponse
TrueRuleChain=UnknownSubscriber
TrueRuleChain=BlacListedSubscriber
TrueRuleChain=StatusDisallowed
TrueRuleChain=Authenticated
TrueRuleChain=Unknown
Unknown=600.Unknown_SetHttpErrorResponseTo500C
UnknownSubscriber=100.UnknownSubscriber_InitResponse


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/100.UnknownSubscriber_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRespStatusString 403
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/200.BlackListedSubscriber_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevRespStatusString 511
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/500.Authenticated_InitResponse]

AdornOps=set DEG_APP_TOKEN_FLAG 1
AdornOps=set DEGDROID_auth_step_Integer 1
AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEG_OEMDevRespTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEG_CDevTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEGDROID_SSL_COOKIE_ID
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP
AdornOps=set DEG_TOKEN_VALIDITY_SECONDS ${DEGDROID_DEVICE_TOKEN_VALIDITY}
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/501.Authenticated_GetResponseTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/510.Authenticated_StoreToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevMobileNumberString
RequestAttributes=DEG_IMSI
RequestAttributes=DEG_CDevTokenString
RequestAttributes=DEG_AUTHENTICATION_TYPE
RequestAttributes=DEG_AUTHENTICATION_SUBTYPE
RequestAttributes=DEG_APP_TOKEN_FLAG
RequestAttributes=DEG_FULLAUTHTIMESTAMP
ResponseAttributes=DEG_OEMDevErrorMessageString
ResponseAttributes=DEG_EVENTTIMESTAMP
RuleChain=005.DEG30StoreTokenRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/520.Authenticated_ServiceConfiguration]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.DEG30ProcessServiceConfigurationRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/530.Authenticated_GenerateResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckEAPPayload
RuleNames=150.CheckResponseXMLEmptyAfterServiceConfigProcess


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/530.Authenticated_GenerateResponse/100.CheckEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodePayload
TrueRuleChain=100.GenerateNullPayloadResponse


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/530.Authenticated_GenerateResponse/100.CheckEAPPayload/100.GenerateNullPayloadResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/530.Authenticated_GenerateResponse/100.CheckEAPPayload/200.EncodePayload]

AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/530.Authenticated_GenerateResponse/100.CheckEAPPayload/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/530.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_XMLTemplateResponseString,!=,""
FalseRuleChain=20.AssignResponseFromAuthConfigTemplate
TrueRuleChain=10.AssignResponseFromServiceConfigTemplate


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/530.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess/10.AssignResponseFromServiceConfigTemplate]

AdornOps=copy DEG_XMLTemplateResponseString ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/530.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess/20.AssignResponseFromAuthConfigTemplate]

AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/530.Authenticated_GenerateResponse/200.MessageFormatXML]

ClassName=com.hp.usage.rules.transform.MessageFormatRule
Locale=en_US
MessageFormat=DEG_XML_TEMPLATES_FILE
ResultAttribute=ResponseMessage
UseDynamicMessageFormat=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/530.Authenticated_GenerateResponse/250.GenerateResponse]

AdornOps=setifnull DEG_XML_TEMPLATES_FILE ""
AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/600.Unknown_SetHttpErrorResponseTo500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400I.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/700.DisallowedAction_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevHttpStatusInteger "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400J.DEG30GenerateNoneInitialEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateNoneInitialEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400J.DEG30GenerateNoneInitialEndAuditDataRuleChain/100.GenerateNoneInitialEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,!=,UNKNOWN_SUBSCRIBER
Description=Unknown Subscriber case already Handled
Operations=or
TrueRuleChain=100.CheckAuthenticationState


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400J.DEG30GenerateNoneInitialEndAuditDataRuleChain/100.GenerateNoneInitialEndAuditData/100.CheckAuthenticationState]

AuthenticatedDEGToken=100.GenerateNoneInitialDEGTokenAuthenticatedEndAuditData
BlackListSubscriber=200.GenerateNoneInitialBlackListSubscriberEndAuditData
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=None
StatusDisallowed=300.GenerateNoneInitialDisallowedActionEndAuditData
TrueRuleChain=AuthenticatedDEGToken
TrueRuleChain=BlackListSubscriber
TrueRuleChain=StatusDisallowed


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400J.DEG30GenerateNoneInitialEndAuditDataRuleChain/100.GenerateNoneInitialEndAuditData/100.CheckAuthenticationState/100.GenerateNoneInitialDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"TKN"
FalseRuleChain=200.GenerateNoneInitialDEGTokenAuthenticatedDefaultEndAuditData
TrueRuleChain=100.GenerateNoneInitialDEGTokenAuthenticatedEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400J.DEG30GenerateNoneInitialEndAuditDataRuleChain/100.GenerateNoneInitialEndAuditData/100.CheckAuthenticationState/100.GenerateNoneInitialDEGTokenAuthenticatedEndAuditData/100.GenerateNoneInitialDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=903.DEG30GenerateNoneInitialDEGTokenAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400J.DEG30GenerateNoneInitialEndAuditDataRuleChain/100.GenerateNoneInitialEndAuditData/100.CheckAuthenticationState/100.GenerateNoneInitialDEGTokenAuthenticatedEndAuditData/200.GenerateNoneInitialDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=904.DEG30GenerateNoneInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400J.DEG30GenerateNoneInitialEndAuditDataRuleChain/100.GenerateNoneInitialEndAuditData/100.CheckAuthenticationState/200.GenerateNoneInitialBlackListSubscriberEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=908.DEG30GenerateNoneInitialBlackListSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/400J.DEG30GenerateNoneInitialEndAuditDataRuleChain/100.GenerateNoneInitialEndAuditData/100.CheckAuthenticationState/300.GenerateNoneInitialDisallowedActionEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=909.DEG30GenerateNoneInitialDisallowedActionEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/903.DEG30GenerateNoneInitialDEGTokenAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/903.DEG30GenerateNoneInitialDEGTokenAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditTransactionTypeString "fast-auth"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/903.DEG30GenerateNoneInitialDEGTokenAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending fast-auth response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/903.DEG30GenerateNoneInitialDEGTokenAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/903.DEG30GenerateNoneInitialDEGTokenAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/903.DEG30GenerateNoneInitialDEGTokenAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by DEG_TOKEN,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/903.DEG30GenerateNoneInitialDEGTokenAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/904.DEG30GenerateNoneInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/904.DEG30GenerateNoneInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditTransactionTypeString "fast-auth"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/904.DEG30GenerateNoneInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending fast-auth response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/904.DEG30GenerateNoneInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=setifnull DEG_OEMDevErrorMessageString ""
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/904.DEG30GenerateNoneInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/904.DEG30GenerateNoneInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by default,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/904.DEG30GenerateNoneInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/908.DEG30GenerateNoneInitialBlackListSubscriberEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/908.DEG30GenerateNoneInitialBlackListSubscriberEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditTransactionTypeString "fast-auth"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/908.DEG30GenerateNoneInitialBlackListSubscriberEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending fast-auth response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/908.DEG30GenerateNoneInitialBlackListSubscriberEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/908.DEG30GenerateNoneInitialBlackListSubscriberEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/908.DEG30GenerateNoneInitialBlackListSubscriberEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "BlackListed Subscriber,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/908.DEG30GenerateNoneInitialBlackListSubscriberEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/909.DEG30GenerateNoneInitialDisallowedActionEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/909.DEG30GenerateNoneInitialDisallowedActionEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditTransactionTypeString "fast-auth"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/909.DEG30GenerateNoneInitialDisallowedActionEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending fast-auth response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/909.DEG30GenerateNoneInitialDisallowedActionEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/909.DEG30GenerateNoneInitialDisallowedActionEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/909.DEG30GenerateNoneInitialDisallowedActionEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Status Disallowed Action,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Internal_Auth_Core/RuleChains/909.DEG30GenerateNoneInitialDisallowedActionEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core]


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains]

RuleChainNames=300.DEG30ProcessOTPRuleChain
RuleChainNames=300A.DEG30ProcessActionRuleChain
RuleChainNames=300B.DEG30SslSessionLookupStatusRuleChain
RuleChainNames=300C.DEG30NewRequest_CheckSslSessionStatusRuleChain
RuleChainNames=300D.DEG30RequestOk_CheckSslSessionStatusRuleChain
RuleChainNames=300E.DEG30ProcessOTPAuthStep1RuleChain
RuleChainNames=300G.DEG30ValidationAndProcessActionRuleChain
RuleChainNames=300I.DEG30FullAuthRuleChain
RuleChainNames=300J.DEG30FastPathAuthRuleChain
RuleChainNames=300K.DEG30GenerateOEMResponseRuleChain
RuleChainNames=300L.DEG30GenerateOTPInitialEndAuditDataRuleChain
RuleChainNames=801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain
RuleChainNames=802.DEG30GenerateOTPWaitEndAuditDataRuleChain
RuleChainNames=803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain
RuleChainNames=804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
RuleChainNames=805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain
RuleChainNames=807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain
RuleChainNames=808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain
RuleChainNames=809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=099.SetLogInfo
RuleNames=100.LogActionDetails
RuleNames=200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber
RuleNames=300.ValidateBody
RuleNames=400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber
RuleNames=500.ResetSSLSessionStatus
RuleNames=600.ProcessAction


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/099.SetLogInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1201"
AdornOps=set DEG_OEMDevMessageString "Processing OEM action"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/100.LogActionDetails]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevRespTokenString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Processing OEM action: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=or,or


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber/TrueRule]

AdornOps=set DEG_OEMDevRequestProcessedInteger 0
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/300.ValidateBody]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=110.DEG30ValidateInitialRequestRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=or,or


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber/TrueRule]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/500.ResetSSLSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,!=,0
Conditions=DEG_SSL_STATE,!=,"WAIT_FOR_OTP_CHALLENGE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,!=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,!=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,!=,"DISALLOWED_ACTION"
Operations=and,and,and,and
TrueRuleChain=100.ResetSslStateToNew


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/500.ResetSSLSessionStatus/100.ResetSslStateToNew]

AdornOps=set DEG_SSL_STATE "NEW"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/600.ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300A.DEG30ProcessActionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300A.DEG30ProcessActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ProcessAction


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300A.DEG30ProcessActionRuleChain/100.ProcessAction]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitSslSessionLookup
TrueRuleChain=110.ExecuteSslSessionLookup
TrueRuleChain=120.CheckSslSessionLookupStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300A.DEG30ProcessActionRuleChain/100.ProcessAction/100.InitSslSessionLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300A.DEG30ProcessActionRuleChain/100.ProcessAction/110.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
MapAttributes=DEG_SSL_ID_PROV_STATUS,DEG_SSL_ID_PROV_STATUS
MapAttributes=DEG_SSL_GW_ADDR,DEG_SSL_GW_ADDR
MapAttributes=DEG_SSL_ADDRESS_UPDATE_URL,DEG_SSL_ADDRESS_UPDATE_URL
MapAttributes=DEG_SSL_ADDRESS_STATUS,DEG_SSL_ADDRESS_STATUS
MapAttributes=DEG_SSL_TC_STATUS,DEG_SSL_TC_STATUS
MapAttributes=DEG_SSL_POSTDATA,DEG_SSL_POSTDATA
MapAttributes=DEG_SSL_EntitlementStatus,DEG_SSL_EntitlementStatus
MapAttributes=DEGDROID_SSL_COOKIE_ID,DEGDROID_SSL_COOKIE_ID
MapAttributes=DEGDROID_SSL_OTP,DEGDROID_SSL_OTP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300A.DEG30ProcessActionRuleChain/100.ProcessAction/120.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300B.DEG30SslSessionLookupStatusRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SslSessionLookup


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_SSL_REQUEST_STATE,=,"NEW"
Conditions=DEG_SSL_REQUEST_STATE,within,[403C,500C]
Conditions=DEG_SSL_REQUEST_STATE,within,[200,200C]
Conditions=DEG_SSL_REQUEST_STATE,=,DEG_SSL_REQUEST_STATE
NewRequest=300.NewRequest_CheckSslSessionStatus
NoSslSession=200.SetSslRequestState_500C
NoSslSession=210.NoSslSessionLog
Operations=None
RequestError=355.SetErrorInfo
RequestError=400.RequestErrorLog
RequestOk=500.RequestOk_CheckSslSessionStatus
SystemError=100.SetSslRequestState_500C
SystemError=110.SystemErrorLog
TrueRuleChain=SystemError
TrueRuleChain=NoSslSession
TrueRuleChain=NewRequest
TrueRuleChain=RequestError
TrueRuleChain=RequestOk
TrueRuleChain=UnknownStatus
UnknownStatus=600.SetSslRequestState_500C
UnknownStatus=610.UnknownStatusLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/100.SetSslRequestState_500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1202"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/110.SystemErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevServiceNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access DEG_SSL_SESSION table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/200.SetSslRequestState_500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1203"
AdornOps=set DEG_OEMDevErrorMessageString "Error while SSL Session does exist in DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/210.NoSslSessionLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevServiceNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Internal system error as SSL Session does exist in DEG_SSL_SESSION store: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/300.NewRequest_CheckSslSessionStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300C.DEG30NewRequest_CheckSslSessionStatusRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/355.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1204"
AdornOps=set DEG_OEMDevErrorMessageString "Error state in request while Skipping processing OEM action"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/400.RequestErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevServiceNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Skipping processing OEM action - request is in error state: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/500.RequestOk_CheckSslSessionStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300D.DEG30RequestOk_CheckSslSessionStatusRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/600.SetSslRequestState_500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1205"
AdornOps=set DEG_OEMDevErrorMessageString "Action processed with error - SSL SESSION is in unrecognized state"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/610.UnknownStatusLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevServiceNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Action processed with error - SSL SESSION is in unrecognized state: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.NewRequest_Check


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check]

AkaWait=200.AkaWait_ProcessAction
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"NEW"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_OTP_CHALLENGE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE
NewSslSession=100.NewSslSession_ProcessAction
Operations=None
TrueRuleChain=NewSslSession
TrueRuleChain=AkaWait
TrueRuleChain=UnknownSslSessionState
UnknownSslSessionState=300.Unknown_UpdateRequestStateTo500C


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/100.NewSslSession_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300E.DEG30ProcessOTPAuthStep1RuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/200.AkaWait_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350.DEG30ProcessOTPAuthStep2RuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=210.CheckSslSessionUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/100.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=65.SetErrorInfo
TrueRuleChain=100.SystemErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/100.SystemErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevServiceNameString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=66.SetErrorInfo
TrueRuleChain=100.RowNotFound


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.RowNotFound]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists/66.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1207"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/65.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1206"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to Update DEG_SSL_SESSION store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300D.DEG30RequestOk_CheckSslSessionStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=095.SetLogInfo
RuleNames=100.LogNMERule300


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300D.DEG30RequestOk_CheckSslSessionStatusRuleChain/095.SetLogInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1208"
AdornOps=set DEG_OEMDevMessageString "Entered Inside rule 300D.DEG30RequestOk_CheckSslSessionStatusRuleChain"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300D.DEG30RequestOk_CheckSslSessionStatusRuleChain/100.LogNMERule300]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Entired Inside rule 300D.DEG30RequestOk_CheckSslSessionStatusRuleChain
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=300.ValidationAndProcessAction
RuleNames=400.UpdateSSLSessionStore
RuleNames=500.SetResponseHandler


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/100.InitWorkingVariables]

AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_OEMDevImsiString ""
AdornOps=set DEG_MDN 0
AdornOps=set DEG_IMSI ""
AdornOps=set DEG_OEMDevRespPhoneNumberString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/300.ValidationAndProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300G.DEG30ValidationAndProcessActionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"NEW"
FalseRuleChain=200.UpdateSslSessionState


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState]

ClassName=RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=300.CheckSslSessionUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/100.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI
AdornOps=copy DEG_OEMDevImsiString DEG_SSL_IMSI
AdornOps=copy DEG_OEMDevUniqueIDString DEG_SSL_UNIQUE_ID
AdornOps=copy DEG_MDN DEG_SSL_MDN
AdornOps=set DEG_SSL_GW_ADDR ""
AdornOps=setifnull DEG_PROVISIONING_STATUS 0
AdornOps=setifnull DEG_ADDRESS_STATUS 0
AdornOps=setifnull DEG_TC_STATUS 0
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDRESS_UPDATE_URL ""
AdornOps=setifnull DEG_EntitlementStatus ""
AdornOps=copy DEG_PROVISIONING_STATUS DEG_SSL_ID_PROV_STATUS
AdornOps=copy DEG_ADDR_UPDATE_POSTDATA DEG_SSL_POSTDATA
AdornOps=copy DEG_ADDRESS_STATUS DEG_SSL_ADDRESS_STATUS
AdornOps=copy DEG_TC_STATUS DEG_SSL_TC_STATUS
AdornOps=copy DEG_ADDRESS_UPDATE_URL DEG_SSL_ADDRESS_UPDATE_URL
AdornOps=copy DEG_EntitlementStatus DEG_SSL_EntitlementStatus
AdornOps=setifnull DEGDROID_SSL_COOKIE_ID ""
AdornOps=setifnull DEGDROID_OTP 0
AdornOps=copy DEGDROID_OTP DEGDROID_SSL_OTP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_STATE,DEG_SSL_AAA_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
MapAttributes=DEG_SSL_ID_PROV_STATUS,DEG_SSL_ID_PROV_STATUS
MapAttributes=DEG_SSL_GW_ADDR,DEG_SSL_GW_ADDR
MapAttributes=DEG_SSL_POSTDATA,DEG_SSL_POSTDATA
MapAttributes=DEG_SSL_ADDRESS_STATUS,DEG_SSL_ADDRESS_STATUS
MapAttributes=DEG_SSL_TC_STATUS,DEG_SSL_TC_STATUS
MapAttributes=DEG_SSL_ADDRESS_UPDATE_URL,DEG_SSL_ADDRESS_UPDATE_URL
MapAttributes=DEG_SSL_EntitlementStatus,DEG_SSL_EntitlementStatus
MapAttributes=DEGDROID_SSL_OTP,DEGDROID_SSL_OTP
MapAttributes=DEGDROID_SSL_COOKIE_ID,DEGDROID_SSL_COOKIE_ID
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=75.SetErrorInfo
TrueRuleChain=100.LogError


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/100.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=68.SetErrorInfo
TrueRuleChain=100.LogError


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/68.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1210"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/75.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1209"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/500.SetResponseHandler]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,within,[200,200C]
FalseRuleChain=200.SetEmptyResponseHandler
TrueRuleChain=100.SetTextResponseHandler


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/500.SetResponseHandler/100.SetTextResponseHandler]

AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/500.SetResponseHandler/200.SetEmptyResponseHandler]

AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ValidationAndProcessAction


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction]

CheckIfSubscriberBlackListed=500.CheckIfSubscriberBlackListed
CheckIfSubscriberProvisioned=600.CheckIfSubscriberProvisioned
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
ExtractNAIFromSubscriberIdAttribute=110.DecodePayload
ExtractNAIFromSubscriberIdAttribute=120.CheckPlayloadIfBase64
GenerateGetAuthenticationEndAuditData=900.GenerateGetAuthenticationEndAuditData
GenerateOEMResponse=800.GenerateOEMResponse
GenerateStartAuditData=400.GenerateStartAuditData
InitVariables=100.InitVariables
Operations=DoAll
ProcessPerAuthType=700.InitVariables
ProcessPerAuthType=710.LookupDEGDROIDToken
ProcessPerAuthType=720.CheckDEGOPTToken
TrueRuleChain=InitVariables
TrueRuleChain=ExtractNAIFromSubscriberIdAttribute
TrueRuleChain=ValidateToken
TrueRuleChain=GenerateStartAuditData
TrueRuleChain=CheckIfSubscriberBlackListed
TrueRuleChain=CheckIfSubscriberProvisioned
TrueRuleChain=ProcessPerAuthType
TrueRuleChain=GenerateGetAuthenticationEndAuditData
TrueRuleChain=GenerateOEMResponse
ValidateToken=300.ValidateToken


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/100.InitVariables]

AdornOps=set DEGDROID_auth_step_Integer 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/110.DecodePayload]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevEAPSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy
DecodeSubscriberId=200.DecodeSubscriberId
DecpdeEAPSubscriberId=100.DecodeEAPSubscriberId
Operations=None
TrueRuleChain=DecpdeEAPSubscriberId
TrueRuleChain=DecodeSubscriberId


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/110.DecodePayload/100.DecodeEAPSubscriberId]

AdornOps=decBase64 DEG_OEMDevEAPSubscriberIdString DEG_OEMDevEAPPayloadBinary
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/110.DecodePayload/200.DecodeSubscriberId]

AdornOps=decBase64 DEG_OEMDevSubscriberIdString DEG_OEMDevEAPPayloadBinary
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.ConvertPayload2String
FalseRuleChain=210.DecodeNAI
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/100.SetHTTPErrorResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1211"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to Extract NAI From SubscriberId"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevTempSubscriberIdString
Attributes=DEG_OEMDevSubscriberIdLengthInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Data Error in EAP payload
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/200.ConvertPayload2String]

AdornOps=bin2str DEG_OEMDevEAPPayloadBinary DEG_OEMDevTempSubscriberIdString "ISO8859_1"
AdornOps=length DEG_OEMDevTempSubscriberIdString DEG_OEMDevSubscriberIdLengthInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdLengthInteger,>=,6
TrueRuleChain=100.ExtractNAI


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevEAPSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy
ExtractEAPSubscriberId=100.ExtractEAPSubscriberId
ExtractEAPSubscriberId=130.ValidateEAPSubscriberIdAttribute
ExtractEAPSubscriberId=145.ExtractImsiFromEAPSubscriberIdAttribute
ExtractSubscriberId=200.ExtractSubscriberId
ExtractSubscriberId=135.ValidateSubscriberIdAttribute
ExtractSubscriberId=150.ExtractImsiFromSubscriberIdAttribute
Operations=None
TrueRuleChain=ExtractEAPSubscriberId
TrueRuleChain=ExtractSubscriberId


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/100.ExtractEAPSubscriberId]

AdornOps=substr 5 length DEG_OEMDevTempSubscriberIdString DEG_OEMDevEAPSubscriberIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/130.ValidateEAPSubscriberIdAttribute]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
FalseRuleChain=200.SetHttpErrorResponse
FalseRuleChain=210.ErrorLog
Operation=match
RegExPattern=${SUBSCRIBERID_PATTERN}
SourceAttribute=DEG_OEMDevEAPSubscriberIdString


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/130.ValidateEAPSubscriberIdAttribute/200.SetHttpErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1212"
AdornOps=set DEG_OEMDevErrorMessageString "EAP-Subscriber-id attribute not NAI format"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/130.ValidateEAPSubscriberIdAttribute/210.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request - EAP-subscriber-id attribute must be in NAI format: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/135.ValidateSubscriberIdAttribute]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
FalseRuleChain=200.SetHttpErrorResponse
FalseRuleChain=210.ErrorLog
Operation=match
RegExPattern=${SUBSCRIBERID_PATTERN}
SourceAttribute=DEG_OEMDevSubscriberIdString


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/135.ValidateSubscriberIdAttribute/200.SetHttpErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1213"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber-id attribute not NAI format"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/135.ValidateSubscriberIdAttribute/210.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request - subscriber-id attribute must be in NAI format: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/145.ExtractImsiFromEAPSubscriberIdAttribute]

AdornOps=substr "0" "@" DEG_OEMDevEAPSubscriberIdString DEG_OEMDevImsiString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/150.ExtractImsiFromSubscriberIdAttribute]

AdornOps=substr "0" "@" DEG_OEMDevSubscriberIdString DEG_OEMDevImsiString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/200.ExtractSubscriberId]

AdornOps=copy DEG_OEMDevTempSubscriberIdString DEG_OEMDevSubscriberIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=(DEG_OEMDevEAPPayloadBinary =="") || (DEG_OEMDevEAPPayloadBinary == null)


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/300.ValidateToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/300.ValidateToken/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1214"
AdornOps=set DEG_OEMDevErrorMessageString "otp Token is empty"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/300.ValidateToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevTokenString
Attributes=DEG_DevOtpTokenString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid otp auth request - otp token is empty: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/400.GenerateStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/500.CheckIfSubscriberBlackListed]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=150.DEG30BlackListeSubscriberRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/600.CheckIfSubscriberProvisioned]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400.GetSubscriberProfileRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/700.InitVariables]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=copy DEG_MDN DEG_CDevMobileNumberString
AdornOps=set DEG_CDevTokenString ""
AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_OEMDevFastAuthFlag 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/710.LookupDEGDROIDToken]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_AUTHENTICATION_TYPE,DEG_AUTHENTICATION_TYPE
MapAttributes=DEG_AUTHENTICATION_SUBTYPE,DEG_AUTHENTICATION_SUBTYPE
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckTokenTimeStamp
FalseRuleChain=210.CheckProcessIntegerFlag
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateGetAuthenticationSystemErrorEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1215"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEG_TOKENS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_TOKENS table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/120.GenerateGetAuthenticationSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/200.CheckTokenTimeStamp]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=130.DEG30CheckTokenTimeStampRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/210.CheckProcessIntegerFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=210.GetToken


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/210.CheckProcessIntegerFlag/210.GetToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
Conditions=DEG_OEMDevFastAuthFlag,=,1
Conditions=DEG_TOKENSTATUS,=,"AE"
Conditions=DEG_OEMDevTokenString,=,DEG_SUBSTOKEN
FalseRuleChain=200.EAPAKAAuth
Operations=and,and,and
TrueRuleChain=100.FastPathAuth


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/210.CheckProcessIntegerFlag/210.GetToken/100.FastPathAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300J.DEG30FastPathAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/210.CheckProcessIntegerFlag/210.GetToken/200.EAPAKAAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300I.DEG30FullAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/800.GenerateOEMResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300K.DEG30GenerateOEMResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/900.GenerateGetAuthenticationEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300L.DEG30GenerateOTPInitialEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain]

ClassName=RuleChain
RuleNames=100.InitRequestVariables
RuleNames=300.CheckErrorAndNoMatchFlag


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/100.InitRequestVariables]

AdornOps=set DEG_CDevSysParameter "EAPAKAAuth"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI
AdornOps=set DEG_SSL_STATE WAIT_FOR_OTP_CHALLENGE_FROM_DEVICE
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/200.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
FalseRuleChain=200.SetSessionStatus
FalseRuleChain=210.LogEAPAKAAtuhDisabled
TrueRuleChain=100.SMSCProcessingRule
TrueRuleChain=105.SetResponseInfo
TrueRuleChain=110.LogEAPAKAAtuhEnabled
TrueRuleChain=120.UpdateTokenTable


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/100.SMSCProcessingRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=smppOutgoingRuleChain1
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/105.SetResponseInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1220"
AdornOps=set DEG_OEMDevMessageString "Perform EAPAKAAtuh Enable"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/110.LogEAPAKAAtuhEnabled]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEGDROID_OTP
Attributes=DEG_DevAuthTypeString
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_SSL_STATE
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Perform EAPAKAAtuh Enable: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
FalseRuleChain=400.SetAuditTransactionType
TrueRuleChain=100.InitUpdate
TrueRuleChain=200.Update
TrueRuleChain=300.CheckUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/100.InitUpdate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=set DEG_AUTH_COUNT 0
AdornOps=setifnull DEG_BLACKLIST_FLAG 0
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=set DEG_AuditTransactionTypeString "full-auth-init"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1221"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS session store during blacklist processing"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_TOKENS session store during blacklist processing
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1222"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS BLACKLISTED session store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_TOKENS BLACKLISTED session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/400.SetAuditTransactionType]

AdornOps=set DEG_AuditTransactionTypeString "full-auth-init"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/200.SetSessionStatus]

AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "DFT"
AdornOps=set DEG_AUTHENTICATION_TYPE "OTP"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1223"
AdornOps=set DEG_OEMDevErrorMessageString "EAPAKAAtuh Disabled or Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/210.LogEAPAKAAtuhDisabled]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Perform EAPAKAAtuh Disabled:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetSystemTime
RuleNames=110.CheckTokenValidity


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/100.SetSystemTime]

AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_EVENTTIMESTAMP DEG_OEMDevTokenTimeStampDiffLong
AdornOps=set DEG_AuditTransactionTypeString "fast-auth"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenTimeStampDiffLong,<=,DEG_OEMDeviceTokenValidityLong
FalseRuleChain=200.SetErrorInfo
FalseRuleChain=210.ErrorLog
TrueRuleChain=100.SetSessionStatus
TrueRuleChain=200.LogFastPathAuth
TrueRuleChain=300.CheckCounter
TrueRuleChain=400.UpdateAsBlackListed
TrueRuleChain=500.GenerateResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/100.SetSessionStatus]

AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_TYPE "OTP"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "TKN"
AdornOps=+ DEG_AUTH_COUNT 1 DEG_AUTH_COUNT
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1217"
AdornOps=set DEG_OEMDevMessageString "Perform FastPathAuth"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/200.LogFastPathAuth]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_AUTH_COUNT
Attributes=DEG_OEMDevAuthThresholdCountInteger
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Perform FastPathAuth: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/200.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1216"
AdornOps=set DEG_OEMDevErrorMessageString "Network Authentication Required"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/210.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevCurrentTimeStampLong
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_OEMDevTokenTimeStampDiffLong
Attributes=DEG_OEMDeviceTokenValidityLong
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Database Error: Token Expired Network Authentication Required
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/300.CheckCounter]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTH_COUNT,>,DEG_OEMDevAuthThresholdCountInteger
TrueRuleChain=100.SetBlackListed


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/300.CheckCounter/100.SetBlackListed]

AdornOps=set DEG_BLACKLIST_FLAG 1
AdornOps=set DEG_AUTH_COUNT 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/100.InitUpdate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=setifnull DEG_AUTH_COUNT 0
AdornOps=setifnull DEG_BLACKLIST_FLAG 0
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1218"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS session store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_TOKENS session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1219"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS session store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_TOKENS session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/500.GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_BLACKLIST_FLAG,=,1
TrueRuleChain=100.GenerateBlackListedResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/500.GenerateResponse/100.GenerateBlackListedResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=140.DEG30GenerateBlackListedResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateOEMResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse]

AkaRejected=400.AkaRejected_InitResponse
AkaRejected=410.AkaRejected_DeactiveToken
AkaRejected=420.AkaRejected_GenerateResponse
AkaWait=300.AkaWait_SetInitResponse
AkaWait=310.AkaWait_GenerateResponse
Authenticated=500.Authenticated_InitResponse
Authenticated=510.Authenticated_StoreToken
Authenticated=520.Authenticated_InitLookUpAuthXMLTemplate
Authenticated=530.Authenticated_LookUpAuthXMLTemplate
Authenticated=540.Authenticated_LookUpServiceConfigTemplate
Authenticated=550.Authenticated_GenerateResponse
BlacListedSubscriber=200.BlackListedSubscriber_HTTPResponse
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_OTP_CHALLENGE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"OTP_CHALLENGE_REJECTED"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Conditions=DEG_SSL_STATE,starts,"AUTHENTICATED"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE
Operations=None
StatusDisallowed=600.DisallowedAction_InitResponse
TrueRuleChain=UnknownSubscriber
TrueRuleChain=BlacListedSubscriber
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=StatusDisallowed
TrueRuleChain=Authenticated
TrueRuleChain=Unknown
Unknown=700.Unknown_SetHttpErrorResponseTo500C
UnknownSubscriber=100.UnknownSubscriber_HTTPResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/100.UnknownSubscriber_HTTPResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_STATE "UNKNOWN_SUBSCRIBER"
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRespStatusString 403
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/200.BlackListedSubscriber_HTTPResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevRespStatusString 511
AdornOps=set  DEG_SSL_STATE "BLACKLISTED_SUBSCRIBER"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/300.AkaWait_SetInitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "200"
AdornOps=set DEG_OEMDevRespStatusString 200
AdornOps=copy DEGDROID_OTP DEGDROID_OTPString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodePayload
FalseRuleChain=203.InitVariableAuthXMLTemplate
FalseRuleChain=205.LookUpAuthXMLTemplate
FalseRuleChain=215.AssignMessagetoResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/200.EncodePayload]

AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/203.InitVariableAuthXMLTemplate]

AdornOps=set DEGDROID_auth_step_Integer 1
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/205.LookUpAuthXMLTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/210.GenerateResponse]

ClassName=com.hp.usage.rules.transform.MessageFormatRule
Locale=en_US
MessageFormat=DEG_XML_TEMPLATES_FILE
ResultAttribute=DEG_XML_TEMPLATES_FILE
UseDynamicMessageFormat=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/215.AssignMessagetoResponse]

AdornOps=setifnull DEG_XML_TEMPLATES_FILE ""
AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/400.AkaRejected_InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 511
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_TOKENSTATUS "DE"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/410.AkaRejected_DeactiveToken]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/420.AkaRejected_GenerateResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/500.Authenticated_InitResponse]

AdornOps=set DEG_APP_TOKEN_FLAG 1
AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEG_OEMDevRespTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEG_CDevTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEGDROID_SSL_COOKIE_ID
AdornOps=set DEG_AUTHENTICATION_TYPE "OTP"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/510.Authenticated_StoreToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevMobileNumberString
RequestAttributes=DEG_IMSI
RequestAttributes=DEG_CDevTokenString
RequestAttributes=DEG_AUTHENTICATION_TYPE
RequestAttributes=DEG_AUTHENTICATION_SUBTYPE
RequestAttributes=DEG_APP_TOKEN_FLAG
RequestAttributes=DEG_FULLAUTHTIMESTAMP
ResponseAttributes=DEG_OEMDevErrorMessageString
ResponseAttributes=DEG_EVENTTIMESTAMP
RuleChain=005.DEG30StoreTokenRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/520.Authenticated_InitLookUpAuthXMLTemplate]

AdornOps=set DEGDROID_auth_step_Integer 3
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEG_OEMDevRespTokenString
AdornOps=set DEG_TOKEN_VALIDITY_SECONDS ${DEGDROID_DEVICE_TOKEN_VALIDITY}
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/530.Authenticated_LookUpAuthXMLTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/540.Authenticated_LookUpServiceConfigTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.DEG30ProcessServiceConfigurationRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckEAPPayload
RuleNames=150.CheckResponseXMLEmptyAfterServiceConfigProcess


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/100.CheckEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodePayload
TrueRuleChain=100.GenerateNullPayloadResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/100.CheckEAPPayload/100.GenerateNullPayloadResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/100.CheckEAPPayload/200.EncodePayload]

AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/100.CheckEAPPayload/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_XMLTemplateResponseString,!=,""
FalseRuleChain=20.AssignResponseFromAuthConfigTemplate
TrueRuleChain=10.AssignResponseFromServiceConfigTemplate


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess/10.AssignResponseFromServiceConfigTemplate]

AdornOps=copy DEG_XMLTemplateResponseString ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess/20.AssignResponseFromAuthConfigTemplate]

AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/200.MessageFormatXML]

ClassName=com.hp.usage.rules.transform.MessageFormatRule
Locale=en_US
MessageFormat=DEG_XML_TEMPLATES_FILE
ResultAttribute=DEG_XML_TEMPLATES_FILE
UseDynamicMessageFormat=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/250.GenerateResponse]

AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/600.DisallowedAction_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevHttpStatusInteger "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/700.Unknown_SetHttpErrorResponseTo500C]

AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevHttpStatusInteger "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateOTPInitialEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,!=,UNKNOWN_SUBSCRIBER
Description=Unknown Subscriber case already Handled
TrueRuleChain=000.SetTranscationType
TrueRuleChain=100.CheckAuthenticationState


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/000.SetTranscationType]

ClassName=ConditionalRule
Conditions=DEG_OEMDevRequestAttributeString,contains,"IMSI_EAP"
FalseRuleChain=SetTranscationType
TrueRuleChain=SetFullAuthTranscationType


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/000.SetTranscationType/SetFullAuthTranscationType]

AdornOps=set DEG_AuditTransactionTypeString "full-auth-init"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/000.SetTranscationType/SetTranscationType]

AdornOps=set DEG_AuditTransactionTypeString "fast-auth"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState]

AkaRejected=100.GenerateOTPRejectedEndAuditData
AkaWait=200.GenerateOTPWaitEndAuditData
AuthenticatedAAA=300.GenerateOTPSMSCAuthenticatedEndAuditData
AuthenticatedDEGToken=400.GenerateOTPDEGTokenAuthenticatedEndAuditData
BlackListSubscriber=500.GenerateOTPBlackListSubscriberEndAuditData
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_OTP_CHALLENGE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"OTP_CHALLENGE_REJECTED"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_SMSC"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=None
StatusDisallowed=600.GenerateOTPDisallowedActionEndAuditData
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=AuthenticatedAAA
TrueRuleChain=AuthenticatedDEGToken
TrueRuleChain=BlackListSubscriber
TrueRuleChain=StatusDisallowed


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/100.GenerateOTPRejectedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/200.GenerateOTPWaitEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=802.DEG30GenerateOTPWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/300.GenerateOTPSMSCAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/400.GenerateOTPDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"TKN"
FalseRuleChain=200.GenerateOTPDEGTokenAuthenticatedDefaultEndAuditData
TrueRuleChain=100.GenerateOTPDEGTokenAuthenticatedEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/400.GenerateOTPDEGTokenAuthenticatedEndAuditData/100.GenerateOTPDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/400.GenerateOTPDEGTokenAuthenticatedEndAuditData/200.GenerateOTPDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/500.GenerateOTPBlackListSubscriberEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/600.GenerateOTPDisallowedActionEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful Sent to SMSC,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/802.DEG30GenerateOTPWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/802.DEG30GenerateOTPWaitEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/802.DEG30GenerateOTPWaitEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/802.DEG30GenerateOTPWaitEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/802.DEG30GenerateOTPWaitEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/802.DEG30GenerateOTPWaitEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sent EAP-AKA message to Device,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/802.DEG30GenerateOTPWaitEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by DEG_TOKEN,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=setifnull DEG_OEMDevErrorMessageString ""
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by default,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "503"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Authentication attempt rejected,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_CDevOutReturnCodeString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "BlackListed Subscriber,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Status Disallowed Action,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core]


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains]

RuleChainNames=350.DEG30ProcessOTPAuthStep2RuleChain
RuleChainNames=350A.DEG30ProcessOTPActionRuleChain
RuleChainNames=350B.DEG30UpdateSslSessionStateRuleChain
RuleChainNames=350C.DEG30ValidateAndProcessOTPRuleChain
RuleChainNames=350D.DEG30GenerateOEMResponseRuleChain
RuleChainNames=350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain
RuleChainNames=350F.DEG30ProcessOTPRuleChain
RuleChainNames=851.DEG30GenerateOTPChallengeStartAuditDataRuleChain
RuleChainNames=852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain
RuleChainNames=853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain
RuleChainNames=854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
RuleChainNames=855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain
RuleChainNames=856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain
RuleChainNames=857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckOTPValue
RuleNames=200.GenerateOTPPayloadEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevOTPLong,=,99999
FalseRuleChain=120.ValidationAndProcessOTP
FalseRuleChain=130.SetResponseHandler
TrueRuleChain=200.Set400Error
TrueRuleChain=170.SetResponseHandler
TrueRuleChain=180.SetErrorInfo
TrueRuleChain=220.LogError


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/120.ValidationAndProcessOTP]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350A.DEG30ProcessOTPActionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/130.SetResponseHandler]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,starts,200
FalseRuleChain=200.SetEmptyResponse
TrueRuleChain=100.SetTextResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/130.SetResponseHandler/100.SetTextResponse]

AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"
AdornOps=set DEG_OEMDevConnectionString "close"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/130.SetResponseHandler/200.SetEmptyResponse]

AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/170.SetResponseHandler]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,starts,200
FalseRuleChain=200.SetEmptyResponse
TrueRuleChain=100.SetTextResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/170.SetResponseHandler/100.SetTextResponse]

AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"
AdornOps=set DEG_OEMDevConnectionString "close"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/170.SetResponseHandler/200.SetEmptyResponse]

AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/180.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1401"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid Action -OTPPayload expected"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/200.Set400Error]

AdornOps=set DEG_SSL_REQUEST_STATE "400C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/100.CheckOTPValue/220.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevOTPLong
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Request processed with error - Invalid Action - OTPPayload expected: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/200.GenerateOTPPayloadEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,1
TrueRuleChain=100.AuthenticationSMACRejected


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350.DEG30ProcessOTPAuthStep2RuleChain/200.GenerateOTPPayloadEndAuditData/100.AuthenticationSMACRejected]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.UpdateSslSessionState
RuleNames=210.CheckOTP
RuleNames=215.SetAuditTransactionType
RuleNames=220.LogOTPChallengeWait
RuleNames=400.GenerateOEMResponse
RuleNames=230.InitSslSessionAfterEAPAKA
RuleNames=300.UpdateSslSessionAfterEAPAKA
RuleNames=310.CheckSslSessionUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/110.UpdateSslSessionState]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350B.DEG30UpdateSslSessionStateRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/210.CheckOTP]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350C.DEG30ValidateAndProcessOTPRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/215.SetAuditTransactionType]

AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1402"
AdornOps=set DEG_OEMDevMessageString "Perform OTPChallengefor AkaWait"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/220.LogOTPChallengeWait]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Perform OTPChallengefor AkaWait: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/230.InitSslSessionAfterEAPAKA]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=setifnull DEGDROID_SSL_COOKIE_ID ""
AdornOps=setifnull DEGDROID_SSL_OTP 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/300.UpdateSslSessionAfterEAPAKA]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEGDROID_SSL_COOKIE_ID,DEGDROID_SSL_COOKIE_ID
MapAttributes=DEGDROID_SSL_OTP,DEGDROID_SSL_OTP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorMessage
TrueRuleChain=110.LogError


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus/100.SetErrorMessage]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1403"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_SSL_SESSION store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus/110.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus/120.GenerateEapAkaPayloadSystemErrorEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.GenerateAuditData


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus/120.GenerateEapAkaPayloadSystemErrorEndAuditData/100.GenerateAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorMessage
TrueRuleChain=110.LogError


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.SetErrorMessage]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1404"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/310.CheckSslSessionUpdateStatus/200.CheckKeyExists/110.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/400.GenerateOEMResponse]

CheckTypeOfResponse=100.CheckTypeOfResponse
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
GenerateEAPAkaPayloadEndAuditData=200.GenerateEAPAkaPayloadEndAuditData
Operations=DoAll
TrueRuleChain=CheckTypeOfResponse
TrueRuleChain=GenerateEAPAkaPayloadEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/400.GenerateOEMResponse/100.CheckTypeOfResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350D.DEG30GenerateOEMResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350A.DEG30ProcessOTPActionRuleChain/400.GenerateOEMResponse/200.GenerateEAPAkaPayloadEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=210.GetActiveMonitoringSessionsByIMSI
RuleNames=220.GetActiveMonitoringSessionsByMDN
RuleNames=300.GenerateEAPAKAPayloadStartAuditData
RuleNames=350.InitSslSessionUpdate
RuleNames=400.ExecuteSslSessionUpdate
RuleNames=410.CheckSslSessionUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/100.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_STATE WAIT_FOR_OTP_CHALLENGE_CHECK_FROM_DEG
AdornOps=copy DEG_SSL_NAI DEG_OEMDevSubscriberIdString
AdornOps=copy DEG_SSL_IMSI DEG_OEMDevImsiString
AdornOps=copy DEG_SSL_IMSI DEG_IMSI
AdornOps=copy DEG_SSL_MDN DEG_CDevMobileNumberString
AdornOps=copy DEG_SSL_MDN DEG_MDN
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/210.GetActiveMonitoringSessionsByIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitVariables
TrueRuleChain=110.CheckIfMonitoredSession


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/210.GetActiveMonitoringSessionsByIMSI/100.InitVariables]

AdornOps=copy DEG_IMSI DEG_MSESSIONKEY
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/210.GetActiveMonitoringSessionsByIMSI/110.CheckIfMonitoredSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessions


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/220.GetActiveMonitoringSessionsByMDN]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitVariables
TrueRuleChain=110.CheckIfMonitoredSession


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/220.GetActiveMonitoringSessionsByMDN/100.InitVariables]

AdornOps=copy DEG_MDN DEG_MSESSIONKEY
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/220.GetActiveMonitoringSessionsByMDN/110.CheckIfMonitoredSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessions


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/300.GenerateEAPAKAPayloadStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=851.DEG30GenerateOTPChallengeStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/350.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/400.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1406"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1407"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to find the row in DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVariables
RuleNames=200.CheckSubscriberIdentity


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/100.InitVariables]

AdornOps=set DEG_DevSubscriberIdentityString ${DEGDROID_SUBSCRIBER_IDENTITY}
AdornOps=lower DEG_DevSubscriberIdentityString DEG_DevSubscriberIdentityString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_DevSubscriberIdentityString,=,"msisdn"
Conditions=DEG_DevSubscriberIdentityString,=,"imsi"
Conditions=DEG_DevSubscriberIdentityString,=,DEG_DevSubscriberIdentityString
LookupByIMSI=200.InitSslSessionLookup
LookupByIMSI=210.ExecuteSslSessionLookup
LookupByIMSI=220.CheckSslSessionLookupStatus
LookupByMSISDN=100.InitSslSessionLookup
LookupByMSISDN=110.ExecuteSslSessionLookup
LookupByMSISDN=120.CheckSslSessionLookupStatus
Operations=None
TrueRuleChain=LookupByMSISDN
TrueRuleChain=LookupByIMSI
TrueRuleChain=UnknownSubscriberIdentity
UnknownSubscriberIdentity=250.SetErrorInfo
UnknownSubscriberIdentity=300.UnknownIdentityLog
UnknownSubscriberIdentity=310.SetSSLRequestState_500


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/100.InitSslSessionLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=setifnull DEGDROID_OTP 0
AdornOps=copy DEGDROID_OTP DEGDROID_SSL_OTP
AdornOps=copy DEG_MDN DEG_SSL_MDN
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/110.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEGDROID_SSL_OTP,DEGDROID_SSL_OTP
NativeCondition=MatchByMDN
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/120.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350F.DEG30ProcessOTPRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/200.InitSslSessionLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=copy DEG_OEMDevImsiString DEG_SSL_IMSI
AdornOps=setifnull DEGDROID_OTP 0
AdornOps=copy DEGDROID_OTP DEGDROID_SSL_OTP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/210.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEGDROID_SSL_OTP,DEGDROID_SSL_OTP
NativeCondition=MatchByIMSI
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/220.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350F.DEG30ProcessOTPRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/250.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1408"
AdornOps=set DEG_OEMDevErrorMessageString "Unknown Subscriber Identity"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/300.UnknownIdentityLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_SSL_MDN
Attributes=DEG_SSL_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Unknown Subscriber Identity:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350C.DEG30ValidateAndProcessOTPRuleChain/200.CheckSubscriberIdentity/310.SetSSLRequestState_500]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckResponseType


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType]

AkaRejected=300.AkaRejected_InitResponse
AkaRejected=310.AkaRejected_DeactiveToken
AkaRejected=320.AkaRejected_GenerateResponse
AkaWait=200.AkaWait_InitResponse
AkaWait=201.AkaWait_GetResponseTemplate
AkaWait=210.AkaWait_GenerateResponse
Authenticated=400.Authenticated_InitResponse
Authenticated=401.Authenticated_GetResponseTemplate
Authenticated=410.Authenticated_TokenLookupForDFTCase
Authenticated=420.Authenticated_StoreToken
Authenticated=425.Authenticated_ResponseCustomization
Authenticated=430.Authenticated_ServiceConfiguration
Authenticated=440.Authenticated_GenerateResponse
BlackListedSubscriber=120.BlackListedSubscriber_InitResponse
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"OTP_CHALLENGE_REJECTED"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Conditions=DEG_SSL_STATE,starts,"AUTHENTICATED"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE
Operations=None
StatusDisallowed=600.DisallowedAction_InitResponse
TrueRuleChain=UnknownSubscriber
TrueRuleChain=BlackListedSubscriber
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=StatusDisallowed
TrueRuleChain=Authenticated
TrueRuleChain=Unknown
Unknown=500.Unknown_SetHttpErrorResponseTo500C
UnknownSubscriber=100.UnknownSubscriber_InitResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/100.UnknownSubscriber_InitResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_STATE "UNKNOWN_SUBSCRIBER"
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRespStatusString 403
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/120.BlackListedSubscriber_InitResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevRespStatusString 511
AdornOps=set  DEG_SSL_STATE "BLACKLISTED_SUBSCRIBER"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/200.AkaWait_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "200"
AdornOps=set DEG_OEMDevRespStatusString 200
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/210.AkaWait_GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodePayload
FalseRuleChain=203.InitVariableAuthXMLTemplate
FalseRuleChain=205.LookUpAuthXMLTemplate
FalseRuleChain=210.GenerateResponse
FalseRuleChain=215.AssignMessagetoResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/210.AkaWait_GenerateResponse/200.EncodePayload]

AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/210.AkaWait_GenerateResponse/203.InitVariableAuthXMLTemplate]

AdornOps=set DEGDROID_auth_step_Integer 1
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/210.AkaWait_GenerateResponse/205.LookUpAuthXMLTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/210.AkaWait_GenerateResponse/210.GenerateResponse]

ClassName=com.hp.usage.rules.transform.MessageFormatRule
Locale=en_US
MessageFormat=DEG_XML_TEMPLATES_FILE
ResultAttribute=DEG_XML_TEMPLATES_FILE
UseDynamicMessageFormat=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/210.AkaWait_GenerateResponse/215.AssignMessagetoResponse]

AdornOps=setifnull DEG_XML_TEMPLATES_FILE ""
AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/210.AkaWait_GenerateResponse/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/300.AkaRejected_InitResponse]

AdornOps=set DEG_TOKENSTATUS "DE"
AdornOps=set DEG_OEMDevRespStatusString 511
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/310.AkaRejected_DeactiveToken]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/320.AkaRejected_GenerateResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/400.Authenticated_InitResponse]

AdornOps=set DEG_APP_TOKEN_FLAG 1
AdornOps=set DEGDROID_auth_step_Integer 2
AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEG_OEMDevRespTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEG_CDevTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEGDROID_SSL_COOKIE_ID
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP
AdornOps=set DEG_AUTHENTICATION_TYPE "OTP"
AdornOps=set DEG_TOKEN_VALIDITY_SECONDS ${DEGDROID_DEVICE_TOKEN_VALIDITY}
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/401.Authenticated_GetResponseTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
Conditions=DEG_AUTHENTICATION_TYPE,=,"OTP"
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"DFT"
Operations=and,and
TrueRuleChain=100.InitValues
TrueRuleChain=110.Lookup
TrueRuleChain=120.CheckLookupStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/100.InitValues]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=copy DEG_MDN DEG_CDevMobileNumberString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/110.Lookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckTokenExist
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1405"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEG_TOKENS table"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_TOKENS table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/120.GeneratePostChallengeSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/200.CheckTokenExist]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
FalseRuleChain=200.SetAuthTimesTamp


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/200.CheckTokenExist/200.SetAuthTimesTamp]

AdornOps=setsystime DEG_FULLAUTHTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/420.Authenticated_StoreToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevMobileNumberString
RequestAttributes=DEG_IMSI
RequestAttributes=DEG_CDevTokenString
RequestAttributes=DEG_AUTHENTICATION_TYPE
RequestAttributes=DEG_AUTHENTICATION_SUBTYPE
RequestAttributes=DEG_APP_TOKEN_FLAG
RequestAttributes=DEG_FULLAUTHTIMESTAMP
ResponseAttributes=DEG_OEMDevErrorMessageString
ResponseAttributes=DEG_EVENTTIMESTAMP
RuleChain=005.DEG30StoreTokenRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/425.Authenticated_ResponseCustomization]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=180.ProcessResponseAttributeCustomization
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/430.Authenticated_ServiceConfiguration]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.DEG30ProcessServiceConfigurationRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckEAPPayload
RuleNames=150.CheckResponseXMLEmptyAfterServiceConfigProcess


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse/100.CheckEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodePayload
TrueRuleChain=100.GenerateNullPayloadResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse/100.CheckEAPPayload/100.GenerateNullPayloadResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse/100.CheckEAPPayload/200.EncodePayload]

AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse/100.CheckEAPPayload/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_XMLTemplateResponseString,!=,""
FalseRuleChain=20.AssignResponseFromAuthConfigTemplate
TrueRuleChain=10.AssignResponseFromServiceConfigTemplate


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess/10.AssignResponseFromServiceConfigTemplate]

AdornOps=copy DEG_XMLTemplateResponseString ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess/20.AssignResponseFromAuthConfigTemplate]

AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/500.Unknown_SetHttpErrorResponseTo500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350D.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/600.DisallowedAction_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevHttpStatusInteger "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateEAPAKAPayloadEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData]

AkaRejected=100.GenerateOPTChallengeRejectedEndAuditData
AkaWait=200.GenerateOTPChallengeWaitEndAuditData
AuthenticatedAAA=300.GenerateOTPChallengeAuthenticatedEndAuditData
AuthenticatedDEGToken=400.GenerateOPTDEGTokenAuthenticatedDefaultEndAuditData
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_OTP_CHALLENGE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"OTP_CHALLENGE_REJECTED"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_SMSC"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=None
StatusDisallowed=500.GenerateOTPChallengedDisallowedActionEndAuditData
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=AuthenticatedAAA
TrueRuleChain=AuthenticatedDEGToken
TrueRuleChain=StatusDisallowed


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/100.GenerateOPTChallengeRejectedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/200.GenerateOTPChallengeWaitEndAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/300.GenerateOTPChallengeAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/400.GenerateOPTDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350E.DEG30GeneratOTPPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/500.GenerateOTPChallengedDisallowedActionEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckSslSessionLookupStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckIfSessionKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEG_SSL_SESSION table"
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1409"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEGDROID_SSL_OTP
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_SSL_SESSION table: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
FalseRuleChain=200.RecordFound
TrueRuleChain=100.RecordNotFound


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/100.RecordNotFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorInfo
RuleNames=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/100.RecordNotFound/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "Unable to get the record from DEG_SSL_SESSION table"
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1410"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/100.RecordNotFound/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEGDROID_SSL_OTP
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to get the record from DEG_SSL_SESSION table: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckDBOTP


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEGDROID_SSL_OTP,=,0
FalseRuleChain=100.CompareOTPWithRequestOTP
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP/100.CompareOTPWithRequestOTP]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEGDROID_SSL_OTP,=,DEG_OEMDevOTPLong
FalseRuleChain=100.SetErrorInfo
FalseRuleChain=110.ErrorLog
TrueRuleChain=100.SetSSLState
TrueRuleChain=110.LogResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP/100.CompareOTPWithRequestOTP/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "Forbidden response"
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_SSL_STATE "OTP_CHALLENGE_REJECTED"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1412"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP/100.CompareOTPWithRequestOTP/100.SetSSLState]

AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_TYPE "OTP"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "EAP"
AdornOps=setsystime DEG_FULLAUTHTIMESTAMP
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1413"
AdornOps=set DEG_OEMDevMessageString "DEGDROID_SSL_OTP is Same from the request OTP"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP/100.CompareOTPWithRequestOTP/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEGDROID_SSL_OTP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_MDN
Attributes=DEG_IMSI
ClassName=LogNMERule
LogLevel=INFO
Message=DEGDROID_SSL_OTP is different from the request OTP:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP/100.CompareOTPWithRequestOTP/110.LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEGDROID_SSL_OTP
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=INFO
Message=DEGDROID_SSL_OTP is Same from the request OTP:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "DEGDROID_SSL_OTP is null from DEG_SSL_SESSION table"
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1411"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/350F.DEG30ProcessOTPRuleChain/100.CheckSslSessionLookupStatus/200.CheckIfSessionKeyExists/200.RecordFound/100.CheckDBOTP/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEGDROID_SSL_OTP
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=WARNING
Message=Database Error: DEGDROID_SSL_OTP is null from DEG_SSL_SESSION table: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/851.DEG30GenerateOTPChallengeStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/851.DEG30GenerateOTPChallengeStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=copy DEG_CDevProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/851.DEG30GenerateOTPChallengeStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Received "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/851.DEG30GenerateOTPChallengeStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/851.DEG30GenerateOTPChallengeStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/851.DEG30GenerateOTPChallengeStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by AAA,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/852.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sent EAP-AKA message to Device,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/853.DEG30GenerateOTPChallengeWaitEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by default,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/854.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "503"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Authentication attempt rejected,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_CDevOutReturnCodeString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/855.DEG30GenerateOTPChallengeRejectedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/856.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Status Disallowed Action,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Challenge_Core/RuleChains/857.DEG30GenerateOTPChallengeDisallowedActionEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core]


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains]

RuleChainNames=150.DEG30RCSInitialConnectRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.SetUniqueIdTonull
RuleNames=002.GenerateStartAuditDataRuleChain
RuleNames=100.RequestAttributeConditionCheck
RuleNames=200.CallRCSCustomTemplate
RuleNames=300.GenerateEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/001.SetUniqueIdTonull]

AdornOps=set DEG_OEMDevUniqueIDString ""
AdornOps=set DEG_AuditTransactionTypeString "initial-connect"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/002.GenerateStartAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestAttributeString,!=,""
FalseRuleChain=100.InitVariables
FalseRuleChain=200.CheckSubscriberIdentity
FalseRuleChain=300.LogNMERule
TrueRuleChain=100.SetErrorResponse


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/100.InitVariables]

AdornOps=set DEG_DevSubscriberIdentityString ${DEGDROID_SUBSCRIBER_IDENTITY}
AdornOps=lower DEG_DevSubscriberIdentityString DEG_DevSubscriberIdentityString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/100.SetErrorResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger 403
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevOutReturnCodeString "403"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1601"
AdornOps=set DEG_OEMDevMessageString "Coming Out from RCS_Initial_Connect_Core"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_DevSubscriberIdentityString,=,"msisdn"
Conditions=DEG_DevSubscriberIdentityString,=,"imsi"
Conditions=DEG_DevSubscriberIdentityString,=,DEG_DevSubscriberIdentityString
Operations=None
Processimsi=200.SetSuccessResponse
Processimsi=203.SetErrorInfo
Processimsi=210.SuccesLog
Processmsisdn=100.CheckForHeaderMSISDNString
ProcessUnknownSubscriberIndentity=300.SetUnknownResponse
ProcessUnknownSubscriberIndentity=310.SetUnknownLog
TrueRuleChain=Processmsisdn
TrueRuleChain=Processimsi
TrueRuleChain=ProcessUnknownSubscriberIndentity


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/100.CheckForHeaderMSISDNString]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevMsisdnString,=,dummy
FalseRuleChain=200.CheckForMSISDN
FalseRuleChain=210.CheckSubscriberKNOWN
TrueRuleChain=100.SetSuccessResponse
TrueRuleChain=106.SetErrorInfo
TrueRuleChain=110.SuccesLog


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/100.CheckForHeaderMSISDNString/100.SetSuccessResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_CDevOutReturnCodeString "1"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/100.CheckForHeaderMSISDNString/106.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1602"
AdornOps=set DEG_OEMDevMessageString "Request processed Successfully.In case of initial Connect"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/100.CheckForHeaderMSISDNString/110.SuccesLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Request processed Successfully : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/100.CheckForHeaderMSISDNString/120.GenerateRCSInitialConnectEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/100.CheckForHeaderMSISDNString/200.CheckForMSISDN]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400C.ProcessReadSubscribertableRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/100.CheckForHeaderMSISDNString/210.CheckSubscriberKNOWN]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
FalseRuleChain=210.150.SetErrorResponse
FalseRuleChain=210.154.SetErrorInfo
FalseRuleChain=210.160.SetErrorLog
TrueRuleChain=210.100.SetSuccessResponse
TrueRuleChain=210.107.SetErrorInfo
TrueRuleChain=210.110.SuccesLog


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/100.CheckForHeaderMSISDNString/210.CheckSubscriberKNOWN/210.100.SetSuccessResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_CDevOutReturnCodeString "1"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/100.CheckForHeaderMSISDNString/210.CheckSubscriberKNOWN/210.107.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1603"
AdornOps=set DEG_OEMDevMessageString "Request processed Successfully for imsi and KNOWN IMSI.In case of initial Connect"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/100.CheckForHeaderMSISDNString/210.CheckSubscriberKNOWN/210.110.SuccesLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Request processed Successfully for imsi and KNOWN IMSI :::
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/100.CheckForHeaderMSISDNString/210.CheckSubscriberKNOWN/210.120.GenerateRCSInitialConnectEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/100.CheckForHeaderMSISDNString/210.CheckSubscriberKNOWN/210.150.SetErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "503C"
AdornOps=set ResponseHeaderRetryAfterInteger ${DEGDROID_DEVICE_HTTP_RETRY_WINDOW}
AdornOps=set DEG_CDevOutReturnCodeString "503"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/100.CheckForHeaderMSISDNString/210.CheckSubscriberKNOWN/210.154.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1604"
AdornOps=set DEG_OEMDevMessageString "Request processed Successfully for imsi and UNKNOWN IMSI and RCS logic Throwing RETRY -AFTER 503 error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/100.CheckForHeaderMSISDNString/210.CheckSubscriberKNOWN/210.160.SetErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_DevAuthTypeString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Request processed Successfully for imsi and UNKNOWN IMSI and RCS logic Throwing RETRY -AFTER 503 error :::
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/100.CheckForHeaderMSISDNString/210.CheckSubscriberKNOWN/210.170.GenerateRCSInitialConnectEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/200.SetSuccessResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_CDevOutReturnCodeString "1"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/203.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1605"
AdornOps=set DEG_OEMDevMessageString "Request processed Successfully for imsi.In case of initial Connect"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/210.SuccesLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Request processed Successfully for imsi.
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/220.GenerateRCSInitialConnectEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/300.SetUnknownResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevHttpStatusInteger 403
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1606"
AdornOps=set DEG_OEMDevErrorMessageString "DEGDROID_SUBSCRIBER_IDENTITY should be IMSI or MSISDN"
AdornOps=set DEG_CDevOutReturnCodeString "403"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevUniqueIDString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/200.CheckSubscriberIdentity/310.SetUnknownLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Action processed with error - DEGDROID_SUBSCRIBER_IDENTITY is not IMSI/MSISDN:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/100.RequestAttributeConditionCheck/300.LogNMERule]

Attributes=DEG_OEMDevMsisdnString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Coming Out from RCS_Initial_Connect_Core :::
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/200.CallRCSCustomTemplate]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,=,"200C"
TrueRuleChain=InvokeRCSCustomTemplate


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/200.CallRCSCustomTemplate/InvokeRCSCustomTemplate]

ClassName=RuleChain
RuleNames=100.CopyAttributesBeforeCustomCall
RuleNames=200.CallForRCSCustom
RuleNames=300.CopyAttributesAfterCustomCall
RuleNames=400.SetDEGSSLState


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/200.CallRCSCustomTemplate/InvokeRCSCustomTemplate/100.CopyAttributesBeforeCustomCall]

AdornOps=setifnull DEG_OEMDevRequestURIString ""
AdornOps=setifnull DEG_OEMDevRequestAttributeString ""
AdornOps=setifnull CUST_DDRCS_OUT_RespHttpStatusInteger 0
AdornOps=copy DEG_OEMDevRequestURIString CUST_DDRCS_IN_RequestURIString
AdornOps=copy DEG_OEMDevRequestAttributeString CUST_DDRCS_IN_RequestAttributeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/200.CallRCSCustomTemplate/InvokeRCSCustomTemplate/200.CallForRCSCustom]

ClassName=LocalRuleChainInvoker
RuleChain=CUSTRC_RCSInitialConnectCustomize
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/200.CallRCSCustomTemplate/InvokeRCSCustomTemplate/300.CopyAttributesAfterCustomCall]

AdornOps=copy CUST_DDRCS_IN_RequestURIString DEG_OEMDevRequestURIString
AdornOps=copy CUST_DDRCS_IN_RequestAttributeString DEG_OEMDevRequestAttributeString
AdornOps=copy CUST_DDRCS_OUT_RespHttpStatusInteger DEG_OEMDevHttpStatusInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/200.CallRCSCustomTemplate/InvokeRCSCustomTemplate/400.SetDEGSSLState]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevHttpStatusInteger,=,"403"
TrueRuleChain=100.SetSSLState


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/200.CallRCSCustomTemplate/InvokeRCSCustomTemplate/400.SetDEGSSLState/100.SetSSLState]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_CDevOutReturnCodeString "403"
AdornOps=set DEG_OEMDevErrorMessageString "Request processed with http status as 403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/300.GenerateEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,!=,"403C"
TrueRuleChain=100.GenerateEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Core/RuleChains/150.DEG30RCSInitialConnectRuleChain/300.GenerateEndAuditDataRuleChain/100.GenerateEndAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Customize]


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Customize/RuleChains]

RuleChainNames=CUSTRC_RCSInitialConnectCustomize


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Customize/RuleChains/CUSTRC_RCSInitialConnectCustomize]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogNMERule


[/templates/DEG/DEGDROID_DeviceInterface/RCS_Initial_Connect_Customize/RuleChains/CUSTRC_RCSInitialConnectCustomize/100.LogNMERule]

Attributes=CUST_DDRCS_IN_RequestURIString
Attributes=CUST_DDRCS_IN_RequestAttributeString
Attributes=CUST_DDRCS_OUT_RespHttpStatusInteger
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Calling RCS Initial connect custom template...
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Response_Post_Process_Customize]


[/templates/DEG/DEGDROID_DeviceInterface/Response_Post_Process_Customize/RuleChains]

RuleChainNames=CUSTRC_Android_Response_Custom_Values


[/templates/DEG/DEGDROID_DeviceInterface/Response_Post_Process_Customize/RuleChains/CUSTRC_Android_Response_Custom_Values]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogNMERule16


[/templates/DEG/DEGDROID_DeviceInterface/Response_Post_Process_Customize/RuleChains/CUSTRC_Android_Response_Custom_Values/100.LogNMERule16]

Attributes=CUST_DDRPP_IN_SslSessionIdString
Attributes=CUST_DDRPP_IN_AuthTypeString
Attributes=CUST_DDRPP_IN_IMSIString
Attributes=CUST_DDRPP_OUT_Status
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Entered inside Android response custom rule chain::
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core]


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains]

ClassName=com.hp.siu.sessionserver.RuleChainManager
RuleChainNames=600.DEG30ProcessServiceConfigurationRuleChain
RuleChainNames=610.LookupServiceTemplate
RuleChainNames=620.CallandAppendServiceXML
RuleChainNames=640.DEG30AndroidVoWiFiCoreRuleChain
RuleChainNames=650.DEGAndroidVoLTECoreRuleChain
RuleChainNames=CUSTRC_Android_VOWIFI_Status_URL_PostData
RuleChainNames=CUSTRC_Android_VOLTE_Entitlement_Status
RuleChainNames=CUSTRC_Android_SIPToCarrier
RuleChainNames=CallResponseXMLCustomize
RuleChainNames=CUSTRC_ResponseXMLCustomize
RuleChainNames=502.GenerateServiceStartAuditDataRuleChain
RuleChainNames=710.GenerateServiceEndOKAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/502.GenerateServiceStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/502.GenerateServiceStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=copy DEG_CDevProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "auth-and-service-config-request"
AdornOps=copy DEG_AuditTransactionTypeString DEG_AuditTransactionTypeStringtemp
AdornOps=copy DEG_OEMDevServiceNameString DEG_AuditEntitlementNameString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/502.GenerateServiceStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "Android DEVICE TO DEG -> Service request received: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/502.GenerateServiceStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/502.GenerateServiceStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/502.GenerateServiceStartAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=00.InitVariables
RuleNames=10.LogNMERule
RuleNames=20.ProcessAction


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/00.InitVariables]

AdornOps=setsystime DEG_CDevProcessStartTimeLong
AdornOps=setifnull DEG_OEMDevServiceNameString ""
AdornOps=setifnull DEG_Common_XMLTemplateString ""
AdornOps=setifnull DEG_VoWiFi_XMLTemplateString ""
AdornOps=setifnull DEG_VoLTE_XMLTemplateString ""
AdornOps=setifnull DEG_DevIdentity_XMLTemplateString ""
AdornOps=set DEG_OEMDevServiceNameCountInteger 0
AdornOps=set DEG_OEMDevServiceNameInValidCountInteger 0
AdornOps=set DEG_OEMDevAndroidTempString "</wap-provisioningdoc>"
AdornOps=set DEG_OEMDevAndroidVoLTEErrorFlagInteger 0
AdornOps=set DEG_OEMDevAndroidVoWiFiErrorFlagInteger 0
AdornOps=set DEG_OEMDevServiceNameTempString ""
AdornOps=set DEG_OEMDevServiceXMLTemplateExistsInteger 0
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1801"
AdornOps=set DEG_OEMDevMessageString "DEGRIOD NEW REQUEST:INSIDE SERVICE CONFIG TEMPLATE"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/10.LogNMERule]

Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=DEGRIOD NEW REQUEST:INSIDE SERVICE CONFIG TEMPLATE :


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction]

ClassName=ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestAttributeString,contains,"service_name"
Operations=and
TrueRuleChain=10.CheckServiceName


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GetValidInvalidCount
RuleNames=110.RemoveCommaFromServiceNameString
RuleNames=120.Log
RuleNames=200.CheckServiceNamesCount
RuleNames=300.GetServiceXMLTemplates
RuleNames=400.CreateResponseMessage


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/100.GetValidInvalidCount]

ClassName=ListAttributeIterator
ListAttributeName=DEG_OEMDevServiceNameList
RuleChain=GetInvalidCount
RuleChain=GetTotalCount
RuleChain=CreateServicesNameString
TmpAttributeName=DEG_OEMDevServiceNameString


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/100.GetValidInvalidCount/CreateServicesNameString]

AdornOps=+ DEG_OEMDevServiceNameTempString DEG_OEMDevServiceNameString DEG_OEMDevServiceNameTempString
AdornOps=+ DEG_OEMDevServiceNameTempString , DEG_OEMDevServiceNameTempString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/100.GetValidInvalidCount/GetInvalidCount]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevServiceNameString,=,VoWiFi
Conditions=DEG_OEMDevServiceNameString,=,VoLTE
Conditions=DEG_OEMDevServiceNameString,=,Device_Identity
FalseRuleChain=SetInValidServiceNameCount
Operations=or,or


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/100.GetValidInvalidCount/GetInvalidCount/SetInValidServiceNameCount]

AdornOps=+ DEG_OEMDevServiceNameInValidCountInteger 1 DEG_OEMDevServiceNameInValidCountInteger
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/100.GetValidInvalidCount/GetTotalCount]

AdornOps=+ DEG_OEMDevServiceNameCountInteger 1 DEG_OEMDevServiceNameCountInteger
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/110.RemoveCommaFromServiceNameString]

AdornOps=substr 0 length-1 DEG_OEMDevServiceNameTempString DEG_OEMDevServiceNameTempString
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1811"
AdornOps=set DEG_OEMDevMessageString "Received Service Request"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/120.Log]

Attributes=DEG_OEMDevServiceNameTempString
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSourceIPAddressString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Received Android Service request: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/200.CheckServiceNamesCount]

ClassName=ConditionalRule
Conditions=DEG_OEMDevServiceNameCountInteger,=,DEG_OEMDevServiceNameInValidCountInteger
FalseRuleChain=200.CheckCountNotMatching
TrueRuleChain=100.SetErrorResponse
TrueRuleChain=101.StartAudit
TrueRuleChain=110.LogInvalidServiceNames


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/200.CheckServiceNamesCount/100.SetErrorResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "Service name/s in the request is/are invalid"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1802"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/200.CheckServiceNamesCount/101.StartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=502.GenerateServiceStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/200.CheckServiceNamesCount/110.LogInvalidServiceNames]

AAttributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevServiceNameCountInteger
Attributes=DEG_OEMDevServiceNameInValidCountInteger
Attributes=DEG_OEMDevServiceNameList
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestProcessedInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_CDevOutReturnCodeString
ClassName=LogNMERule
LogLevel=WARNING
Message=Action processed with error: Service name/s in the request is/are invalid : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/200.CheckServiceNamesCount/200.CheckCountNotMatching]

ClassName=ConditionalRule
Conditions=DEG_OEMDevServiceNameInValidCountInteger,!=,0
Conditions=DEG_OEMDevServiceNameInValidCountInteger,<,DEG_OEMDevServiceNameCountInteger
Operations=and
TrueRuleChain=100.SetLogInfo
TrueRuleChain=100.LogInvalidServiceName


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/200.CheckServiceNamesCount/200.CheckCountNotMatching/100.LogInvalidServiceName]

Attributes=DEG_OEMDevServiceNameCountInteger
Attributes=DEG_OEMDevServiceNameInValidCountInteger
Attributes=DEG_OEMDevServiceNameList
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevServiceNameString
ClassName=LogNMERule
LogLevel=WARNING
Message=Service name/s in the request is/are invalid : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/200.CheckServiceNamesCount/200.CheckCountNotMatching/100.SetLogInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1803"
AdornOps=set DEG_OEMDevErrorMessageString "Service name/s in the request is/are invalid"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/300.GetServiceXMLTemplates]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CallandAppendServiceTemplate
RuleNames=200.AppendServiceXML


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/300.GetServiceXMLTemplates/100.CallandAppendServiceTemplate]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=10.Call


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/300.GetServiceXMLTemplates/100.CallandAppendServiceTemplate/10.Call]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=620.CallandAppendServiceXML
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/300.GetServiceXMLTemplates/200.AppendServiceXML]

ClassName=ConditionalRule
Conditions=DEG_Common_XMLTemplateString,!=,""
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Operations=and
TrueRuleChain=100.SetCommonXMLTemplate
TrueRuleChain=200.AddServiceTemplatetoList
TrueRuleChain=300.FormFinalServiceXML


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/300.GetServiceXMLTemplates/200.AppendServiceXML/100.SetCommonXMLTemplate]

AdornOps=indexof DEG_OEMDevAndroidTempString DEG_Common_XMLTemplateString DEG_CommonXMLTemplateIndexInteger
AdornOps=- DEG_CommonXMLTemplateIndexInteger 1 DEG_CommonXMLTemplateIndexInteger
AdornOps=substr 0 DEG_CommonXMLTemplateIndexInteger DEG_Common_XMLTemplateString DEG_Common_XMLTemplateString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/300.GetServiceXMLTemplates/200.AppendServiceXML/200.AddServiceTemplatetoList]

ClassName=ListAttributeIterator
ListAttributeName=DEG_OEMDevServiceNameList
RuleChain=CreateXML
TmpAttributeName=DEG_OEMDevServiceNameString


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/300.GetServiceXMLTemplates/200.AppendServiceXML/200.AddServiceTemplatetoList/CreateXML]

AppendDevIdentityServiceXML=330.AppendDevIdentityServiceXML
AppendDevIdentityServiceXML=110.GenerateServiceEndAudit
AppendVoLTEServiceXML=200.AppendVoLTEServiceXML
AppendVoLTEServiceXML=110.GenerateServiceEndAudit
AppendVoWiFiServiceXML=100.AppendVoWiFiServiceXML
AppendVoWiFiServiceXML=110.GenerateServiceEndAudit
ClassName=SwitchConditionRule
Conditions=DEG_OEMDevServiceNameString,=,VoWiFi
Conditions=DEG_OEMDevServiceNameString,=,VoLTE
Conditions=DEG_OEMDevServiceNameString,=,Device_Identity
Operations=None
TrueRuleChain=AppendVoWiFiServiceXML
TrueRuleChain=AppendVoLTEServiceXML
TrueRuleChain=AppendDevIdentityServiceXML


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/300.GetServiceXMLTemplates/200.AppendServiceXML/200.AddServiceTemplatetoList/CreateXML/100.AppendVoWiFiServiceXML]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAndroidVoWiFiErrorFlagInteger,=,0
TrueRuleChain=10.AddVoWiFiXML


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/300.GetServiceXMLTemplates/200.AppendServiceXML/200.AddServiceTemplatetoList/CreateXML/100.AppendVoWiFiServiceXML/10.AddVoWiFiXML]

AdornOps=+ DEG_Common_XMLTemplateString DEG_VoWiFi_XMLTemplateString DEG_Common_XMLTemplateString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/300.GetServiceXMLTemplates/200.AppendServiceXML/200.AddServiceTemplatetoList/CreateXML/110.GenerateServiceEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=710.GenerateServiceEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/300.GetServiceXMLTemplates/200.AppendServiceXML/200.AddServiceTemplatetoList/CreateXML/200.AppendVoLTEServiceXML]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAndroidVoLTEErrorFlagInteger,=,0
TrueRuleChain=10.AddVoLTEXML


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/300.GetServiceXMLTemplates/200.AppendServiceXML/200.AddServiceTemplatetoList/CreateXML/200.AppendVoLTEServiceXML/10.AddVoLTEXML]

AdornOps=+ DEG_Common_XMLTemplateString DEG_VoLTE_XMLTemplateString DEG_Common_XMLTemplateString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/300.GetServiceXMLTemplates/200.AppendServiceXML/200.AddServiceTemplatetoList/CreateXML/330.AppendDevIdentityServiceXML]

AdornOps=+ DEG_Common_XMLTemplateString DEG_DevIdentity_XMLTemplateString DEG_Common_XMLTemplateString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/300.GetServiceXMLTemplates/200.AppendServiceXML/300.FormFinalServiceXML]

AdornOps=+ DEG_Common_XMLTemplateString DEG_OEMDevAndroidTempString DEG_Common_XMLTemplateString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/400.CreateResponseMessage]

ClassName=ConditionalRule
Conditions=DEG_Common_XMLTemplateString,!=,""
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevServiceXMLTemplateExistsInteger,>,0
Operations=and,and
TrueRuleChain=100.CopyResponseMessage
TrueRuleChain=200.CallCustomTemplate
TrueRuleChain=300.MessageFormat
TrueRuleChain=400.AssignMessagetoResponse


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/400.CreateResponseMessage/100.CopyResponseMessage]

AdornOps=setifnull DEG_XMLTemplateResponseString ""
AdornOps=copy DEG_Common_XMLTemplateString DEG_XMLTemplateResponseString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/400.CreateResponseMessage/200.CallCustomTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CallResponseXMLCustomize
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/400.CreateResponseMessage/300.MessageFormat]

ClassName=com.hp.usage.rules.transform.MessageFormatRule
Locale=en_US
MessageFormat=DEG_XMLTemplateResponseString
ResultAttribute=DEG_XMLTemplateResponseString
UseDynamicMessageFormat=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/600.DEG30ProcessServiceConfigurationRuleChain/20.ProcessAction/10.CheckServiceName/400.CreateResponseMessage/400.AssignMessagetoResponse]

AdornOps=setifnull DEG_XMLTemplateResponseString ""
AdornOps=copy DEG_XMLTemplateResponseString ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/610.LookupServiceTemplate]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=00.InitLookup
RuleNames=10.CheckParameterValues
RuleNames=20.CheckLookupStatus


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/610.LookupServiceTemplate/00.InitLookup]

AdornOps=copy DEG_OEMDevVersionInteger DEG_VERSION
AdornOps=copy DEG_OEMDevVersionInteger DEGDROID_XML_VOWIFI_VERSION
AdornOps=set DEGDROID_XML_VOWIFI_CONFIG_VALIDITY ${DEGDROID_VOWIFI_CONFIG_VALIDITY}
AdornOps=copy DEG_OEMDevTerminalVendorString DEG_TERMINAL_VENDOR
AdornOps=copy DEG_OEMDevTerminalModelString DEG_TERMINAL_MODEL
AdornOps=copy DEG_OEMDevTermianlSWversionString DEG_TERMINAL_SW_VERSION
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_SERVICE_TEMPLATES"
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/610.LookupServiceTemplate/10.CheckParameterValues]

ClassName=ConditionalRule
Conditions=DEG_OEMDevVersionInteger,!=,-1
Conditions=DEG_OEMDevTerminalVendorString,!=,dummy
Conditions=DEG_OEMDevTerminalModelString,!=,dummy
Conditions=DEG_OEMDevTermianlSWversionString,!=,dummy
FalseRuleChain=10.LookUpServiceTemplateDBWithVersion
Operations=and,and,and
TrueRuleChain=10.LookUpServiceTemplateDB


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/610.LookupServiceTemplate/10.CheckParameterValues/10.LookUpServiceTemplateDB]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_VERSION,DEG_VersionString
MapAttributes=DEG_SERVICE_NAME,DEG_ServiceNameString
MapAttributes=DEG_TERMINAL_VENDOR,DEG_TerminalVendorString
MapAttributes=DEG_TERMINAL_MODEL,DEG_TerminalModelString
MapAttributes=DEG_TERMINAL_SW_VERSION,DEG_SwVersionString
MapAttributes=DEG_XML_TEMPLATES_FILE,DEG_XMLTemplateString
NativeCondition=1.MatchAllParameters
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_SERVICE_TEMPLATES_Sessionstore


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/610.LookupServiceTemplate/10.CheckParameterValues/10.LookUpServiceTemplateDBWithVersion]

ClassName=ConditionalRule
Conditions=DEG_OEMDevVersionInteger,!=,-1
Conditions=DEG_OEMDevVersionInteger,=,0
Operations=and
TrueRuleChain=LookUpServiceTemplate


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/610.LookupServiceTemplate/10.CheckParameterValues/10.LookUpServiceTemplateDBWithVersion/LookUpServiceTemplate]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_VERSION,DEG_VersionString
MapAttributes=DEG_XML_TEMPLATES_FILE,DEG_XMLTemplateString
NativeCondition=2.MatchVersionParameter
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_SERVICE_TEMPLATES_Sessionstore


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/610.LookupServiceTemplate/20.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
NoRowExists=200.SetErrorInfo
NoRowExists=210.ErrorLog
SystemError=100.SetHTTPErrorResponse
SystemError=110.ErrorLog
TrueRuleChain=SystemError
TrueRuleChain=NoRowExists


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/610.LookupServiceTemplate/20.CheckLookupStatus/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1804"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEGDROID_SERVICE_TEMPLATES table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/610.LookupServiceTemplate/20.CheckLookupStatus/110.ErrorLog]

Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SERVICE_NAME
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEGDROID_SERVICE_TEMPLATES table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/610.LookupServiceTemplate/20.CheckLookupStatus/200.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1805"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the record in DEGDROID_SERVICE_TEMPLATES table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/610.LookupServiceTemplate/20.CheckLookupStatus/210.ErrorLog]

Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SERVICE_NAME
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to find the record in DEGDROID_SERVICE_TEMPLATES table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.IterateServiceNamesList
RuleNames=200.SetError


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/100.IterateServiceNamesList]

ClassName=ListAttributeIterator
ListAttributeName=DEG_OEMDevServiceNameList
RuleChain=100.CallServiceXML
TmpAttributeName=DEG_OEMDevServiceNameString


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/100.IterateServiceNamesList/100.CallServiceXML]

CallDevIdentityServiceXML=300.InitValues
CallDevIdentityServiceXML=310.StartAudit
CallDevIdentityServiceXML=320.CallServiceXMLForDevIdentity
CallDevIdentityServiceXML=110.CallCommonServiceXML
CallVoLTEServiceXML=200.CallVoLTEServiceXML
CallVoLTEServiceXML=110.CallCommonServiceXML
CallVoWiFiServiceXML=100.CallVoWiFiServiceXML
CallVoWiFiServiceXML=110.CallCommonServiceXML
ClassName=SwitchConditionRule
Conditions=DEG_OEMDevServiceNameString,=,VoWiFi
Conditions=DEG_OEMDevServiceNameString,=,VoLTE
Conditions=DEG_OEMDevServiceNameString,=,Device_Identity
Operations=None
TrueRuleChain=CallVoWiFiServiceXML
TrueRuleChain=CallVoLTEServiceXML
TrueRuleChain=CallDevIdentityServiceXML


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/100.IterateServiceNamesList/100.CallServiceXML/100.CallVoWiFiServiceXML]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=640.DEG30AndroidVoWiFiCoreRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/100.IterateServiceNamesList/100.CallServiceXML/110.CallCommonServiceXML]

ClassName=ConditionalRule
Conditions=DEG_OEMDevAndroidXMLErrorFlagInteger,=,0
Conditions=DEG_Common_XMLTemplateString,=,""
Operations=and
TrueRuleChain=100.SetServiceName
TrueRuleChain=200.LookupCommonServiceXMLTemplate
TrueRuleChain=300.CopyCommonXMLServiceTemplate


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/100.IterateServiceNamesList/100.CallServiceXML/110.CallCommonServiceXML/100.SetServiceName]

AdornOps=set DEG_SERVICE_NAME "Common"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/100.IterateServiceNamesList/100.CallServiceXML/110.CallCommonServiceXML/200.LookupCommonServiceXMLTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=610.LookupServiceTemplate
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/100.IterateServiceNamesList/100.CallServiceXML/110.CallCommonServiceXML/300.CopyCommonXMLServiceTemplate]

ClassName=ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
TrueRuleChain=CopyTemplate


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/100.IterateServiceNamesList/100.CallServiceXML/110.CallCommonServiceXML/300.CopyCommonXMLServiceTemplate/CopyTemplate]

AdornOps=copy DEG_XMLTemplateString DEG_Common_XMLTemplateString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/100.IterateServiceNamesList/100.CallServiceXML/200.CallVoLTEServiceXML]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEGAndroidVoLTECoreRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/100.IterateServiceNamesList/100.CallServiceXML/300.InitValues]

AdornOps=set DEG_OEMDevAndroidXMLErrorFlagInteger 0
AdornOps=setsystime DEG_CDevProcessStartTimeLong
AdornOps=set DEG_SERVICE_NAME "Device_Identity"
AdornOps=set DEG_OEMDevRespPhoneNumberString ${DEVICE_COUNTRYISD_CODE}
AdornOps=+ DEG_OEMDevRespPhoneNumberString DEG_MDN DEG_OEMDevRespPhoneNumberString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/100.IterateServiceNamesList/100.CallServiceXML/310.StartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=502.GenerateServiceStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/100.IterateServiceNamesList/100.CallServiceXML/320.CallServiceXMLForDevIdentity]

ClassName=RuleChain
RuleNames=100.LookupDevIdentityTemplate
RuleNames=200.CopyDevIdentityTemplate


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/100.IterateServiceNamesList/100.CallServiceXML/320.CallServiceXMLForDevIdentity/100.LookupDevIdentityTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=610.LookupServiceTemplate
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/100.IterateServiceNamesList/100.CallServiceXML/320.CallServiceXMLForDevIdentity/200.CopyDevIdentityTemplate]

ClassName=ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
TrueRuleChain=CopyTemplate


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/100.IterateServiceNamesList/100.CallServiceXML/320.CallServiceXMLForDevIdentity/200.CopyDevIdentityTemplate/CopyTemplate]

AdornOps=+ DEG_OEMDevServiceXMLTemplateExistsInteger 1 DEG_OEMDevServiceXMLTemplateExistsInteger
AdornOps=copy DEG_XMLTemplateString DEG_DevIdentity_XMLTemplateString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/200.SetError]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevServiceNameCountInteger,=,1
Conditions=DEG_OEMDevServiceNameInValidCountInteger,=,0
FalseRuleChain=200.CheckServiceNames
Operations=and
TrueRuleChain=100.CheckErrorFlag


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/200.SetError/100.CheckErrorFlag]

ClassName=SwitchConditionRule
Conditions=DEG_OEMDevAndroidVoLTEErrorFlagInteger,=,1
Conditions=DEG_OEMDevAndroidVoWiFiErrorFlagInteger,=,1
Operations=None
SetVoLTE403=100.SetVoLTE403
SetVoLTE403=110.LogVoLTE403
SetVoWiFi403=200.SetVoWiFi403
SetVoWiFi403=210.LogVoWiFi403
TrueRuleChain=SetVoLTE403
TrueRuleChain=SetVoWiFi403


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/200.SetError/100.CheckErrorFlag/100.SetVoLTE403]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1807"
AdornOps=set DEG_OEMDevErrorMessageString "Android_VoLTE is not present in Entitlement List"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/200.SetError/100.CheckErrorFlag/110.LogVoLTE403]

AAttributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevServiceNameCountInteger
Attributes=DEG_OEMDevServiceNameInValidCountInteger
Attributes=DEG_OEMDevServiceNameList
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestProcessedInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_CDevOutReturnCodeString
ClassName=LogNMERule
LogLevel=WARNING
Message=Action processed with error: Android_VoLTE is not present in Entitlement List : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/200.SetError/100.CheckErrorFlag/200.SetVoWiFi403]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "Android_VoWiFi is not present in Entitlement List"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1808"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/200.SetError/100.CheckErrorFlag/210.LogVoWiFi403]

AAttributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevServiceNameCountInteger
Attributes=DEG_OEMDevServiceNameInValidCountInteger
Attributes=DEG_OEMDevServiceNameList
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestProcessedInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_CDevOutReturnCodeString
ClassName=LogNMERule
LogLevel=WARNING
Message=Action processed with error: AAndroid_VoWiFi is not present in Entitlement List : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/200.SetError/200.CheckServiceNames]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevServiceNameTempString,contains,"VoLTE"
Conditions=DEG_OEMDevServiceNameTempString,contains,"VoWiFi"
Conditions=DEG_OEMDevServiceNameTempString,!contains,"Device_Identity"
Conditions=DEG_OEMDevAndroidVoLTEErrorFlagInteger,=,1
Conditions=DEG_OEMDevAndroidVoWiFiErrorFlagInteger,=,1
Operations=and,and,and,and
TrueRuleChain=100.SetInvalidServiceName
TrueRuleChain=110.LogInvalidServiceName


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/200.SetError/200.CheckServiceNames/100.SetInvalidServiceName]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "VoLTE and VoWiFi Service names are not present in Entitlement List"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1806"
AdornOps=set DEG_CDevOutReturnCodeString "403"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/620.CallandAppendServiceXML/200.SetError/200.CheckServiceNames/110.LogInvalidServiceName]

AAttributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevServiceNameCountInteger
Attributes=DEG_OEMDevServiceNameInValidCountInteger
Attributes=DEG_OEMDevServiceNameList
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestProcessedInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_CDevOutReturnCodeString
ClassName=LogNMERule
LogLevel=WARNING
Message=Action processed with error: VoLTE and VoWiFi Service names are not present in Entitlement List : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/710.GenerateServiceEndOKAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/710.GenerateServiceEndOKAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "1"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=copy DEG_OEMDevServiceNameString DEG_AuditEntitlementNameString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/710.GenerateServiceEndOKAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending Service response:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/710.GenerateServiceEndOKAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/710.GenerateServiceEndOKAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful Service response"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/710.GenerateServiceEndOKAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/CallResponseXMLCustomize]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.InitVariables
RuleNames=100.CopybeforeResponseXMLCustomize
RuleNames=200.LogbeforeResponseXMLCustomize
RuleNames=300.ProcessResponseXMLCustomize
RuleNames=400.CopyAfterResponseXMLCustomize
RuleNames=500.LogAfterResponseXMLCustomize


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/CallResponseXMLCustomize/000.InitVariables]

AdornOps=setifnull DEG_OEMDevServiceNameList null
AdornOps=setifnull DEG_OEMDevVersionInteger 0
AdornOps=setifnull DEG_OEMDevTerminalVendorString ""
AdornOps=setifnull DEG_OEMDevTerminalModelString ""
AdornOps=setifnull DEG_OEMDevTermianlSWversionString ""
AdornOps=setifnull DEG_OEMDevFriendlyDeviceString ""
AdornOps=setifnull DEG_OEMDevSipUserNameString ""
AdornOps=setifnull CUST_DDRXC_OUT_XMLTemplateResponseString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/CallResponseXMLCustomize/100.CopybeforeResponseXMLCustomize]

AdornOps=copy DEG_OEMDevServiceNameList CUST_DDRXC_IN_ServiceNamesList
AdornOps=copy DEG_OEMDevVersionInteger CUST_DDRXC_IN_VersionInteger
AdornOps=copy DEG_OEMDevTerminalVendorString CUST_DDRXC_IN_TerminalVendorString
AdornOps=copy DEG_OEMDevTerminalModelString CUST_DDRXC_IN_TerminalModelString
AdornOps=copy DEG_OEMDevTermianlSWversionString CUST_DDRXC_IN_TermianlSWversionString
AdornOps=copy DEG_OEMDevFriendlyDeviceString CUST_DDRXC_IN_FriendlyDeviceString
AdornOps=copy DEG_OEMDevSipUserNameString CUST_DDRXC_IN_SipUserNameString
AdornOps=copy DEG_XMLTemplateResponseString CUST_DDRXC_OUT_XMLTemplateResponseString
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1809"
AdornOps=set DEG_OEMDevMessageString "Log before setting values for service configuration XML"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/CallResponseXMLCustomize/200.LogbeforeResponseXMLCustomize]

Attributes=CUST_DDRXC_IN_ServiceNamesList
Attributes=CUST_DDRXC_IN_VersionInteger
Attributes=CUST_DDRXC_IN_TerminalVendorString
Attributes=CUST_DDRXC_IN_TerminalModelString
Attributes=CUST_DDRXC_IN_TermianlSWversionString
Attributes=CUST_DDRXC_IN_FriendlyDeviceString
Attributes=CUST_DDRXC_IN_SipUserNameString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Log before setting values for service configuration XML
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/CallResponseXMLCustomize/300.ProcessResponseXMLCustomize]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_ResponseXMLCustomize
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/CallResponseXMLCustomize/400.CopyAfterResponseXMLCustomize]

AdornOps=copy CUST_DDRXC_OUT_XMLTemplateResponseString DEG_XMLTemplateResponseString
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1810"
AdornOps=set DEG_OEMDevMessageString "Log after setting values for service configuration XML"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/RuleChains/CallResponseXMLCustomize/500.LogAfterResponseXMLCustomize]

Attributes=CUST_DDRXC_OUT_XMLTemplateResponseString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Log after setting values for service configuration XML
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/SessionStores]

ClassName=com.hp.siu.session.SessionStoreManager
SessionStoreNames=DEGDROID_SERVICE_TEMPLATES_Sessionstore


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/SessionStores/DEGDROID_SERVICE_TEMPLATES_Sessionstore]

Attributes=DEG_VERSION,key
Attributes=DEG_SERVICE_NAME,key
Attributes=DEG_TERMINAL_VENDOR
Attributes=DEG_TERMINAL_MODEL
Attributes=DEG_TERMINAL_SW_VERSION
Attributes=DEG_XML_TEMPLATES_FILE
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy1
DatabaseId=DEGDROID_SERVICE_TEMPLATES
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
NativeConditions=1.MatchAllParameters
NativeConditions=2.MatchVersionParameter
SQLTypeMap=DEG_VERSION,VARCHAR(16)
SQLTypeMap=DEG_SERVICE_NAME,VARCHAR(64)
SQLTypeMap=DEG_TERMINAL_VENDOR,VARCHAR(20)
SQLTypeMap=DEG_TERMINAL_MODEL,VARCHAR(20)
SQLTypeMap=DEG_TERMINAL_SW_VERSION,VARCHAR(20)
SQLTypeMap=DEG_XML_TEMPLATES_FILE,VARCHAR(4096)


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/SessionStores/DEGDROID_SERVICE_TEMPLATES_Sessionstore/1.MatchAllParameters]

Condition=where DEG_VERSION = %DEG_VERSION AND DEG_SERVICE_NAME = %DEG_SERVICE_NAME AND DEG_TERMINAL_VENDOR=%DEG_TERMINAL_VENDOR AND DEG_TERMINAL_MODEL=%DEG_TERMINAL_MODEL AND DEG_TERMINAL_SW_VERSION=%DEG_TERMINAL_SW_VERSION


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Core/SessionStores/DEGDROID_SERVICE_TEMPLATES_Sessionstore/2.MatchVersionParameter]

Condition=where DEG_VERSION = %DEG_VERSION AND DEG_SERVICE_NAME = %DEG_SERVICE_NAME


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Post_Process_Customize]


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Post_Process_Customize/RuleChains]


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Post_Process_Customize/RuleChains/CUSTRC_ResponseXMLCustomize]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogRule


[/templates/DEG/DEGDROID_DeviceInterface/Service_Configuration_Post_Process_Customize/RuleChains/CUSTRC_ResponseXMLCustomize/100.LogRule]

Attributes=CUST_DDRXC_IN_ServiceNamesList
Attributes=CUST_DDRXC_IN_VersionInteger
Attributes=CUST_DDRXC_IN_TerminalVendorString
Attributes=CUST_DDRXC_IN_TerminalModelString
Attributes=CUST_DDRXC_IN_TermianlSWversionString
Attributes=CUST_DDRXC_IN_FriendlyDeviceString
Attributes=CUST_DDRXC_IN_SipUserNameString
Attributes=CUST_DDRXC_OUT_XMLTemplateResponseString
ClassName=LogNMERule
LogLevel=DEBUG2
Message=Entered into Service configuration post process Custom Template:


[/templates/DEG/DEGDROID_DeviceInterface/SiptoCarrier_Customize]


[/templates/DEG/DEGDROID_DeviceInterface/SiptoCarrier_Customize/RuleChains]


[/templates/DEG/DEGDROID_DeviceInterface/SiptoCarrier_Customize/RuleChains/CUSTRC_Android_SIPToCarrier]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogRequestAttributeDetails


[/templates/DEG/DEGDROID_DeviceInterface/SiptoCarrier_Customize/RuleChains/CUSTRC_Android_SIPToCarrier/100.LogRequestAttributeDetails]

Attributes=CUST_ASTC_IN_IMSIString
Attributes=CUST_ASTC_IN_FriendlyDeviceString
Attributes=CUST_ASTC_IN_SIPUserNameString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Processing Initial validation under Customize template
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core]


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains]


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ProcessAction


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction]

CheckAndroidVoLTEPresent=001.SetErrorResponse
CheckAndroidVoLTEPresent=100.logNME
CheckAndroidVoLTEPresent=110.InitVariables
CheckAndroidVoLTEPresent=111.StartAuditData
CheckAndroidVoLTEPresent=120.CheckAndroidVoLTEPresent
CheckXMLErrorFlag=300.CheckXMLErrorFlag
ClassName=SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
GetEntitlementStatus=200.GetEntitlementStatus
Operations=DoAll
TrueRuleChain=CheckAndroidVoLTEPresent
TrueRuleChain=GetEntitlementStatus
TrueRuleChain=CheckXMLErrorFlag


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/001.SetErrorResponse]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1901"
AdornOps=set DEG_OEMDevMessageString "Entered into VoLTE core template"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/100.logNME]

Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_OEMDevRequestProcessedInteger
ClassName=LogNMERule
LogLevel=DEBUG
Message=Entered into VoLTE core template :


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/110.InitVariables]

AdornOps=setsystime DEG_CDevProcessStartTimeLong
AdornOps=set DEG_OEMDevVoLTEFeatureCodeString ${ANDROIDVOLTE_ENTITLEMENT_NAME}
AdornOps=set DEG_OEMDevAndroidXMLErrorFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/111.StartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=502.GenerateServiceStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/120.CheckAndroidVoLTEPresent]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_EntitlementStatus,contains,DEG_OEMDevVoLTEFeatureCodeString
FalseRuleChain=100.SetErrorFlag
FalseRuleChain=200.LogError


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/120.CheckAndroidVoLTEPresent/100.SetErrorFlag]

AdornOps=set DEG_OEMDevAndroidXMLErrorFlagInteger 1
AdornOps=set DEG_OEMDevAndroidVoLTEErrorFlagInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1902"
AdornOps=set DEG_OEMDevErrorMessageString "Android_VoLTE is not present in Entiltlement List"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/120.CheckAndroidVoLTEPresent/200.LogError]

Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevFeatureCodeTypeString
Attributes=DEG_SSL_EntitlementStatus
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Action processed with error - Android_VoLTE is not present in Entiltlement List
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/200.GetEntitlementStatus]

ClassName=com.hp.siu.collector.rules.StringTokenizerRule
Delimiter=,
SourceAttribute=DEG_SSL_EntitlementStatus
TokenAttribute=tmp_FEATCODE


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/200.GetEntitlementStatus/IterationRule]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=tmp_FEATCODE,contains,DEG_OEMDevVoLTEFeatureCodeString
TrueRuleChain=100.CopyEntitlementStatusValue
TrueRuleChain=101.CheckEntitlementStatusValue


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/200.GetEntitlementStatus/IterationRule/100.CopyEntitlementStatusValue]

AdornOps=substr "=" length tmp_FEATCODE DEG_OEMDevAndroidVoLTEStatusString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/200.GetEntitlementStatus/IterationRule/101.CheckEntitlementStatusValue]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAndroidVoLTEStatusString,=,null
Conditions=DEG_OEMDevAndroidVoLTEStatusString,=,""
Operations=or
TrueRuleChain=10.SetError
TrueRuleChain=20.LogError


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/200.GetEntitlementStatus/IterationRule/101.CheckEntitlementStatusValue/10.SetError]

AdornOps=set DEG_OEMDevAndroidXMLErrorFlagInteger 1
AdornOps=set DEG_OEMDevAndroidVoLTEErrorFlagInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1903"
AdornOps=set DEG_OEMDevErrorMessageString "Android_VoLTE Value is not present in Entiltlement List"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/200.GetEntitlementStatus/IterationRule/101.CheckEntitlementStatusValue/20.LogError]

Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_EntitlementStatus
Attributes=DEG_OEMDevAndroidVoLTEStatusString
Attributes=DEG_OEMDevFeatureCodeTypeString
Attributes=DEG_SSL_EntitlementStatus
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=tmp_FEATCODE
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Action processed with error - Android_VoLTE Value is not present in Entiltlement List
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag]

ClassName=ConditionalRule
Conditions=DEG_OEMDevAndroidXMLErrorFlagInteger,=,0
TrueRuleChain=100.LookupVoLTEServiceXMLTemplate
TrueRuleChain=200.CallAndroidVoLTECustom


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/100.LookupVoLTEServiceXMLTemplate]

ClassName=RuleChain
RuleNames=100.InitVariables
RuleNames=200.LookupVoLTEServiceTemplate
RuleNames=300.CopyVoLTEServiceTemplate


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/100.LookupVoLTEServiceXMLTemplate/100.InitVariables]

AdornOps=set DEG_SERVICE_NAME "VoLTE"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/100.LookupVoLTEServiceXMLTemplate/200.LookupVoLTEServiceTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=610.LookupServiceTemplate
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/100.LookupVoLTEServiceXMLTemplate/300.CopyVoLTEServiceTemplate]

ClassName=ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
TrueRuleChain=CopyVoLTEServiceTemplate


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/100.LookupVoLTEServiceXMLTemplate/300.CopyVoLTEServiceTemplate/CopyVoLTEServiceTemplate]

AdornOps=+ DEG_OEMDevServiceXMLTemplateExistsInteger 1 DEG_OEMDevServiceXMLTemplateExistsInteger
AdornOps=copy DEG_XMLTemplateString DEG_VoLTE_XMLTemplateString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoLTECustom]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CopyBeforeVoLTECustomTemplate
RuleNames=110.SetErrorResponse
RuleNames=200.LogBeforeVoLTECustomTemplate
RuleNames=300.CallVoLTECustom
RuleNames=400.CopyAfterVoLTECustomTemplate
RuleNames=410.SetErrorResponse
RuleNames=500.LogAfterVoLTECustomTemplate
RuleNames=600.CheckStatus


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoLTECustom/100.CopyBeforeVoLTECustomTemplate]

AdornOps=setifnull DEG_OEMDevImsiString ""
AdornOps=setifnull DEG_OEMDevUniqueIDString ""
AdornOps=setifnull DEG_MDN 0
AdornOps=copy DEG_OEMDevImsiString CUST_VOLTE_IN_IMSIString
AdornOps=copy DEG_MDN CUST_VOLTE_IN_MDNString
AdornOps=copy DEG_OEMDevUniqueIDString CUST_VOLTE_IN_UniqueIDString
AdornOps=copy DEG_OEMDevAndroidVoLTEStatusString CUST_VOLTE_OUT_EntitlementStatus
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoLTECustom/110.SetErrorResponse]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1904"
AdornOps=set DEG_OEMDevMessageString "Log before android VoLTE custom call"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoLTECustom/200.LogBeforeVoLTECustomTemplate]

Attributes=CUST_VOLTE_IN_IMSIString
Attributes=CUST_VOLTE_IN_MDNString
Attributes=CUST_VOLTE_IN_UniqueIDString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Log before android VoLTE custom call::
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoLTECustom/300.CallVoLTECustom]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_Android_VOLTE_Entitlement_Status
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoLTECustom/400.CopyAfterVoLTECustomTemplate]

AdornOps=setifnull CUST_VOLTE_OUT_ErrorStatusInteger 0
AdornOps=copy CUST_VOLTE_OUT_ErrorStatusInteger DEG_OEMDevVoLTEErrorStatusInteger
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoLTECustom/410.SetErrorResponse]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1905"
AdornOps=set DEG_OEMDevMessageString "Log after android VoLTE custom call"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoLTECustom/500.LogAfterVoLTECustomTemplate]

Attributes=CUST_VOLTE_IN_IMSIString
Attributes=CUST_VOLTE_IN_MDNString
Attributes=CUST_VOLTE_IN_UniqueIDString
Attributes=CUST_VOLTE_OUT_EntitlementStatus
Attributes=CUST_VOLTE_OUT_ErrorStatusInteger
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Log after android VoLTE custom call::
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoLTECustom/600.CheckStatus]

ClassName=ConditionalRule
Conditions=DEG_OEMDevVoLTEErrorStatusInteger,=,1
FalseRuleChain=100.CopyVoLTEStatusInteger
TrueRuleChain=100.SetError
TrueRuleChain=101.LogError


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoLTECustom/600.CheckStatus/100.CopyVoLTEStatusInteger]

AdornOps=copy CUST_VOLTE_OUT_EntitlementStatus DEG_OEMDevAndroidVoLTEStatusString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoLTECustom/600.CheckStatus/100.SetError]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=copy DEG_OEMDevVoLTEErrorStatusInteger DEG_OEMDevRequestProcessedInteger
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1906"
AdornOps=set DEG_OEMDevErrorMessageString "VoLTE Custom Configuration Failure"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Core/RuleChains/650.DEGAndroidVoLTECoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoLTECustom/600.CheckStatus/101.LogError]

Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=VoLTE Custom Configuration Failure : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Customize]


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Customize/RuleChains]


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Customize/RuleChains/CUSTRC_Android_VOLTE_Entitlement_Status]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogRequestAttributeDetails


[/templates/DEG/DEGDROID_DeviceInterface/VoLTE_Customize/RuleChains/CUSTRC_Android_VOLTE_Entitlement_Status/100.LogRequestAttributeDetails]

Attributes=CUST_VOLTE_IN_IMSIString
Attributes=CUST_VOLTE_IN_MDNString
Attributes=CUST_VOLTE_IN_UniqueIDString
Attributes=CUST_VOLTE_OUT_EntitlementStatus
Attributes=CUST_VOLTE_OUT_ErrorStatusInteger
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Processing Android VoLTE request in custom template:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core]


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains]


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ProcessAction


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction]

ClassName=ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=95.SetErrorINFO
TrueRuleChain=99.logNME
TrueRuleChain=100.InitVariables
TrueRuleChain=101.StartAuditData
TrueRuleChain=110.CheckAndroidVoWiFiPresent
TrueRuleChain=200.GetEntitlementStatus
TrueRuleChain=300.CheckXMLErrorFlag


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/100.InitVariables]

AdornOps=setsystime DEG_CDevProcessStartTimeLong
AdornOps=set DEG_OEMDevFeatureCodeTypeString ${ANDROIDVOWIFI_ENTITLEMENT_NAME}
AdornOps=set DEG_OEMDevAndroidXMLErrorFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/101.StartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=502.GenerateServiceStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/110.CheckAndroidVoWiFiPresent]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_EntitlementStatus,contains,DEG_OEMDevFeatureCodeTypeString
FalseRuleChain=100.SetErrorFlag
FalseRuleChain=200.LogError


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/110.CheckAndroidVoWiFiPresent/100.SetErrorFlag]

AdornOps=set DEG_OEMDevAndroidXMLErrorFlagInteger 1
AdornOps=set DEG_OEMDevAndroidVoWiFiErrorFlagInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.2002"
AdornOps=set DEG_OEMDevErrorMessageString "Android_VoWiFi is not present in Entiltlement List"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/110.CheckAndroidVoWiFiPresent/200.LogError]

Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevFeatureCodeTypeString
Attributes=DEG_SSL_EntitlementStatus
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Action processed with error - Android_VoWiFi is not present in Entiltlement List
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/200.GetEntitlementStatus]

ClassName=com.hp.siu.collector.rules.StringTokenizerRule
Delimiter=,
SourceAttribute=DEG_SSL_EntitlementStatus
TokenAttribute=tmp_FEATCODE


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/200.GetEntitlementStatus/IterationRule]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=tmp_FEATCODE,contains,DEG_OEMDevFeatureCodeTypeString
TrueRuleChain=100.CopyEntitlementStatusValue
TrueRuleChain=101.CheckEntitlementStatusValue


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/200.GetEntitlementStatus/IterationRule/100.CopyEntitlementStatusValue]

AdornOps=substr "=" length tmp_FEATCODE DEG_OEMDevAndroidVoWiFiStatusString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/200.GetEntitlementStatus/IterationRule/101.CheckEntitlementStatusValue]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAndroidVoWiFiStatusString,=,null
Conditions=DEG_OEMDevAndroidVoWiFiStatusString,=,""
Operations=or
TrueRuleChain=10.SetError
TrueRuleChain=20.LogError


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/200.GetEntitlementStatus/IterationRule/101.CheckEntitlementStatusValue/10.SetError]

AdornOps=set DEG_OEMDevAndroidXMLErrorFlagInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.2003"
AdornOps=set DEG_OEMDevErrorMessageString "Android_VoWiFi Value is not present in Entiltlement List"
AdornOps=set DEG_OEMDevAndroidVoWiFiErrorFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/200.GetEntitlementStatus/IterationRule/101.CheckEntitlementStatusValue/20.LogError]

Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_EntitlementStatus
Attributes=DEG_OEMDevAndroidVoWiFiStatusString
Attributes=DEG_OEMDevFeatureCodeTypeString
Attributes=DEG_SSL_EntitlementStatus
Attributes=tmp_FEATCODE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Action processed with error - Android_VoWiFi Value is not present in Entiltlement List
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag]

ClassName=ConditionalRule
Conditions=DEG_OEMDevAndroidXMLErrorFlagInteger,=,0
TrueRuleChain=100.LookupVoWiFiServiceXMLTemplate
TrueRuleChain=200.CallAndroidVoWiFiCustom
TrueRuleChain=300.CheckSipUserName


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/100.LookupVoWiFiServiceXMLTemplate]

ClassName=RuleChain
RuleNames=100.InitVariables
RuleNames=200.LookupVoWiFierviceTemplate
RuleNames=300.CopyVoWiFiServiceTemplate


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/100.LookupVoWiFiServiceXMLTemplate/100.InitVariables]

AdornOps=set DEG_SERVICE_NAME "VoWiFi"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/100.LookupVoWiFiServiceXMLTemplate/200.LookupVoWiFierviceTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=610.LookupServiceTemplate
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/100.LookupVoWiFiServiceXMLTemplate/300.CopyVoWiFiServiceTemplate]

ClassName=ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
TrueRuleChain=CopyVoWiFiServiceTemplate


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/100.LookupVoWiFiServiceXMLTemplate/300.CopyVoWiFiServiceTemplate/CopyVoWiFiServiceTemplate]

AdornOps=+ DEG_OEMDevServiceXMLTemplateExistsInteger 1 DEG_OEMDevServiceXMLTemplateExistsInteger
AdornOps=copy DEG_XMLTemplateString DEG_VoWiFi_XMLTemplateString
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=050.ResponseInfo
RuleNames=100.LogIncomingAttributes
RuleNames=110.LookUpDeviceDataTable


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/050.ResponseInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.2004"
AdornOps=set DEG_OEMDevMessageString "Values before Device Data Lookup"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/100.LogIncomingAttributes]

Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevFriendlyDeviceString
Attributes=DEG_OEMDevSipUserNameString
Attributes=DEG_DevAndroidEntitlementNameString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Values before Device Data Lookup :
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitDeviceDataLookup
RuleNames=110.ExecuteDeviceDataLookup
RuleNames=120.CheckErrorAndNoMatchFlag


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/100.InitDeviceDataLookup]

AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_DEVICE_DATA"
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=set DEG_ENTITLEMENT_NAME ${ANDROIDVOWIFI_ENTITLEMENT_NAME}
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/110.ExecuteDeviceDataLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_ADDR_UPDATE_POSTDATA,DEG_ADDR_UPDATE_POSTDATA
MapAttributes=DEG_TC_STATUS,DEG_TC_STATUS
MapAttributes=DEG_DISPLAY_NAME,DEG_DISPLAY_NAME
MapAttributes=DEG_SIP_USERNAME,DEG_SIP_USERNAME
MapAttributes=DEG_ADDRESS_STATUS,DEG_ADDRESS_STATUS
MapAttributes=DEG_PROVISIONING_STATUS,DEG_PROVISIONING_STATUS
MapAttributes=DEG_ENTITLEMENT_NAME,DEG_ENTITLEMENT_NAME
MapAttributes=DEG_IMSI,DEG_IMSI
NativeCondition=4.MatchByIMSIAndEntitelementName
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=210.CheckKeyExistFlag
TrueRuleChain=110.SetErrorInfo
TrueRuleChain=120.SetErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/110.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.2005"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEG_DEVICE_DATA table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/120.SetErrorLog]

Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_ENTITLEMENT_NAME
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_DEVICE_DATA table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
FalseRuleChain=200.SetErrorResponse
FalseRuleChain=300.LogError
TrueRuleChain=100.RowFound


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CopyDbAttributestoOutput
RuleNames=150.CopyBeforeVoWiFiCustomTemplate
RuleNames=160.SetValueBeforeVoWiFiCusotomTemplate
RuleNames=170.LogBeforeVoWiFiCustomTemplate
RuleNames=200.CallVoWiFiCustom
RuleNames=250.CopyAfterVoWiFiCustomTemplate
RuleNames=260.LogAfterVoWiFiCustomTemplate
RuleNames=270.CheckTemplateInvocationStatus
RuleNames=300.CheckStatus


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/100.CopyDbAttributestoOutput]

AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDRESS_UPDATE_URL ""
AdornOps=setifnull DEG_SSL_ADDRESS_UPDATE_URL ""
AdornOps=copy DEG_TC_STATUS DEGDROID_XML_TC_STATUS
AdornOps=copy DEG_ADDRESS_STATUS DEGDROID_XML_ADDRESS_STATUS
AdornOps=copy DEG_PROVISIONING_STATUS DEGDROID_XML_PROVISIONING_STATUS
AdornOps=copy DEG_ADDR_UPDATE_POSTDATA DEGDROID_XML_ADDR_UPDATE_POSTDATA
AdornOps=copy DEG_SSL_ADDRESS_UPDATE_URL DEGDROID_XML_ADDRESS_UPDATE_URL
AdornOps=setifnull DEG_OEMDevPrevSipUserNameString ""
AdornOps=setifnull DEG_OEMDevPrevFriendlyDeviceString ""
AdornOps=setifnull DEG_SIP_USERNAME ""
AdornOps=setifnull DEG_DISPLAY_NAME ""
AdornOps=copy DEG_SIP_USERNAME DEG_OEMDevPrevSipUserNameString
AdornOps=copy DEG_DISPLAY_NAME DEG_OEMDevPrevFriendlyDeviceString
AdornOps=setifnull DEG_OEMDevSipUserNameString ""
AdornOps=setifnull DEG_OEMDevFriendlyDeviceString ""
AdornOps=setifnull DEG_OEMDevImsiString ""
AdornOps=setifnull DEG_OEMDevUniqueIDString ""
AdornOps=setifnull DEG_OEMDevRequestProcessedInteger 0
AdornOps=setifnull DEGDROID_XML_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_OEMDevURLPostDataString ""
AdornOps=setifnull DEG_OEMDevUpdateDeviceDataInteger 0
AdornOps=setifnull CUST_VOWIFI_OUT_TemplateInvokationStatus 0
AdornOps=setifnull CUST_VOWIFI_OUT_TCStatusString ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull CUST_VOWIFI_OUT_AddressStatusString ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull CUST_VOWIFI_OUT_AddressUpdateURLString ""
AdornOps=setifnull CUST_VOWIFI_OUT_ResponsePostDataString ""
AdornOps=setifnull CUST_VOWIFI_OUT_ProvStatusInteger ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull CUST_VOWIFI_OUT_UpdateDeviceDataFlagInteger 0
AdornOps=setifnull CUST_VOWIFI_OUT_PersistPostDataString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/150.CopyBeforeVoWiFiCustomTemplate]

AdornOps=copy DEG_OEMDevSipUserNameString CUST_VOWIFI_IN_SipUserNameString
AdornOps=copy DEG_OEMDevFriendlyDeviceString CUST_VOWIFI_IN_FriendlyDeviceString
AdornOps=copy DEG_OEMDevImsiString CUST_VOWIFI_IN_IMSIString
AdornOps=copy DEG_OEMDevPrevSipUserNameString CUST_VOWIFI_IN_PrevSipUserNameString
AdornOps=copy DEG_OEMDevPrevFriendlyDeviceString CUST_VOWIFI_IN_PreFriendlyDeviceString
AdornOps=copy DEG_OEMDevUniqueIDString CUST_VOWIFI_IN_UniqueIDString
AdornOps=copy DEG_ADDR_UPDATE_POSTDATA CUST_VOWIFI_IN_PrevPostData
AdornOps=copy DEG_TC_STATUS CUST_VOWIFI_OUT_TCStatusString
AdornOps=copy DEG_ADDRESS_STATUS CUST_VOWIFI_OUT_AddressStatusString
AdornOps=copy DEG_PROVISIONING_STATUS CUST_VOWIFI_OUT_ProvStatusInteger
AdornOps=copy DEG_ADDR_UPDATE_POSTDATA CUST_VOWIFI_OUT_ResponsePostDataString
AdornOps=copy DEG_SSL_ADDRESS_UPDATE_URL CUST_VOWIFI_OUT_AddressUpdateURLString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/160.SetValueBeforeVoWiFiCusotomTemplate]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.2006"
AdornOps=set DEG_OEMDevMessageString "before VoWiFi custom call"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/170.LogBeforeVoWiFiCustomTemplate]

Attributes=CUST_VOWIFI_IN_SipUserNameString
Attributes=CUST_VOWIFI_IN_FriendlyDeviceString
Attributes=CUST_VOWIFI_IN_IMSIString
Attributes=CUST_VOWIFI_IN_PrevSipUserNameString
Attributes=CUST_VOWIFI_IN_PreFriendlyDeviceString
Attributes=CUST_VOWIFI_IN_PrevUniqueIDString
Attributes=CUST_VOWIFI_IN_UniqueIDString
Attributes=CUST_VOWIFI_IN_PrevPostData
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Log before android VoWiFi custom call::
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/200.CallVoWiFiCustom]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_Android_VOWIFI_Status_URL_PostData
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/250.CopyAfterVoWiFiCustomTemplate]

AdornOps=copy CUST_VOWIFI_OUT_TCStatusString DEGDROID_XML_TC_STATUS
AdornOps=copy CUST_VOWIFI_OUT_AddressStatusString DEGDROID_XML_ADDRESS_STATUS
AdornOps=copy CUST_VOWIFI_OUT_AddressUpdateURLString DEGDROID_XML_ADDRESS_UPDATE_URL
AdornOps=copy CUST_VOWIFI_OUT_ResponsePostDataString DEGDROID_XML_ADDR_UPDATE_POSTDATA
AdornOps=copy CUST_VOWIFI_OUT_ProvStatusInteger DEGDROID_XML_PROVISIONING_STATUS
AdornOps=copy CUST_VOWIFI_OUT_UpdateDeviceDataFlagInteger DEG_OEMDevUpdateDeviceDataInteger
AdornOps=copy CUST_VOWIFI_OUT_PersistPostDataString DEG_OEMDevURLPostDataString
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.2007"
AdornOps=set DEG_OEMDevMessageString "After VoWiFi custom call"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/260.LogAfterVoWiFiCustomTemplate]

Attributes=CUST_VOWIFI_OUT_TemplateInvokationStatus
Attributes=CUST_VOWIFI_OUT_TCStatusString
Attributes=CUST_VOWIFI_OUT_AddressStatusString
Attributes=CUST_VOWIFI_OUT_AddressUpdateURLString
Attributes=CUST_VOWIFI_OUT_ResponsePostDataString
Attributes=CUST_VOWIFI_OUT_ProvStatusInteger
Attributes=CUST_VOWIFI_OUT_UpdateDeviceDataFlagInteger
Attributes=CUST_VOWIFI_OUT_PersistPostDataString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Log after Android VoWiFi custom call::
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/270.CheckTemplateInvocationStatus]

ClassName=ConditionalRule
Conditions=CUST_VOWIFI_OUT_TemplateInvokationStatus,=,1
TrueRuleChain=90.UpdatePrevUniqueID
TrueRuleChain=100.SetError
TrueRuleChain=101.LogError


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/270.CheckTemplateInvocationStatus/100.SetError]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=copy CUST_VOWIFI_OUT_TemplateInvokationStatus DEG_OEMDevRequestProcessedInteger
AdornOps=set DEG_OEMDevErrorMessageString "VoWiFi Custom Configuration Failure"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.2009"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/270.CheckTemplateInvocationStatus/101.LogError]

Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=VoWiFi Custom Configuration Failure : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/270.CheckTemplateInvocationStatus/90.UpdatePrevUniqueID]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=110.UpdateTokensTable
RuleNames=120.CheckUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/270.CheckTemplateInvocationStatus/90.UpdatePrevUniqueID/100.InitUpdate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy CUST_VOWIFI_IN_PrevUniqueIDString DEG_UNIQUE_ID
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/270.CheckTemplateInvocationStatus/90.UpdatePrevUniqueID/110.UpdateTokensTable]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/270.CheckTemplateInvocationStatus/90.UpdatePrevUniqueID/120.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Operations=and
TrueRuleChain=100.SetSystemErrorResponse
TrueRuleChain=110.SystemError_Log


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/270.CheckTemplateInvocationStatus/90.UpdatePrevUniqueID/120.CheckUpdateStatus/100.SetSystemErrorResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.2008"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update or access DEGDROID_TOKENS table"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/270.CheckTemplateInvocationStatus/90.UpdatePrevUniqueID/120.CheckUpdateStatus/110.SystemError_Log]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevUniqueIDString
Attributes=DEG_UNIQUE_ID
Attributes=CUST_VOWIFI_IN_PrevUniqueIDString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update or access DEGDROID_TOKENS table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/300.CheckStatus]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=200.CheckDeviceDataInteger


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/300.CheckStatus/200.CheckDeviceDataInteger]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevUpdateDeviceDataInteger,=,1
Operations=and
TrueRuleChain=100.UpdateDeviceDataTable


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/300.CheckStatus/200.CheckDeviceDataInteger/100.UpdateDeviceDataTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=95.SetLogInfo
RuleNames=99.Log
RuleNames=100.InitUpdate
RuleNames=200.UpdateData
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/300.CheckStatus/200.CheckDeviceDataInteger/100.UpdateDeviceDataTable/100.InitUpdate]

AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_DEVICE_DATA"
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=setifnull DEG_OEMDevURLPostDataString ""
AdornOps=setifnull DEG_OEMDevSipUserNameString ""
AdornOps=setifnull DEG_OEMDevFriendlyDeviceString ""
AdornOps=setifnull DEGDROID_XML_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEGDROID_XML_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEGDROID_XML_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=copy DEG_OEMDevSipUserNameString DEG_SIP_USERNAME
AdornOps=copy DEG_OEMDevFriendlyDeviceString DEG_DISPLAY_NAME
AdornOps=copy DEGDROID_XML_ADDRESS_STATUS DEG_ADDRESS_STATUS
AdornOps=copy DEGDROID_XML_PROVISIONING_STATUS DEG_PROVISIONING_STATUS
AdornOps=copy DEG_OEMDevURLPostDataString DEG_ADDR_UPDATE_POSTDATA
AdornOps=copy DEGDROID_XML_TC_STATUS DEG_TC_STATUS
AdornOps=setsystime DEG_LASTUPDATE
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/300.CheckStatus/200.CheckDeviceDataInteger/100.UpdateDeviceDataTable/200.UpdateData]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_ENTITLEMENT_NAME,DEG_ENTITLEMENT_NAME
MapAttributes=DEG_PROVISIONING_STATUS,DEG_PROVISIONING_STATUS
MapAttributes=DEG_DISPLAY_NAME,DEG_DISPLAY_NAME
MapAttributes=DEG_SIP_USERNAME,DEG_SIP_USERNAME
MapAttributes=DEG_ADDRESS_STATUS,DEG_ADDRESS_STATUS
MapAttributes=DEG_TC_STATUS,DEG_TC_STATUS
MapAttributes=DEG_ADDR_UPDATE_POSTDATA,DEG_ADDR_UPDATE_POSTDATA
MapAttributes=DEG_LASTUPDATE,DEG_LASTUPDATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/300.CheckStatus/200.CheckDeviceDataInteger/100.UpdateDeviceDataTable/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
NoRowExists=100.SetErrorForNoRow
NoRowExists=200.PrintMessageForNoRow
Operations=None
SystemError=100.SetErrorAttribute
SystemError=200.PrintError
TrueRuleChain=SystemError
TrueRuleChain=NoRowExists
TrueRuleChain=UpdateRow
UpdateRow=090.SetLogInfo
UpdateRow=100.LogMessage


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/300.CheckStatus/200.CheckDeviceDataInteger/100.UpdateDeviceDataTable/300.CheckUpdateStatus/090.SetLogInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.2011"
AdornOps=set DEG_OEMDevMessageString "Row updated in Device Data Table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/300.CheckStatus/200.CheckDeviceDataInteger/100.UpdateDeviceDataTable/300.CheckUpdateStatus/100.LogMessage]

Attributes=DEG_ENTITLEMENT_NAME
Attributes=DEG_IMSI
Attributes=DEG_UNIQUE_ID
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Row updated in Device Data Table:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/300.CheckStatus/200.CheckDeviceDataInteger/100.UpdateDeviceDataTable/300.CheckUpdateStatus/100.SetErrorAttribute]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.2012"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating Device Data Table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/300.CheckStatus/200.CheckDeviceDataInteger/100.UpdateDeviceDataTable/300.CheckUpdateStatus/100.SetErrorForNoRow]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.2013"
AdornOps=set DEG_OEMDevErrorMessageString "Error while access Device Data Table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/300.CheckStatus/200.CheckDeviceDataInteger/100.UpdateDeviceDataTable/300.CheckUpdateStatus/200.PrintError]

Attributes=DEG_ENTITLEMENT_NAME
Attributes=DEG_IMSI
Attributes=DEG_UNIQUE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Error while access Device Data Table:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/300.CheckStatus/200.CheckDeviceDataInteger/100.UpdateDeviceDataTable/300.CheckUpdateStatus/200.PrintMessageForNoRow]

Attributes=DEG_ENTITLEMENT_NAME
Attributes=DEG_IMSI
Attributes=DEG_UNIQUE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Error while updating Device Data Table:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/300.CheckStatus/200.CheckDeviceDataInteger/100.UpdateDeviceDataTable/95.SetLogInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.2010"
AdornOps=set DEG_OEMDevMessageString "Values after VoWiFiCustom RuleChain"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/100.RowFound/300.CheckStatus/200.CheckDeviceDataInteger/100.UpdateDeviceDataTable/99.Log]

Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_ENTITLEMENT_NAME
Attributes=DEG_OEMDevSipUserNameString
Attributes=DEG_OEMDevFriendlyDeviceString
Attributes=DEG_OEMDevPrevSipUserNameString
Attributes=DEG_OEMDevPrevFriendlyDeviceString
Attributes=DEG_OEMDevAddressUpdateURLString
Attributes=DEGDROID_XML_ADDRESS_UPDATE_URL
Attributes=DEGDROID_XML_ADDR_UPDATE_POSTDATA
Attributes=DEGDROID_XML_ADDRESS_STATUS
Attributes=DEGDROID_XML_TC_STATUS
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Values after VoWiFiCustom RuleChain : : :
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/200.SetErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.2014"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup DEG_DEVICE_DATA table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/200.CallAndroidVoWiFiCustom/110.LookUpDeviceDataTable/120.CheckErrorAndNoMatchFlag/210.CheckKeyExistFlag/300.LogError]

Attributes=DEG_ENTITLEMENT_NAME
Attributes=DEG_IMSI
Attributes=DEG_UNIQUE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Error while looking up Device Data Table:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/300.CheckSipUserName]

ClassName=ConditionalRule
Conditions=DEG_OEMDevSipUserNameString,!=,-99DEGINVALID-99
TrueRuleChain=10.CopyDEGAttributeToCustomAttribute
TrueRuleChain=10.LogCustomAttributeBeforeCall
TrueRuleChain=10.CallSiptoCarrier


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/300.CheckSipUserName/10.CallSiptoCarrier]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_Android_SIPToCarrier
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/300.CheckSipUserName/10.CopyDEGAttributeToCustomAttribute]

AdornOps=copy DEG_OEMDevSipUserNameString CUST_ASTC_IN_SIPUserNameString
AdornOps=copy DEG_OEMDevFriendlyDeviceString CUST_ASTC_IN_FriendlyDeviceString
AdornOps=copy DEG_OEMDevImsiString CUST_ASTC_IN_IMSIString
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.2015"
AdornOps=set DEG_OEMDevMessageString "Logging Before SIP To Carrier Custom Call"
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/300.CheckXMLErrorFlag/300.CheckSipUserName/10.LogCustomAttributeBeforeCall]

Attributes=CUST_ASTC_IN_SIPUserNameString
Attributes=CUST_ASTC_IN_FriendlyDeviceString
Attributes=CUST_ASTC_IN_IMSIString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=DEBUG2
Message=Logging Before SIP To Carrier Custom Call:


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/95.SetErrorINFO]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.2001"
AdornOps=set DEG_OEMDevMessageString "ENTERED INSIDE VOWIFICORE TEMPLATE"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Core/RuleChains/640.DEG30AndroidVoWiFiCoreRuleChain/100.ProcessAction/99.logNME]

Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=ENTERED INSIDE VOWIFICORE TEMPLATE :


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Customize]


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Customize/RuleChains]


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Customize/RuleChains/CUSTRC_Android_VOWIFI_Status_URL_PostData]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogRequestAttributeDetails


[/templates/DEG/DEGDROID_DeviceInterface/VoWiFi_Customize/RuleChains/CUSTRC_Android_VOWIFI_Status_URL_PostData/100.LogRequestAttributeDetails]

Attributes=CUST_VOWIFI_IN_IMSIString
Attributes=CUST_VOWIFI_IN_FriendlyDeviceString
Attributes=CUST_VOWIFI_IN_SipUserNameString
Attributes=CUST_VOWIFI_IN_PrevSipUserNameString
Attributes=CUST_VOWIFI_IN_PreFriendlyDeviceString
Attributes=CUST_VOWIFI_IN_UniqueIDString
Attributes=CUST_VOWIFI_IN_PrevUniqueIDString
Attributes=CUST_VOWIFI_IN_PrevPostData
Attributes=CUST_VOWIFI_OUT_TemplateInvokationStatus
Attributes=CUST_VOWIFI_OUT_TCStatusString
Attributes=CUST_VOWIFI_OUT_AddressStatusString
Attributes=CUST_VOWIFI_OUT_PersistPostDataString
Attributes=CUST_VOWIFI_OUT_ResponsePostDataString
Attributes=CUST_VOWIFI_OUT_AddressUpdateURLString
Attributes=CUST_VOWIFI_OUT_ProvStatusInteger
Attributes=CUST_VOWIFI_OUT_UpdateDeviceDataFlagInteger
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Processing Android VoWiFi request in custom template:
NullAlso=true
