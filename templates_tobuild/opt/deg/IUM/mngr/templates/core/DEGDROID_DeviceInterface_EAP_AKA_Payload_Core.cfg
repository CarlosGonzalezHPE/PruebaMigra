[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core]

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains]

RuleChainNames=250.DEG30ProcessEAPAKAPayloadRuleChain
RuleChainNames=250A.DEG30ProcessActionRuleChain
RuleChainNames=250B.DEG30UpdateSslSessionStateRuleChain
RuleChainNames=250C.DEG30GenerateOEMResponseRuleChain
RuleChainNames=250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain

RuleChainNames=751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain
RuleChainNames=752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain
RuleChainNames=753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain
RuleChainNames=754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
RuleChainNames=755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain
RuleChainNames=756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain
RuleChainNames=757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckEAPPayload
RuleNames=200.GenerateEapAkaPayloadEndAuditData

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPPayloadString,=,dummy

FalseRuleChain=110.DecodePayload
FalseRuleChain=120.CheckPlayloadIfBase64
FalseRuleChain=170.SetResponseHandler

TrueRuleChain=150.GenerateStartAudit
TrueRuleChain=200.Set403Error
TrueRuleChain=170.SetResponseHandler
TrueRuleChain=220.LogError

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/150.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain
UseRuleChainManagerPool=true

#If payload is empty degdroid should return 403 error.So changing 400C to 403C.
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/200.Set403Error]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0401"
AdornOps=set DEG_OEMDevErrorMessageString "Empty EAPPayload"
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/170.SetResponseHandler]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,starts,200
TrueRuleChain=100.SetTextResponse
FalseRuleChain=200.SetEmptyResponse

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/170.SetResponseHandler/100.SetTextResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"
###AdornOps=set DEG_OEMDevConnectionString "keep-alive"
AdornOps=set DEG_OEMDevConnectionString "close"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/170.SetResponseHandler/200.SetEmptyResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/220.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - Invalid Action - EAPPayload expected: 
NullAlso=true
#Action=Request processed with error - Invalid Action - EAPPayload expected.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/110.DecodePayload]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=decBase64 DEG_OEMDevEapPayloadString DEG_OEMDevEAPPayloadBinary
AdornOps=set DEG_SSL_REQUEST_STATE "200"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/120.CheckPlayloadIfBase64]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=000.GenerateStartAudit
TrueRuleChain=100.SetHTTPError
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.ProcessAction

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/120.CheckPlayloadIfBase64/000.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/120.CheckPlayloadIfBase64/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=(DEG_OEMDevEapPayloadString =="") || (DEG_OEMDevEAPPayloadBinary == null)

#QXCM1001480475:When the payload has wrong format (for e.g., invalid length for base64 encoding), DEG is returning 500 instead of 403.
#changed ssl rqst state from 400C(which was causing unknown 500 error) to 403C
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/120.CheckPlayloadIfBase64/100.SetHTTPError]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0402"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid EAPPayload"
AdornOps=set DEG_CDevOutReturnCodeString "403"


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/120.CheckPlayloadIfBase64/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevEapPayloadString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - Invalid Payload - Unable to Perform Base64 decoding: 
NullAlso=true
#Action=Request processed with error - Invalid Payload - Unable to Perform Base64 decoding . Contact HP Admin

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/120.CheckPlayloadIfBase64/200.ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=250A.DEG30ProcessActionRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/170.SetResponseHandler]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,starts,200
TrueRuleChain=100.SetTextResponse
FalseRuleChain=200.SetEmptyResponse

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/170.SetResponseHandler/100.SetTextResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"
###AdornOps=set DEG_OEMDevConnectionString "keep-alive"
AdornOps=set DEG_OEMDevConnectionString "close"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/100.CheckEAPPayload/170.SetResponseHandler/200.SetEmptyResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/200.GenerateEapAkaPayloadEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,1
Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
Operations=and
TrueRuleChain=100.AuthenticationAkaRejected
#Adding one more condition in case of EAPAKADefaultAuthWhenError=Disabled.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250.DEG30ProcessEAPAKAPayloadRuleChain/200.GenerateEapAkaPayloadEndAuditData/100.AuthenticationAkaRejected]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.UpdateSslSessionState
RuleNames=200.AAAProcessingRule
RuleNames=205.SetAuditTransactionType
RuleNames=210.CheckPayload
RuleNames=220.LogEAPAKAWait
RuleNames=230.InitSslSessionAfterEAPAKA
RuleNames=300.UpdateSslSessionAfterEAPAKA
RuleNames=310.CheckSslSessionUpdateStatus
RuleNames=400.GenerateOEMResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/110.UpdateSslSessionState]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=250B.DEG30UpdateSslSessionStateRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/200.AAAProcessingRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_OEMDevSubscriberIdString
RequestAttributes=DEG_OEMDevEAPPayloadBinary
RequestAttributes=DEG_OEMDevSslSessionIdString
#RequestAttributes=DEG_OEMDevAuthSessionStateStringTbl
RequestAttributes=DEG_SSL_AAA_STATE
RequestAttributes=DEG_SSL_AAA_SESSIONID
RequestAttributes=DEG_SSL_NAI
ResponseAttributes=DEG_SSL_STATE
ResponseAttributes=DEG_SSL_AAA_STATE
ResponseAttributes=DEG_AUTHENTICATION_TYPE
ResponseAttributes=DEG_AUTHENTICATION_SUBTYPE
ResponseAttributes=DEG_OEMDevEAPPayloadBinary
RuleChain=301.DEG30AAAProcessingRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/205.SetAuditTransactionType]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/210.CheckPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodeEAPPayload

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/210.CheckPayload/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/210.CheckPayload/200.EncodeEAPPayload]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0403"
AdornOps=set DEG_OEMDevMessageString "Perform EAPAKAAtuh for AkaWait"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/220.LogEAPAKAWait]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_SSL_STATE
Attributes=DEG_OEMDevEapPayloadString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
LogLevel=DEBUG
Message=Perform EAPAKAAtuh for AkaWait: 
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/230.InitSslSessionAfterEAPAKA]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=setifnull DEGDROID_SSL_COOKIE_ID ""
AdornOps=setifnull DEGDROID_SSL_OTP 0


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/300.UpdateSslSessionAfterEAPAKA]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEGDROID_SSL_COOKIE_ID,DEGDROID_SSL_COOKIE_ID
MapAttributes=DEGDROID_SSL_OTP,DEGDROID_SSL_OTP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1

TrueRuleChain=100.SetErrorMessage
TrueRuleChain=110.LogError
#TrueRuleChain=120.GenerateEapAkaPayloadSystemErrorEndAuditData
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/100.SetErrorMessage]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0404"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_SSL_SESSION table"
AdornOps=set DEG_CDevOutReturnCodeString "500"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/110.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/120.GenerateEapAkaPayloadSystemErrorEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.GenerateAuditData

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/120.GenerateEapAkaPayloadSystemErrorEndAuditData/100.GenerateAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.SetErrorMessage
TrueRuleChain=110.LogError

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.SetErrorMessage]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION table"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0405"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/200.CheckKeyExists/110.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/400.GenerateOEMResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=GenerateEAPAkaPayloadEndAuditData
TrueRuleChain=CheckTypeOfResponse

CheckTypeOfResponse=100.CheckTypeOfResponse

GenerateEAPAkaPayloadEndAuditData=200.GenerateEAPAkaPayloadEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/400.GenerateOEMResponse/100.CheckTypeOfResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=250C.DEG30GenerateOEMResponseRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250A.DEG30ProcessActionRuleChain/400.GenerateOEMResponse/200.GenerateEAPAkaPayloadEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckResponseType

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Conditions=DEG_SSL_STATE,starts,"AUTHENTICATED"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE

TrueRuleChain=UnknownSubscriber
TrueRuleChain=BlackListedSubscriber
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=StatusDisallowed
TrueRuleChain=Authenticated
TrueRuleChain=Unknown

UnknownSubscriber=100.UnknownSubscriber_InitResponse

BlackListedSubscriber=120.BlackListedSubscriber_InitResponse

AkaWait=200.AkaWait_InitResponse
AkaWait=201.AkaWait_GetResponseTemplate
AkaWait=202.AkaWait_GenerateEapAkaPayloadWaitEndAuditData

AkaRejected=300.AkaRejected_InitResponse
AkaRejected=310.AkaRejected_DeactiveToken
AkaRejected=320.AkaRejected_GenerateEapAkaPayloadRejectedEndAuditData

Authenticated=400.Authenticated_InitResponse
Authenticated=401.Authenticated_GetResponseTemplate
Authenticated=402.Authenticated_CheckProcessedInteger

Unknown=500.Unknown_SetHttpErrorResponseTo500C

StatusDisallowed=600.DisallowedAction_InitResponse

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/100.UnknownSubscriber_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRespStatusString 403
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0406"
AdornOps=set DEG_OEMDevErrorMessageString "UnknownSubscriber"
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/120.BlackListedSubscriber_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevRespStatusString 511
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0407"
AdornOps=set DEG_OEMDevErrorMessageString "Network Authentication Required"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/200.AkaWait_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "200"
AdornOps=set DEG_OEMDevRespStatusString 200

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodePayload
FalseRuleChain=203.InitVariableAuthXMLTemplate
FalseRuleChain=205.LookUpAuthXMLTemplate
FalseRuleChain=215.AssignMessagetoResponse

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate/200.EncodePayload]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate/203.InitVariableAuthXMLTemplate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEGDROID_auth_step_Integer 1
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate/205.LookUpAuthXMLTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate/215.AssignMessagetoResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.AssignResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/201.AkaWait_GetResponseTemplate/215.AssignMessagetoResponse/100.AssignResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull DEG_XML_TEMPLATES_FILE ""
AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/202.AkaWait_GenerateEapAkaPayloadWaitEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,!=,"500C"
TrueRuleChain=100.GenerateEndAuditDataRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/202.AkaWait_GenerateEapAkaPayloadWaitEndAuditData/100.GenerateEndAuditDataRuleChain]

ClassName=LocalRuleChainInvoker
RuleChain=753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


#5001 is due to unknown user.  This error might get rectified if carrier systems are in sync.  So, 503 is responded.
#5003 is due to DIAMETER_ERROR_IDENTITY_NOT_REGISTERED as per SWx.  This may rectified after carrier systems are in sync.  So, 503 is responded.
#4001 is DIAMETER_AUTHENTICATION_REJECTED may be due to incorrect password sent by device due to unsynced authentication requests.  So, 503 is responded.
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/300.AkaRejected_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_TOKENSTATUS "DE"
AdornOps=set DEG_SSL_REQUEST_STATE "503C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0408"
AdornOps=set DEG_OEMDevErrorMessageString "AAA returns error.Check at device side and retry"


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/310.AkaRejected_DeactiveToken]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/320.AkaRejected_GenerateEapAkaPayloadRejectedEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,!=,"500C"
TrueRuleChain=100.GenerateEndAuditDataRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/320.AkaRejected_GenerateEapAkaPayloadRejectedEndAuditData/100.GenerateEndAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/400.Authenticated_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_APP_TOKEN_FLAG 1
AdornOps=set DEGDROID_auth_step_Integer 2
AdornOps=setifnull DEGDROID_SSL_COOKIE_ID ""
AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEG_OEMDevRespTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEG_CDevTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEGDROID_SSL_COOKIE_ID
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP
AdornOps=set DEG_TOKEN_VALIDITY_SECONDS ${DEGDROID_DEVICE_TOKEN_VALIDITY}


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/401.Authenticated_GetResponseTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=Authenticated_TokenLookupForDFTCase
TrueRuleChain=Authenticated_StoreToken
TrueRuleChain=Authenticated_DeviceDataLookUp
TrueRuleChain=Authenticated_DeviceData
TrueRuleChain=Authenticated_ResponseCustomization
TrueRuleChain=Authenticated_GenerateEapAkaPayloadAuthenticatedEndAuditData
TrueRuleChain=Authenticated_ServiceConfiguration
TrueRuleChain=Authenticated_GenerateResponse

Authenticated_TokenLookupForDFTCase=410.Authenticated_TokenLookupForDFTCase
Authenticated_StoreToken=420.Authenticated_StoreToken
Authenticated_DeviceDataLookUp=430.Authenticated_DeviceDataLookUp
Authenticated_DeviceData=440.Authenticated_DeviceData
Authenticated_ResponseCustomization=450.Authenticated_ResponseCustomization
Authenticated_GenerateEapAkaPayloadAuthenticatedEndAuditData=460.Authenticated_GenerateEapAkaPayloadAuthenticatedEndAuditData
Authenticated_ServiceConfiguration=470.Authenticated_ServiceConfiguration
Authenticated_GenerateResponse=480.Authenticated_GenerateResponse

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
Conditions=DEG_AUTHENTICATION_TYPE,=,"EAP"
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"DFT"
Operations=and,and
TrueRuleChain=100.InitValues
TrueRuleChain=110.Lookup
TrueRuleChain=120.CheckLookupStatus

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/100.InitValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=copy DEG_MDN DEG_CDevMobileNumberString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/110.Lookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
#TrueRuleChain=120.GeneratePostChallengeSystemErrorEndAuditData
FalseRuleChain=200.CheckTokenExist

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0409"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEGDROID_TOKENS table"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEGDROID_TOKENS table
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/120.GeneratePostChallengeSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/200.CheckTokenExist]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
FalseRuleChain=200.SetAuthTimesTamp

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/200.CheckTokenExist/200.SetAuthTimesTamp]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_FULLAUTHTIMESTAMP


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/420.Authenticated_StoreToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevMobileNumberString
RequestAttributes=DEG_IMSI
RequestAttributes=DEG_CDevTokenString
RequestAttributes=DEG_AUTHENTICATION_TYPE
RequestAttributes=DEG_AUTHENTICATION_SUBTYPE
RequestAttributes=DEG_APP_TOKEN_FLAG
RequestAttributes=DEG_FULLAUTHTIMESTAMP
ResponseAttributes=DEG_OEMDevErrorMessageString
ResponseAttributes=DEG_EVENTTIMESTAMP
RuleChain=005.DEG30StoreTokenRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/430.Authenticated_DeviceDataLookUp]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200M.DEG30DeviceDataLookupRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/440.Authenticated_DeviceData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200N.DEG30DeviceDataProcessRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/450.Authenticated_ResponseCustomization]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=180.ProcessResponseAttributeCustomization
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/460.Authenticated_GenerateEapAkaPayloadAuthenticatedEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,!=,"500C"
TrueRuleChain=100.GenerateEndAuditDataRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/460.Authenticated_GenerateEapAkaPayloadAuthenticatedEndAuditData/100.GenerateEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
TrueRuleChain=GenerateEapAkaPayloadAAAAuthenticatedEndAuditData
TrueRuleChain=GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditData
GenerateEapAkaPayloadAAAAuthenticatedEndAuditData=100.GenerateEapAkaPayloadAAAAuthenticatedEndAuditData
GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditData=100.GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditData

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/460.Authenticated_GenerateEapAkaPayloadAuthenticatedEndAuditData/100.GenerateEndAuditDataRuleChain/100.GenerateEapAkaPayloadAAAAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/460.Authenticated_GenerateEapAkaPayloadAuthenticatedEndAuditData/100.GenerateEndAuditDataRuleChain/100.GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/470.Authenticated_ServiceConfiguration]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.DEG30ProcessServiceConfigurationRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/480.Authenticated_GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_XMLTemplateResponseString,!=,""

TrueRuleChain=10.AssignResponseFromServiceConfigTemplate

FalseRuleChain=20.AssignResponseFromAuthConfigTemplate

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/480.Authenticated_GenerateResponse/10.AssignResponseFromServiceConfigTemplate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_XMLTemplateResponseString ResponseMessage

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/402.Authenticated_CheckProcessedInteger/480.Authenticated_GenerateResponse/20.AssignResponseFromAuthConfigTemplate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/500.Unknown_SetHttpErrorResponseTo500C]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0410"
AdornOps=set DEG_OEMDevErrorMessageString "Unknown DEG_SSL_STATE"
AdornOps=set DEG_CDevOutReturnCodeString "500"


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250C.DEG30GenerateOEMResponseRuleChain/100.CheckResponseType/600.DisallowedAction_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevHttpStatusInteger "511"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0411"
AdornOps=set DEG_OEMDevErrorMessageString "Network Authentication Required"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateEAPAKAPayloadEndAuditData

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

#Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
#Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
#Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_AAA"
#Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"


#TrueRuleChain=AkaWait
#TrueRuleChain=AkaRejected
#TrueRuleChain=AuthenticatedAAA
#TrueRuleChain=AuthenticatedDEGToken
TrueRuleChain=StatusDisallowed

#AkaRejected=100.GenerateEapAkaPayloadRejectedEndAuditData

#AkaWait=200.GenerateEapAkaPayloadWaitEndAuditData

#AuthenticatedAAA=300.GenerateEapAkaPayloadAAAAuthenticatedEndAuditData

#AuthenticatedDEGToken=400.GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditData

StatusDisallowed=500.GenerateEapAkaPayloadDisallowedActionEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/100.GenerateEapAkaPayloadRejectedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/200.GenerateEapAkaPayloadWaitEndAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/300.GenerateEapAkaPayloadAAAAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/400.GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250D.DEG30GenerateEapAkaPayloadEndAuditDataRuleChain/100.GenerateEAPAKAPayloadEndAuditData/500.GenerateEapAkaPayloadDisallowedActionEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=210.GetActiveMonitoringSessionsByIMSI
RuleNames=220.GetActiveMonitoringSessionsByMDN
RuleNames=230.GetActiveMonitoringSessionsByUNIQUEID
RuleNames=300.GenerateEAPAKAPayloadStartAuditData
RuleNames=350.InitSslSessionUpdate
RuleNames=400.ExecuteSslSessionUpdate
RuleNames=410.CheckSslSessionUpdateStatus

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/100.InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_STATE WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA
AdornOps=copy DEG_SSL_NAI DEG_OEMDevSubscriberIdString
AdornOps=copy DEG_SSL_IMSI DEG_OEMDevImsiString
AdornOps=copy DEG_SSL_IMSI DEG_IMSI
AdornOps=copy DEG_SSL_MDN DEG_CDevMobileNumberString
AdornOps=copy DEG_SSL_MDN DEG_MDN

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/210.GetActiveMonitoringSessionsByIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitVariables
TrueRuleChain=110.CheckIfMonitoredSession

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/210.GetActiveMonitoringSessionsByIMSI/100.InitVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_IMSI DEG_MSESSIONKEY

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/210.GetActiveMonitoringSessionsByIMSI/110.CheckIfMonitoredSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessionsV2

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/220.GetActiveMonitoringSessionsByMDN]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitVariables
TrueRuleChain=110.CheckIfMonitoredSession

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/220.GetActiveMonitoringSessionsByMDN/100.InitVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_MDN DEG_MSESSIONKEY

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/220.GetActiveMonitoringSessionsByMDN/110.CheckIfMonitoredSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessionsV2

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/230.GetActiveMonitoringSessionsByUNIQUEID]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitVariables
TrueRuleChain=110.CheckIfMonitoredSession

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/230.GetActiveMonitoringSessionsByUNIQUEID/100.InitVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_MSESSIONKEY

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/230.GetActiveMonitoringSessionsByUNIQUEID/110.CheckIfMonitoredSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessionsV2

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/300.GenerateEAPAKAPayloadStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/350.InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/400.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0412"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_SSL_SESSION table"
AdornOps=set DEG_CDevOutReturnCodeString "500"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0413"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION table"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/250B.DEG30UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/200.CheckKeyExists/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Database Error: Unable to find the row in DEG_SSL_SESSION store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
#AdornOps=set DEG_AuditMessageString "DEVICE TO DEG -> Received auth-post-challenge request: "
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Received "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/751.DEG30GenerateEapAkaPayloadStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]


ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

#AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending auth-post-challenge response: "
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by AAA,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/752.DEG30GenerateEapAkaPayloadAAAAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

#AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending auth-post-challenge response: "
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sent EAP-AKA message to Device,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/753.DEG30GenerateEapAkaPayloadWaitEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

#AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending auth-post-challenge response: "
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by default,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/754.DEG30GenerateEapAkaPayloadDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

#QXCM1001475098 -DEG_CDevOutReturnCodeString is changed from 12 to 503 in below rule chain

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "503"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

#AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending auth-post-challenge response: "
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Authentication attempt rejected by AAA"
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/755.DEG30GenerateEapAkaPayloadRejectedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain]


ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

#AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending auth-post-challenge response: "
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/756.DEG30GenerateEapAkaPayloadSystemErrorEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

#QXCM1001475098 -DEG_CDevOutReturnCodeString is changed from 12 to 511 in below rule chain

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "511"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

#AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending auth-post-challenge response: "
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Status Disallowed Action,Return code is"
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Payload_Core/RuleChains/757.DEG30GenerateEapAkaPayloadDisallowedActionEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true
