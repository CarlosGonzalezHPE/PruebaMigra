

[/templates/DEG/AAAuthentication/Common]


[/templates/DEG/AAAuthentication/Common/Connectors]

ClassName=com.hp.siu.serverutils.ConnectorManager
ConnectorNames=900.AAASessionScheduler
ConnectorNames=100.DiameterServerAdapter
ConnectorNames=200.RadiusServerAdapter
ConnectorNames=300.EAPAdapter
ConnectorNames=600.RefereshCacheConnector
ConnectorNames=700.CorbaConnector


[/templates/DEG/AAAuthentication/Common/Connectors/100.DiameterServerAdapter]

ApplicationId=16777250
ApplicationIdAttribute=DEG_AAASWaAppIdLong
AuthApplicationIds=16777250
ClassName=com.hp.usage.diameter.DiameterAdapter
CommandCodeAttribute=DEG_AAASWaCommandcodeInteger
E2EAttribute=DEG_AAASWaE2ELong
ErrorFlagAttribute=DEG_AAASWaErrorFlagInteger
GSMQueueSize=10
HbHAttribute=DEG_AAASWaHbHLong
JNDIName=AAA Server
MaxConnectionNumber=5
MaxDMPoolSize=10
MinDMPoolSize=10
NeedResponseAttribute=DEG_AAASWaNeedResponseInteger
ProductName=AAA Session Server
ProxiableFlagAttribute=DEG_AAASWaProxiableFlagInteger
RemoteHostAttribute=DEG_AAASWaDesthostString
RemoteRealmAttribute=DEG_AAASWaDestRealmString
RequestFlagAttribute=DEG_AAASWaRequestFlagInteger
RetransmitFlagAttribute=DEG_AAASWaRetransmitFlagInteger
RetryTimeouts=3,20
ServerHost=${AAA_DIAMETER_SERVER_HOST_NAME}
ServerIP=${AAA_DIAMETER_HOST_IP}
ServerRealm=${AAA_DIAMETER_SERVER_REALM}
StopAttribute=DEG_AAASWaStopInteger


[/templates/DEG/AAAuthentication/Common/Connectors/100.DiameterServerAdapter/DecoderFactory]

ClassName=com.hp.usage.diameter.codec.AVPDecoderFactory
DecoderMap=268,1,Decoder


[/templates/DEG/AAAuthentication/Common/Connectors/100.DiameterServerAdapter/DecoderFactory/Decoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpDecoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWa/DiameterEAPRequestSWa


[/templates/DEG/AAAuthentication/Common/Connectors/100.DiameterServerAdapter/EncoderFactory]

ClassName=com.hp.usage.diameter.codec.AVPEncoderFactory
EncoderMap=268,0,Encoder


[/templates/DEG/AAAuthentication/Common/Connectors/100.DiameterServerAdapter/EncoderFactory/Encoder]

ClassName=com.hp.usage.diameter.codec.CcfAvpEncoder
FormatId=http://www.hp.com/usage/datastruct/xfd/diameterSWa/DiameterEAPAnswerSWa


[/templates/DEG/AAAuthentication/Common/Connectors/100.DiameterServerAdapter/StateMachinePool]

ClassName=com.hp.usage.diameter.StateMachinePool
GSMQueueSize=100
ThreadPoolSize=1


[/templates/DEG/AAAuthentication/Common/Connectors/100.DiameterServerAdapter/StateMachinePool/StateMachine]

ClassName=com.hp.usage.diameter.GenericStateMachine
MessageCodeAttribute=DEG_AAASWaCommandcodeInteger
MessageDirectionAttribute=DEG_AAASWaRequestFlagInteger
RuleChainMapping=268,1,100.DERProcessingRuleChain


[/templates/DEG/AAAuthentication/Common/Connectors/100.DiameterServerAdapter/Transport]

ClassName=com.hp.usage.diameter.DiameterTCPTransport
HostName=${AAA_DIAMETER_HOST_IP}
HostsMap=${DEVICE_DIAMETER_SERVER_HOST_NAME},${AAA_DIAMETER_SERVER_REALM},${DEVICE_DIAMETER_SERVER_HOST_IP},${DEVICE_DIAMETER_SERVER_PORT}
PortNumber=${AAA_DIAMETER_SERVER_PORT}


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter]

ClassName=com.hp.usage.radius.adapter.RadiusAdapter
Codec=RadiusCodec
EnableAlarm=true
EnableManagementService=true


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/RadiusCodec]


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/RadiusCodec/Decoder]

UseRepository=true
XfdList=radius.AccessRequest
XfdList=radius.AccessReject
XfdList=radius.AccessAccept
XfdList=radius.AccessChallenge


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/RadiusCodec/Decoder/radius.AccessAccept]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/RadiusCodec/Decoder/radius.AccessChallenge]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/RadiusCodec/Decoder/radius.AccessReject]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/RadiusCodec/Decoder/radius.AccessRequest]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/RadiusCodec/Encoder]

UseRepository=true
XfdList=radius.AccessRequest
XfdList=radius.AccessReject
XfdList=radius.AccessAccept
XfdList=radius.AccessChallenge


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/RadiusCodec/Encoder/radius.AccessAccept]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/RadiusCodec/Encoder/radius.AccessChallenge]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/RadiusCodec/Encoder/radius.AccessReject]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/RadiusCodec/Encoder/radius.AccessRequest]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/Server]

CacheResponse=true
ClassName=RadiusServer
EnableProxy=false
Host=${AAA_RADIUS_SERVER_HOST_IP}
Port=${AAA_RADIUS_SERVER_HOST_PORT}
RecvBufferSize=65536
RequestProcessor=ServerRequestProcessor
RequestTTL=300
SendBufferSize=65536
SessionTTL=3000
SharedSecretStores=staticstore


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/Server/RadiusAdapterErrorProcessor]

ClassName=com.hp.usage.radius.adapter.RuleChainErrorProcessor
ErrorCodeAttribute=DEG_AAARadiusErrorCodeString
ErrorMessageAttribute=DEG_AAARadiusErrorMessageString
ErrorPacketAttribute=DEG_AAARadiusErrorPacketBinary
ErrorRuleChain=610.RadiusErrorRuleChain
HostAttribute=DEG_AAARadiusErrorHostString
PortAttribute=DEG_AAARadiusErrorPortInteger


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/Server/ServerRequestProcessor]

ClassName=com.hp.usage.radius.adapter.RuleChainMessageProcessor
RuleChainMapping=1,600.RadiusProcessingRuleChain


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/Server/staticstore]

ClassName=StaticSharedSecretStore
Clients=Client1


[/templates/DEG/AAAuthentication/Common/Connectors/200.RadiusServerAdapter/Server/staticstore/Client1]

Host=${AAA_RADIUS_CLIENT_HOST_IP}
SecretCode=${AAA_RADIUS_CLIENT_SECRET_CODE}


[/templates/DEG/AAAuthentication/Common/Connectors/300.EAPAdapter]

ClassName=com.hp.usage.eap.adapter.EAPAdapter
EAPCodeAttribute=DEG_EAPCodeInteger
EAPMessageAttribute=DEG_EAPMessageBinary
EAPOperationAttribute=DEG_EAPOperationString
EAPTransactionIDAttribute=DEG_EAPTransactionIDBinary
EnableManagementService=false


[/templates/DEG/AAAuthentication/Common/Connectors/300.EAPAdapter/Authenticator]

DefaultType=18
DynamicallySelectType=true
TransactionTTL=20
Types=eap-aka
Types=eap-sim


[/templates/DEG/AAAuthentication/Common/Connectors/300.EAPAdapter/Authenticator/eap-aka]

ClassName=com.hp.usage.eap.aka.authenticator.EAPAKAAuthenticatorHandler
FastReAuth=false
IdentityPrefix=0
IdentityPrivacy=false
ReAuthCounter=3
Type=23
UseEAPIdentity=true
UseResultIndication=false


[/templates/DEG/AAAuthentication/Common/Connectors/300.EAPAdapter/Authenticator/eap-aka/EAPStore]

Attributes=AUTN,DEG_EAPAKAAUTNList
Attributes=CK,DEG_EAPAKACKList
Attributes=IK,DEG_EAPAKAIKList
Attributes=RES,DEG_EAPAKAXRESList
Attributes=RAND,DEG_EAPAKARANDList
Attributes=UserIdentity,DEG_EAPUserIdentityString
Attributes=AUTS,DEG_EAPAKAAUTSBinary
Attributes=RE_SYNC_RAND,DEG_EAPAKARANDBinary
Attributes=AKAOperation,DEG_EAPAKAOperation
ClassName=com.hp.usage.eap.aka.common.RuleChainEAPAKAStore
RuleChainName=300.EAPAKAProcessingRuleChain


[/templates/DEG/AAAuthentication/Common/Connectors/300.EAPAdapter/Authenticator/eap-sim]

ClassName=com.hp.usage.eap.sim.authenticator.EAPSIMAuthenticatorHandler
FastReAuth=false
IdentityPrefix=1
IdentityPrivacy=false
ReAuthCounter=3
Type=18
UseEAPIdentity=true
UseResultIndication=false
VersionList=1


[/templates/DEG/AAAuthentication/Common/Connectors/300.EAPAdapter/Authenticator/eap-sim/EAPStore]

Attributes=SRES,DEG_EAPSIMSRESList
Attributes=RAND,DEG_EAPSIMRANDList
Attributes=UserIdentity,DEG_EAPUserIdentityString
Attributes=KC,DEG_EAPSIMKCList
Attributes=TripletSetCount,DEG_EAPSIMTripletsRequiredInteger
ClassName=com.hp.usage.eap.sim.common.RuleChainEAPSIMStore
RuleChainName=310.EAPSIMProcessingRuleChain


[/templates/DEG/AAAuthentication/Common/Connectors/600.RefereshCacheConnector]

ClassName=com.hp.siu.plugins.dna.collector.rules.SocketConnector
ListenPort=${AAA_LISTEN_PORT}


[/templates/DEG/AAAuthentication/Common/Connectors/700.CorbaConnector]

ClassName=CorbaConnector


[/templates/DEG/AAAuthentication/Common/Connectors/900.AAASessionScheduler]

ClassName=com.hp.siu.scheduler.Scheduler
ScheduledJobs=100.AAASessionExpirationValidator


[/templates/DEG/AAAuthentication/Common/Connectors/900.AAASessionScheduler/100.AAASessionExpirationValidator]

MaxExecutions=-1
PollIntervalClassName=com.hp.siu.utils.SecondsInterval
QueryInterval=50ms
TaskLogLevel=DEBUG4
Tasks=100.ProcessAAATimedOutSessions


[/templates/DEG/AAAuthentication/Common/Connectors/900.AAASessionScheduler/100.AAASessionExpirationValidator/100.ProcessAAATimedOutSessions]

ClassName=com.hp.siu.sessionserver.InvokeRuleChainTask
InputNMEAttributes=EndTime,%current_time%
RuleChain=800.AAATimedOutSessionsProcessingRuleChain


[/templates/DEG/AAAuthentication/Common/ReferenceDataService]

ClassName=com.hp.siu.serverutils.RefDataServiceManager
QueryNames=100.QueryExpiredAAASessions
QueryNames=200.QueryMonitoringIdGenerator
QueryNames=300.QueryActiveMonitoringSessions


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/100.QueryExpiredAAASessions]

ClassName=JDBCQuery
CommitQuery=false
CommonPolicyID=Policy1
FieldExtracted=DEG_AAA_SESSID,DEG_AAASessionIdString,""
FieldExtracted=DEG_AAA_AUC_ID,DEG_AAAAUCSessionIDString,""
FieldExtracted=DEG_RESULT_CODE,DEG_AAAResultCodeInteger,0
FieldExtracted=DEG_USERIDENTITY,DEG_AAAUserIdentityString,""
FieldExtracted=DEG_STATUS,DEG_AAASessionStatusString,""
FieldExtracted=DEG_FIRSTREQTIMESTAMP,DEG_AAAFirstRequestedTimestampLong,0
FieldExtracted=DEG_UPDATEDTIMESTAMP,DEG_AAAUpdatedTimestampLong,0
QueryString=select %FIELDS from DEG_AAA_SESSIONS
ResultAttribute=DEG_AAARecordFoundInteger
ResultIndexAttribute=DEG_AAAIndexInteger


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/100.QueryExpiredAAASessions/ErrorRule]

ClassName=RuleChain
RuleNames=100.SetErrorInfo
RuleNames=100.LogAlarming


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/100.QueryExpiredAAASessions/ErrorRule/100.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Database Error:


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/100.QueryExpiredAAASessions/ErrorRule/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0000"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/100.QueryExpiredAAASessions/InitialRule]

ClassName=RuleChain
RuleNames=100.InitParams
RuleNames=200.LogNME


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/100.QueryExpiredAAASessions/InitialRule/100.InitParams]

AdornOps=set DEG_AAARecordFoundInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
AdornOps=set DEG_AAASessionIdString ""
AdornOps=set DEG_AAAAUCSessionIDString ""
AdornOps=set DEG_AAAResultCodeInteger 0
AdornOps=set DEG_AAAUserIdentityString ""
AdornOps=set DEG_AAASessionStatusString ""
AdornOps=set DEG_AAAFirstRequestedTimestampLong 0
AdornOps=set DEG_AAAUpdatedTimestampLong 0
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0001"
AdornOps=set DEG_OEMDevErrorMessageString "AAA Session Timeout QUERY STARTS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/100.QueryExpiredAAASessions/InitialRule/200.LogNME]

Attributes=DEG_AAARecordFoundInteger
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=LogNMERule
LogLevel=DEBUG4
Message=AAA Session Timeout QUERY STARTS:


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/100.QueryExpiredAAASessions/ResultRowRule]

ClassName=RuleChain
RuleNames=100.SetMatchFound
RuleNames=110.LogQueriedSession
RuleNames=200.DeleteExpiredAAASessions


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/100.QueryExpiredAAASessions/ResultRowRule/100.SetMatchFound]

AdornOps=set DEG_AAARecordFoundInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0002"
AdornOps=set DEG_OEMDevErrorMessageString "QueryExpiredSessions ResultRowRule"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/100.QueryExpiredAAASessions/ResultRowRule/110.LogQueriedSession]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAAUCSessionIDString
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAAUserIdentityString
Attributes=DEG_AAASessionStatusString
Attributes=DEG_AAAFirstRequestedTimestampLong
Attributes=DEG_AAAUpdatedTimestampLong
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=QueryExpiredSessions ResultRowRule :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/100.QueryExpiredAAASessions/ResultRowRule/200.DeleteExpiredAAASessions]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=810.DeleteAAAExpiredSessionsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/200.QueryMonitoringIdGenerator]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
CommonPolicyID=Policy2
FieldExtracted=DEG_MSESSIONTRANSID,DEG_MSESSIONTRANSID
QueryString=SELECT SEQUENCE_NEXTVAL('DEG_MONITORINGID_GENERATOR') AS DEG_MSESSIONTRANSID
ResultAttribute=DEG_AAANrbRecordFoundInteger
ResultIndexAttribute=DEG_AAANrbIndexInteger


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/200.QueryMonitoringIdGenerator/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorInfo
RuleNames=100.LogAlarming


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/200.QueryMonitoringIdGenerator/ErrorRule/100.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/200.QueryMonitoringIdGenerator/ErrorRule/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0003"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/200.QueryMonitoringIdGenerator/FinalRule]

AdornOps=copy DEG_AAANrbRecordFoundInteger DEG_AAANrbRecordFoundInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/200.QueryMonitoringIdGenerator/InitialRule]

AdornOps=set DEG_AAANrbRecordFoundInteger 0
AdornOps=set DEG_AAANrbIndexInteger 0
AdornOps=set DEG_MSESSIONTRANSID 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_MONITORINGID_GENERATOR.NEXTVAL"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/200.QueryMonitoringIdGenerator/ResultRowRule]

AdornOps=set DEG_AAANrbRecordFoundInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/300.QueryActiveMonitoringSessions]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
CommonPolicyID=Policy2
FieldExtracted=DEG_MSESSIONID,DEG_MSESSIONID
QueryConditionColumns=DEG_MSESSIONKEY,VarChar
QueryString=SELECT %FIELDS FROM DEG_MONITORING_SESSIONS WHERE DEG_MSESSIONTYPE in ('MDN','IMSI') AND DEG_MSESSIONSTATUS='AE' AND DEG_MSESSIONKEY = %DEG_MSESSIONKEY
ResultAttribute=DEG_AAANrbRecordFoundInteger
ResultIndexAttribute=DEG_AAANrbIndexInteger


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/300.QueryActiveMonitoringSessions/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.SetErrorFlag
RuleNames=100.LogAlarming


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/300.QueryActiveMonitoringSessions/ErrorRule/001.SetErrorFlag]

AdornOps=set DEG_AAADBErrorFlagInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0004"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/300.QueryActiveMonitoringSessions/ErrorRule/100.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/300.QueryActiveMonitoringSessions/FinalRule]

AdornOps=copy DEG_AAANrbRecordFoundInteger DEG_AAANrbRecordFoundInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/300.QueryActiveMonitoringSessions/InitialRule]

AdornOps=set DEG_AAADBErrorFlagInteger 0
AdornOps=set DEG_AAANrbRecordFoundInteger 0
AdornOps=set DEG_AAANrbIndexInteger 0
AdornOps=set DEG_MSESSIONID ""
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_MONITORING_SESSIONS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/300.QueryActiveMonitoringSessions/ResultRowRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetRecordFound
RuleNames=200.PopulateMonitoringSessionIdsList


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/300.QueryActiveMonitoringSessions/ResultRowRule/100.SetRecordFound]

AdornOps=set DEG_AAANrbRecordFoundInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/ReferenceDataService/300.QueryActiveMonitoringSessions/ResultRowRule/200.PopulateMonitoringSessionIdsList]

ClassName=AddToListAttributeRule
Delimiters=,
InputAttribute=DEG_MSESSIONID
ListAttribute=DEG_AAANrbMonitoringSessionIdList


[/templates/DEG/AAAuthentication/Common/RuleChains]

ClassName=com.hp.siu.sessionserver.RuleChainManager
MaxPoolSize=10
MinPoolSize=10
RuleChainNames=001.DeleteSessionRuleChain
RuleChainNames=002.DeleteSessionErrorRuleChain
RuleChainNames=003.SessionStoreDefaultErrorRuleChain
RuleChainNames=004.SessionStoreKeyNotExistsRuleChain
RuleChainNames=005.SessionStoreDuplicateKeyRuleChain
RuleChainNames=008.ReadMonitoringSessionRuleChain
RuleChainNames=100.DERProcessingRuleChain
RuleChainNames=102.DERErrorNMEToSNMERuleChain
RuleChainNames=103.DERSuccessNMEToSNMERuleChain
RuleChainNames=200.CheckEAPTransactionResultRuleChain
RuleChainNames=300.EAPAKAProcessingRuleChain
RuleChainNames=310.EAPSIMProcessingRuleChain
RuleChainNames=320.EAPTransactionProcessingRuleChain
RuleChainNames=600.RadiusProcessingRuleChain
RuleChainNames=610.RadiusErrorRuleChain
RuleChainNames=700.CheckEAPTransactionResultRuleChain
RuleChainNames=800.AAATimedOutSessionsProcessingRuleChain
RuleChainNames=810.DeleteAAAExpiredSessionsRuleChain
RuleChainNames=900.GenerateAccessRequestStartAuditDataRuleChain
RuleChainNames=901.GenerateAccessRequestAuthWaitEndAuditDataRuleChain
RuleChainNames=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
RuleChainNames=903.GenerateAccessRequestAuthenticatedByAAAAuditDataRuleChain
RuleChainNames=904.GenerateDERStartAuditDataRuleChain
RuleChainNames=905.GenerateDERAuthWaitEndAuditDataRuleChain
RuleChainNames=906.GenerateDERAuthRejectedEndAuditDataRuleChain
RuleChainNames=907.GenerateDERAuthenticatedByAAAAuditDataRuleChain
RuleChainNames=908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain
RuleChainNames=909.GenerateAAADiameterHSSCallStartAuditDataRuleChain
RuleChainNames=910.GenerateAAADiameterHSSCallEndErrorAuditDataRuleChain
RuleChainNames=911.GenerateAAADiameterHSSCallEndOKAuditDataRuleChain
RuleChainNames=915.GenerateAuditAndNRBEventsRuleChain
RuleChainNames=916.DumpMonitoringTransactionsRuleChain


[/templates/DEG/AAAuthentication/Common/RuleChains/001.DeleteSessionRuleChain]

ClassName=RuleChain
RuleNames=001.InitDelete
RuleNames=002.DeleteSession


[/templates/DEG/AAAuthentication/Common/RuleChains/001.DeleteSessionRuleChain/001.InitDelete]

AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=set log_DB_Operation "DELETE"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/001.DeleteSessionRuleChain/002.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=002.DeleteSessionErrorRuleChain
LogInvalidSession=false
NativeCondition=1.MatchByAAASessionId
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/002.DeleteSessionErrorRuleChain]

ClassName=RuleChain
RuleNames=010.SetErrorValues
RuleNames=020.Log


[/templates/DEG/AAAuthentication/Common/RuleChains/002.DeleteSessionErrorRuleChain/010.SetErrorValues]

AdornOps=set DEG_AAASessionStoreErrorFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to delete session from DEG_AAA_SESSIONS"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0005"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable To delete entry From DEG_AAA_SESSIONS"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/002.DeleteSessionErrorRuleChain/020.Log]

Attributes=DEG_AAA_SESSID
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable To delete entry From DEG_AAA_SESSIONS
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/003.SessionStoreDefaultErrorRuleChain]

ClassName=RuleChain
RuleNames=SetLookupErrorFlag
RuleNames=LogAlarming


[/templates/DEG/AAAuthentication/Common/RuleChains/003.SessionStoreDefaultErrorRuleChain/LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Database Error :


[/templates/DEG/AAAuthentication/Common/RuleChains/003.SessionStoreDefaultErrorRuleChain/SetLookupErrorFlag]

AdornOps=set DEG_AAASessionStoreErrorFlagInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0006"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/004.SessionStoreKeyNotExistsRuleChain]

ClassName=RuleChain
RuleNames=ClearSessionExistsFlag


[/templates/DEG/AAAuthentication/Common/RuleChains/004.SessionStoreKeyNotExistsRuleChain/ClearSessionExistsFlag]

AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 0
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/005.SessionStoreDuplicateKeyRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetDuplicateKeyFlag


[/templates/DEG/AAAuthentication/Common/RuleChains/005.SessionStoreDuplicateKeyRuleChain/100.SetDuplicateKeyFlag]

AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/008.ReadMonitoringSessionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.Initialise
RuleNames=100.ReadMonitoringSession
RuleNames=110.CheckQueryStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/008.ReadMonitoringSessionRuleChain/001.Initialise]

AdornOps=copy DEG_MDN DEG_MSESSIONKEY
AdornOps=set DEG_AAANrbMonitoringSessionIdList null
AdornOps=set DEG_AAANrbMonitoringSessionIdString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/008.ReadMonitoringSessionRuleChain/100.ReadMonitoringSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=300.QueryActiveMonitoringSessions


[/templates/DEG/AAAuthentication/Common/RuleChains/008.ReadMonitoringSessionRuleChain/100.ReadMonitoringSession/ErrorRule]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/008.ReadMonitoringSessionRuleChain/110.CheckQueryStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAANrbRecordFoundInteger,=,0
Operations=and
TrueRuleChain=100.GetActiveMonitoringSessionByIMSI


[/templates/DEG/AAAuthentication/Common/RuleChains/008.ReadMonitoringSessionRuleChain/110.CheckQueryStatus/100.GetActiveMonitoringSessionByIMSI]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.Initialise
RuleNames=100.ReadMonitoringSession
RuleNames=110.CheckQueryStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/008.ReadMonitoringSessionRuleChain/110.CheckQueryStatus/100.GetActiveMonitoringSessionByIMSI/001.Initialise]

AdornOps=copy DEG_AAAImsiString DEG_MSESSIONKEY
AdornOps=set DEG_AAANrbMonitoringSessionIdList null
AdornOps=set DEG_AAANrbMonitoringSessionIdString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/008.ReadMonitoringSessionRuleChain/110.CheckQueryStatus/100.GetActiveMonitoringSessionByIMSI/100.ReadMonitoringSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=300.QueryActiveMonitoringSessions


[/templates/DEG/AAAuthentication/Common/RuleChains/008.ReadMonitoringSessionRuleChain/110.CheckQueryStatus/100.GetActiveMonitoringSessionByIMSI/100.ReadMonitoringSession/ErrorRule]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/008.ReadMonitoringSessionRuleChain/110.CheckQueryStatus/100.GetActiveMonitoringSessionByIMSI/110.CheckQueryStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAADBErrorFlagInteger,!=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,!=,0
Operations=or
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.DeleteSession


[/templates/DEG/AAAuthentication/Common/RuleChains/008.ReadMonitoringSessionRuleChain/110.CheckQueryStatus/100.GetActiveMonitoringSessionByIMSI/110.CheckQueryStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to lookup or access DEG_MONITORING_TRANSACTIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0007"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable To lookup or access DEG_MONITORING_TRANSACTIONS table"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/008.ReadMonitoringSessionRuleChain/110.CheckQueryStatus/100.GetActiveMonitoringSessionByIMSI/110.CheckQueryStatus/110.ErrorLog]

Attributes=DEG_MSESSIONKEY
Attributes=DEG_MSESSIONID
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable To lookup or access DEG_MONITORING_TRANSACTIONS table
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/008.ReadMonitoringSessionRuleChain/110.CheckQueryStatus/100.GetActiveMonitoringSessionByIMSI/110.CheckQueryStatus/120.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain]

ClassName=RuleChain
RuleNames=100.Initialize
RuleNames=110.LogIncomingRequest
RuleNames=200.SNMEtoNME
RuleNames=100.SetErrorInfo
RuleNames=210.LogIncomingAttributes
RuleNames=300.ProcessDiameterSWaRequest


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/100.Initialize]

AdornOps=set DEG_AAASWaNeedResponseInteger 1
AdornOps=set DEG_AAASWaRequestFlagInteger 0
AdornOps=set DEG_AAAErrorProcessingFlagInteger 0
AdornOps=set DEG_AAAErrorMessageString ""
AdornOps=set DEG_AAAResultCodeInteger 0
AdornOps=set DEG_AAAResultCodeString 0
AdornOps=set DEG_AAAExperimentalResultInteger 0
AdornOps=set DEG_AAAVendorIdInteger 12345
AdornOps=set DEG_AAAExperimentalResultCodeInteger 0
AdornOps=set DEG_AAAEAPPayloadBinary 0
AdornOps=set DEG_AAARespOriginHostString "${AAA_DIAMETER_SERVER_HOST_NAME}"
AdornOps=set DEG_AAARespOriginRealmString "${AAA_SERVER_REALM}"
AdornOps=setsystime DEG_AAADERProcessStartTimeLong
AdornOps=set DEG_AAAMDNIndexLong 0
AdornOps=set DEG_MDN 0
AdornOps=setifnull DEG_OEMDevRespStatusString ""
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0008"
AdornOps=set DEG_OEMDevMessageString "DEVICEINTERFACE to AAA -> Received DER"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0009"
AdornOps=set DEG_OEMDevMessageString "DEVICEINTERFACE to AAA -> Received DER Attributes"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/110.LogIncomingRequest]

Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=DEVICEINTERFACE to AAA -> Received DER :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/200.SNMEtoNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
SNMEType=diameterSWa:DiameterEAPRequestSWa
StructuredNMEToNMEMap=session_id,DEG_AAASessionIdString,""
StructuredNMEToNMEMap=origin_Host,DEG_AAAReqOriginHostString,""
StructuredNMEToNMEMap=origin_Realm,DEG_AAAReqOriginRealmString,""
StructuredNMEToNMEMap=destination_Realm,DEG_AAAPrimaryDestRealmString,""
StructuredNMEToNMEMap=auth_application_id,DEG_AAAAuthApplicationIdInteger,0
StructuredNMEToNMEMap=auth_request_type,DEG_AAAAuthRequestTypeInteger,0
StructuredNMEToNMEMap=eap_payload,DEG_AAAEAPPayloadBinary,0
StructuredNMEToNMEMap=user_Name,DEG_AAAUserNameString,""
StructuredNMEToNMEMap=RAT_type,DEG_AAARATTypeInteger,0
StructuredNMEToNMEMap=visited_network_identifier,DEG_AAAVisitedNetworkIdBinary,0
StructuredNMEToNMEMap=authorization_lifeTime,DEG_AAAAuthLifeTime,0
StructuredNMEToNMEMap=auth_grace_period,DEG_AAAAuthGracePeriod,""
StructuredNMEToNMEMap=auth_session_state,DEG_AAAAuthSessionState,0
StructuredNMEToNMEMap=destination_host,DEG_AAAPrimaryDesthostString,""


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/210.LogIncomingAttributes]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAReqOriginHostString
Attributes=DEG_AAAReqOriginRealmString
Attributes=DEG_AAAPrimaryDestRealmString
Attributes=DEG_AAAAuthApplicationIdInteger
Attributes=DEG_AAAAuthRequestTypeInteger
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAAUserNameString
Attributes=DEG_AAACallingStationIdString
Attributes=DEG_AAARATTypeInteger
Attributes=DEG_AAAVisitedNetworkIdBinary
Attributes=DEG_AAAAuthLifeTime
Attributes=DEG_AAAAuthGracePeriod
Attributes=DEG_AAAAuthSessionState
Attributes=DEG_AAAPrimaryDesthostString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=INFO
Message=DEVICEINTERFACE to AAA -> Received DER Attributes:
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest]

CheckEAPTransactionResults=400.CheckEAPTransactionResults
CheckIfNewSession=200.LookupSession
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
DecodeAVPs=120.DecodeSWaAVPs
DecodeAVPs=130.LogDecodeSWaAVPs
EAPTransaction=300.EAPTransaction
Operations=DoAll
TrueRuleChain=Validation
TrueRuleChain=DecodeAVPs
TrueRuleChain=CheckIfNewSession
TrueRuleChain=EAPTransaction
TrueRuleChain=CheckEAPTransactionResults
Validation=100.ValidateDiameterSWaRequest
Validation=110.CheckValidationResults


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Operations=DoAll
TrueRuleChain=ValidateSessionId
TrueRuleChain=ValidateOriginHost
TrueRuleChain=ValidateOriginRealm
TrueRuleChain=ValidateDestRealm
TrueRuleChain=ValidateAppId
TrueRuleChain=ValidateRequestType
TrueRuleChain=ValidateEAPPayload
ValidateAppId=140.ValidateAppId
ValidateDestRealm=130.ValidateDestRealm
ValidateEAPPayload=160.ValidateEAPPayload
ValidateOriginHost=110.ValidateOriginHost
ValidateOriginRealm=120.ValidateOriginRealm
ValidateRequestType=150.ValidateRequestType
ValidateSessionId=100.ValidateSessionId


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/100.ValidateSessionId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionIdString,=,""
TrueRuleChain=100.SetValidationError
TrueRuleChain=110.LogValidationError


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/100.ValidateSessionId/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Diameter SWa AVP Session ID is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0010"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP Session Id is not present in incoming request"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/100.ValidateSessionId/110.LogValidationError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP Session Id is not present in incoming request :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/110.ValidateOriginHost]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAReqOriginHostString,=,""
TrueRuleChain=100.SetValidationError
TrueRuleChain=110.LogValidationError


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/110.ValidateOriginHost/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Diameter SWa AVP Origin Host is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0011"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP Origin Host is not present in incoming request"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/110.ValidateOriginHost/110.LogValidationError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAReqOriginHostString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP Origin Host is not present in incoming request :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/120.ValidateOriginRealm]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAReqOriginRealmString,=,""
TrueRuleChain=100.SetValidationError
TrueRuleChain=110.LogValidationError


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/120.ValidateOriginRealm/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Diameter SWa AVP Origin Realm is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0012"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP Origin Realm is not present in incoming request"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/120.ValidateOriginRealm/110.LogValidationError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAReqOriginRealmString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP Origin Realm is not present in incoming request :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/130.ValidateDestRealm]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAPrimaryDestRealmString,=,""
TrueRuleChain=100.SetValidationError
TrueRuleChain=110.LogValidationError


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/130.ValidateDestRealm/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Diameter SWa AVP Destination Realm is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0013"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP Destination Realm is not present in incoming request"
ClassName=com.hp.siu.collector.rules.AdornmentRule
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/130.ValidateDestRealm/110.LogValidationError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAPrimaryDestRealmString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP Destination Realm is not present in incoming request :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/140.ValidateAppId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAAuthApplicationIdInteger,=,0
TrueRuleChain=100.SetValidationError
TrueRuleChain=110.LogValidationError


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/140.ValidateAppId/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Diameter SWa AVP Application ID is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0014"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP Application Id is not present in incoming request"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/140.ValidateAppId/110.LogValidationError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAAuthApplicationIdInteger
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP Application Id is not present in incoming request :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/150.ValidateRequestType]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAAuthRequestTypeInteger,=,0
TrueRuleChain=100.SetValidationError
TrueRuleChain=110.LogValidationError


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/150.ValidateRequestType/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Diameter SWa AVP Request Type is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0015"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP Request Type is not present in incoming request"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/150.ValidateRequestType/110.LogValidationError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAAuthRequestTypeInteger
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP Request Type is not present in incoming request :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/160.ValidateEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAEAPPayloadBinary,=,0
TrueRuleChain=100.SetValidationError
TrueRuleChain=110.LogValidationError


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/160.ValidateEAPPayload/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Diameter SWa AVP EAPPayload is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0016"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP EAP Payload is not present in incoming request"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/100.ValidateDiameterSWaRequest/160.ValidateEAPPayload/110.LogValidationError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP EAP Payload is not present in incoming request :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/110.CheckValidationResults]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,!=,0
Conditions=DEG_AAAErrorMessageString,!=,""
Operations=and
TrueRuleChain=001.ErrorNMEToSNME
TrueRuleChain=002.GenerateAAASystemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/110.CheckValidationResults/001.ErrorNMEToSNME]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAAErrorMessageString
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_EAPMessageBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=102.DERErrorNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/110.CheckValidationResults/002.GenerateAAASystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/120.DecodeSWaAVPs]

AdornOps=bin2str DEG_AAAVisitedNetworkIdBinary DEG_AAAVisitedNetworkIdString
AdornOps=lastindexof ";" DEG_AAASessionIdString DEG_AAAMDNIndexLong
AdornOps=+ DEG_AAAMDNIndexLong 1 DEG_AAAMDNIndexLong
AdornOps=substr DEG_AAAMDNIndexLong length DEG_AAASessionIdString DEG_MDN
AdornOps=substr 1 "@" DEG_AAAUserNameString DEG_AAAImsiString
AdornOps=setifnull DEG_AAAImsiString ""
AdornOps=setifnull DEG_MDN 0
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0017"
AdornOps=set DEG_OEMDevMessageString "Successfully validated DER Attributes"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/130.LogDecodeSWaAVPs]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAReqOriginHostString
Attributes=DEG_AAAReqOriginRealmString
Attributes=DEG_AAAPrimaryDestRealmString
Attributes=DEG_AAAAuthApplicationIdInteger
Attributes=DEG_AAAAuthRequestTypeInteger
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAAUserNameString
Attributes=DEG_AAACallingStationIdString
Attributes=DEG_AAARATTypeInteger
Attributes=DEG_AAAVisitedNetworkIdBinary
Attributes=DEG_AAAAuthLifeTime
Attributes=DEG_AAAAuthGracePeriod
Attributes=DEG_AAAAuthSessionState
Attributes=DEG_AAAPrimaryDesthostString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Successfully validated DER Attributes:
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitLookup
RuleNames=200.Lookup
RuleNames=300.CheckLookupStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/100.InitLookup]

AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/200.Lookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_AAA_AUC_ID,DEG_AAA_AUC_ID
MapAttributes=DEG_RESULT_CODE,DEG_RESULT_CODE
MapAttributes=DEG_USERIDENTITY,DEG_USERIDENTITY
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_FIRSTREQTIMESTAMP,DEG_FIRSTREQTIMESTAMP
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus]

AAASessionExists=200.CheckAAAExistingSession
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
Conditions=DEG_AAASessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_AAA_SESSID,=,DEG_AAA_SESSID
NoAAASession=100.CreateNewAAASession
Operations=None
SystemError=000.SystemError_SetDiameterSWaErrorResponse
SystemError=010.SystemErrorLog
SystemError=020.ErrorNMEToSNME
TrueRuleChain=SystemError
TrueRuleChain=NoAAASession
TrueRuleChain=AAASessionExists


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/000.SystemError_SetDiameterSWaErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to lookup or access DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0018"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to lookup or access DEG_AAA_SESSIONS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/010.SystemErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access DEG_AAA_SESSIONS table
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/020.ErrorNMEToSNME]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAAErrorMessageString
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_EAPMessageBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=102.DERErrorNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitCreateSession
RuleNames=110.CreateSession
RuleNames=120.CheckCreateSessionStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/100.InitCreateSession]

AdornOps=set log_DB_Operation INSERT
AdornOps=set log_Table_Name DEG_AAA_SESSIONS
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=set DEG_AAA_AUC_ID ""
AdornOps=set DEG_RESULT_CODE 0
AdornOps=copy DEG_AAAUserNameString DEG_USERIDENTITY
AdornOps=set DEG_STATUS "NEW"
AdornOps=setsystime DEG_FIRSTREQTIMESTAMP
AdornOps=set DEG_UPDATEDTIMESTAMP 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/110.CreateSession]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=005.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/120.CheckCreateSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
Conditions=DEG_AAASessionStoreKeyExistsFlagInteger,=,1
FalseRuleChain=400.GenerateDERStartAuditData
Operations=or
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=200.ErrorNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/120.CheckCreateSessionStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to create or access entry in DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0019"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to access or create entry in DEG_AAA_SESSIONS table"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/120.CheckCreateSessionStatus/110.ErrorLog]

Attributes=DEG_AAA_SESSID
Attributes=DEG_AAA_AUC_ID
Attributes=DEG_RESULT_CODE
Attributes=DEG_USERIDENTITY
Attributes=DEG_STATUS
Attributes=DEG_FIRSTREQTIMESTAMP
Attributes=DEG_UPDATEDTIMESTAMP
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to access or create entry in DEG_AAA_SESSIONS table
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/120.CheckCreateSessionStatus/200.ErrorNMEToSNME]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAAErrorMessageString
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_AAAEAPPayloadBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=102.DERErrorNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/120.CheckCreateSessionStatus/400.GenerateDERStartAuditData]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
GetActiveMonitoringSessionsByMDN=001.GetActiveMonitoringSessionsByMDN
InvokeStartAuditDataGeneration=100.InvokeStartAuditDataGeneration
Operations=DoAll
TrueRuleChain=GetActiveMonitoringSessionsByMDN
TrueRuleChain=InvokeStartAuditDataGeneration


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/120.CheckCreateSessionStatus/400.GenerateDERStartAuditData/001.GetActiveMonitoringSessionsByMDN]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=008.ReadMonitoringSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/120.CheckCreateSessionStatus/400.GenerateDERStartAuditData/100.InvokeStartAuditDataGeneration]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=904.GenerateDERStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_STATUS,=,"WAIT_FOR_NAK_RESPONSE"
Conditions=DEG_STATUS,=,"WAIT_FOR_CHALLENGE_RESPONSE"
Operations=None
ReceivedChallengeResponse=002.UpdateAAASessionForChallengeResponse
ReceivedNAKResponse=001.UpdateAAASessionForNAKResponse
TrueRuleChain=ReceivedNAKResponse
TrueRuleChain=ReceivedChallengeResponse


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse]

ClassName=RuleChain
RuleNames=100.InitialiseUpdateSession
RuleNames=200.UpdateAAASession
RuleNames=300.CheckUpdateStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/100.InitialiseUpdateSession]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_AAA_SESSIONS
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 0
AdornOps=set DEG_STATUS "RECEIVED_NAK"
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/200.UpdateAAASession]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeConditions=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
FalseRuleChain=400.GenerateDERStartAuditData
TrueRuleChain=100.SystemError_SetDiameterSWaErrorResponse
TrueRuleChain=110.SystemErrorLog
TrueRuleChain=200.ErrorNMEToSNME
TrueRuleChain=300.GenerateAAASystemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/100.SystemError_SetDiameterSWaErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0020"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to update or access DEG_AAA_SESSIONS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/110.SystemErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update or access DEG_AAA_SESSIONS table
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/200.ErrorNMEToSNME]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAAErrorMessageString
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_AAAEAPPayloadBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=102.DERErrorNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/300.GenerateAAASystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/400.GenerateDERStartAuditData]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
GetActiveMonitoringSessionsByMDN=001.GetActiveMonitoringSessionsByMDN
InvokeStartAuditDataGeneration=100.InvokeStartAuditDataGeneration
Operations=DoAll
TrueRuleChain=GetActiveMonitoringSessionsByMDN
TrueRuleChain=InvokeStartAuditDataGeneration


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/400.GenerateDERStartAuditData/001.GetActiveMonitoringSessionsByMDN]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=008.ReadMonitoringSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/400.GenerateDERStartAuditData/100.InvokeStartAuditDataGeneration]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=904.GenerateDERStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.UpdateAAASessionForChallengeResponse]

ClassName=RuleChain
RuleNames=100.InitialiseUpdateSession
RuleNames=200.UpdateAAASession
RuleNames=300.CheckUpdateStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.UpdateAAASessionForChallengeResponse/100.InitialiseUpdateSession]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_AAA_SESSIONS
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 0
AdornOps=set DEG_STATUS "RECEIVED_CHALLENGE_RESPONSE"
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.UpdateAAASessionForChallengeResponse/200.UpdateAAASession]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.UpdateAAASessionForChallengeResponse/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
FalseRuleChain=400.GenerateDERStartAuditData
TrueRuleChain=100.SystemError_SetDiameterSWaErrorResponse
TrueRuleChain=110.SystemErrorLog
TrueRuleChain=200.ErrorNMEToSNME
TrueRuleChain=300.GenerateAAASystemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.UpdateAAASessionForChallengeResponse/300.CheckUpdateStatus/100.SystemError_SetDiameterSWaErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0021"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to update or access DEG_AAA_SESSIONS table while processing diameterSWa"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.UpdateAAASessionForChallengeResponse/300.CheckUpdateStatus/110.SystemErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update or access DEG_AAA_SESSIONS table while processing diameterSWa
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.UpdateAAASessionForChallengeResponse/300.CheckUpdateStatus/200.ErrorNMEToSNME]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAAErrorMessageString
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_AAAEAPPayloadBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=102.DERErrorNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.UpdateAAASessionForChallengeResponse/300.CheckUpdateStatus/300.GenerateAAASystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.UpdateAAASessionForChallengeResponse/300.CheckUpdateStatus/400.GenerateDERStartAuditData]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
GetActiveMonitoringSessionsByMDN=001.GetActiveMonitoringSessionsByMDN
InvokeStartAuditDataGeneration=100.InvokeStartAuditDataGeneration
Operations=DoAll
TrueRuleChain=GetActiveMonitoringSessionsByMDN
TrueRuleChain=InvokeStartAuditDataGeneration


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.UpdateAAASessionForChallengeResponse/300.CheckUpdateStatus/400.GenerateDERStartAuditData/001.GetActiveMonitoringSessionsByMDN]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=008.ReadMonitoringSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.UpdateAAASessionForChallengeResponse/300.CheckUpdateStatus/400.GenerateDERStartAuditData/100.InvokeStartAuditDataGeneration]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=904.GenerateDERStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/300.EAPTransaction]

ClassName=LocalRuleChainInvoker
RuleChain=320.EAPTransactionProcessingRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitLookup
RuleNames=200.Lookup
RuleNames=300.CheckLookupStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults/100.InitLookup]

AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_AAAErrorProcessingFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults/200.Lookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_AAA_AUC_ID,DEG_AAA_AUC_ID
MapAttributes=DEG_RESULT_CODE,DEG_RESULT_CODE
MapAttributes=DEG_USERIDENTITY,DEG_USERIDENTITY
MapAttributes=DEG_STATUS,DEG_STATUS
NativeCondition=2.MatchByUserIdentity
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
Conditions=DEG_AAASessionStoreKeyExistsFlagInteger,=,0
FalseRuleChain=200.CheckResultCode
Operations=or
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.ErrorNMEToSNME
TrueRuleChain=200.GenerateAAASystemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to create or access entry in DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0022"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to lookup or access DEG_AAA_SESSIONS table while Processing diameterSWa"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/110.ErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access DEG_AAA_SESSIONS table while Processing diameterSWa
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/120.ErrorNMEToSNME]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAAErrorMessageString
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_AAAEAPPayloadBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=102.DERErrorNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_RESULT_CODE,!=,0
FalseRuleChain=200.CheckEAPCode
Operations=or
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.ErrorNMEToSNME
TrueRuleChain=200.GenerateAAASystemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/100.SetAAAErrorResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_RESULT_CODE,=,5004
Conditions=DEG_RESULT_CODE,=,5012
Conditions=DEG_RESULT_CODE,=,DEG_RESULT_CODE
Default=110.SetEAPInternalError
EAPInternalError=110.SetEAPInternalError
MandatoryAVPNotPresent=100.SetMandatoryAVPNotPresentError
Operations=None
TrueRuleChain=MandatoryAVPNotPresent
TrueRuleChain=EAPInternalError
TrueRuleChain=Default


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/100.SetAAAErrorResponse/100.SetMandatoryAVPNotPresentError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Diameter SWx AVP missing in the response from HSS"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/100.SetAAAErrorResponse/110.SetEAPInternalError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "EAP Adapter Internal Processing Error"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0023"
AdornOps=set DEG_OEMDevErrorMessageString "EAP Processing Internal Error"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/110.ErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAAExperimentalResultInteger
Attributes=DEG_AAAExperimentalResultCodeInteger
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=EAP Processing Internal Error :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/120.ErrorNMEToSNME]

ClassName=LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAAErrorMessageString
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_AAAEAPPayloadBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=102.DERErrorNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/200.CheckEAPCode]

ClassName=LocalRuleChainInvoker
RuleChain=200.CheckEAPTransactionResultRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/200.GenerateAAASystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/100.DERProcessingRuleChain/300.ProcessDiameterSWaRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.GenerateAAASystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/102.DERErrorNMEToSNMERuleChain]

ClassName=RuleChain
RuleNames=001.DeleteSession
RuleNames=002.DERNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/102.DERErrorNMEToSNMERuleChain/001.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/102.DERErrorNMEToSNMERuleChain/002.DERNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/102.DERErrorNMEToSNMERuleChain/002.DERNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAASessionIdString,session_id,""
NMEToStructuredNMEMap=DEG_AAAAuthApplicationIdInteger,auth_application_id,0
NMEToStructuredNMEMap=DEG_AAAResultCodeInteger,result_Code,0
NMEToStructuredNMEMap=DEG_AAAErrorMessageString,error_message,""
NMEToStructuredNMEMap=DEG_AAAVendorIdInteger,experimental_result[0].vendor_id,0
NMEToStructuredNMEMap=DEG_AAAExperimentalResultCodeInteger,experimental_result[0].experimental_result_code,0
NMEToStructuredNMEMap=DEG_AAARespOriginHostString,origin_Host,""
NMEToStructuredNMEMap=DEG_AAARespOriginRealmString,origin_Realm,""
NMEToStructuredNMEMap=DEG_AAAAuthRequestTypeInteger,auth_request_type,0
NMEToStructuredNMEMap=DEG_AAAEAPPayloadBinary,eap_payload,0
NMEToStructuredNMEMap=DEG_AAAUserNameString,user_Name,""
NMEToStructuredNMEMap=DEG_AAARATTypeInteger,RAT_type,0
SNMEType=diameterSWa:DiameterEAPAnswerSWa


[/templates/DEG/AAAuthentication/Common/RuleChains/103.DERSuccessNMEToSNMERuleChain]

ClassName=RuleChain
RuleNames=001.DERNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/103.DERSuccessNMEToSNMERuleChain/001.DERNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/103.DERSuccessNMEToSNMERuleChain/001.DERNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAASessionIdString,session_id,""
NMEToStructuredNMEMap=DEG_AAAAuthApplicationIdInteger,auth_application_id,0
NMEToStructuredNMEMap=DEG_AAAResultCodeInteger,result_Code,0
NMEToStructuredNMEMap=DEG_AAAVendorIdInteger,experimental_result[0].vendor_id,0
NMEToStructuredNMEMap=DEG_AAAExperimentalResultCodeInteger,experimental_result[0].experimental_result_code,0
NMEToStructuredNMEMap=DEG_AAARespOriginHostString,origin_Host,""
NMEToStructuredNMEMap=DEG_AAARespOriginRealmString,origin_Realm,""
NMEToStructuredNMEMap=DEG_AAAAuthRequestTypeInteger,auth_request_type,0
NMEToStructuredNMEMap=DEG_AAAEAPPayloadBinary,eap_payload,0
NMEToStructuredNMEMap=DEG_AAAUserNameString,user_Name,""
NMEToStructuredNMEMap=DEG_AAARATTypeInteger,RAT_type,0
SNMEType=diameterSWa:DiameterEAPAnswerSWa


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain]

ClassName=RuleChain
RuleNames=100.CheckEAPCode


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/001.Initialise]

AdornOps=copy DEG_AAA_SESSID DEG_AAASessionIdString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_EAPCodeInteger,=,1
Conditions=DEG_EAPCodeInteger,=,3
Conditions=DEG_EAPCodeInteger,=,4
Conditions=DEG_EAPCodeInteger,=,0
Operations=None
ProcessEAPAccept=200.ProcessEAPAccept
ProcessEAPChallengeRequest=100.ProcessEAPChallengeRequest
ProcessEAPError=400.ProcessEAPError
ProcessEAPReject=300.ProcessEAPReject
TrueRuleChain=ProcessEAPChallengeRequest
TrueRuleChain=ProcessEAPAccept
TrueRuleChain=ProcessEAPReject
TrueRuleChain=ProcessEAPError


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest]

CheckChallengeType=004.CheckChallengeType
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
LookupAAASessions=001.InitLookup
LookupAAASessions=002.LookupSession
LookupAAASessions=003.CheckLookupStatus
Operations=DoAll
SetDERResponse=005.SetDERSuccessResponse
SetDERResponse=006.SuccessNMEToSNME
SetDERResponse=100.SetErrorInfo
SetDERResponse=007.LogChallengeResponse
SetDERResponse=008.GenerateDERChallengeRequestAuditData
TrueRuleChain=LookupAAASessions
TrueRuleChain=CheckChallengeType
TrueRuleChain=SetDERResponse


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/001.InitLookup]

AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/002.LookupSession]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_AAA_AUC_ID,DEG_AAA_AUC_ID
MapAttributes=DEG_RESULT_CODE,DEG_RESULT_CODE
MapAttributes=DEG_USERIDENTITY,DEG_USERIDENTITY
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_FIRSTREQTIMESTAMP,DEG_FIRSTREQTIMESTAMP
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/003.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=200.ErrorNMEToSNME
TrueRuleChain=300.GenerateAAASystemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/003.CheckLookupStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to access entry in DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0024"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to lookup or access  DEG_AAA_SESSIONS table while Processing ChallengeRequest"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/003.CheckLookupStatus/110.ErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access  DEG_AAA_SESSIONS table while Processing ChallengeRequest
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/003.CheckLookupStatus/200.ErrorNMEToSNME]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAAErrorMessageString
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_EAPMessageBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=102.DERErrorNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/003.CheckLookupStatus/300.GenerateAAASystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType]

ClassName=RuleChain
RuleNames=100.SetSessionStatus
RuleNames=200.UpdateAAASessions


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/100.SetSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_STATUS,=,"NEW"
Conditions=DEG_RESULT_CODE,=,0
Conditions=DEG_USERIDENTITY,=,DEG_AAAUserNameString
FalseRuleChain=200.CheckIfChallengeRequest
Operations=and,and,and
TrueRuleChain=100.SetWAIT_FOR_NAK_RESPONSE


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/100.SetSessionStatus/100.SetWAIT_FOR_NAK_RESPONSE]

AdornOps=set DEG_STATUS "WAIT_FOR_NAK_RESPONSE"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/100.SetSessionStatus/200.CheckIfChallengeRequest]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_STATUS,=,"RECEIVED_AND_VALIDATED_AUTHVECTORS_FROM_AUC"
Conditions=DEG_STATUS,=,"RECEIVED_AND_VALIDATED_REAUTHVECTORS_FROM_AUC"
Conditions=DEG_RESULT_CODE,=,0
Conditions=DEG_USERIDENTITY,=,DEG_AAAUserNameString
Operations=or,and,and
TrueRuleChain=100.SetWAIT_FOR_CHALLENGE_RESPONSE


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/100.SetSessionStatus/200.CheckIfChallengeRequest/100.SetWAIT_FOR_CHALLENGE_RESPONSE]

AdornOps=set DEG_STATUS "WAIT_FOR_CHALLENGE_RESPONSE"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions]

ClassName=RuleChain
RuleNames=100.InitAAASessionUpdate
RuleNames=200.ExecuteAAASessionUpdate
RuleNames=300.CheckAAASessionUpdateStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/100.InitAAASessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_AAA_SESSIONS
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/200.ExecuteAAASessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/300.CheckAAASessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=200.ErrorNMEToSNME
TrueRuleChain=300.GenerateAAASystemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/300.CheckAAASessionUpdateStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access entry in DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0025"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing ChallengeRequest"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/300.CheckAAASessionUpdateStatus/110.ErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing ChallengeRequest
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/300.CheckAAASessionUpdateStatus/200.ErrorNMEToSNME]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAAErrorMessageString
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_AAAEAPPayloadBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=102.DERErrorNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/300.CheckAAASessionUpdateStatus/300.GenerateAAASystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/005.SetDERSuccessResponse]

AdornOps=set DEG_AAAResultCodeInteger 1001
AdornOps=set DEG_AAAExperimentalResultInteger 1001
AdornOps=set DEG_AAAExperimentalResultCodeInteger 1001
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/006.SuccessNMEToSNME]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_AAAEAPPayloadBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=103.DERSuccessNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/007.LogChallengeResponse]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAARespOriginHostString
Attributes=DEG_AAARespOriginRealmString
Attributes=DEG_AAAAuthApplicationIdInteger
Attributes=DEG_AAAExperimentalResultInteger
Attributes=DEG_AAAVendorIdInteger
Attributes=DEG_AAAExperimentalResultCodeInteger
Attributes=DEG_AAAAuthRequestTypeInteger
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAAUserNameString
Attributes=DEG_AAARATTypeInteger
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=INFO
Message=Sending Challenge Response From AAA to DEVICEINTERFACE (DER) :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/008.GenerateDERChallengeRequestAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=905.GenerateDERAuthWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0026"
AdornOps=set DEG_OEMDevMessageString "Sending Challenge Response From AAA to DEVICEINTERFACE (DER)"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Operations=DoAll
SetDERSucessResponse=004.SetDERSuccessResponse
SetDERSucessResponse=005.DeleteAAASession
SetDERSucessResponse=006.SuccessNMEToSNME
SetDERSucessResponse=002.SetErrorInfo
SetDERSucessResponse=007.LogSuccessResponse
SetDERSucessResponse=008.GenerateDERAuthenticatedByAAAAuditData
TrueRuleChain=UpdateAAASessions
TrueRuleChain=SetDERSucessResponse
UpdateAAASessions=001.InitUpdateAAASession
UpdateAAASessions=002.ExecuteUpdateAAASession
UpdateAAASessions=003.CheckUpdateAAASessionStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/001.InitUpdateAAASession]

AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=set DEG_STATUS "AUTHENTICATED_BY_AAA"
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/002.ExecuteUpdateAAASession]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/002.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0028"
AdornOps=set DEG_OEMDevMessageString "Authentication Success Response From AAA to DEVICEINTERFACE (DER)"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/003.CheckUpdateAAASessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=200.ErrorNMEToSNME
TrueRuleChain=300.GenerateAAASystemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/003.CheckUpdateAAASessionStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access entry in DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0027"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to update or access  DEG_AAA_SESSIONS table while Processing EAPAccept"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/003.CheckUpdateAAASessionStatus/110.ErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update or access  DEG_AAA_SESSIONS table while Processing EAPAccept
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/003.CheckUpdateAAASessionStatus/200.ErrorNMEToSNME]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAAErrorMessageString
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_AAAEAPPayloadBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=102.DERErrorNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/003.CheckUpdateAAASessionStatus/300.GenerateAAASystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/004.SetDERSuccessResponse]

AdornOps=set DEG_AAAResultCodeInteger 2001
AdornOps=set DEG_AAAExperimentalResultInteger 2001
AdornOps=set DEG_AAAExperimentalResultCodeInteger 2001
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/005.DeleteAAASession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/006.SuccessNMEToSNME]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_AAAEAPPayloadBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=103.DERSuccessNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/007.LogSuccessResponse]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAARespOriginHostString
Attributes=DEG_AAARespOriginRealmString
Attributes=DEG_AAAAuthApplicationIdInteger
Attributes=DEG_AAAExperimentalResultInteger
Attributes=DEG_AAAVendorIdInteger
Attributes=DEG_AAAExperimentalResultCodeInteger
Attributes=DEG_AAAAuthRequestTypeInteger
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAAUserNameString
Attributes=DEG_AAARATTypeInteger
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=INFO
Message=Authentication Success Response From AAA to DEVICEINTERFACE (DER) :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/008.GenerateDERAuthenticatedByAAAAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=907.GenerateDERAuthenticatedByAAAAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Operations=DoAll
SetDERRejectedResponse=004.SetDERRejectedResponse
SetDERRejectedResponse=005.DeleteAAASession
SetDERRejectedResponse=006.SuccessNMEToSNME
SetDERRejectedResponse=003.SetErrorInfo
SetDERRejectedResponse=007.LogRejectedResponse
SetDERRejectedResponse=008.GenerateDERAuthRejectedAuditData
TrueRuleChain=UpdateAAASessions
TrueRuleChain=SetDERRejectedResponse
UpdateAAASessions=001.InitUpdateAAASession
UpdateAAASessions=002.ExecuteUpdateAAASession
UpdateAAASessions=003.CheckUpdateAAASessionStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/001.InitUpdateAAASession]

AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=set DEG_STATUS "REJECTED_BY_AAA"
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/002.ExecuteUpdateAAASession]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/003.CheckUpdateAAASessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=200.ErrorNMEToSNME
TrueRuleChain=300.GenerateAAASystemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/003.CheckUpdateAAASessionStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access entry in DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0029"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing EAPReject"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/003.CheckUpdateAAASessionStatus/110.ErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing EAPReject
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/003.CheckUpdateAAASessionStatus/200.ErrorNMEToSNME]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAAErrorMessageString
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_AAAEAPPayloadBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=102.DERErrorNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/003.CheckUpdateAAASessionStatus/300.GenerateAAASystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/003.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0030"
AdornOps=set DEG_OEMDevErrorMessageString "Authentication Rejected Response From AAA to DEVICEINTERFACE (DER)"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/004.SetDERRejectedResponse]

AdornOps=set DEG_AAAResultCodeInteger 5003
AdornOps=set DEG_AAAExperimentalResultInteger 5003
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5003
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/005.DeleteAAASession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/006.SuccessNMEToSNME]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_AAAEAPPayloadBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=103.DERSuccessNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/007.LogRejectedResponse]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAARespOriginHostString
Attributes=DEG_AAARespOriginRealmString
Attributes=DEG_AAAAuthApplicationIdInteger
Attributes=DEG_AAAExperimentalResultInteger
Attributes=DEG_AAAVendorIdInteger
Attributes=DEG_AAAExperimentalResultCodeInteger
Attributes=DEG_AAAAuthRequestTypeInteger
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAAUserNameString
Attributes=DEG_AAARATTypeInteger
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=LogNMERule
LogLevel=INFO
Message=Authentication Rejected Response From AAA to DEVICEINTERFACE (DER) :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/008.GenerateDERAuthRejectedAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=906.GenerateDERAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Operations=DoAll
SetDERErrorResponse=004.SetDERErrorResponse
SetDERErrorResponse=005.ErrorNMEToSNME
SetDERErrorResponse=003.SetErrorInfo
SetDERErrorResponse=006.LogErrorResponse
SetDERErrorResponse=070.GenerateAAASystemErrorAuditData
TrueRuleChain=UpdateAAASessions
TrueRuleChain=SetDERErrorResponse
UpdateAAASessions=001.InitUpdateAAASession
UpdateAAASessions=002.ExecuteUpdateAAASession
UpdateAAASessions=003.CheckUpdateAAASessionStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/001.InitUpdateAAASession]

AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=set DEG_STATUS "EAP_TRANSACTION_FAILED"
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/002.ExecuteUpdateAAASession]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/003.CheckUpdateAAASessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=200.ErrorNMEToSNME
TrueRuleChain=300.GenerateAAASystemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/003.CheckUpdateAAASessionStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access entry in DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0031"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to update or access  DEG_AAA_SESSIONS table while Processing EAPError"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/003.CheckUpdateAAASessionStatus/110.ErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update or access  DEG_AAA_SESSIONS table while Processing EAPError
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/003.CheckUpdateAAASessionStatus/200.ErrorNMEToSNME]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAAErrorMessageString
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_AAAEAPPayloadBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=102.DERErrorNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/003.CheckUpdateAAASessionStatus/300.GenerateAAASystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/003.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0032"
AdornOps=set DEG_OEMDevErrorMessageString "EAP Transaction Failed Response From AAA to DEVICEINTERFACE (DER)"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/004.SetDERErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString ""
AdornOps=+ DEG_AAAErrorMessageString DEG_EAPErrorAttributeString DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString - DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString DEG_EAPErrorMsgAttributeString DEG_AAAErrorMessageString
AdornOps=set DEG_AAAResultCodeInteger 4001
AdornOps=set DEG_AAAExperimentalResultInteger 4001
AdornOps=set DEG_AAAExperimentalResultCodeInteger 4001
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/005.ErrorNMEToSNME]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAASessionIdString
RequestAttributes=DEG_AAAResultCodeInteger
RequestAttributes=DEG_AAAErrorMessageString
RequestAttributes=DEG_AAARespOriginHostString
RequestAttributes=DEG_AAARespOriginRealmString
RequestAttributes=DEG_AAAAuthApplicationIdInteger
RequestAttributes=DEG_AAAExperimentalResultInteger
RequestAttributes=DEG_AAAVendorIdInteger
RequestAttributes=DEG_AAAExperimentalResultCodeInteger
RequestAttributes=DEG_AAAAuthRequestTypeInteger
RequestAttributes=DEG_AAAEAPPayloadBinary
RequestAttributes=DEG_AAAUserNameString
RequestAttributes=DEG_AAARATTypeInteger
RuleChain=102.DERErrorNMEToSNMERuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/006.LogErrorResponse]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAARespOriginHostString
Attributes=DEG_AAARespOriginRealmString
Attributes=DEG_AAAAuthApplicationIdInteger
Attributes=DEG_AAAExperimentalResultInteger
Attributes=DEG_AAAVendorIdInteger
Attributes=DEG_AAAExperimentalResultCodeInteger
Attributes=DEG_AAAAuthRequestTypeInteger
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAAUserNameString
Attributes=DEG_AAARATTypeInteger
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=LogNMERule
LogLevel=INFO
Message=EAP Transaction Failed Response From AAA to DEVICEINTERFACE (DER) :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/200.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/070.GenerateAAASystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain]

ClassName=RuleChain
RuleNames=500.SetErrorInfo
RuleNames=100.LogWithinEAPAKARuleChain
RuleNames=110.LookupAAASessions
RuleNames=200.CheckResultCode
RuleNames=300.UpdateAAASessionStatus
RuleNames=400.SetAuthVectors


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/100.LogWithinEAPAKARuleChain]

Attributes=DEG_EAPUserIdentityString
Attributes=DEG_EAPAKAAUTSBinary
Attributes=DEG_EAPAKARANDBinary
Attributes=DEG_EAPAKAOperation
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Start EAP-AKA Processing :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/110.LookupAAASessions]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitAAASessionLookup
RuleNames=110.ExecuteAAASessionLookup
RuleNames=120.CheckAAASessionLookupStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/110.LookupAAASessions/100.InitAAASessionLookup]

AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_EAPUserIdentityString DEG_USERIDENTITY
AdornOps=set DEG_AAAErrorProcessingFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/110.LookupAAASessions/110.ExecuteAAASessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_AAA_AUC_ID,DEG_AAA_AUC_ID
MapAttributes=DEG_RESULT_CODE,DEG_RESULT_CODE
MapAttributes=DEG_USERIDENTITY,DEG_USERIDENTITY
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_FIRSTREQTIMESTAMP,DEG_FIRSTREQTIMESTAMP
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=2.MatchByUserIdentity
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/110.LookupAAASessions/120.CheckAAASessionLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
Conditions=DEG_AAASessionStoreKeyExistsFlagInteger,=,0
FalseRuleChain=200.SetMDN
FalseRuleChain=300.HSSMAPGWProcessingRule
Operations=or
TrueRuleChain=100.SystemError_SetDiameterSWaErrorResponse
TrueRuleChain=110.SystemErrorLog


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/110.LookupAAASessions/120.CheckAAASessionLookupStatus/100.SystemError_SetDiameterSWaErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to access DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0034"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to lookup or access DEG_AAA_SESSIONS table while Processing EAP-AKA"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/110.LookupAAASessions/120.CheckAAASessionLookupStatus/110.SystemErrorLog]

Attributes=DEG_USERIDENTITY
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access DEG_AAA_SESSIONS table while Processing EAP-AKA
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/110.LookupAAASessions/120.CheckAAASessionLookupStatus/200.SetMDN]

AdornOps=copy DEG_AAA_SESSID DEG_AAASessionIdString
AdornOps=copy DEG_USERIDENTITY DEG_AAAUserNameString
AdornOps=lastindexof ";" DEG_AAASessionIdString DEG_AAAMDNIndexLong
AdornOps=+ DEG_AAAMDNIndexLong 1 DEG_AAAMDNIndexLong
AdornOps=substr DEG_AAAMDNIndexLong length DEG_AAASessionIdString DEG_MDN
AdornOps=substr 1 "@" DEG_AAAUserNameString DEG_AAAImsiString
AdornOps=setifnull DEG_AAAImsiString ""
AdornOps=setifnull DEG_MDN 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/110.LookupAAASessions/120.CheckAAASessionLookupStatus/300.HSSMAPGWProcessingRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400.HSSMAPGWProcessingRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/200.CheckResultCode]

AUCRequestFailed=200.CheckAUCRequestFailedStatus
AUCRequestSuccess=100.SetAUCRequestSuccessStatus
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,1
Operations=None
TrueRuleChain=AUCRequestSuccess
TrueRuleChain=AUCRequestFailed


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/200.CheckResultCode/100.SetAUCRequestSuccessStatus]

AuthRequestSuccess=100.SetAuthRequestSuccess
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_STATUS,=,"WAIT_FOR_AUTHVECTORS_FROM_AUC"
Conditions=DEG_STATUS,=,"WAIT_FOR_REAUTHVECTORS_FROM_AUC"
Operations=None
ReAuthRequestSuccess=200.SetReAuthRequestSuccess
TrueRuleChain=AuthRequestSuccess
TrueRuleChain=ReAuthRequestSuccess


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/200.CheckResultCode/100.SetAUCRequestSuccessStatus/100.SetAuthRequestSuccess]

AdornOps=set DEG_STATUS "RECEIVED_AND_VALIDATED_AUTHVECTORS_FROM_AUC"
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/200.CheckResultCode/100.SetAUCRequestSuccessStatus/200.SetReAuthRequestSuccess]

AdornOps=set DEG_STATUS "RECEIVED_AND_VALIDATED_REAUTHVECTORS_FROM_AUC"
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/200.CheckResultCode/200.CheckAUCRequestFailedStatus]

AdornOps=copy DEG_AAAResultCodeInteger DEG_RESULT_CODE
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/300.UpdateAAASessionStatus]

ClassName=RuleChain
RuleNames=100.InitialiseUpdateSession
RuleNames=200.UpdateAAASession
RuleNames=300.CheckUpdateStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/300.UpdateAAASessionStatus/100.InitialiseUpdateSession]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_AAA_SESSIONS
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_EAPUserIdentityString DEG_USERIDENTITY
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/300.UpdateAAASessionStatus/200.UpdateAAASession]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_AUC_ID,DEG_AAA_AUC_ID
MapAttributes=DEG_RESULT_CODE,DEG_RESULT_CODE
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=2.MatchByUserIdentity
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/300.UpdateAAASessionStatus/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/300.UpdateAAASessionStatus/300.CheckUpdateStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access entry in DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0035"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing EAP-AKA"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/300.UpdateAAASessionStatus/300.CheckUpdateStatus/110.ErrorLog]

Attributes=DEG_USERIDENTITY
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing EAP-AKA
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/400.SetAuthVectors]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
TrueRuleChain=001.InitialiseEAPAKAVectors
TrueRuleChain=100.SetEAPAKAVectors
TrueRuleChain=110.LogAuthVectors


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/400.SetAuthVectors/001.InitialiseEAPAKAVectors]

AdornOps=setifnull DEG_AAARANDList null
AdornOps=setifnull DEG_AAAAUTNList null
AdornOps=setifnull DEG_AAACKList null
AdornOps=setifnull DEG_AAAIKList null
AdornOps=setifnull DEG_AAAXRESList null
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/400.SetAuthVectors/100.SetEAPAKAVectors]

AdornOps=copy DEG_AAARANDList DEG_EAPAKARANDList
AdornOps=copy DEG_AAAAUTNList DEG_EAPAKAAUTNList
AdornOps=copy DEG_AAACKList DEG_EAPAKACKList
AdornOps=copy DEG_AAAIKList DEG_EAPAKAIKList
AdornOps=copy DEG_AAAXRESList DEG_EAPAKAXRESList
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0036"
AdornOps=set DEG_OEMDevMessageString "Received EAP-AKA Auth Vectors From AUC to AAA ->"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/400.SetAuthVectors/110.LogAuthVectors]

Attributes=DEG_EAPAKARANDList
Attributes=DEG_EAPAKAAUTNList
Attributes=DEG_EAPAKACKList
Attributes=DEG_EAPAKAIKList
Attributes=DEG_EAPAKAXRESList
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Received EAP-AKA Auth Vectors From AUC to AAA ->
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/300.EAPAKAProcessingRuleChain/500.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0033"
AdornOps=set DEG_OEMDevMessageString "Start EAP-AKA Processing"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain]

ClassName=RuleChain
RuleNames=50.SetErrorInfo
RuleNames=100.LogWithinEAPSIMRuleChain
RuleNames=110.LookupAAASessions
RuleNames=200.InvokeMAPGatewayProcessingRule
RuleNames=300.CheckMAPGatewayProcessingResult
RuleNames=400.UpdateAAASessionStatus
RuleNames=500.SetAuthVectors


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/100.LogWithinEAPSIMRuleChain]

Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Start EAP-SIM Processing :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/110.LookupAAASessions]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitAAASessionLookup
RuleNames=110.ExecuteAAASessionLookup
RuleNames=120.CheckAAASessionLookupStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/110.LookupAAASessions/100.InitAAASessionLookup]

AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_EAPUserIdentityString DEG_USERIDENTITY
AdornOps=set DEG_AAAErrorProcessingFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/110.LookupAAASessions/110.ExecuteAAASessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_AAA_AUC_ID,DEG_AAA_AUC_ID
MapAttributes=DEG_RESULT_CODE,DEG_RESULT_CODE
MapAttributes=DEG_USERIDENTITY,DEG_USERIDENTITY
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_FIRSTREQTIMESTAMP,DEG_FIRSTREQTIMESTAMP
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=2.MatchByUserIdentity
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/110.LookupAAASessions/120.CheckAAASessionLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
Conditions=DEG_AAASessionStoreKeyExistsFlagInteger,=,0
FalseRuleChain=200.SetSessionId
Operations=or
TrueRuleChain=100.SystemError_SetDiameterSWaErrorResponse
TrueRuleChain=110.SystemErrorLog


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/110.LookupAAASessions/120.CheckAAASessionLookupStatus/100.SystemError_SetDiameterSWaErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to access DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0038"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to lookup or access DEG_AAA_SESSIONS table while Processing EAP-SIM"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/110.LookupAAASessions/120.CheckAAASessionLookupStatus/110.SystemErrorLog]

Attributes=DEG_USERIDENTITY
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access DEG_AAA_SESSIONS table while Processing EAP-SIM
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/110.LookupAAASessions/120.CheckAAASessionLookupStatus/200.SetSessionId]

AdornOps=copy DEG_AAA_SESSID DEG_AAASessionIdString
AdornOps=copy DEG_USERIDENTITY DEG_AAAUserNameString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/200.InvokeMAPGatewayProcessingRule]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.SetMAPRequestType
TrueRuleChain=002.InvokeMapGatewayProcessingRuleChain


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/200.InvokeMAPGatewayProcessingRule/001.SetMAPRequestType]

AdornOps=set DEG_MAPRequestString "EAPSIMRequest"
AdornOps=set DEG_MAPNumVectorsInteger ${AAA_EAP_SIM_NO_OF_VECTORS}
AdornOps=lastindexof ";" DEG_AAASessionIdString DEG_AAAMDNIndexLong
AdornOps=+ DEG_AAAMDNIndexLong 1 DEG_AAAMDNIndexLong
AdornOps=substr DEG_AAAMDNIndexLong length DEG_AAASessionIdString DEG_MDN
AdornOps=substr 1 "@" DEG_AAAUserNameString DEG_AAAImsiString
AdornOps=setifnull DEG_AAAImsiString ""
AdornOps=setifnull DEG_MDN 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/200.InvokeMAPGatewayProcessingRule/002.InvokeMapGatewayProcessingRuleChain]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
TrueRuleChain=001.InvokeMapGatewayProcessingRule


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/200.InvokeMAPGatewayProcessingRule/002.InvokeMapGatewayProcessingRuleChain/001.InvokeMapGatewayProcessingRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400.HSSMAPGWProcessingRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/300.CheckMAPGatewayProcessingResult]

AUCRequestFailed=200.CheckAUCRequestFailedStatus
AUCRequestSuccess=100.SetAUCRequestSuccessStatus
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,1
Operations=None
TrueRuleChain=AUCRequestSuccess
TrueRuleChain=AUCRequestFailed


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/300.CheckMAPGatewayProcessingResult/100.SetAUCRequestSuccessStatus]

AuthRequestSuccess=100.SetAuthRequestSuccess
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_STATUS,=,"WAIT_FOR_AUTHVECTORS_FROM_AUC"
Conditions=DEG_STATUS,=,"WAIT_FOR_REAUTHVECTORS_FROM_AUC"
Operations=None
ReAuthRequestSuccess=200.SetReAuthRequestSuccess
TrueRuleChain=AuthRequestSuccess
TrueRuleChain=ReAuthRequestSuccess


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/300.CheckMAPGatewayProcessingResult/100.SetAUCRequestSuccessStatus/100.SetAuthRequestSuccess]

AdornOps=set DEG_STATUS "RECEIVED_AND_VALIDATED_AUTHVECTORS_FROM_AUC"
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/300.CheckMAPGatewayProcessingResult/100.SetAUCRequestSuccessStatus/200.SetReAuthRequestSuccess]

AdornOps=set DEG_STATUS "RECEIVED_AND_VALIDATED_REAUTHVECTORS_FROM_AUC"
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/300.CheckMAPGatewayProcessingResult/200.CheckAUCRequestFailedStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAResultCodeInteger,!=,5004
Conditions=DEG_AAAResultCodeInteger,!=,5012
FalseRuleChain=110.SetInternaleError
Operations=and
TrueRuleChain=100.SetCommunicationError


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/300.CheckMAPGatewayProcessingResult/200.CheckAUCRequestFailedStatus/100.SetCommunicationError]

AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_RESULT_CODE
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/300.CheckMAPGatewayProcessingResult/200.CheckAUCRequestFailedStatus/110.SetInternaleError]

AdornOps=copy DEG_AAAResultCodeInteger DEG_RESULT_CODE
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/400.UpdateAAASessionStatus]

ClassName=RuleChain
RuleNames=100.InitialiseUpdateSession
RuleNames=200.UpdateAAASession
RuleNames=300.CheckUpdateStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/400.UpdateAAASessionStatus/100.InitialiseUpdateSession]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_AAA_SESSIONS
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_EAPUserIdentityString DEG_USERIDENTITY
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/400.UpdateAAASessionStatus/200.UpdateAAASession]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_AAA_AUC_ID,DEG_AAA_AUC_ID
MapAttributes=DEG_RESULT_CODE,DEG_RESULT_CODE
MapAttributes=DEG_USERIDENTITY,DEG_USERIDENTITY
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_FIRSTREQTIMESTAMP,DEG_FIRSTREQTIMESTAMP
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=2.MatchByUserIdentity
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/400.UpdateAAASessionStatus/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/400.UpdateAAASessionStatus/300.CheckUpdateStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access entry in DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0039"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing EAP-SIM"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/400.UpdateAAASessionStatus/300.CheckUpdateStatus/110.ErrorLog]

Attributes=DEG_USERIDENTITY
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing EAP-SIM
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/50.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0037"
AdornOps=set DEG_OEMDevErrorMessageString "Start EAP-SIM Processing"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/500.SetAuthVectors]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
TrueRuleChain=100.SetEAPSIMVectors
TrueRuleChain=110.LogAuthVectors


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/500.SetAuthVectors/100.SetEAPSIMVectors]

AdornOps=copy DEG_AAARANDList DEG_EAPSIMRANDList
AdornOps=copy DEG_AAASRESList DEG_EAPSIMSRESList
AdornOps=copy DEG_AAAKCList DEG_EAPSIMKCList
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0040"
AdornOps=set DEG_OEMDevMessageString "Received EAP-SIM Auth Vectors From AUC to AAA ->"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/310.EAPSIMProcessingRuleChain/500.SetAuthVectors/110.LogAuthVectors]

Attributes=DEG_AAARANDList
Attributes=DEG_AAASRESList
Attributes=DEG_AAAKCList
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Received EAP-SIM Auth Vectors From AUC to AAA ->
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/320.EAPTransactionProcessingRuleChain]

ClassName=RuleChain
RuleNames=001.InitialiseEAPAttributes
RuleNames=002.LogEAPAttibutes
RuleNames=003.EAPClientRule
RuleNames=004.CopyEAPMessage
RuleNames=005.LogPostEAPClientRule


[/templates/DEG/AAAuthentication/Common/RuleChains/320.EAPTransactionProcessingRuleChain/001.InitialiseEAPAttributes]

AdornOps=copy DEG_AAASessionIdString DEG_EAPTransactionIDString
AdornOps=str2bin DEG_EAPTransactionIDString DEG_EAPTransactionIDBinary
AdornOps=set DEG_EAPCodeInteger 0
AdornOps=set DEG_EAPOperationString "Update"
AdornOps=copy DEG_AAAEAPPayloadBinary DEG_EAPMessageBinary
AdornOps=set DEG_EAPErrorAttributeString ""
AdornOps=set DEG_EAPErrorMsgAttributeString ""
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0041"
AdornOps=set DEG_OEMDevMessageString "EAP Transaction Begins"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/320.EAPTransactionProcessingRuleChain/002.LogEAPAttibutes]

Attributes=DEG_EAPTransactionIDString
Attributes=DEG_EAPTransactionIDBinary
Attributes=DEG_EAPCodeInteger
Attributes=DEG_EAPOperationString
Attributes=DEG_EAPMessageBinary
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=EAP Transaction Begins:
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/320.EAPTransactionProcessingRuleChain/003.EAPClientRule]

ClassName=com.hp.usage.eap.connector.EAPClientRule
EAPAdapterName=300.EAPAdapter
ErrorCodeAttribute=DEG_EAPErrorAttributeString
ErrorMessageAttribute=DEG_EAPErrorMsgAttributeString


[/templates/DEG/AAAuthentication/Common/RuleChains/320.EAPTransactionProcessingRuleChain/004.CopyEAPMessage]

AdornOps=copy DEG_EAPMessageBinary DEG_AAAEAPPayloadBinary
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0042"
AdornOps=set DEG_OEMDevMessageString "EAP Transaction Ends"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/320.EAPTransactionProcessingRuleChain/005.LogPostEAPClientRule]

Attributes=DEG_EAPTransactionIDString
Attributes=DEG_EAPTransactionIDBinary
Attributes=DEG_EAPCodeInteger
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=EAP Transaction Ends:
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain]

ClassName=RuleChain
RuleNames=100.Initialize
RuleNames=110.LogIncomingRequest
RuleNames=200.SNMEToNME
RuleNames=250.SetErrorInfo
RuleNames=210.LogIncomingAttributes
RuleNames=300.ProcessRadiusRequest


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/100.Initialize]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 0
AdornOps=setsystime DEG_AAAWifiProcessStartTimeLong
AdornOps=set DEG_AAAErrorMessageString ""
AdornOps=set DEG_AAAResultCodeInteger 0
AdornOps=set DEG_AAAResultCodeString 0
AdornOps=set DEG_AAAExperimentalResultInteger 0
AdornOps=set DEG_AAAExperimentalResultCodeInteger 0
AdornOps=set DEG_AAAResultCodeString 0
AdornOps=set DEG_AAAMDNIndexLong 0
AdornOps=set DEG_MDN 0
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0043"
AdornOps=set DEG_OEMDevMessageString "WIFIINTERFACE to AAA -> Received Radius Request"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/110.LogIncomingRequest]

Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=WIFIINTERFACE to AAA -> Received Radius Request :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/200.SNMEToNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
SNMEType=radius:RadiusMessage
StructuredNMEToNMEMap=request.accessRequest.UserName,DEG_AAAUserNameString,""
StructuredNMEToNMEMap=request.accessRequest.code,DEG_AAARadiusTypeCodeInteger,0
StructuredNMEToNMEMap=request.accessRequest.EAPMessage,DEG_AAAEAPPayloadBinary,0
StructuredNMEToNMEMap=request.accessRequest.State,DEG_AAARadiusStateBinary,0
StructuredNMEToNMEMap=request.accessRequest.AcctSessionId,DEG_AAASessionIdString,""


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/210.LogIncomingAttributes]

Attributes=DEG_AAAUserNameString
Attributes=DEG_AAARadiusTypeCodeInteger
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAARadiusStateBinary
Attributes=DEG_AAASessionIdString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=INFO
Message=WIFIINTERFACE to AAA -> Received Radius Attributes :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/250.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0044"
AdornOps=set DEG_OEMDevMessageString "WIFIINTERFACE to AAA -> Received Radius Attributes"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest]

CheckEAPTransactionResults=400.CheckEAPTransactionResults
CheckIfNewSession=200.LookupSession
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
EAPTransaction=300.EAPTransaction
ExtractMDN=120.ExtractMDNFromSessionId
Operations=DoAll
TrueRuleChain=Validation
TrueRuleChain=ExtractMDN
TrueRuleChain=CheckIfNewSession
TrueRuleChain=EAPTransaction
TrueRuleChain=CheckEAPTransactionResults
Validation=100.ValidateRadiusRequest
Validation=110.CheckValidationResults


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/100.ValidateRadiusRequest]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Operations=DoAll
TrueRuleChain=ValidateSessionId
TrueRuleChain=ValidateUserName
TrueRuleChain=ValidateEAPPayload
ValidateEAPPayload=003.ValidateEAPPayload
ValidateSessionId=001.ValidateSessionId
ValidateUserName=002.ValidateUserName


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/100.ValidateRadiusRequest/001.ValidateSessionId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionIdString,=,""
TrueRuleChain=100.SetValidationError
TrueRuleChain=110.LogValidationError


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/100.ValidateRadiusRequest/001.ValidateSessionId/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Radius field Account Session ID is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0045"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP SessionId is not present in incoming Request"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/100.ValidateRadiusRequest/001.ValidateSessionId/110.LogValidationError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAUserNameString
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP SessionId is not present in incoming Request :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/100.ValidateRadiusRequest/002.ValidateUserName]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAUserNameString,=,""
TrueRuleChain=100.SetValidationError
TrueRuleChain=110.LogValidationError


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/100.ValidateRadiusRequest/002.ValidateUserName/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Radius field UserName is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0046"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP UserName is not present in incoming Request"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/100.ValidateRadiusRequest/002.ValidateUserName/110.LogValidationError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAUserNameString
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP UserName is not present in incoming Request :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/100.ValidateRadiusRequest/003.ValidateEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAEAPPayloadBinary,=,0
TrueRuleChain=100.SetValidationError
TrueRuleChain=110.LogValidationError


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/100.ValidateRadiusRequest/003.ValidateEAPPayload/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Radius field EAPPayload is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0047"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP EAPPayload is not present in incoming Request"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/100.ValidateRadiusRequest/003.ValidateEAPPayload/110.LogValidationError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAUserNameString
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP EAPPayload is not present in incoming Request :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/110.CheckValidationResults]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,!=,0
Conditions=DEG_AAAErrorMessageString,!=,""
FalseRuleChain=100.SetErrorInfo
FalseRuleChain=200.LogRadiusRequest
Operations=and
TrueRuleChain=100.DeleteSession
TrueRuleChain=110.ErrorNMEToSNME
TrueRuleChain=120.GenerateSytemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/110.CheckValidationResults/100.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/110.CheckValidationResults/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0048"
AdornOps=set DEG_OEMDevMessageString "Succesfully validated Radius Attributes"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/110.CheckValidationResults/110.ErrorNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/110.CheckValidationResults/110.ErrorNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/110.CheckValidationResults/120.GenerateSytemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/110.CheckValidationResults/200.LogRadiusRequest]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAUserNameString
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAARadiusTypeCodeInteger
Attributes=DEG_AAARadiusStateBinary
Attributes=DEG_AAARadiusStateString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Succesfully validated Radius Attributes :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/120.ExtractMDNFromSessionId]

AdornOps=lastindexof ";" DEG_AAASessionIdString DEG_AAAMDNIndexLong
AdornOps=+ DEG_AAAMDNIndexLong 1 DEG_AAAMDNIndexLong
AdornOps=substr DEG_AAAMDNIndexLong length DEG_AAASessionIdString DEG_MDN
AdornOps=substr 1 "@" DEG_AAAUserNameString DEG_AAAImsiString
AdornOps=setifnull DEG_AAAImsiString ""
AdornOps=setifnull DEG_MDN 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitLookup
RuleNames=200.LookupAAASession
RuleNames=300.CheckLookupStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/100.InitLookup]

AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/200.LookupAAASession]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_AAA_AUC_ID,DEG_AAA_AUC_ID
MapAttributes=DEG_RESULT_CODE,DEG_RESULT_CODE
MapAttributes=DEG_USERIDENTITY,DEG_USERIDENTITY
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_FIRSTREQTIMESTAMP,DEG_FIRSTREQTIMESTAMP
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus]

AAASessionExists=200.CheckAAAExistingSession
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
Conditions=DEG_AAASessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_AAA_SESSID,=,DEG_AAA_SESSID
NoAAASession=100.CreateNewAAASession
Operations=None
SystemError=000.SystemError_SetAccessRequestErrorResponse
SystemError=010.SystemErrorLog
SystemError=020.ErrorNMEToSNME
TrueRuleChain=SystemError
TrueRuleChain=NoAAASession
TrueRuleChain=AAASessionExists


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/000.SystemError_SetAccessRequestErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to lookup or access DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0049"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable To lookup or access  DEG_AAA_SESSIONS table while Processing RadiusRequest"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/010.SystemErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable To lookup or access  DEG_AAA_SESSIONS table while Processing RadiusRequest
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/020.ErrorNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitCreateSession
RuleNames=110.CreateSession
RuleNames=120.CheckCreateSessionStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/100.InitCreateSession]

AdornOps=set log_DB_Operation INSERT
AdornOps=set log_Table_Name DEG_AAA_SESSIONS
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=set DEG_AAA_AUC_ID ""
AdornOps=set DEG_RESULT_CODE 0
AdornOps=copy DEG_AAAUserNameString DEG_USERIDENTITY
AdornOps=set DEG_STATUS "NEW"
AdornOps=setsystime DEG_FIRSTREQTIMESTAMP
AdornOps=set DEG_UPDATEDTIMESTAMP 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/110.CreateSession]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/120.CheckCreateSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
Conditions=DEG_AAASessionStoreKeyExistsFlagInteger,=,1
FalseRuleChain=300.GenerateAccessRequestStartAuditDataRuleChain
Operations=or
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=210.ErrorNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/120.CheckCreateSessionStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to create or access entry in DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0050"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to access or create entry in DEG_AAA_SESSIONS table"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/120.CheckCreateSessionStatus/110.ErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to access or create entry in DEG_AAA_SESSIONS table
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/120.CheckCreateSessionStatus/210.ErrorNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/120.CheckCreateSessionStatus/300.GenerateAccessRequestStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
GetActiveMonitoringSessionsByMDN=001.GetActiveMonitoringSessionsByMDN
InvokeStartAuditDataGeneration=100.InvokeStartAuditDataGeneration
Operations=DoAll
TrueRuleChain=GetActiveMonitoringSessionsByMDN
TrueRuleChain=InvokeStartAuditDataGeneration


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/120.CheckCreateSessionStatus/300.GenerateAccessRequestStartAuditDataRuleChain/001.GetActiveMonitoringSessionsByMDN]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=008.ReadMonitoringSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/100.CreateNewAAASession/120.CheckCreateSessionStatus/300.GenerateAccessRequestStartAuditDataRuleChain/100.InvokeStartAuditDataGeneration]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=900.GenerateAccessRequestStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_STATUS,=,"WAIT_FOR_NAK_RESPONSE"
Conditions=DEG_STATUS,=,"WAIT_FOR_CHALLENGE_RESPONSE"
Operations=None
ReceivedChallengeResponse=002.CheckAAASessionForChallengeResponse
ReceivedNAKResponse=001.UpdateAAASessionForNAKResponse
TrueRuleChain=ReceivedNAKResponse
TrueRuleChain=ReceivedChallengeResponse


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
TrueRuleChain=100.InitialiseUpdateSession
TrueRuleChain=200.UpdateAAASession
TrueRuleChain=300.CheckUpdateStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/100.InitialiseUpdateSession]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_AAA_SESSIONS
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 0
AdornOps=set DEG_STATUS "RECEIVED_NAK"
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/200.UpdateAAASession]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
FalseRuleChain=300.GenerateAccessRequestStartAuditDataRuleChain
TrueRuleChain=100.SystemError_SetRadiusErrorResponse
TrueRuleChain=110.SystemErrorLog
TrueRuleChain=120.DeleteSession
TrueRuleChain=200.ErrorNMEToSNME
TrueRuleChain=210.GenerateSystemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/100.SystemError_SetRadiusErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access entry in DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0051"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing RadiusRequest"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/110.SystemErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing RadiusRequest
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/120.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/200.ErrorNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/200.ErrorNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/210.GenerateSystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/300.GenerateAccessRequestStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckLookupStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/300.GenerateAccessRequestStartAuditDataRuleChain/100.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
GetActiveMonitoringSessionsByMDN=001.GetActiveMonitoringSessionsByMDN
InvokeStartAuditDataGeneration=100.InvokeStartAuditDataGeneration
Operations=DoAll
TrueRuleChain=GetActiveMonitoringSessionsByMDN
TrueRuleChain=InvokeStartAuditDataGeneration


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/300.GenerateAccessRequestStartAuditDataRuleChain/100.CheckLookupStatus/001.GetActiveMonitoringSessionsByMDN]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=008.ReadMonitoringSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/001.UpdateAAASessionForNAKResponse/300.CheckUpdateStatus/300.GenerateAccessRequestStartAuditDataRuleChain/100.CheckLookupStatus/100.InvokeStartAuditDataGeneration]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=900.GenerateAccessRequestStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAARadiusStateBinary,!=,0
FalseRuleChain=100.SetValidationError
FalseRuleChain=110.LogValidationError
FalseRuleChain=200.DeleteSession
FalseRuleChain=210.ErrorNMEToSNME
FalseRuleChain=300.GenerateSystemErrorAuditData
TrueRuleChain=001.DecodeState
TrueRuleChain=002.ValidateRadiusState


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/001.DecodeState]

AdornOps=set DEG_AAARadiusStateString ""
AdornOps=bin2str DEG_AAARadiusStateBinary DEG_AAARadiusStateString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAARadiusStateString,=,DEG_AAASessionIdString
FalseRuleChain=100.SetValidationError
FalseRuleChain=100.SetErrorInfo
FalseRuleChain=110.LogValidationError
FalseRuleChain=200.DeleteSession
FalseRuleChain=210.ErrorNMEToSNME
FalseRuleChain=300.GenerateSystemErrorAuditData
TrueRuleChain=100.UpdateChallengeResponseReceived


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0053"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid Radius State AVP in incoming Request"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Invalid Radius State field"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.UpdateChallengeResponseReceived]

ClassName=RuleChain
RuleNames=100.InitialiseUpdateSession
RuleNames=200.UpdateAAASession
RuleNames=300.CheckUpdateStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.UpdateChallengeResponseReceived/100.InitialiseUpdateSession]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_AAA_SESSIONS
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 0
AdornOps=set DEG_STATUS "RECEIVED_CHALLENGE_RESPONSE"
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.UpdateChallengeResponseReceived/200.UpdateAAASession]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.UpdateChallengeResponseReceived/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
FalseRuleChain=300.GenerateAccessRequestStartAuditDataRuleChain
TrueRuleChain=100.SystemError_SetRadiusErrorResponse
TrueRuleChain=110.SystemErrorLog
TrueRuleChain=120.DeleteSession
TrueRuleChain=200.ErrorNMEToSNME
TrueRuleChain=210.GenerateSystemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.UpdateChallengeResponseReceived/300.CheckUpdateStatus/100.SystemError_SetRadiusErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0052"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing RadiusRequest"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.UpdateChallengeResponseReceived/300.CheckUpdateStatus/110.SystemErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing RadiusRequest
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.UpdateChallengeResponseReceived/300.CheckUpdateStatus/120.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.UpdateChallengeResponseReceived/300.CheckUpdateStatus/200.ErrorNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.UpdateChallengeResponseReceived/300.CheckUpdateStatus/200.ErrorNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.UpdateChallengeResponseReceived/300.CheckUpdateStatus/210.GenerateSystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.UpdateChallengeResponseReceived/300.CheckUpdateStatus/300.GenerateAccessRequestStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckLookupStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.UpdateChallengeResponseReceived/300.CheckUpdateStatus/300.GenerateAccessRequestStartAuditDataRuleChain/100.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
GetActiveMonitoringSessionsByMDN=001.GetActiveMonitoringSessionsByMDN
InvokeStartAuditDataGeneration=100.InvokeStartAuditDataGeneration
Operations=DoAll
TrueRuleChain=GetActiveMonitoringSessionsByMDN
TrueRuleChain=InvokeStartAuditDataGeneration


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.UpdateChallengeResponseReceived/300.CheckUpdateStatus/300.GenerateAccessRequestStartAuditDataRuleChain/100.CheckLookupStatus/001.GetActiveMonitoringSessionsByMDN]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=008.ReadMonitoringSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/100.UpdateChallengeResponseReceived/300.CheckUpdateStatus/300.GenerateAccessRequestStartAuditDataRuleChain/100.CheckLookupStatus/100.InvokeStartAuditDataGeneration]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=900.GenerateAccessRequestStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/110.LogValidationError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAUserNameString
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAARadiusStateString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid Radius State AVP in incoming Request :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/200.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/210.ErrorNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/210.ErrorNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/002.ValidateRadiusState/300.GenerateSystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/100.SetValidationError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Radius field State is not present"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0054"
AdornOps=set DEG_OEMDevErrorMessageString "Mandatory AVP State is not present in incoming Request"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/110.LogValidationError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAUserNameString
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAARadiusStateBinary
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Mandatory AVP State is not present in incoming Request :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/200.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/210.ErrorNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/210.ErrorNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/200.LookupSession/300.CheckLookupStatus/200.CheckAAAExistingSession/002.CheckAAASessionForChallengeResponse/300.GenerateSystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/300.EAPTransaction]

ClassName=LocalRuleChainInvoker
RuleChain=320.EAPTransactionProcessingRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
TrueRuleChain=100.InitLookup
TrueRuleChain=200.Lookup
TrueRuleChain=300.CheckLookupStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/100.InitLookup]

AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_AAAErrorProcessingFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/200.Lookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_AAA_AUC_ID,DEG_AAA_AUC_ID
MapAttributes=DEG_RESULT_CODE,DEG_RESULT_CODE
MapAttributes=DEG_USERIDENTITY,DEG_USERIDENTITY
MapAttributes=DEG_STATUS,DEG_STATUS
NativeCondition=2.MatchByUserIdentity
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
Conditions=DEG_AAASessionStoreKeyExistsFlagInteger,=,0
FalseRuleChain=200.CheckResultCode
Operations=or
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.DeleteSession
TrueRuleChain=130.ErrorNMEToSNME
TrueRuleChain=140.GenerateSytemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to lookup or access DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0055"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable To lookup or access DEG_AAA_SESSIONS table while RadiusRequest"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/110.ErrorLog]

Attributes=DEG_USERIDENTITY
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable To lookup or access DEG_AAA_SESSIONS table while RadiusRequest
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/120.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/130.ErrorNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/130.ErrorNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/140.GenerateSytemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_RESULT_CODE,!=,0
FalseRuleChain=200.CheckEAPCode
Operations=or
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.DeleteSession
TrueRuleChain=130.ErrorNMEToSNME
TrueRuleChain=140.GenerateSytemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/100.SetAAAErrorResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_RESULT_CODE,=,5004
Conditions=DEG_RESULT_CODE,=,5012
Conditions=DEG_RESULT_CODE,=,DEG_RESULT_CODE
Default=110.SetEAPInternalError
EAPInternalError=110.SetEAPInternalError
MandatoryAVPNotPresent=100.SetMandatoryAVPNotPresentError
Operations=None
TrueRuleChain=MandatoryAVPNotPresent
TrueRuleChain=EAPInternalError
TrueRuleChain=Default


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/100.SetAAAErrorResponse/100.SetMandatoryAVPNotPresentError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Mandatory Attributes missing in the response from HLR"
AdornOps=set DEG_AAAResultCodeInteger 5004
AdornOps=set DEG_AAAExperimentalResultInteger 5004
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5004
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/100.SetAAAErrorResponse/110.SetEAPInternalError]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "EAP Adapter Internal Processing Error"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0056"
AdornOps=set DEG_OEMDevErrorMessageString "EAP Processing Internal Error"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/110.ErrorLog]

Attributes=DEG_AAA_SESSID
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_RESULT_CODE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=EAP Processing Internal Error :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/120.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/130.ErrorNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/130.ErrorNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/140.GenerateSytemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/200.CheckEAPCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
TrueRuleChain=100.InvokeCheckEAPTransactions


[/templates/DEG/AAAuthentication/Common/RuleChains/600.RadiusProcessingRuleChain/300.ProcessRadiusRequest/400.CheckEAPTransactionResults/300.CheckLookupStatus/200.CheckResultCode/200.CheckEAPCode/100.InvokeCheckEAPTransactions]

ClassName=LocalRuleChainInvoker
RuleChain=700.CheckEAPTransactionResultRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/610.RadiusErrorRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=600.SetErrorInfo
RuleNames=100.LogWithinRadiusErrorRuleChain
RuleNames=200.SetRadiusProcessingError
RuleNames=300.NMEToSNMEConversion
RuleNames=350.SetErrorInfo
RuleNames=400.LogRadiusErrorResponse
RuleNames=500.GenerateSystemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/610.RadiusErrorRuleChain/100.LogWithinRadiusErrorRuleChain]

Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Encountered Radius Processing Error :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/610.RadiusErrorRuleChain/200.SetRadiusProcessingError]

AdornOps=set DEG_AAAErrorMessageString "Radius Processing Error : "
AdornOps=+ DEG_AAAErrorMessageString "DEG_AAARadiusErrorCodeString=" DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString DEG_AAARadiusErrorCodeString DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString ; DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString "DEG_AAARadiusErrorMessageString=" DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString DEG_AAARadiusErrorMessageString DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString ; DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString "DEG_AAARadiusErrorPacketBinary=" DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString DEG_AAARadiusErrorPacketBinary DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString ; DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString "DEG_AAARadiusErrorHostString=" DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString DEG_AAARadiusErrorHostString DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString ; DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString "DEG_AAARadiusErrorPortInteger=" DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString DEG_AAARadiusErrorPortInteger DEG_AAAErrorMessageString
AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/610.RadiusErrorRuleChain/300.NMEToSNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/610.RadiusErrorRuleChain/350.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0058"
AdornOps=set DEG_OEMDevErrorMessageString "Radius Processing Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/610.RadiusErrorRuleChain/400.LogRadiusErrorResponse]

Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=LogNMERule
LogLevel=ERROR
Message=Radius Processing Error :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/610.RadiusErrorRuleChain/500.GenerateSystemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/610.RadiusErrorRuleChain/600.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0057"
AdornOps=set DEG_OEMDevErrorMessageString "Encountered Radius Processing Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain]

ClassName=RuleChain
RuleNames=100.CheckEAPCode


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_EAPCodeInteger,=,1
Conditions=DEG_EAPCodeInteger,=,3
Conditions=DEG_EAPCodeInteger,=,4
Conditions=DEG_EAPCodeInteger,=,0
Operations=None
ProcessEAPAccept=200.ProcessEAPAccept
ProcessEAPChallengeRequest=100.ProcessEAPChallengeRequest
ProcessEAPError=400.ProcessEAPError
ProcessEAPReject=300.ProcessEAPReject
TrueRuleChain=ProcessEAPChallengeRequest
TrueRuleChain=ProcessEAPAccept
TrueRuleChain=ProcessEAPReject
TrueRuleChain=ProcessEAPError


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest]

CheckChallengeType=004.CheckChallengeType
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
LookupAAASessions=001.InitLookup
LookupAAASessions=002.LookupSession
LookupAAASessions=003.CheckLookupStatus
Operations=DoAll
SetResponse=005.SetSuccessResponse
SetResponse=006.SuccessNMEToSNME
SetResponse=005.SetErrorInfo
SetResponse=007.LogChallengeResponse
SetResponse=008.GenerateAuthWaitAuditData
TrueRuleChain=LookupAAASessions
TrueRuleChain=CheckChallengeType
TrueRuleChain=SetResponse


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/001.InitLookup]

AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/002.LookupSession]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_AAA_AUC_ID,DEG_AAA_AUC_ID
MapAttributes=DEG_RESULT_CODE,DEG_RESULT_CODE
MapAttributes=DEG_USERIDENTITY,DEG_USERIDENTITY
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_FIRSTREQTIMESTAMP,DEG_FIRSTREQTIMESTAMP
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/003.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.DeleteSession
TrueRuleChain=200.ErrorNMEToSNME
TrueRuleChain=300.GenerateSytemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/003.CheckLookupStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to lookup or access DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0059"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable To lookup or access DEG_AAA_SESSIONS table while Processing ChallengeRequest"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/003.CheckLookupStatus/110.ErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable To lookup or access DEG_AAA_SESSIONS table while Processing ChallengeRequest
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/003.CheckLookupStatus/120.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/003.CheckLookupStatus/200.ErrorNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/003.CheckLookupStatus/200.ErrorNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/003.CheckLookupStatus/300.GenerateSytemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType]

ClassName=RuleChain
RuleNames=100.SetSessionStatus
RuleNames=200.UpdateAAASessions


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/100.SetSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_STATUS,=,"NEW"
Conditions=DEG_RESULT_CODE,=,0
Conditions=DEG_USERIDENTITY,=,DEG_AAAUserNameString
FalseRuleChain=200.CheckIfChallengeRequest
Operations=and,and,and
TrueRuleChain=100.SetWAIT_FOR_NAK_RESPONSE


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/100.SetSessionStatus/100.SetWAIT_FOR_NAK_RESPONSE]

AdornOps=set DEG_STATUS "WAIT_FOR_NAK_RESPONSE"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/100.SetSessionStatus/200.CheckIfChallengeRequest]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_STATUS,=,"RECEIVED_AND_VALIDATED_AUTHVECTORS_FROM_AUC"
Conditions=DEG_STATUS,=,"RECEIVED_AND_VALIDATED_REAUTHVECTORS_FROM_AUC"
Conditions=DEG_RESULT_CODE,=,0
Conditions=DEG_USERIDENTITY,=,DEG_AAAUserNameString
Operations=or,and,and
TrueRuleChain=100.SetWAIT_FOR_CHALLENGE_RESPONSE


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/100.SetSessionStatus/200.CheckIfChallengeRequest/100.SetWAIT_FOR_CHALLENGE_RESPONSE]

AdornOps=set DEG_STATUS "WAIT_FOR_CHALLENGE_RESPONSE"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions]

ClassName=RuleChain
RuleNames=100.InitAAASessionUpdate
RuleNames=200.ExecuteAAASessionUpdate
RuleNames=300.CheckAAASessionUpdateStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/100.InitAAASessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_AAA_SESSIONS
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/200.ExecuteAAASessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/300.CheckAAASessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.DeleteSession
TrueRuleChain=200.ErrorNMEToSNME
TrueRuleChain=300.GenerateSytemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/300.CheckAAASessionUpdateStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0060"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable To update or access DEG_AAA_SESSIONS table while Processing ChallengeRequest"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/300.CheckAAASessionUpdateStatus/110.ErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable To update or access DEG_AAA_SESSIONS table while Processing ChallengeRequest
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/300.CheckAAASessionUpdateStatus/120.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/300.CheckAAASessionUpdateStatus/200.ErrorNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/300.CheckAAASessionUpdateStatus/200.ErrorNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/004.CheckChallengeType/200.UpdateAAASessions/300.CheckAAASessionUpdateStatus/300.GenerateSytemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/005.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0061"
AdornOps=set DEG_OEMDevMessageString "Sending Challenge Response From AAA to WIFIINTERFACE (Radius)"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/005.SetSuccessResponse]

AdornOps=copy DEG_AAASessionIdString DEG_AAARadiusStateString
AdornOps=str2bin DEG_AAARadiusStateString DEG_AAARadiusStateBinary
AdornOps=set DEG_AAAResultCodeInteger 1001
AdornOps=set DEG_AAAExperimentalResultInteger 1001
AdornOps=set DEG_AAAExperimentalResultCodeInteger 1001
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/006.SuccessNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,11
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessChallenge.code,11
NMEToStructuredNMEMap=DEG_AAARadiusStateBinary,answer.accessChallenge.State
NMEToStructuredNMEMap=DEG_AAAEAPPayloadBinary,answer.accessChallenge.EAPMessage
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessChallenge.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/007.LogChallengeResponse]

Attributes=DEG_AAARadiusAnswerBoolean
Attributes=DEG_AAAAnswerTypeInteger
Attributes=DEG_AAARadiusTypeCodeInteger
Attributes=DEG_AAARadiusStateBinary
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=INFO
Message=Sending Challenge Response From AAA to WIFIINTERFACE (Radius) :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/100.ProcessEAPChallengeRequest/008.GenerateAuthWaitAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=901.GenerateAccessRequestAuthWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Operations=DoAll
SetSuccessResponse=004.SetSuccessResponse
SetSuccessResponse=005.LogSuccessResponse
SetSuccessResponse=006.DeleteSession
SetSuccessResponse=007.SuccessNMEToSNME
SetSuccessResponse=008.GenerateAuthenticatedByAAAAuditData
TrueRuleChain=UpdateAAASessions
TrueRuleChain=SetSuccessResponse
UpdateAAASessions=001.InitUpdateAAASession
UpdateAAASessions=002.ExecuteUpdateAAASession
UpdateAAASessions=003.CheckUpdateAAASessionStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/001.InitUpdateAAASession]

AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=set DEG_STATUS "AUTHENTICATED_BY_AAA"
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/002.ExecuteUpdateAAASession]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/003.CheckUpdateAAASessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.DeleteSession
TrueRuleChain=200.ErrorNMEToSNME
TrueRuleChain=300.GenerateSytemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/003.CheckUpdateAAASessionStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0062"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update or access 4 DEG_AAA_SESSIONS table"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/003.CheckUpdateAAASessionStatus/110.ErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Unable to update or access 4 DEG_AAA_SESSIONS table :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/003.CheckUpdateAAASessionStatus/120.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/003.CheckUpdateAAASessionStatus/200.ErrorNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/003.CheckUpdateAAASessionStatus/200.ErrorNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/003.CheckUpdateAAASessionStatus/300.GenerateSytemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/004.SetSuccessResponse]

AdornOps=copy DEG_AAASessionIdString DEG_AAARadiusStateString
AdornOps=str2bin DEG_AAARadiusStateString DEG_AAARadiusStateBinary
AdornOps=set DEG_AAAResultCodeInteger 2001
AdornOps=set DEG_AAAExperimentalResultInteger 2001
AdornOps=set DEG_AAAExperimentalResultCodeInteger 2001
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.AAA.0063"
AdornOps=set DEG_OEMDevMessageString "Authentication Success Response From AAA to WIFIINTERFACE (Radius)"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/005.LogSuccessResponse]

Attributes=DEG_AAARadiusAnswerBoolean
Attributes=DEG_AAAAnswerTypeInteger
Attributes=DEG_AAARadiusTypeCodeInteger
Attributes=DEG_AAARadiusStateBinary
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAAUserNameString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=LogNMERule
LogLevel=INFO
Message=Authentication Success Response From AAA to WIFIINTERFACE (Radius) :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/006.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/007.SuccessNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/007.SuccessNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,2
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessAccept.code,2
NMEToStructuredNMEMap=DEG_AAARadiusStateBinary,answer.accessAccept.State
NMEToStructuredNMEMap=DEG_AAAEAPPayloadBinary,answer.accessAccept.EAPMessage
NMEToStructuredNMEMap=DEG_AAAUserNameString,answer.accessAccept.UserName
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessAccept.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/200.ProcessEAPAccept/008.GenerateAuthenticatedByAAAAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=903.GenerateAccessRequestAuthenticatedByAAAAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Operations=DoAll
SetRejectedResponse=004.SetRejectedResponse
SetRejectedResponse=005.LogRejectedResponse
SetRejectedResponse=006.DeleteSession
SetRejectedResponse=007.SuccessNMEToSNME
SetRejectedResponse=008.GenerateAuthRejectedAuditData
TrueRuleChain=UpdateAAASessions
TrueRuleChain=SetRejectedResponse
UpdateAAASessions=001.InitUpdateAAASession
UpdateAAASessions=002.ExecuteUpdateAAASession
UpdateAAASessions=003.CheckUpdateAAASessionStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/001.InitUpdateAAASession]

AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=set DEG_STATUS "REJECTED_BY_AAA"
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/002.ExecuteUpdateAAASession]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/003.CheckUpdateAAASessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.DeleteSession
TrueRuleChain=200.ErrorNMEToSNME
TrueRuleChain=300.GenerateSytemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/003.CheckUpdateAAASessionStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0064"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing EAPReject"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/003.CheckUpdateAAASessionStatus/110.ErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing EAPReject
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/003.CheckUpdateAAASessionStatus/120.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/003.CheckUpdateAAASessionStatus/200.ErrorNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/003.CheckUpdateAAASessionStatus/200.ErrorNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/003.CheckUpdateAAASessionStatus/300.GenerateSytemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/004.SetRejectedResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Authentication Request Rejected by EAP Adapter"
AdornOps=set DEG_AAAResultCodeInteger 5003
AdornOps=set DEG_AAAExperimentalResultInteger 5003
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5003
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0065"
AdornOps=set DEG_OEMDevErrorMessageString "Authentication Rejected Response From AAA to WIFIINTERFACE (Radius)"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/005.LogRejectedResponse]

Attributes=DEG_AAARadiusAnswerBoolean
Attributes=DEG_AAAAnswerTypeInteger
Attributes=DEG_AAARadiusTypeCodeInteger
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAEAPPayloadBinary
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=LogNMERule
LogLevel=INFO
Message=Authentication Rejected Response From AAA to WIFIINTERFACE (Radius) :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/006.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/007.SuccessNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/007.SuccessNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
NMEToStructuredNMEMap=DEG_AAAEAPPayloadBinary,answer.accessReject.EAPMessage
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/300.ProcessEAPReject/008.GenerateAuthRejectedAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Conditions=DEG_AAAErrorProcessingFlagInteger,=,0
Operations=DoAll
SetErrorResponse=004.SetErrorResponse
SetErrorResponse=005.LogErrorResponse
SetErrorResponse=006.DeleteSession
SetErrorResponse=007.ErrorNMEToSNME
SetErrorResponse=008.GenerateSytemErrorAuditData
TrueRuleChain=UpdateAAASessions
TrueRuleChain=SetErrorResponse
UpdateAAASessions=001.InitUpdateAAASession
UpdateAAASessions=002.ExecuteUpdateAAASession
UpdateAAASessions=003.CheckUpdateAAASessionStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/001.InitUpdateAAASession]

AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_AAA_SESSIONS"
AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
AdornOps=set DEG_STATUS "EAP_TRANSACTION_FAILED"
AdornOps=setsystime DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/002.ExecuteUpdateAAASession]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AAA_SESSID,DEG_AAA_SESSID
MapAttributes=DEG_STATUS,DEG_STATUS
MapAttributes=DEG_UPDATEDTIMESTAMP,DEG_UPDATEDTIMESTAMP
NativeCondition=1.MatchByAAASessionId
NotExistsErrorRuleChain=004.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/003.CheckUpdateAAASessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetAAAErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.DeleteSession
TrueRuleChain=200.ErrorNMEToSNME
TrueRuleChain=300.GenerateSytemErrorAuditData


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/003.CheckUpdateAAASessionStatus/100.SetAAAErrorResponse]

AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAErrorMessageString "Unable to update or access DEG_AAA_SESSIONS table"
AdornOps=set DEG_AAAResultCodeInteger 5012
AdornOps=set DEG_AAAExperimentalResultInteger 5012
AdornOps=set DEG_AAAExperimentalResultCodeInteger 5012
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0066"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing EAPError"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/003.CheckUpdateAAASessionStatus/110.ErrorLog]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_AAAResultCodeString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update or access DEG_AAA_SESSIONS table while Processing EAPError
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/003.CheckUpdateAAASessionStatus/120.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/003.CheckUpdateAAASessionStatus/200.ErrorNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/003.CheckUpdateAAASessionStatus/200.ErrorNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/003.CheckUpdateAAASessionStatus/300.GenerateSytemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/004.SetErrorResponse]

AdornOps=set DEG_AAAErrorMessageString "EAP transaction failed -  "
AdornOps=+ DEG_AAAErrorMessageString DEG_EAPErrorAttributeString DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString - DEG_AAAErrorMessageString
AdornOps=+ DEG_AAAErrorMessageString DEG_EAPErrorMsgAttributeString DEG_AAAErrorMessageString
AdornOps=set DEG_AAAErrorProcessingFlagInteger 1
AdornOps=set DEG_AAAResultCodeInteger 4001
AdornOps=set DEG_AAAExperimentalResultInteger 4001
AdornOps=set DEG_AAAExperimentalResultCodeInteger 4001
AdornOps=copy DEG_AAAResultCodeInteger DEG_AAAResultCodeString
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0067"
AdornOps=set DEG_OEMDevErrorMessageString "EAP Transaction Failed Response From AAA to DEG (Radius)"
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/005.LogErrorResponse]

Attributes=DEG_AAARadiusAnswerBoolean
Attributes=DEG_AAAAnswerTypeInteger
Attributes=DEG_AAARadiusTypeCodeInteger
Attributes=DEG_AAAErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_AAAResultCodeString
ClassName=LogNMERule
LogLevel=INFO
Message=EAP Transaction Failed Response From AAA to DEG (Radius) :
NullAlso=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/006.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=001.DeleteSessionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/007.ErrorNMEToSNME]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,=,0
TrueRuleChain=001.ConvertNMEToSNME


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/007.ErrorNMEToSNME/001.ConvertNMEToSNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_AAARadiusAnswerBoolean,isAnswer,true
NMEToStructuredNMEMap=DEG_AAAAnswerTypeInteger,answer.answerType,3
NMEToStructuredNMEMap=DEG_AAARadiusTypeCodeInteger,answer.accessReject.code,3
NMEToStructuredNMEMap=DEG_AAAResultCodeString,answer.accessReject.ReplyMessages[0].value
SNMEType=radius:RadiusMessage


[/templates/DEG/AAAuthentication/Common/RuleChains/700.CheckEAPTransactionResultRuleChain/100.CheckEAPCode/400.ProcessEAPError/008.GenerateSytemErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/800.AAATimedOutSessionsProcessingRuleChain]

ClassName=RuleChain
RuleNames=100.InitTimestamp
RuleNames=200.QueryAAASessions


[/templates/DEG/AAAuthentication/Common/RuleChains/800.AAATimedOutSessionsProcessingRuleChain/100.InitTimestamp]

AdornOps=setsystime DEG_AAACreateTimeStampFiveSecLong
AdornOps=- DEG_AAACreateTimeStampFiveSecLong 5000 DEG_AAACreateTimeStampFiveSecLong
AdornOps=setsystime DEG_AAACreateTimeStampFiftyFiveSecLong
AdornOps=- DEG_AAACreateTimeStampFiftyFiveSecLong 50000 DEG_AAACreateTimeStampFiftyFiveSecLong
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/800.AAATimedOutSessionsProcessingRuleChain/200.QueryAAASessions]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=100.QueryExpiredAAASessions


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain]

ClassName=RuleChain
RuleNames=100.CheckSessionState


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_AAASessionStatusString,=,"NEW"
Conditions=DEG_AAASessionStatusString,=,"WAIT_FOR_NAK_RESPONSE"
Conditions=DEG_AAASessionStatusString,=,"WAIT_FOR_CHALLENGE_RESPONSE"
Conditions=DEG_AAASessionStatusString,=,"WAIT_FOR_AUTHVECTORS_FROM_AUC"
Conditions=DEG_AAASessionStatusString,=,"WAIT_FOR_REAUTHVECTORS_FROM_AUC"
Conditions=DEG_AAASessionStatusString,=,DEG_AAASessionStatusString
InvalidState=400.DeleteInvalidState
Operations=None
ReceivedNewRequest=100.DeleteExpiredNewRequest
TrueRuleChain=ReceivedNewRequest
TrueRuleChain=WaitForNAK
TrueRuleChain=WaitForChallengeResponse
TrueRuleChain=WaitForAuthVectorsFromAUC
TrueRuleChain=WaitForReAuthVectorsFromAUC
TrueRuleChain=InvalidState
WaitForAuthVectorsFromAUC=300.DeleteWaitForAUCResponseExpiredSessions
WaitForChallengeResponse=200.DeleteChallengeResponseExpiredSessions
WaitForNAK=200.DeleteChallengeResponseExpiredSessions
WaitForReAuthVectorsFromAUC=300.DeleteWaitForAUCResponseExpiredSessions


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/100.DeleteExpiredNewRequest]

ClassName=RuleChain
RuleNames=100.CheckSessionGreaterThanFiftySecs


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/100.DeleteExpiredNewRequest/100.CheckSessionGreaterThanFiftySecs]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAFirstRequestedTimestampLong,<=,DEG_AAACreateTimeStampFiftyFiveSecLong


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/100.DeleteExpiredNewRequest/100.CheckSessionGreaterThanFiftySecs/TrueRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.Initialise
RuleNames=100.DeleteAAASession
RuleNames=200.CheckDeleteStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/100.DeleteExpiredNewRequest/100.CheckSessionGreaterThanFiftySecs/TrueRule/001.Initialise]

AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/100.DeleteExpiredNewRequest/100.CheckSessionGreaterThanFiftySecs/TrueRule/100.DeleteAAASession]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=002.DeleteSessionErrorRuleChain
LogInvalidSession=false
NativeCondition=1.MatchByAAASessionId
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/100.DeleteExpiredNewRequest/100.CheckSessionGreaterThanFiftySecs/TrueRule/200.CheckDeleteStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,!=,0
FalseRuleChain=250.SetErrorInfo
FalseRuleChain=200.LogDeleteSessionSuccess
TrueRuleChain=150.SetErrorInfo
TrueRuleChain=100.LogDeleteSessionError


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/100.DeleteExpiredNewRequest/100.CheckSessionGreaterThanFiftySecs/TrueRule/200.CheckDeleteStatus/100.LogDeleteSessionError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAAUCSessionIDString
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAAUserIdentityString
Attributes=DEG_AAASessionStatusString
Attributes=DEG_AAAFirstRequestedTimestampLong
Attributes=DEG_AAAUpdatedTimestampLong
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to delete entry from DEG_AAA_SESSIONS table


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/100.DeleteExpiredNewRequest/100.CheckSessionGreaterThanFiftySecs/TrueRule/200.CheckDeleteStatus/150.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0068"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to delete entry from DEG_AAA_SESSIONS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/100.DeleteExpiredNewRequest/100.CheckSessionGreaterThanFiftySecs/TrueRule/200.CheckDeleteStatus/200.LogDeleteSessionSuccess]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAAUCSessionIDString
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAAUserIdentityString
Attributes=DEG_AAASessionStatusString
Attributes=DEG_AAAFirstRequestedTimestampLong
Attributes=DEG_AAAUpdatedTimestampLong
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Deleted New Session sent more than 50 secs ago :


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/100.DeleteExpiredNewRequest/100.CheckSessionGreaterThanFiftySecs/TrueRule/200.CheckDeleteStatus/250.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0069"
AdornOps=set DEG_OEMDevErrorMessageString "Deleted New Session sent more than 50 secs ago"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/200.DeleteChallengeResponseExpiredSessions]

ClassName=RuleChain
RuleNames=100.CheckSessionGreaterThan5Secs


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/200.DeleteChallengeResponseExpiredSessions/100.CheckSessionGreaterThan5Secs]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAFirstRequestedTimestampLong,<=,DEG_AAACreateTimeStampFiftyFiveSecLong
Conditions=DEG_AAAUpdatedTimestampLong,<=,DEG_AAACreateTimeStampFiveSecLong
Operations=or


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/200.DeleteChallengeResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.Initialise
RuleNames=100.DeleteAAASession
RuleNames=200.CheckDeleteStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/200.DeleteChallengeResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule/001.Initialise]

AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/200.DeleteChallengeResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule/100.DeleteAAASession]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=002.DeleteSessionErrorRuleChain
LogInvalidSession=false
NativeCondition=1.MatchByAAASessionId
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/200.DeleteChallengeResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule/200.CheckDeleteStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,!=,0
FalseRuleChain=250.SetErrorInfo
FalseRuleChain=200.LogDeleteSessionSuccess
TrueRuleChain=150.SetErrorInfo
TrueRuleChain=100.LogDeleteSessionError


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/200.DeleteChallengeResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule/200.CheckDeleteStatus/100.LogDeleteSessionError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAAUCSessionIDString
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAAUserIdentityString
Attributes=DEG_AAASessionStatusString
Attributes=DEG_AAAFirstRequestedTimestampLong
Attributes=DEG_AAAUpdatedTimestampLong
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to delete entry from DEG_AAA_SESSIONS table


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/200.DeleteChallengeResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule/200.CheckDeleteStatus/150.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0070"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to delete entry from DEG_AAA_SESSIONS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/200.DeleteChallengeResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule/200.CheckDeleteStatus/200.LogDeleteSessionSuccess]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAAUCSessionIDString
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAAUserIdentityString
Attributes=DEG_AAASessionStatusString
Attributes=DEG_AAAFirstRequestedTimestampLong
Attributes=DEG_AAAUpdatedTimestampLong
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=LogNMERule
LogLevel=INFO
Message=Deleted AAA session waiting for Challenge response for more than 5 secs :


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/200.DeleteChallengeResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule/200.CheckDeleteStatus/250.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0071"
AdornOps=set DEG_OEMDevErrorMessageString "Deleted AAA session waiting for Challenge response for more than 5 secs"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/300.DeleteWaitForAUCResponseExpiredSessions]

ClassName=RuleChain
RuleNames=100.CheckSessionGreaterThan5Secs


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/300.DeleteWaitForAUCResponseExpiredSessions/100.CheckSessionGreaterThan5Secs]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAFirstRequestedTimestampLong,<=,DEG_AAACreateTimeStampFiftyFiveSecLong
Conditions=DEG_AAAUpdatedTimestampLong,<=,DEG_AAACreateTimeStampFiveSecLong
Operations=or


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/300.DeleteWaitForAUCResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.Initialise
RuleNames=100.DeleteAAASession
RuleNames=200.CheckDeleteStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/300.DeleteWaitForAUCResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule/001.Initialise]

AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/300.DeleteWaitForAUCResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule/100.DeleteAAASession]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=002.DeleteSessionErrorRuleChain
LogInvalidSession=false
NativeCondition=1.MatchByAAASessionId
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/300.DeleteWaitForAUCResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule/200.CheckDeleteStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,!=,0
FalseRuleChain=250.SetErrorInfo
FalseRuleChain=200.LogDeleteSessionSuccess
TrueRuleChain=150.SetErrorInfo
TrueRuleChain=100.LogDeleteSessionError


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/300.DeleteWaitForAUCResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule/200.CheckDeleteStatus/100.LogDeleteSessionError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAAUCSessionIDString
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAAUserIdentityString
Attributes=DEG_AAASessionStatusString
Attributes=DEG_AAAFirstRequestedTimestampLong
Attributes=DEG_AAAUpdatedTimestampLong
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to delete entry from DEG_AAA_SESSIONS table while Processing ExpiredSession


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/300.DeleteWaitForAUCResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule/200.CheckDeleteStatus/150.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0072"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to delete entry from DEG_AAA_SESSIONS table while Processing ExpiredSession"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/300.DeleteWaitForAUCResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule/200.CheckDeleteStatus/200.LogDeleteSessionSuccess]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAAUCSessionIDString
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAAUserIdentityString
Attributes=DEG_AAASessionStatusString
Attributes=DEG_AAAFirstRequestedTimestampLong
Attributes=DEG_AAAUpdatedTimestampLong
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Deleted AAA Session waiting for response from AUC more than 5 secs :


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/300.DeleteWaitForAUCResponseExpiredSessions/100.CheckSessionGreaterThan5Secs/TrueRule/200.CheckDeleteStatus/250.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0073"
AdornOps=set DEG_OEMDevErrorMessageString "Deleted AAA Session waiting for response from AUC more than 5 secs"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/400.DeleteInvalidState]

ClassName=RuleChain
RuleNames=100.CheckSessionGreaterThanFiftySecs


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/400.DeleteInvalidState/100.CheckSessionGreaterThanFiftySecs]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAAFirstRequestedTimestampLong,<=,DEG_AAACreateTimeStampFiftyFiveSecLong


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/400.DeleteInvalidState/100.CheckSessionGreaterThanFiftySecs/TrueRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.Initialise
RuleNames=100.DeleteAAASession
RuleNames=200.CheckDeleteStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/400.DeleteInvalidState/100.CheckSessionGreaterThanFiftySecs/TrueRule/001.Initialise]

AdornOps=copy DEG_AAASessionIdString DEG_AAA_SESSID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/400.DeleteInvalidState/100.CheckSessionGreaterThanFiftySecs/TrueRule/100.DeleteAAASession]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=002.DeleteSessionErrorRuleChain
LogInvalidSession=false
NativeCondition=1.MatchByAAASessionId
SessionStore=DEG_AAA_SESSIONS_Store


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/400.DeleteInvalidState/100.CheckSessionGreaterThanFiftySecs/TrueRule/200.CheckDeleteStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,!=,0
FalseRuleChain=250.SetErrorInfo
FalseRuleChain=200.LogDeleteSessionSuccess
TrueRuleChain=150.SetErrorInfo
TrueRuleChain=100.LogDeleteSessionError


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/400.DeleteInvalidState/100.CheckSessionGreaterThanFiftySecs/TrueRule/200.CheckDeleteStatus/100.LogDeleteSessionError]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAAUCSessionIDString
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAAUserIdentityString
Attributes=DEG_AAASessionStatusString
Attributes=DEG_AAAFirstRequestedTimestampLong
Attributes=DEG_AAAUpdatedTimestampLong
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to delete entry from DEG_AAA_SESSIONS table wile Processing ExpiredSession


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/400.DeleteInvalidState/100.CheckSessionGreaterThanFiftySecs/TrueRule/200.CheckDeleteStatus/150.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0074"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to delete entry from DEG_AAA_SESSIONS table wile Processing ExpiredSession"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/400.DeleteInvalidState/100.CheckSessionGreaterThanFiftySecs/TrueRule/200.CheckDeleteStatus/200.LogDeleteSessionSuccess]

Attributes=DEG_AAASessionIdString
Attributes=DEG_AAAAUCSessionIDString
Attributes=DEG_AAAResultCodeInteger
Attributes=DEG_AAAUserIdentityString
Attributes=DEG_AAASessionStatusString
Attributes=DEG_AAAFirstRequestedTimestampLong
Attributes=DEG_AAAUpdatedTimestampLong
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Deleted AAA session with invalid STATUS :


[/templates/DEG/AAAuthentication/Common/RuleChains/810.DeleteAAAExpiredSessionsRuleChain/100.CheckSessionState/400.DeleteInvalidState/100.CheckSessionGreaterThanFiftySecs/TrueRule/200.CheckDeleteStatus/250.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0075"
AdornOps=set DEG_OEMDevErrorMessageString "Deleted AAA session with invalid STATUS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/900.GenerateAccessRequestStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CreateAuditRecord
RuleNames=200.GenerateAuditAndNRBEvents


[/templates/DEG/AAAuthentication/Common/RuleChains/900.GenerateAccessRequestStartAuditDataRuleChain/100.CreateAuditRecord]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute


[/templates/DEG/AAAuthentication/Common/RuleChains/900.GenerateAccessRequestStartAuditDataRuleChain/100.CreateAuditRecord/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=copy DEG_AAAWifiProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_AAASessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AAAAuditDurationLong 0
AdornOps=copy DEG_AAAAuditDurationLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_AAAImsiString DEG_AuditIMSIString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "AAAAccessRequest"
AdornOps=set DEG_AuditSourceDestinationString "DEGWIFI"
AdornOps=copy DEG_AAAImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AAANrbRecordFoundInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/900.GenerateAccessRequestStartAuditDataRuleChain/100.CreateAuditRecord/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "WIFIINTERFACE TO AAA -> Received AccessRequest : "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/900.GenerateAccessRequestStartAuditDataRuleChain/100.CreateAuditRecord/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_AAATmp1String "DEG_AAASessionIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAASessionIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditMdnString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAImsiString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAImsiString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAUserNameString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAUserNameString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/900.GenerateAccessRequestStartAuditDataRuleChain/100.CreateAuditRecord/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Received AccessRequest"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/900.GenerateAccessRequestStartAuditDataRuleChain/200.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=915.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/901.GenerateAccessRequestAuthWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_AuditResultCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/AAAuthentication/Common/RuleChains/901.GenerateAccessRequestAuthWaitEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_AAAWifiProcessStartTimeLong DEG_AAAAuditDurationLong
AdornOps=copy DEG_AAAAuditDurationLong DEG_AuditDurationString
AdornOps=copy DEG_AAASessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "1001"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_AAAImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "AAAAccessChallenge"
AdornOps=set DEG_AuditSourceDestinationString "DEGWIFI"
AdornOps=copy DEG_AAAImsiString DEG_AuditChannelNameString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/901.GenerateAccessRequestAuthWaitEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO WIFIINTERFACE -> Sending Access Challenge response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/901.GenerateAccessRequestAuthWaitEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_AAATmp1String "DEG_AAASessionIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAASessionIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditMdnString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAImsiString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAImsiString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAUserNameString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAUserNameString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_STATUS="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_STATUS DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/901.GenerateAccessRequestAuthWaitEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_AuditResultCodeString]

AdornOps=set DEG_AAATmp1String ", DEG_AuditResultCodeString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/901.GenerateAccessRequestAuthWaitEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sending Access Challenge Response,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/901.GenerateAccessRequestAuthWaitEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=915.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_AuditResultCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/AAAuthentication/Common/RuleChains/902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_AAAWifiProcessStartTimeLong DEG_AAAAuditDurationLong
AdornOps=copy DEG_AAAAuditDurationLong DEG_AuditDurationString
AdornOps=copy DEG_AAASessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=setifnull DEG_AAAResultCodeString 0
AdornOps=copy DEG_AAAResultCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_AAAImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "AAAAccessReject"
AdornOps=set DEG_AuditSourceDestinationString "DEGWIFI"
AdornOps=copy DEG_AAAImsiString DEG_AuditChannelNameString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO WIFIINTERFACE -> Sending Access Reject response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_AAATmp1String "DEG_AAASessionIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAASessionIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditMdnString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAImsiString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAImsiString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAUserNameString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAUserNameString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_AuditResultCodeString]

AdornOps=set DEG_AAATmp1String ", DEG_AuditResultCodeString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sending Access Reject Response,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/902.GenerateAccessRequestAuthRejectedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=915.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/903.GenerateAccessRequestAuthenticatedByAAAAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_AuditResultCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/AAAuthentication/Common/RuleChains/903.GenerateAccessRequestAuthenticatedByAAAAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditProcessingNodeString deg-appserver13
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_AAAWifiProcessStartTimeLong DEG_AAAAuditDurationLong
AdornOps=copy DEG_AAAAuditDurationLong DEG_AuditDurationString
AdornOps=copy DEG_AAASessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "2001"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_AAAImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "AAAAccessAccept"
AdornOps=set DEG_AuditSourceDestinationString "DEGWIFI"
AdornOps=copy DEG_AAAImsiString DEG_AuditChannelNameString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/903.GenerateAccessRequestAuthenticatedByAAAAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO WIFIINTERFACE -> Sending Access Accept response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/903.GenerateAccessRequestAuthenticatedByAAAAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_AAATmp1String "DEG_AAASessionIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAASessionIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditMdnString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAImsiString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAImsiString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAUserNameString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAUserNameString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_STATUS="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_STATUS DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/903.GenerateAccessRequestAuthenticatedByAAAAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_AuditResultCodeString]

AdornOps=set DEG_AAATmp1String ", DEG_AuditResultCodeString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/903.GenerateAccessRequestAuthenticatedByAAAAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sending Access Accept Response,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/903.GenerateAccessRequestAuthenticatedByAAAAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=915.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/904.GenerateDERStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CreateAuditRecord
RuleNames=200.GenerateAuditAndNRBEvents


[/templates/DEG/AAAuthentication/Common/RuleChains/904.GenerateDERStartAuditDataRuleChain/100.CreateAuditRecord]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute


[/templates/DEG/AAAuthentication/Common/RuleChains/904.GenerateDERStartAuditDataRuleChain/100.CreateAuditRecord/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=copy DEG_AAADERProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_AAASessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AAAAuditDurationLong 0
AdornOps=copy DEG_AAAAuditDurationLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_AAAImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DERRequest"
AdornOps=set DEG_AuditSourceDestinationString "DEVICEIF"
AdornOps=copy DEG_AAAImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AAANrbRecordFoundInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/904.GenerateDERStartAuditDataRuleChain/100.CreateAuditRecord/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEVICEINTERFACE TO AAA -> Received DER Request : "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/904.GenerateDERStartAuditDataRuleChain/100.CreateAuditRecord/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_AAATmp1String "DEG_AAASessionIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAASessionIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditMdnString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAImsiString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAImsiString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAUserNameString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAUserNameString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/904.GenerateDERStartAuditDataRuleChain/100.CreateAuditRecord/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Received DER Request"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/904.GenerateDERStartAuditDataRuleChain/200.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=915.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/905.GenerateDERAuthWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_AuditResultCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/AAAuthentication/Common/RuleChains/905.GenerateDERAuthWaitEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_AAADERProcessStartTimeLong DEG_AAAAuditDurationLong
AdornOps=copy DEG_AAAAuditDurationLong DEG_AuditDurationString
AdornOps=copy DEG_AAASessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "1001"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_AAAImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DEAChallenge"
AdornOps=set DEG_AuditSourceDestinationString "DEVICEIF"
AdornOps=copy DEG_AAAImsiString DEG_AuditChannelNameString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/905.GenerateDERAuthWaitEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO DEVICENTERFACE -> Sending DEA Challenge Response : "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/905.GenerateDERAuthWaitEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_AAATmp1String "DEG_AAASessionIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAASessionIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditMdnString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAImsiString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAImsiString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAUserNameString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAUserNameString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_STATUS="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_STATUS DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/905.GenerateDERAuthWaitEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_AuditResultCodeString]

AdornOps=set DEG_AAATmp1String ", DEG_AuditResultCodeString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/905.GenerateDERAuthWaitEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sending DEA Challenge Response,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/905.GenerateDERAuthWaitEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=915.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/906.GenerateDERAuthRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_AuditResultCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/AAAuthentication/Common/RuleChains/906.GenerateDERAuthRejectedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_AAADERProcessStartTimeLong DEG_AAAAuditDurationLong
AdornOps=copy DEG_AAAAuditDurationLong DEG_AuditDurationString
AdornOps=copy DEG_AAASessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "5003"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_AAAImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DEAReject"
AdornOps=set DEG_AuditSourceDestinationString "DEVICEIF"
AdornOps=copy DEG_AAAImsiString DEG_AuditChannelNameString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/906.GenerateDERAuthRejectedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO DEVICEINTERFACE -> Sending DEA Reject Response : "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/906.GenerateDERAuthRejectedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_AAATmp1String "DEG_AAASessionIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAASessionIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditMdnString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAImsiString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAImsiString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAUserNameString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAUserNameString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/906.GenerateDERAuthRejectedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_AuditResultCodeString]

AdornOps=set DEG_AAATmp1String ", DEG_AuditResultCodeString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/906.GenerateDERAuthRejectedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sending DEA Reject Response,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/906.GenerateDERAuthRejectedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=915.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/907.GenerateDERAuthenticatedByAAAAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_AuditResultCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/AAAuthentication/Common/RuleChains/907.GenerateDERAuthenticatedByAAAAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_AAADERProcessStartTimeLong DEG_AAAAuditDurationLong
AdornOps=copy DEG_AAAAuditDurationLong DEG_AuditDurationString
AdornOps=copy DEG_AAASessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "2001"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_AAAImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DEAAccept"
AdornOps=set DEG_AuditSourceDestinationString "DEVICEIF"
AdornOps=copy DEG_AAAImsiString DEG_AuditChannelNameString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/907.GenerateDERAuthenticatedByAAAAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO DEVICEINTERFACE -> Sending DEA Accept Response : "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/907.GenerateDERAuthenticatedByAAAAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_AAATmp1String "DEG_AAASessionIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAASessionIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditMdnString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAImsiString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAImsiString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAUserNameString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAUserNameString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_STATUS="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_STATUS DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/907.GenerateDERAuthenticatedByAAAAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_AuditResultCodeString]

AdornOps=set DEG_AAATmp1String ", DEG_AuditResultCodeString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/907.GenerateDERAuthenticatedByAAAAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sending DEA Accept Response,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/907.GenerateDERAuthenticatedByAAAAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=915.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/AAAuthentication/Common/RuleChains/908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_AAADERProcessStartTimeLong DEG_AAAAuditDurationLong
AdornOps=copy DEG_AAAAuditDurationLong DEG_AuditDurationString
AdornOps=copy DEG_AAASessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=setifnull DEG_AAAResultCodeString 0
AdornOps=copy DEG_AAAResultCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_AAAImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "DEAError"
AdornOps=set DEG_AuditSourceDestinationString "DEVICEIF"
AdornOps=copy DEG_AAAImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AAANrbRecordFoundInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO DEVICEINTERFACE -> Error while Processing DER Request : "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_AAATmp1String "DEG_AAASessionIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAASessionIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditMdnString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAImsiString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAImsiString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAUserNameString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAUserNameString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_AAATmp1String ", DEG_AuditResultCodeString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Error while Processing DER Request,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/908.GenerateAAADiameterSystemErrorEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=915.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/909.GenerateAAADiameterHSSCallStartAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/AAAuthentication/Common/RuleChains/909.GenerateAAADiameterHSSCallStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=copy DEG_AAAHSSProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_AAASessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AAAAuditDurationLong 0
AdornOps=copy DEG_AAAAuditDurationLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "MultiMediaAccess"
AdornOps=set DEG_AuditSourceDestinationString "HSS"
AdornOps=copy DEG_AAAImsiString DEG_AuditIMSIString
AdornOps=copy DEG_AAAImsiString DEG_AuditChannelNameString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/909.GenerateAAADiameterHSSCallStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "AAA TO HSS -> Sending Multimedia Access Request : "
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/909.GenerateAAADiameterHSSCallStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_AAATmp1String "DEG_AAASessionIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAASessionIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditMdnString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAImsiString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAImsiString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/909.GenerateAAADiameterHSSCallStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sending Multimedia Access Request,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/909.GenerateAAADiameterHSSCallStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=915.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/910.GenerateAAADiameterHSSCallEndErrorAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/AAAuthentication/Common/RuleChains/910.GenerateAAADiameterHSSCallEndErrorAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_AAASessionIdString DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_AAAHSSProcessStartTimeLong DEG_AAAAuditDurationLong
AdornOps=copy DEG_AAAAuditDurationLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=setifnull DEG_AAAResultCodeString 0
AdornOps=copy DEG_AAAResultCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "MultiMediaAccess"
AdornOps=set DEG_AuditSourceDestinationString "HSS"
AdornOps=setifnull DEG_AAAErrorMessageString ""
AdornOps=setifnull DEG_AAAProcessingErrorIdString ""
AdornOps=copy DEG_AAAImsiString DEG_AuditIMSIString
AdornOps=copy DEG_AAAImsiString DEG_AuditChannelNameString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/910.GenerateAAADiameterHSSCallEndErrorAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "HSS TO AAA -> Received Multimedia Access Answer Error : "
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/910.GenerateAAADiameterHSSCallEndErrorAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_AAATmp1String "DEG_AAASessionIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAASessionIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditMdnString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAProcessingErrorIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAProcessingErrorIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AuditResultCodeString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAErrorMessageString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/910.GenerateAAADiameterHSSCallEndErrorAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditMessageString "Received Multimedia Access Answer Error"
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/910.GenerateAAADiameterHSSCallEndErrorAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=915.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/911.GenerateAAADiameterHSSCallEndOKAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/AAAuthentication/Common/RuleChains/911.GenerateAAADiameterHSSCallEndOKAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_AAASessionIdString DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_AAAHSSProcessStartTimeLong DEG_AAAAuditDurationLong
AdornOps=copy DEG_AAAAuditDurationLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "DIAMETER"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "2001"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "MultiMediaAccess"
AdornOps=set DEG_AuditSourceDestinationString "HSS"
AdornOps=copy DEG_AAAImsiString DEG_AuditIMSIString
AdornOps=copy DEG_AAAImsiString DEG_AuditChannelNameString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/911.GenerateAAADiameterHSSCallEndOKAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "HSS TO AAA -> Received Multimedia Access Answer Ok : "
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/911.GenerateAAADiameterHSSCallEndOKAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_AAATmp1String "DEG_AAASessionIdString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAASessionIdString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAMobileNumberString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditMdnString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AAAImsiString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AAAImsiString DEG_AuditMessageString
AdornOps=set DEG_AAATmp1String ", DEG_AuditResultCodeString="
AdornOps=+ DEG_AuditMessageString DEG_AAATmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/911.GenerateAAADiameterHSSCallEndOKAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Received Multimedia Access Answer Ok"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/911.GenerateAAADiameterHSSCallEndOKAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=915.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/915.GenerateAuditAndNRBEventsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpAuditRecord
RuleNames=200.DumpMonitoringTransactions


[/templates/DEG/AAAuthentication/Common/RuleChains/915.GenerateAuditAndNRBEventsRuleChain/100.DumpAuditRecord]

ClassName=com.hp.siu.sessionserver.rules.NMEStoreRule
NMEStore=AuditNmeStore


[/templates/DEG/AAAuthentication/Common/RuleChains/915.GenerateAuditAndNRBEventsRuleChain/200.DumpMonitoringTransactions]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_AAANrbMonitoringSessionIdList
RequestAttributes=DEG_AuditProcessingNodeString
RequestAttributes=DEG_AuditTimestampLong
RequestAttributes=DEG_AuditInterfaceString
RequestAttributes=DEG_AuditInOutString
RequestAttributes=DEG_AuditResultCodeString
RequestAttributes=DEG_AuditMdnString
RequestAttributes=DEG_AuditIMSIString
RequestAttributes=DEG_AuditTransactionTypeString
RequestAttributes=DEG_AuditSourceDestinationString
RequestAttributes=DEG_AuditNRBMessageString
RequestAttributes=DEG_AuditMessageString
RuleChain=916.DumpMonitoringTransactionsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpMonitoringTransactions


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.DumpMonitoringTransactions


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_AAANrbMonitoringSessionIdList
RuleChain=100.InsertMonitoringTransactionToDb
TmpAttributeName=DEG_AAANrbMonitoringSessionIdString


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=200.QueryMonitoringIdGenerator


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateTransactionId
RuleNames=110.PopulateMonitoringTransactionAttributes
RuleNames=120.InitInsert2Db
RuleNames=200.Insert2Db
RuleNames=300.CheckCreateStatus


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/100.GenerateTransactionId]

AdornOps=setsystime DEG_AAATmp1Long
AdornOps=copy DEG_AAATmp1Long DEG_AAATmp1String
AdornOps=+ DEG_AAATmp1String DEG_MSESSIONTRANSID DEG_MSESSIONTRANSID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/110.PopulateMonitoringTransactionAttributes]

AdornOps=copy DEG_AuditProcessingNodeString DEG_MSESSIONPROCID
AdornOps=copy DEG_AuditTimestampLong DEG_MSESSIONTIMESTAMP
AdornOps=copy DEG_AuditInterfaceString DEG_MSESSIONINTERFACE
AdornOps=copy DEG_AuditInOutString DEG_MSESSIONINOUT
AdornOps=copy DEG_AuditResultCodeString DEG_MSESSIONRESULTCODE
AdornOps=copy DEG_AuditMdnString DEG_MSESSIONMDN
AdornOps=copy DEG_AuditIMSIString DEG_MSESSIONIMSI
AdornOps=copy DEG_AuditTransactionTypeString DEG_MSESSIONTRANSACTIONTYPE
AdornOps=copy DEG_AuditSourceDestinationString DEG_MSESSIONSOURCEDESTINATION
AdornOps=copy DEG_AuditNRBMessageString DEG_MSESSIONMESSAGE
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/120.InitInsert2Db]

AdornOps=set DEG_AAASessionStoreErrorFlagInteger 0
AdornOps=set DEG_AAASessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_AAANrbMonitoringSessionIdString DEG_MSESSIONID
AdornOps=set log_DB_Operation "CREATE"
AdornOps=set log_Table_Name "DEG_MONITORING_TRANSACTIONS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/200.Insert2Db]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=003.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=005.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_MONITORING_TRANSACTIONS_SessionStore


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AAASessionStoreErrorFlagInteger,!=,0
Conditions=DEG_AAASessionStoreKeyExistsFlagInteger,!=,0
Operations=or
TrueRuleChain=150.SetErrorInfo
TrueRuleChain=100.ErrorLog


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus/100.ErrorLog]

Attributes=DEG_MSESSIONID
Attributes=DEG_MSESSIONTRANSID
Attributes=DEG_MSESSIONPROCID
Attributes=DEG_MSESSIONTIMESTAMP
Attributes=DEG_MSESSIONINTERFACE
Attributes=DEG_MSESSIONINOUT
Attributes=DEG_MSESSIONRESULTCODE
Attributes=DEG_MSESSIONMDN
Attributes=DEG_MSESSIONTRANSACTIONTYPE
Attributes=DEG_MSESSIONSOURCEDESTINATION
Attributes=DEG_MSESSIONMESSAGE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to create entry in DEG_MONITORING_TRANSACTIONS session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus/150.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0076"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to create entry in DEG_MONITORING_TRANSACTIONS session store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetEmptyTransactionId
RuleNames=200.Log


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/100.SetEmptyTransactionId]

AdornOps=set DEG_MSESSIONTRANSID ""
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.AAA.0077"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to generate unique value of monitoring transaction id"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/200.Log]

Attributes=DEG_MSESSIONTRANSID
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=Unable to generate unique value of monitoring transaction id:
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/AAAuthentication/Common/RuleChains/916.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_AAANrbMonitoringSessionIdList != null


[/templates/DEG/AAAuthentication/Common/SessionStores]

ClassName=com.hp.siu.sessionserver.SessionStoreManager
SessionStoreNames=DEG_AAA_SESSIONS_Store
SessionStoreNames=DEG_SSL_SESSION_Store
SessionStoreNames=DEG_WIFIRADIUSSESSION_Store
SessionStoreNames=DEG_MONITORING_TRANSACTIONS_SessionStore


[/templates/DEG/AAAuthentication/Common/SessionStores/DEG_AAA_SESSIONS_Store]

Attributes=DEG_AAA_SESSID,key
Attributes=DEG_AAA_AUC_ID
Attributes=DEG_RESULT_CODE
Attributes=DEG_USERIDENTITY
Attributes=DEG_STATUS
Attributes=DEG_FIRSTREQTIMESTAMP
Attributes=DEG_UPDATEDTIMESTAMP
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy1
DatabaseId=DEG_AAA_SESSIONS
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${AAA_MAX_DBCONN_AAA_SESSION}
NativeConditions=1.MatchByAAASessionId
NativeConditions=2.MatchByUserIdentity
SQLTypeMap=DEG_AAA_SESSID,VARCHAR(256)
SQLTypeMap=DEG_AAA_AUC_ID,VARCHAR(256)
SQLTypeMap=DEG_RESULT_CODE,BIGINT
SQLTypeMap=DEG_USERIDENTITY,VARCHAR(256)
SQLTypeMap=DEG_STATUS,VARCHAR(256)
SQLTypeMap=DEG_FIRSTREQTIMESTAMP,BIGINT
SQLTypeMap=DEG_UPDATEDTIMESTAMP,BIGINT


[/templates/DEG/AAAuthentication/Common/SessionStores/DEG_AAA_SESSIONS_Store/1.MatchByAAASessionId]

Condition=where DEG_AAA_SESSID = %DEG_AAA_SESSID


[/templates/DEG/AAAuthentication/Common/SessionStores/DEG_AAA_SESSIONS_Store/2.MatchByUserIdentity]

Condition=where DEG_USERIDENTITY = %DEG_USERIDENTITY


[/templates/DEG/AAAuthentication/Common/SessionStores/DEG_MONITORING_TRANSACTIONS_SessionStore]

Attributes=DEG_MSESSIONID,key
Attributes=DEG_MSESSIONTRANSID,key
Attributes=DEG_MSESSIONIMSI
Attributes=DEG_MSESSIONPROCID
Attributes=DEG_MSESSIONTIMESTAMP
Attributes=DEG_MSESSIONINTERFACE
Attributes=DEG_MSESSIONINOUT
Attributes=DEG_MSESSIONRESULTCODE
Attributes=DEG_MSESSIONMDN
Attributes=DEG_MSESSIONTRANSACTIONTYPE
Attributes=DEG_MSESSIONSOURCEDESTINATION
Attributes=DEG_MSESSIONMESSAGE
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy2
DatabaseId=DEG_MONITORING_TRANSACTIONS
DbSchema=${DBSCHEMA_NRB}
MaxDatabaseConnections=${AAA_MAX_DBCONN_MONI_TRANS}
SQLTypeMap=DEG_MSESSIONID,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONTRANSID,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONPROCID,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONTIMESTAMP,BIGINT
SQLTypeMap=DEG_MSESSIONINTERFACE,VARCHAR(10)
SQLTypeMap=DEG_MSESSIONINOUT,VARCHAR(3)
SQLTypeMap=DEG_MSESSIONRESULTCODE,VARCHAR(15)
SQLTypeMap=DEG_MSESSIONMDN,BIGINT
SQLTypeMap=DEG_MSESSIONTRANSACTIONTYPE,VARCHAR(50)
SQLTypeMap=DEG_MSESSIONSOURCEDESTINATION,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONMESSAGE,VARCHAR(512)
SQLTypeMap=DEG_MSESSIONIMSI,VARCHAR(64)


[/templates/DEG/AAAuthentication/Common/SessionStores/DEG_SSL_SESSION_Store]

Attributes=DEG_SSL_ID,key
Attributes=DEG_SSL_STATE
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_SSL_AAA_STATE
Attributes=DEG_SSL_NAI
Attributes=DEG_SSL_IMSI
Attributes=DEG_SSL_MDN
Attributes=DEG_SSL_CREATETIMESTAMP
Attributes=DEG_STR_FLAG
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy1
DatabaseId=DEG_SSL_SESSION
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${AAA_MAX_DBCONN_SSL_SESSION}
NativeConditions=MatchingSession
SQLTypeMap=DEG_SSL_ID,VARCHAR(256)
SQLTypeMap=DEG_SSL_STATE,VARCHAR(256)
SQLTypeMap=DEG_SSL_AAA_SESSIONID,VARCHAR(256)
SQLTypeMap=DEG_SSL_AAA_STATE,VARBINARY(8)
SQLTypeMap=DEG_SSL_NAI,VARCHAR(256)
SQLTypeMap=DEG_SSL_IMSI,VARCHAR(256)
SQLTypeMap=DEG_SSL_MDN,VARCHAR(256)
SQLTypeMap=DEG_SSL_CREATETIMESTAMP,BIGINT
SQLTypeMap=DEG_STR_FLAG,TINYINT


[/templates/DEG/AAAuthentication/Common/SessionStores/DEG_SSL_SESSION_Store/MatchingSession]

Condition=where DEG_SSL_NAI = %DEG_SSL_NAI and DEG_SSL_IMSI = %DEG_SSL_IMSI


[/templates/DEG/AAAuthentication/Common/SessionStores/DEG_WIFIRADIUSSESSION_Store]

Attributes=DEG_WIFIRPROCID
Attributes=DEG_WIFIRORIGIPADDR,key
Attributes=DEG_WIFIRACCTSESSID,key
Attributes=DEG_WIFIRUSERNAME,key
Attributes=DEG_WIFIRIMSI
Attributes=DEG_WIFIRSTATE
Attributes=DEG_WIFIAAASTATE
Attributes=DEG_WIFIRUPDATETIMESTAMP
Attributes=DEG_WIFIRMDN
Attributes=DEG_WIFIRERRCODE
Attributes=DEG_WIFIRORIGCODE
Attributes=DEG_WIFIRORIGMESAUTHENTICATOR
Attributes=DEG_WIFIRORIGLENGTH
Attributes=DEG_WIFIRAAASESSID
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy1
DatabaseId=DEG_WIFIRADIUSSESSION
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${AAA_MAX_DBCONN_WIFI_RADIUSSESSION}
NativeConditions=MatchingSession
SQLTypeMap=DEG_WIFIRPROCID,VARCHAR(32)
SQLTypeMap=DEG_WIFIRORIGIPADDR,VARCHAR(256)
SQLTypeMap=DEG_WIFIRACCTSESSID,VARCHAR(256)
SQLTypeMap=DEG_WIFIRUSERNAME,VARCHAR(256)
SQLTypeMap=DEG_WIFIRIMSI,VARCHAR(15)
SQLTypeMap=DEG_WIFIRSTATE,VARCHAR(64)
SQLTypeMap=DEG_WIFIAAASTATE,VARCHAR(64)
SQLTypeMap=DEG_WIFIRUPDATETIMESTAMP,BIGINT
SQLTypeMap=DEG_WIFIRMDN,BIGINT
SQLTypeMap=DEG_WIFIRAAASESSID,VARCHAR(256)
SQLTypeMap=DEG_WIFIRERRCODE,VARCHAR(32)
SQLTypeMap=DEG_WIFIRORIGMESAUTHENTICATOR,VARCHAR(100)
SQLTypeMap=DEG_WIFIRORIGCODE,BIGINT
SQLTypeMap=DEG_WIFIRORIGLENGTH,BIGINT


[/templates/DEG/AAAuthentication/Common/SessionStores/DEG_WIFIRADIUSSESSION_Store/MatchingSession]

Condition=where DEG_WIFIRUSERNAME = %DEG_WIFIRUSERNAME and DEG_WIFIRIMSI = %DEG_WIFIRIMSI and DEG_WIFIRAAASESSID = %DEG_WIFIRAAASESSID


[/templates/DEG/AAAuthentication/Common/snmeloader]

ClassName=com.hp.usage.nme.schemaloader.NMESchemaLoader
Schema=mySNMESchema
SchemaPath=datamodel


[/templates/DEG/AAAuthentication/Common/snmeloader/mySNMESchema]

Link=/SNMESchema
