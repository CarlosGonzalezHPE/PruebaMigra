

[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core]


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains]

RuleChainNames=300.DEG30ProcessOTPRuleChain
RuleChainNames=300A.DEG30ProcessActionRuleChain
RuleChainNames=300B.DEG30SslSessionLookupStatusRuleChain
RuleChainNames=300C.DEG30NewRequest_CheckSslSessionStatusRuleChain
RuleChainNames=300D.DEG30RequestOk_CheckSslSessionStatusRuleChain
RuleChainNames=300E.DEG30ProcessOTPAuthStep1RuleChain
RuleChainNames=300G.DEG30ValidationAndProcessActionRuleChain
RuleChainNames=300I.DEG30FullAuthRuleChain
RuleChainNames=300J.DEG30FastPathAuthRuleChain
RuleChainNames=300K.DEG30GenerateOEMResponseRuleChain
RuleChainNames=300L.DEG30GenerateOTPInitialEndAuditDataRuleChain
RuleChainNames=801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain
RuleChainNames=802.DEG30GenerateOTPWaitEndAuditDataRuleChain
RuleChainNames=803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain
RuleChainNames=804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
RuleChainNames=805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain
RuleChainNames=807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain
RuleChainNames=808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain
RuleChainNames=809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=099.SetLogInfo
RuleNames=100.LogActionDetails
RuleNames=200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber
RuleNames=300.ValidateBody
RuleNames=400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber
RuleNames=500.ResetSSLSessionStatus
RuleNames=600.ProcessAction


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/099.SetLogInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1201"
AdornOps=set DEG_OEMDevMessageString "Processing OEM action"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/100.LogActionDetails]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevRespTokenString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Processing OEM action: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=or,or


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber/TrueRule]

AdornOps=set DEG_OEMDevRequestProcessedInteger 0
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/300.ValidateBody]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=110.DEG30ValidateInitialRequestRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=or,or


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber/TrueRule]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
ClassName=AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/500.ResetSSLSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,!=,0
Conditions=DEG_SSL_STATE,!=,"WAIT_FOR_OTP_CHALLENGE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,!=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,!=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,!=,"DISALLOWED_ACTION"
Operations=and,and,and,and
TrueRuleChain=100.ResetSslStateToNew


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/500.ResetSSLSessionStatus/100.ResetSslStateToNew]

AdornOps=set DEG_SSL_STATE "NEW"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300.DEG30ProcessOTPRuleChain/600.ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300A.DEG30ProcessActionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300A.DEG30ProcessActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ProcessAction


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300A.DEG30ProcessActionRuleChain/100.ProcessAction]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitSslSessionLookup
TrueRuleChain=110.ExecuteSslSessionLookup
TrueRuleChain=120.CheckSslSessionLookupStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300A.DEG30ProcessActionRuleChain/100.ProcessAction/100.InitSslSessionLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300A.DEG30ProcessActionRuleChain/100.ProcessAction/110.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
MapAttributes=DEG_SSL_ID_PROV_STATUS,DEG_SSL_ID_PROV_STATUS
MapAttributes=DEG_SSL_GW_ADDR,DEG_SSL_GW_ADDR
MapAttributes=DEG_SSL_ADDRESS_UPDATE_URL,DEG_SSL_ADDRESS_UPDATE_URL
MapAttributes=DEG_SSL_ADDRESS_STATUS,DEG_SSL_ADDRESS_STATUS
MapAttributes=DEG_SSL_TC_STATUS,DEG_SSL_TC_STATUS
MapAttributes=DEG_SSL_POSTDATA,DEG_SSL_POSTDATA
MapAttributes=DEG_SSL_EntitlementStatus,DEG_SSL_EntitlementStatus
MapAttributes=DEGDROID_SSL_COOKIE_ID,DEGDROID_SSL_COOKIE_ID
MapAttributes=DEGDROID_SSL_OTP,DEGDROID_SSL_OTP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300A.DEG30ProcessActionRuleChain/100.ProcessAction/120.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300B.DEG30SslSessionLookupStatusRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SslSessionLookup


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_SSL_REQUEST_STATE,=,"NEW"
Conditions=DEG_SSL_REQUEST_STATE,within,[403C,500C]
Conditions=DEG_SSL_REQUEST_STATE,within,[200,200C]
Conditions=DEG_SSL_REQUEST_STATE,=,DEG_SSL_REQUEST_STATE
NewRequest=300.NewRequest_CheckSslSessionStatus
NoSslSession=200.SetSslRequestState_500C
NoSslSession=210.NoSslSessionLog
Operations=None
RequestError=355.SetErrorInfo
RequestError=400.RequestErrorLog
RequestOk=500.RequestOk_CheckSslSessionStatus
SystemError=100.SetSslRequestState_500C
SystemError=110.SystemErrorLog
TrueRuleChain=SystemError
TrueRuleChain=NoSslSession
TrueRuleChain=NewRequest
TrueRuleChain=RequestError
TrueRuleChain=RequestOk
TrueRuleChain=UnknownStatus
UnknownStatus=600.SetSslRequestState_500C
UnknownStatus=610.UnknownStatusLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/100.SetSslRequestState_500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1202"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/110.SystemErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevServiceNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access DEG_SSL_SESSION table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/200.SetSslRequestState_500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1203"
AdornOps=set DEG_OEMDevErrorMessageString "Error while SSL Session does exist in DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/210.NoSslSessionLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevServiceNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Internal system error as SSL Session does exist in DEG_SSL_SESSION store: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/300.NewRequest_CheckSslSessionStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300C.DEG30NewRequest_CheckSslSessionStatusRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/355.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1204"
AdornOps=set DEG_OEMDevErrorMessageString "Error state in request while Skipping processing OEM action"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/400.RequestErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevServiceNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Skipping processing OEM action - request is in error state: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/500.RequestOk_CheckSslSessionStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300D.DEG30RequestOk_CheckSslSessionStatusRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/600.SetSslRequestState_500C]

AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1205"
AdornOps=set DEG_OEMDevErrorMessageString "Action processed with error - SSL SESSION is in unrecognized state"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300B.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/610.UnknownStatusLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevServiceNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Action processed with error - SSL SESSION is in unrecognized state: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.NewRequest_Check


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check]

AkaWait=200.AkaWait_ProcessAction
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"NEW"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_OTP_CHALLENGE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE
NewSslSession=100.NewSslSession_ProcessAction
Operations=None
TrueRuleChain=NewSslSession
TrueRuleChain=AkaWait
TrueRuleChain=UnknownSslSessionState
UnknownSslSessionState=300.Unknown_UpdateRequestStateTo500C


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/100.NewSslSession_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300E.DEG30ProcessOTPAuthStep1RuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/200.AkaWait_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=350.DEG30ProcessOTPAuthStep2RuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=210.CheckSslSessionUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/100.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=65.SetErrorInfo
TrueRuleChain=100.SystemErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/100.SystemErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevServiceNameString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=66.SetErrorInfo
TrueRuleChain=100.RowNotFound


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.RowNotFound]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists/66.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1207"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300C.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/65.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1206"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to Update DEG_SSL_SESSION store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300D.DEG30RequestOk_CheckSslSessionStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=095.SetLogInfo
RuleNames=100.LogNMERule300


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300D.DEG30RequestOk_CheckSslSessionStatusRuleChain/095.SetLogInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1208"
AdornOps=set DEG_OEMDevMessageString "Entered Inside rule 300D.DEG30RequestOk_CheckSslSessionStatusRuleChain"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300D.DEG30RequestOk_CheckSslSessionStatusRuleChain/100.LogNMERule300]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Entired Inside rule 300D.DEG30RequestOk_CheckSslSessionStatusRuleChain
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=300.ValidationAndProcessAction
RuleNames=400.UpdateSSLSessionStore
RuleNames=500.SetResponseHandler


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/100.InitWorkingVariables]

AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_OEMDevImsiString ""
AdornOps=set DEG_MDN 0
AdornOps=set DEG_IMSI ""
AdornOps=set DEG_OEMDevRespPhoneNumberString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/300.ValidationAndProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300G.DEG30ValidationAndProcessActionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"NEW"
FalseRuleChain=200.UpdateSslSessionState


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState]

ClassName=RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=300.CheckSslSessionUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/100.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI
AdornOps=copy DEG_OEMDevImsiString DEG_SSL_IMSI
AdornOps=copy DEG_OEMDevUniqueIDString DEG_SSL_UNIQUE_ID
AdornOps=copy DEG_MDN DEG_SSL_MDN
AdornOps=set DEG_SSL_GW_ADDR ""
AdornOps=setifnull DEG_PROVISIONING_STATUS 0
AdornOps=setifnull DEG_ADDRESS_STATUS 0
AdornOps=setifnull DEG_TC_STATUS 0
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDRESS_UPDATE_URL ""
AdornOps=setifnull DEG_EntitlementStatus ""
AdornOps=copy DEG_PROVISIONING_STATUS DEG_SSL_ID_PROV_STATUS
AdornOps=copy DEG_ADDR_UPDATE_POSTDATA DEG_SSL_POSTDATA
AdornOps=copy DEG_ADDRESS_STATUS DEG_SSL_ADDRESS_STATUS
AdornOps=copy DEG_TC_STATUS DEG_SSL_TC_STATUS
AdornOps=copy DEG_ADDRESS_UPDATE_URL DEG_SSL_ADDRESS_UPDATE_URL
AdornOps=copy DEG_EntitlementStatus DEG_SSL_EntitlementStatus
AdornOps=setifnull DEGDROID_SSL_COOKIE_ID ""
AdornOps=setifnull DEGDROID_OTP 0
AdornOps=copy DEGDROID_OTP DEGDROID_SSL_OTP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_STATE,DEG_SSL_AAA_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
MapAttributes=DEG_SSL_ID_PROV_STATUS,DEG_SSL_ID_PROV_STATUS
MapAttributes=DEG_SSL_GW_ADDR,DEG_SSL_GW_ADDR
MapAttributes=DEG_SSL_POSTDATA,DEG_SSL_POSTDATA
MapAttributes=DEG_SSL_ADDRESS_STATUS,DEG_SSL_ADDRESS_STATUS
MapAttributes=DEG_SSL_TC_STATUS,DEG_SSL_TC_STATUS
MapAttributes=DEG_SSL_ADDRESS_UPDATE_URL,DEG_SSL_ADDRESS_UPDATE_URL
MapAttributes=DEG_SSL_EntitlementStatus,DEG_SSL_EntitlementStatus
MapAttributes=DEGDROID_SSL_OTP,DEGDROID_SSL_OTP
MapAttributes=DEGDROID_SSL_COOKIE_ID,DEGDROID_SSL_COOKIE_ID
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=75.SetErrorInfo
TrueRuleChain=100.LogError


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/100.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=68.SetErrorInfo
TrueRuleChain=100.LogError


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/68.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1210"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/75.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1209"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_SSL_SESSION table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/500.SetResponseHandler]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,within,[200,200C]
FalseRuleChain=200.SetEmptyResponseHandler
TrueRuleChain=100.SetTextResponseHandler


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/500.SetResponseHandler/100.SetTextResponseHandler]

AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300E.DEG30ProcessOTPAuthStep1RuleChain/500.SetResponseHandler/200.SetEmptyResponseHandler]

AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ValidationAndProcessAction


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction]

CheckIfSubscriberBlackListed=500.CheckIfSubscriberBlackListed
CheckIfSubscriberProvisioned=600.CheckIfSubscriberProvisioned
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
ExtractNAIFromSubscriberIdAttribute=110.DecodePayload
ExtractNAIFromSubscriberIdAttribute=120.CheckPlayloadIfBase64
GenerateGetAuthenticationEndAuditData=900.GenerateGetAuthenticationEndAuditData
GenerateOEMResponse=800.GenerateOEMResponse
GenerateStartAuditData=400.GenerateStartAuditData
InitVariables=100.InitVariables
Operations=DoAll
ProcessPerAuthType=700.InitVariables
ProcessPerAuthType=710.LookupDEGDROIDToken
ProcessPerAuthType=720.CheckDEGOPTToken
TrueRuleChain=InitVariables
TrueRuleChain=ExtractNAIFromSubscriberIdAttribute
TrueRuleChain=ValidateToken
TrueRuleChain=GenerateStartAuditData
TrueRuleChain=CheckIfSubscriberBlackListed
TrueRuleChain=CheckIfSubscriberProvisioned
TrueRuleChain=ProcessPerAuthType
TrueRuleChain=GenerateGetAuthenticationEndAuditData
TrueRuleChain=GenerateOEMResponse
ValidateToken=300.ValidateToken


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/100.InitVariables]

AdornOps=set DEGDROID_auth_step_Integer 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/110.DecodePayload]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevEAPSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy
DecodeSubscriberId=200.DecodeSubscriberId
DecpdeEAPSubscriberId=100.DecodeEAPSubscriberId
Operations=None
TrueRuleChain=DecpdeEAPSubscriberId
TrueRuleChain=DecodeSubscriberId


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/110.DecodePayload/100.DecodeEAPSubscriberId]

AdornOps=decBase64 DEG_OEMDevEAPSubscriberIdString DEG_OEMDevEAPPayloadBinary
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/110.DecodePayload/200.DecodeSubscriberId]

AdornOps=decBase64 DEG_OEMDevSubscriberIdString DEG_OEMDevEAPPayloadBinary
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.ConvertPayload2String
FalseRuleChain=210.DecodeNAI
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/100.SetHTTPErrorResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1211"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to Extract NAI From SubscriberId"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevTempSubscriberIdString
Attributes=DEG_OEMDevSubscriberIdLengthInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Data Error in EAP payload
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/200.ConvertPayload2String]

AdornOps=bin2str DEG_OEMDevEAPPayloadBinary DEG_OEMDevTempSubscriberIdString "ISO8859_1"
AdornOps=length DEG_OEMDevTempSubscriberIdString DEG_OEMDevSubscriberIdLengthInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdLengthInteger,>=,6
TrueRuleChain=100.ExtractNAI


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevEAPSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy
ExtractEAPSubscriberId=100.ExtractEAPSubscriberId
ExtractEAPSubscriberId=130.ValidateEAPSubscriberIdAttribute
ExtractEAPSubscriberId=145.ExtractImsiFromEAPSubscriberIdAttribute
ExtractSubscriberId=200.ExtractSubscriberId
ExtractSubscriberId=135.ValidateSubscriberIdAttribute
ExtractSubscriberId=150.ExtractImsiFromSubscriberIdAttribute
Operations=None
TrueRuleChain=ExtractEAPSubscriberId
TrueRuleChain=ExtractSubscriberId


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/100.ExtractEAPSubscriberId]

AdornOps=substr 5 length DEG_OEMDevTempSubscriberIdString DEG_OEMDevEAPSubscriberIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/130.ValidateEAPSubscriberIdAttribute]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
FalseRuleChain=200.SetHttpErrorResponse
FalseRuleChain=210.ErrorLog
Operation=match
RegExPattern=${SUBSCRIBERID_PATTERN}
SourceAttribute=DEG_OEMDevEAPSubscriberIdString


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/130.ValidateEAPSubscriberIdAttribute/200.SetHttpErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1212"
AdornOps=set DEG_OEMDevErrorMessageString "EAP-Subscriber-id attribute not NAI format"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/130.ValidateEAPSubscriberIdAttribute/210.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request - EAP-subscriber-id attribute must be in NAI format: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/135.ValidateSubscriberIdAttribute]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
FalseRuleChain=200.SetHttpErrorResponse
FalseRuleChain=210.ErrorLog
Operation=match
RegExPattern=${SUBSCRIBERID_PATTERN}
SourceAttribute=DEG_OEMDevSubscriberIdString


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/135.ValidateSubscriberIdAttribute/200.SetHttpErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1213"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber-id attribute not NAI format"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/135.ValidateSubscriberIdAttribute/210.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid request - subscriber-id attribute must be in NAI format: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/145.ExtractImsiFromEAPSubscriberIdAttribute]

AdornOps=substr "0" "@" DEG_OEMDevEAPSubscriberIdString DEG_OEMDevImsiString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/150.ExtractImsiFromSubscriberIdAttribute]

AdornOps=substr "0" "@" DEG_OEMDevSubscriberIdString DEG_OEMDevImsiString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/200.ExtractSubscriberId]

AdornOps=copy DEG_OEMDevTempSubscriberIdString DEG_OEMDevSubscriberIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/120.CheckPlayloadIfBase64/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=(DEG_OEMDevEAPPayloadBinary =="") || (DEG_OEMDevEAPPayloadBinary == null)


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/300.ValidateToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/300.ValidateToken/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1214"
AdornOps=set DEG_OEMDevErrorMessageString "otp Token is empty"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/300.ValidateToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevTokenString
Attributes=DEG_DevOtpTokenString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid otp auth request - otp token is empty: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/400.GenerateStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/500.CheckIfSubscriberBlackListed]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=150.DEG30BlackListeSubscriberRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/600.CheckIfSubscriberProvisioned]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400.GetSubscriberProfileRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/700.InitVariables]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=copy DEG_MDN DEG_CDevMobileNumberString
AdornOps=set DEG_CDevTokenString ""
AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_OEMDevFastAuthFlag 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/710.LookupDEGDROIDToken]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_AUTHENTICATION_TYPE,DEG_AUTHENTICATION_TYPE
MapAttributes=DEG_AUTHENTICATION_SUBTYPE,DEG_AUTHENTICATION_SUBTYPE
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckTokenTimeStamp
FalseRuleChain=210.CheckProcessIntegerFlag
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateGetAuthenticationSystemErrorEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/100.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1215"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEG_TOKENS table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_TOKENS table
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/120.GenerateGetAuthenticationSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/200.CheckTokenTimeStamp]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=130.DEG30CheckTokenTimeStampRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/210.CheckProcessIntegerFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=210.GetToken


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/210.CheckProcessIntegerFlag/210.GetToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
Conditions=DEG_OEMDevFastAuthFlag,=,1
Conditions=DEG_TOKENSTATUS,=,"AE"
Conditions=DEG_OEMDevTokenString,=,DEG_SUBSTOKEN
FalseRuleChain=200.EAPAKAAuth
Operations=and,and,and
TrueRuleChain=100.FastPathAuth


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/210.CheckProcessIntegerFlag/210.GetToken/100.FastPathAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300J.DEG30FastPathAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/720.CheckDEGOPTToken/210.CheckProcessIntegerFlag/210.GetToken/200.EAPAKAAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300I.DEG30FullAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/800.GenerateOEMResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300K.DEG30GenerateOEMResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300G.DEG30ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/900.GenerateGetAuthenticationEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300L.DEG30GenerateOTPInitialEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain]

ClassName=RuleChain
RuleNames=100.InitRequestVariables
RuleNames=300.CheckErrorAndNoMatchFlag


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/100.InitRequestVariables]

AdornOps=set DEG_CDevSysParameter "EAPAKAAuth"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI
AdornOps=set DEG_SSL_STATE WAIT_FOR_OTP_CHALLENGE_FROM_DEVICE
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/200.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
FalseRuleChain=200.SetSessionStatus
FalseRuleChain=210.LogEAPAKAAtuhDisabled
TrueRuleChain=100.SMSCProcessingRule
TrueRuleChain=105.SetResponseInfo
TrueRuleChain=110.LogEAPAKAAtuhEnabled
TrueRuleChain=120.UpdateTokenTable


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/100.SMSCProcessingRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=smppOutgoingRuleChain1
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/105.SetResponseInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1220"
AdornOps=set DEG_OEMDevMessageString "Perform EAPAKAAtuh Enable"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/110.LogEAPAKAAtuhEnabled]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEGDROID_OTP
Attributes=DEG_DevAuthTypeString
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_SSL_STATE
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Perform EAPAKAAtuh Enable: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
FalseRuleChain=400.SetAuditTransactionType
TrueRuleChain=100.InitUpdate
TrueRuleChain=200.Update
TrueRuleChain=300.CheckUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/100.InitUpdate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=set DEG_AUTH_COUNT 0
AdornOps=setifnull DEG_BLACKLIST_FLAG 0
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=set DEG_AuditTransactionTypeString "full-auth-init"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1221"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS session store during blacklist processing"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_TOKENS session store during blacklist processing
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1222"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS BLACKLISTED session store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_TOKENS BLACKLISTED session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/400.SetAuditTransactionType]

AdornOps=set DEG_AuditTransactionTypeString "full-auth-init"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/200.SetSessionStatus]

AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "DFT"
AdornOps=set DEG_AUTHENTICATION_TYPE "OTP"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1223"
AdornOps=set DEG_OEMDevErrorMessageString "EAPAKAAtuh Disabled or Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300I.DEG30FullAuthRuleChain/300.CheckErrorAndNoMatchFlag/210.LogEAPAKAAtuhDisabled]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Perform EAPAKAAtuh Disabled:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetSystemTime
RuleNames=110.CheckTokenValidity


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/100.SetSystemTime]

AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_EVENTTIMESTAMP DEG_OEMDevTokenTimeStampDiffLong
AdornOps=set DEG_AuditTransactionTypeString "fast-auth"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenTimeStampDiffLong,<=,DEG_OEMDeviceTokenValidityLong
FalseRuleChain=200.SetErrorInfo
FalseRuleChain=210.ErrorLog
TrueRuleChain=100.SetSessionStatus
TrueRuleChain=200.LogFastPathAuth
TrueRuleChain=300.CheckCounter
TrueRuleChain=400.UpdateAsBlackListed
TrueRuleChain=500.GenerateResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/100.SetSessionStatus]

AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_TYPE "OTP"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "TKN"
AdornOps=+ DEG_AUTH_COUNT 1 DEG_AUTH_COUNT
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.1217"
AdornOps=set DEG_OEMDevMessageString "Perform FastPathAuth"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/200.LogFastPathAuth]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_AUTH_COUNT
Attributes=DEG_OEMDevAuthThresholdCountInteger
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Perform FastPathAuth: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/200.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1216"
AdornOps=set DEG_OEMDevErrorMessageString "Network Authentication Required"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/210.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevCurrentTimeStampLong
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_OEMDevTokenTimeStampDiffLong
Attributes=DEG_OEMDeviceTokenValidityLong
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Database Error: Token Expired Network Authentication Required
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/300.CheckCounter]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTH_COUNT,>,DEG_OEMDevAuthThresholdCountInteger
TrueRuleChain=100.SetBlackListed


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/300.CheckCounter/100.SetBlackListed]

AdornOps=set DEG_BLACKLIST_FLAG 1
AdornOps=set DEG_AUTH_COUNT 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/100.InitUpdate]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=setifnull DEG_AUTH_COUNT 0
AdornOps=setifnull DEG_BLACKLIST_FLAG 0
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1218"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS session store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_TOKENS session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.1219"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS session store"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_TOKENS session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/500.GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_BLACKLIST_FLAG,=,1
TrueRuleChain=100.GenerateBlackListedResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300J.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/500.GenerateResponse/100.GenerateBlackListedResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=140.DEG30GenerateBlackListedResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateOEMResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse]

AkaRejected=400.AkaRejected_InitResponse
AkaRejected=410.AkaRejected_DeactiveToken
AkaRejected=420.AkaRejected_GenerateResponse
AkaWait=300.AkaWait_SetInitResponse
AkaWait=310.AkaWait_GenerateResponse
Authenticated=500.Authenticated_InitResponse
Authenticated=510.Authenticated_StoreToken
Authenticated=520.Authenticated_InitLookUpAuthXMLTemplate
Authenticated=530.Authenticated_LookUpAuthXMLTemplate
Authenticated=540.Authenticated_LookUpServiceConfigTemplate
Authenticated=550.Authenticated_GenerateResponse
BlacListedSubscriber=200.BlackListedSubscriber_HTTPResponse
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_OTP_CHALLENGE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"OTP_CHALLENGE_REJECTED"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Conditions=DEG_SSL_STATE,starts,"AUTHENTICATED"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE
Operations=None
StatusDisallowed=600.DisallowedAction_InitResponse
TrueRuleChain=UnknownSubscriber
TrueRuleChain=BlacListedSubscriber
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=StatusDisallowed
TrueRuleChain=Authenticated
TrueRuleChain=Unknown
Unknown=700.Unknown_SetHttpErrorResponseTo500C
UnknownSubscriber=100.UnknownSubscriber_HTTPResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/100.UnknownSubscriber_HTTPResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_STATE "UNKNOWN_SUBSCRIBER"
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRespStatusString 403
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/200.BlackListedSubscriber_HTTPResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevRespStatusString 511
AdornOps=set  DEG_SSL_STATE "BLACKLISTED_SUBSCRIBER"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/300.AkaWait_SetInitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "200"
AdornOps=set DEG_OEMDevRespStatusString 200
AdornOps=copy DEGDROID_OTP DEGDROID_OTPString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodePayload
FalseRuleChain=203.InitVariableAuthXMLTemplate
FalseRuleChain=205.LookUpAuthXMLTemplate
FalseRuleChain=215.AssignMessagetoResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/200.EncodePayload]

AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/203.InitVariableAuthXMLTemplate]

AdornOps=set DEGDROID_auth_step_Integer 1
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/205.LookUpAuthXMLTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/210.GenerateResponse]

ClassName=com.hp.usage.rules.transform.MessageFormatRule
Locale=en_US
MessageFormat=DEG_XML_TEMPLATES_FILE
ResultAttribute=DEG_XML_TEMPLATES_FILE
UseDynamicMessageFormat=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/215.AssignMessagetoResponse]

AdornOps=setifnull DEG_XML_TEMPLATES_FILE ""
AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/400.AkaRejected_InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 511
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_TOKENSTATUS "DE"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/410.AkaRejected_DeactiveToken]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/420.AkaRejected_GenerateResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/500.Authenticated_InitResponse]

AdornOps=set DEG_APP_TOKEN_FLAG 1
AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEG_OEMDevRespTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEG_CDevTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEGDROID_SSL_COOKIE_ID
AdornOps=set DEG_AUTHENTICATION_TYPE "OTP"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/510.Authenticated_StoreToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevMobileNumberString
RequestAttributes=DEG_IMSI
RequestAttributes=DEG_CDevTokenString
RequestAttributes=DEG_AUTHENTICATION_TYPE
RequestAttributes=DEG_AUTHENTICATION_SUBTYPE
RequestAttributes=DEG_APP_TOKEN_FLAG
RequestAttributes=DEG_FULLAUTHTIMESTAMP
ResponseAttributes=DEG_OEMDevErrorMessageString
ResponseAttributes=DEG_EVENTTIMESTAMP
RuleChain=005.DEG30StoreTokenRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/520.Authenticated_InitLookUpAuthXMLTemplate]

AdornOps=set DEGDROID_auth_step_Integer 3
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEG_OEMDevRespTokenString
AdornOps=set DEG_TOKEN_VALIDITY_SECONDS ${DEGDROID_DEVICE_TOKEN_VALIDITY}
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/530.Authenticated_LookUpAuthXMLTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/540.Authenticated_LookUpServiceConfigTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.DEG30ProcessServiceConfigurationRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckEAPPayload
RuleNames=150.CheckResponseXMLEmptyAfterServiceConfigProcess


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/100.CheckEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodePayload
TrueRuleChain=100.GenerateNullPayloadResponse


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/100.CheckEAPPayload/100.GenerateNullPayloadResponse]

AdornOps=set DEG_OEMDevHttpStatusInteger "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/100.CheckEAPPayload/200.EncodePayload]

AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/100.CheckEAPPayload/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_XMLTemplateResponseString,!=,""
FalseRuleChain=20.AssignResponseFromAuthConfigTemplate
TrueRuleChain=10.AssignResponseFromServiceConfigTemplate


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess/10.AssignResponseFromServiceConfigTemplate]

AdornOps=copy DEG_XMLTemplateResponseString ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess/20.AssignResponseFromAuthConfigTemplate]

AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/200.MessageFormatXML]

ClassName=com.hp.usage.rules.transform.MessageFormatRule
Locale=en_US
MessageFormat=DEG_XML_TEMPLATES_FILE
ResultAttribute=DEG_XML_TEMPLATES_FILE
UseDynamicMessageFormat=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/550.Authenticated_GenerateResponse/250.GenerateResponse]

AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/600.DisallowedAction_InitResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevHttpStatusInteger "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300K.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/700.Unknown_SetHttpErrorResponseTo500C]

AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevHttpStatusInteger "511"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateOTPInitialEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,!=,UNKNOWN_SUBSCRIBER
Description=Unknown Subscriber case already Handled
TrueRuleChain=000.SetTranscationType
TrueRuleChain=100.CheckAuthenticationState


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/000.SetTranscationType]

ClassName=ConditionalRule
Conditions=DEG_OEMDevRequestAttributeString,contains,"IMSI_EAP"
FalseRuleChain=SetTranscationType
TrueRuleChain=SetFullAuthTranscationType


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/000.SetTranscationType/SetFullAuthTranscationType]

AdornOps=set DEG_AuditTransactionTypeString "full-auth-init"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/000.SetTranscationType/SetTranscationType]

AdornOps=set DEG_AuditTransactionTypeString "fast-auth"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState]

AkaRejected=100.GenerateOTPRejectedEndAuditData
AkaWait=200.GenerateOTPWaitEndAuditData
AuthenticatedAAA=300.GenerateOTPSMSCAuthenticatedEndAuditData
AuthenticatedDEGToken=400.GenerateOTPDEGTokenAuthenticatedEndAuditData
BlackListSubscriber=500.GenerateOTPBlackListSubscriberEndAuditData
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_OTP_CHALLENGE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"OTP_CHALLENGE_REJECTED"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_SMSC"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Operations=None
StatusDisallowed=600.GenerateOTPDisallowedActionEndAuditData
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=AuthenticatedAAA
TrueRuleChain=AuthenticatedDEGToken
TrueRuleChain=BlackListSubscriber
TrueRuleChain=StatusDisallowed


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/100.GenerateOTPRejectedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/200.GenerateOTPWaitEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=802.DEG30GenerateOTPWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/300.GenerateOTPSMSCAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/400.GenerateOTPDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"TKN"
FalseRuleChain=200.GenerateOTPDEGTokenAuthenticatedDefaultEndAuditData
TrueRuleChain=100.GenerateOTPDEGTokenAuthenticatedEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/400.GenerateOTPDEGTokenAuthenticatedEndAuditData/100.GenerateOTPDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/400.GenerateOTPDEGTokenAuthenticatedEndAuditData/200.GenerateOTPDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/500.GenerateOTPBlackListSubscriberEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/300L.DEG30GenerateOTPInitialEndAuditDataRuleChain/100.GenerateOTPInitialEndAuditData/100.CheckAuthenticationState/600.GenerateOTPDisallowedActionEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful Sent to SMSC,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/801.DEG30GenerateOTPSMSCAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/802.DEG30GenerateOTPWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/802.DEG30GenerateOTPWaitEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/802.DEG30GenerateOTPWaitEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/802.DEG30GenerateOTPWaitEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/802.DEG30GenerateOTPWaitEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/802.DEG30GenerateOTPWaitEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sent EAP-AKA message to Device,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/802.DEG30GenerateOTPWaitEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by DEG_TOKEN,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/803.DEG30GenerateOTPDEGTokenAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=setifnull DEG_OEMDevErrorMessageString ""
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by default,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/804.DEG30GenerateOTPDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "503"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Authentication attempt rejected,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_CDevOutReturnCodeString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/805.DEG30GenerateOTPSMSCRejectedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/807.DEG30GenerateOTPInitialSystemErrorEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "BlackListed Subscriber,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/808.DEG30GenerateOTPBlackListSubscriberEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=set DEG_AuditDeviceTypeString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Status Disallowed Action,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/OTP_Auth_Core/RuleChains/809.DEG30GenerateOTPDisallowedActionEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true
