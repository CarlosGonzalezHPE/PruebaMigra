

[/templates/DEG/JobsInterface/ClearSelfProvStat_Core]


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/Connectors]

ClassName=com.hp.siu.serverutils.ConnectorManager
ConnectorNames=300.JDBCOperationsConnector
ConnectorNames=400.NMERPCAPNSClientConnector


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/Connectors/300.JDBCOperationsConnector]

ClassName=com.hp.usage.jdbc.JDBCClientConnector
Operations=100.DEG_DEVICE_DATA_UpdateByIMSI
OpNameAttribute=DEG_OEMDevJDBCOpNameString


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/Connectors/300.JDBCOperationsConnector/100.DEG_DEVICE_DATA_UpdateByIMSI]

ClassName=com.hp.usage.jdbc.operations.JDBCUpdateOperation
CommonPolicyID=Policy1
SQLStatement=update DEG_DEVICE_DATA set DEG_PROVISIONING_STATUS=%DEG_PROVISIONING_STATUS, DEG_SELF_PROV_STARTDATE=%DEG_JobsCDevProcessStartTimeString where DEG_UNIQUE_ID=%DEG_UNIQUE_ID and DEG_IMSI=%DEG_IMSI and DEG_PROVISIONING_STATUS=3 and DEG_ENTITLEMENT_NAME IN ('VoWiFi','iCloudVoWiFi')
_ConnectionPoolID=DEG_DSN_TT_Pool


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/Connectors/300.JDBCOperationsConnector/100.DEG_DEVICE_DATA_UpdateByIMSI/OpsErrRuleChain]

ClassName=com.hp.usage.jdbc.operations.error.OpsErrRuleChain
ErrorCodeAttribute=DEG_OEMDevDBErrorCodeString
ErrorMessageAttribute=DEG_OEMDevDBErrorMessageString


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/Connectors/300.JDBCOperationsConnector/100.DEG_DEVICE_DATA_UpdateByIMSI/OpsErrRuleChain/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=SetLogInfo
RuleNames=LogError


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/Connectors/300.JDBCOperationsConnector/100.DEG_DEVICE_DATA_UpdateByIMSI/OpsErrRuleChain/ErrorRule/LogError]

Attributes=DEG_OEMDevDBErrorCodeString
Attributes=DEG_OEMDevDBErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=ERROR
Message=Database Error: update failed for DEG_DEVICE_DATA table : 


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/Connectors/300.JDBCOperationsConnector/100.DEG_DEVICE_DATA_UpdateByIMSI/OpsErrRuleChain/ErrorRule/SetLogInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.JOB.0009"
AdornOps=set DEG_OEMDevErrorMessageString "update failed for DEG_DEVICE_DATA table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/Connectors/400.NMERPCAPNSClientConnector]

ClassName=com.hp.usage.nme.rpc.client.NMERPCClientAdapter
Connection=PrimaryServer
MessageTypes=JOBRequestMessage
Name=JOBRPCClientAdapter
Routers=Router1


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/Connectors/400.NMERPCAPNSClientConnector/JOBRequestMessage]

ClassName=com.hp.usage.nme.rpc.codec.NMERPCMessageType
RequestAttributes=CUST_APN_IN_MDNLong
RequestAttributes=CUST_APN_IN_IMSIString
RequestAttributes=CUST_APN_IN_TopicString
RequestAttributes=CUST_APN_IN_TriggerTypeString
RequestAttributes=CUST_APN_IN_TokenString
RequestAttributes=CUST_APN_IN_UniqueIdString
RequestAttributes=CUST_APN_IN_PushNotificationStatus
ResponseAttributes=CUST_APN_IN_MDNLong
ResponseAttributes=CUST_APN_IN_IMSIString
ResponseAttributes=CUST_APN_OUT_APNSSentStatusString
RuleChain=CUSTRC_Apple_APNS_SendNotification
_ResponseAttributes=DEG_APNSRecvString


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/Connectors/400.NMERPCAPNSClientConnector/PrimaryServer]

ClassName=com.hp.usage.nme.rpc.client.NMERPCClientConnection
MaxAllowedRequestTimeouts=1000
MaxPendingRequests=512
ReconnectDelay=1000
ResponseTimeout=10000


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/Connectors/400.NMERPCAPNSClientConnector/Router1]

ClassName=com.hp.usage.framework.connector.router.StaticRouter
Description=StaticRouter identifies destinations that a message can be sent to.
Destinations=${APNS_INTERFACE_IP}:${APNS_INTERFACE_PORT}


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/Connectors/400.NMERPCAPNSClientConnector/Transport]

ClassName=com.hp.usage.transport.tcp.TCPTransport


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/ReferenceDataService]

QueryNames=LookUpOldProvisioningSessions


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/ReferenceDataService/LookUpOldProvisioningSessions]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
CommonPolicyID=Policy1
FieldExtracted=DEG_IMSI,DEG_IMSI
FieldExtracted=DEG_UNIQUE_ID,DEG_UNIQUE_ID
FieldExtracted=DEG_APNS_TOKEN,DEG_APNS_TOKEN
FieldExtracted=DEG_PROVISIONING_STATUS,DEG_PROVISIONING_STATUS
FieldExtracted=DEG_PUSH_NOTIFICATION_STATUS,DEG_PUSH_NOTIFICATION_STATUS
FieldExtracted=DEG_SELF_PROV_STARTDATE,DEG_SELF_PROV_STARTDATE
QueryString=SELECT %FIELDS  FROM DEG_DEVICE_DATA WHERE DEG_PROVISIONING_STATUS =%DEG_PROVISIONING_STATUS
ResultAttribute=DEG_JobsSigMatchFoundInteger
ResultIndexAttribute=DEG_JobsSigIndexInteger
_JDBCDataSourceConnectorName=002.RefDataDbConnectorDEG


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/ReferenceDataService/LookUpOldProvisioningSessions/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorMessage
RuleNames=200.LogAlarming


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/ReferenceDataService/LookUpOldProvisioningSessions/ErrorRule/100.SetErrorMessage]

AdornOps=set DEG_JobsDatabaseErrorFlagInteger 1
AdornOps=set DEG_JobsReturnCodeString "-1"
AdornOps=set DEG_JobsErrorMessageString "Unable to access DEG_DEVICE_DATA table"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.JOB.0000"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to access DEG_DEVICE_DATA table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/ReferenceDataService/LookUpOldProvisioningSessions/ErrorRule/200.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_JobsErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error:


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/ReferenceDataService/LookUpOldProvisioningSessions/InitialRule]

AdornOps=set DEG_JobsSigMatchFoundInteger 0
AdornOps=set DEG_JobsDatabaseErrorFlagInteger 0
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_PROVISIONING_STATUS 3
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/ReferenceDataService/LookUpOldProvisioningSessions/ResultRowRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=201.TimeFormatChange
RuleNames=110.SetErrorInfo
RuleNames=202.PrintChangeFormatTime
RuleNames=203.CompareProvisioningTime


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/ReferenceDataService/LookUpOldProvisioningSessions/ResultRowRule/110.SetErrorInfo]

AdornOps=set DEG_JobsErrorMessageString "Printing values:"
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.JOB.0001"
AdornOps=set DEG_OEMDevMessageString "Printing values:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/ReferenceDataService/LookUpOldProvisioningSessions/ResultRowRule/201.TimeFormatChange]

AdornOps=setifnull DEG_IMSI ""
AdornOps=setifnull DEG_UNIQUE_ID ""
AdornOps=setifnull DEG_APNS_TOKEN ""
AdornOps=setifnull DEG_PUSH_NOTIFICATION_STATUS 0
AdornOps=copy DEG_SELF_PROV_STARTDATE DEGSELFPROVSTARTDATELong
AdornOps=copy DEG_IMSI DEG_JobsImsiString
AdornOps=copy DEG_UNIQUE_ID DEG_JobsUniqueIDString
AdornOps=copy DEG_APNS_TOKEN DEG_JobsAPNSTokenString
AdornOps=copy DEG_PUSH_NOTIFICATION_STATUS DEG_JobsPushNotificationInteger
AdornOps=+ DEGSELFPROVSTARTDATELong DEG_DEVICEDATA_RecordLong DEGSELFPROVSTARTDATELong
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/ReferenceDataService/LookUpOldProvisioningSessions/ResultRowRule/202.PrintChangeFormatTime]

Attributes=DEGSELFPROVSTARTDATELong
Attributes=DEG_SELF_PROV_STARTDATE
Attributes=DEG_JobsImsiString
Attributes=DEG_JobsUniqueIDString
Attributes=DEG_JobsAPNSTokenString
Attributes=DEG_JobsPushNotificationInteger
Attributes=DEG_JobsCurrSysTimeLong
Attributes=DEG_DEVICEDATA_RecordLong
Attributes=DEG_CDevProcessingMessageIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Printing values:


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/ReferenceDataService/LookUpOldProvisioningSessions/ResultRowRule/203.CompareProvisioningTime]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_JobsCurrSysTimeLong,>,DEGSELFPROVSTARTDATELong
TrueRuleChain=ProcessSession


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/ReferenceDataService/LookUpOldProvisioningSessions/ResultRowRule/203.CompareProvisioningTime/ProcessSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.ProcessExpiredProvisioningSessionRuleChain
UseRuleChainManagerPool=false


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains]

RuleChainNames=500.ProcessExpiredProvisioningSessionRuleChain
RuleChainNames=400.FetchExpiredProvisioningSessionsRuleChain


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/400.FetchExpiredProvisioningSessionsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVar
RuleNames=110.UpdateOldSession


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/400.FetchExpiredProvisioningSessionsRuleChain/100.InitVar]

AdornOps=setsystime DEG_JobsCurrSysTimeMSLong
AdornOps=/ DEG_JobsCurrSysTimeMSLong 1000 DEG_JobsCurrSysTimeLong
AdornOps=set DEG_DEVICEDATA_RecordLong ${VOWIFI_PROVISIONING_STATUS_RESET_WINDOW}
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/400.FetchExpiredProvisioningSessionsRuleChain/110.UpdateOldSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=LookUpOldProvisioningSessions


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=41.QueryDEG_TOKENSForMDN
RuleNames=42.UpdateDeviceDataTable
RuleNames=43.SendAPNSNotification


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/41.QueryDEG_TOKENSForMDN]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.InitLookup
RuleNames=020.ExecuteLookup
RuleNames=030.CheckLookupStatus


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/41.QueryDEG_TOKENSForMDN/010.InitLookup]

AdornOps=copy DEG_JobsUniqueIDString DEG_UNIQUE_ID
AdornOps=copy DEG_JobsImsiString DEG_IMSI
AdornOps=set DEG_JobCarrRequestProcessedInteger 0
AdornOps=set DEG_MDN 0
AdornOps=set DEG_JobsSessionStoreErrorFlagInteger 0
AdornOps=set DEG_JobsSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_TOKENS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/41.QueryDEG_TOKENSForMDN/020.ExecuteLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_MDN,DEG_MDN
NativeCondition=1.MatchByPrimaryIMSIAndUniqueID
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/41.QueryDEG_TOKENSForMDN/030.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_JobsSessionStoreErrorFlagInteger,=,1
Conditions=DEG_JobsSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_JobsSessionStoreKeyExistsFlagInteger,=,1
DBError=100.SetLookupError
DBError=110.LogDBError
NoMatch=200.SetNoMatchError
NoMatch=210.LogNoMatch
Operations=None
RecordFound=170.SetErrorInfo
RecordFound=300.PrintMDN
TrueRuleChain=DBError
TrueRuleChain=NoMatch
TrueRuleChain=RecordFound


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/41.QueryDEG_TOKENSForMDN/030.CheckLookupStatus/100.SetLookupError]

AdornOps=set DEG_JobCarrRequestProcessedInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.JOB.0002"
AdornOps=set DEG_JobsErrorMessageString "Error during lookup in DEG_TOKENS table:"
AdornOps=set DEG_OEMDevErrorMessageString "Error during lookup in DEG_TOKENS table:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/41.QueryDEG_TOKENSForMDN/030.CheckLookupStatus/110.LogDBError]

Attributes=DEG_JobsImsiString
Attributes=DEG_JobsUniqueIDString
Attributes=DEG_JobCarrRequestProcessedInteger
Attributes=DEG_JobsErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Error during lookup in DEG_TOKENS table:


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/41.QueryDEG_TOKENSForMDN/030.CheckLookupStatus/170.SetErrorInfo]

AdornOps=set DEG_JobsErrorMessageString "Print MDN from DEG_TOKENS table:"
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.JOB.0004"
AdornOps=set DEG_OEMDevMessageString "Printing MDN from DEG_TOKENS table:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/41.QueryDEG_TOKENSForMDN/030.CheckLookupStatus/200.SetNoMatchError]

AdornOps=set DEG_JobCarrRequestProcessedInteger 1
AdornOps=set DEG_JobsErrorMessageString "No entry found in DEG_TOKENS table:"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.JOB.0003"
AdornOps=set DEG_OEMDevErrorMessageString "No entry found in DEG_TOKENS table:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/41.QueryDEG_TOKENSForMDN/030.CheckLookupStatus/210.LogNoMatch]

Attributes=DEG_JobsImsiString
Attributes=DEG_JobsUniqueIDString
Attributes=DEG_JobCarrRequestProcessedInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=CRITICAL
Message=No entry found in DEG_TOKENS table:


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/41.QueryDEG_TOKENSForMDN/030.CheckLookupStatus/300.PrintMDN]

Attributes=DEG_JobsImsiString
Attributes=DEG_JobsUniqueIDString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=INFO
Message=Print MDN from DEG_TOKENS table:


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/42.UpdateDeviceDataTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.TimeFormatChange
RuleNames=105.InitVar
RuleNames=110.ConnectDB
RuleNames=115.DBStatus


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/42.UpdateDeviceDataTable/100.TimeFormatChange]

ClassName=com.hp.siu.collector.rules.TimeAdornmentRule
FormatStrings=DEG_JobsCurrSysTimeMSLong,DEG_JobsCDevProcessStartTimeString,yyyy-MM-dd HH-mm-ss
TimeZone=America/Toronto


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/42.UpdateDeviceDataTable/105.InitVar]

AdornOps=copy DEG_JobsImsiString DEG_IMSI
AdornOps=copy DEG_JobsUniqueIDString DEG_UNIQUE_ID
AdornOps=set DEG_PROVISIONING_STATUS 0
AdornOps=set DEG_OEMDevJDBCOpNameString "100.DEG_DEVICE_DATA_UpdateByIMSI"
AdornOps=set DEG_OEMDevDBErrorCodeString "0"
AdornOps=set DEG_OEMDevDBErrorMessageString ""
ClassName=AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/42.UpdateDeviceDataTable/110.ConnectDB]

ClassName=com.hp.usage.update.SynchronousUpdateRule
ConnectorName=300.JDBCOperationsConnector
ErrorCodeAttribute=DEG_OEMDevDBErrorCodeString
ErrorMessageAttribute=DEG_OEMDevDBErrorMessageString


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/42.UpdateDeviceDataTable/115.DBStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevDBErrorCodeString,!=,0
Conditions=DEG_OEMDevDBErrorMessageString,!=,""
FalseRuleChain=000.SetErrorInfo
FalseRuleChain=030.LogSuccessResponse
Operation=and
TrueRuleChain=000.SetErrorResponse
TrueRuleChain=010.ErrorLog


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/42.UpdateDeviceDataTable/115.DBStatus/000.SetErrorInfo]

AdornOps=set DEG_CDevProcessingMessageIdString "DEG.JOB.0006"
AdornOps=set DEG_JobsErrorMessageString "Entry updated in DEG_DEVICE_DATA table:"
AdornOps=set DEG_OEMDevMessageString "Entry updated in DEG_DEVICE_DATA table:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/42.UpdateDeviceDataTable/115.DBStatus/000.SetErrorResponse]

AdornOps=set DEG_JobCarrRequestProcessedInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.JOB.0005"
AdornOps=set DEG_JobsErrorMessageString "Unable to update entry in DEG_DEVICE_DATA table:"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_DEVICE_DATA table:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/42.UpdateDeviceDataTable/115.DBStatus/010.ErrorLog]

Attributes=DEG_JobsImsiString
Attributes=DEG_JobsUniqueIDString
Attributes=DEG_JobCarrRequestProcessedInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_JobsErrorMessageString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Unable to update entry in DEG_DEVICE_DATA table:


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/42.UpdateDeviceDataTable/115.DBStatus/030.LogSuccessResponse]

Attributes=DEG_JobsImsiString
Attributes=DEG_MDN
Attributes=DEG_JobsAPNSTokenString
Attributes=DEG_JobsPushNotificationInteger
Attributes=DEG_JobCarrRequestProcessedInteger
Attributes=DEG_JobsCDevProcessStartTimeString
Attributes=DEG_JobsErrorMessageString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=INFO
Message=Entry updated in DEG_DEVICE_DATA table:


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/43.SendAPNSNotification]

ClassName=ConditionalRule
Conditions=DEG_JobsImsiString,!=,"NULL"
Conditions=DEG_MDN,!=,0
Conditions=DEG_JobsAPNSTokenString,!=,"NULL"
Conditions=DEG_JobsPushNotificationInteger,=,6100
Conditions=DEG_JobCarrRequestProcessedInteger,=,0
Operations=and,and,and,and


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/43.SendAPNSNotification/TrueRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetAPNSNotification
RuleNames=101.CopyBeforeCustomCall
RuleNames=180.SetErrorInfo
RuleNames=110.LogAPNSNotification
RuleNames=200.InvokeNMERPC
RuleNames=210.LogNMERPCResponse
RuleNames=220.CopyAfterCustomCall


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/43.SendAPNSNotification/TrueRule/100.SetAPNSNotification]

AdornOps=copy DEG_MDN DEG_CarrMDNLong
AdornOps=copy DEG_JobsImsiString DEG_CarrIMSIString
AdornOps=copy DEG_JobsAPNSTokenString APNS_TokenString
AdornOps=copy DEG_JobsUniqueIDString DEG_APNSUniqueIdString
AdornOps=setifnull DEG_APNSTopicString "VoWiFi"
AdornOps=set DEG_TriggerTypeString "provisioning-changed"
AdornOps=copy DEG_JobsPushNotificationInteger DEG_APNSPushNotifStatusString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/43.SendAPNSNotification/TrueRule/101.CopyBeforeCustomCall]

AdornOps=copy DEG_CarrIMSIString CUST_APN_IN_IMSIString
AdornOps=copy DEG_CarrMDNLong CUST_APN_IN_MDNLong
AdornOps=copy APNS_TokenString CUST_APN_IN_TokenString
AdornOps=copy DEG_APNSUniqueIdString CUST_APN_IN_UniqueIdString
AdornOps=copy DEG_APNSTopicString CUST_APN_IN_TopicString
AdornOps=copy DEG_TriggerTypeString CUST_APN_IN_TriggerTypeString
AdornOps=copy DEG_APNSPushNotifStatusString CUST_APN_IN_PushNotificationStatus
AdornOps=setifnull DEG_APNSRecvString "Checking APNS connection"
AdornOps=copy DEG_APNSRecvString CUST_APN_OUT_APNSSentStatusString
ClassName=AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/43.SendAPNSNotification/TrueRule/110.LogAPNSNotification]

Attributes=CUST_APN_IN_IMSIString
Attributes=CUST_APN_IN_MDNLong
Attributes=CUST_APN_IN_TokenString
Attributes=CUST_APN_IN_UniqueIdString
Attributes=CUST_APN_IN_TopicString
Attributes=CUST_APN_IN_TriggerTypeString
Attributes=CUST_APN_IN_PushNotificationStatus
Attributes=CUST_APN_OUT_APNSSentStatusString
Attributes=DEG_JobsErrorMessageString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=INFO
Message=JOBSInterface To APNSInterface ->


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/43.SendAPNSNotification/TrueRule/180.SetErrorInfo]

AdornOps=set DEG_JobsErrorMessageString "JOBSInterface To APNSInterface "
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.JOB.0007"
AdornOps=set DEG_OEMDevMessageString "JOBSInterface To APNSInterface"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/43.SendAPNSNotification/TrueRule/200.InvokeNMERPC]

ClassName=com.hp.usage.nme.rpc.client.NMERPCClientRule
MessageType=JOBRequestMessage
NMERPCClientAdapter=JOBRPCClientAdapter
Router=Router1


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/43.SendAPNSNotification/TrueRule/210.LogNMERPCResponse]

Attributes=CUST_APN_IN_IMSIString
Attributes=CUST_APN_IN_MDNLong
Attributes=CUST_APN_IN_TokenString
Attributes=CUST_APN_IN_UniqueIdString
Attributes=CUST_APN_IN_TopicString
Attributes=CUST_APN_IN_TriggerTypeString
Attributes=CUST_APN_OUT_APNSSentStatusString
Attributes=DEG_JobsErrorMessageString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=INFO
Message=APNSInterface To JOBSInterface ->


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/43.SendAPNSNotification/TrueRule/220.CopyAfterCustomCall]

AdornOps=copy CUST_APN_IN_IMSIString DEG_CarrIMSIString
AdornOps=copy CUST_APN_IN_MDNLong DEG_CarrMDNLong
AdornOps=copy CUST_APN_OUT_APNSSentStatusString DEG_APNSRecvString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/RuleChains/500.ProcessExpiredProvisioningSessionRuleChain/43.SendAPNSNotification/TrueRule/220.SetErrorInfo]

AdornOps=set DEG_JobsErrorMessageString "APNSInterface To JOBSInterface"
AdornOps=set DEG_CDevProcessingMessageIdString  "DEG.JOB.0008"
AdornOps=set DEG_OEMDevMessageString "APNSInterface To JOBSInterface"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/SessionStores]

SessionStoreNames=DEG_TOKENS_SessionStore


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/SessionStores/DEG_TOKENS_SessionStore]

Attributes=DEG_MDN
Attributes=DEG_IMSI,key
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_APP_TOKEN_FLAG
Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_FULLAUTHTIMESTAMP
Attributes=DEG_PUSH_TOKEN
Attributes=DEG_UNIQUE_ID
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy1
DatabaseId=DEG_TOKENS
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
NativeConditions=1.MatchByPrimaryIMSIAndUniqueID
SQLTypeMap=DEG_MDN,BIGINT
SQLTypeMap=DEG_IMSI,VARCHAR(64)
SQLTypeMap=DEG_UNIQUE_ID,VARCHAR(64)
SQLTypeMap=DEG_SUBSTOKEN,CHAR(28)
SQLTypeMap=DEG_TOKENSTATUS,CHAR(2)
SQLTypeMap=DEG_AUTHENTICATION_TYPE,CHAR(3)
SQLTypeMap=DEG_AUTHENTICATION_SUBTYPE,CHAR(3)
SQLTypeMap=DEG_APP_TOKEN_FLAG,TINYINT
SQLTypeMap=DEG_AUTH_COUNT,BIGINT
SQLTypeMap=DEG_BLACKLIST_FLAG,BIGINT
SQLTypeMap=DEG_EVENTTIMESTAMP,BIGINT
SQLTypeMap=DEG_FULLAUTHTIMESTAMP,BIGINT
SQLTypeMap=DEG_PUSH_TOKEN,VARCHAR(100)


[/templates/DEG/JobsInterface/ClearSelfProvStat_Core/SessionStores/DEG_TOKENS_SessionStore/1.MatchByPrimaryIMSIAndUniqueID]

Condition=where DEG_UNIQUE_ID = %DEG_UNIQUE_ID and DEG_IMSI = %DEG_IMSI
