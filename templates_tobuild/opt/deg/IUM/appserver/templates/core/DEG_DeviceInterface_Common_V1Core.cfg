[/templates/DEG/DeviceInterface/Common_V1Core]


[/templates/DEG/DeviceInterface/Common_V1Core/Connectors]

ClassName=com.hp.siu.serverutils.ConnectorManager
ConnectorNames=100.RefreshCacheConnector
#ConnectorNames=120.RefDataDbConnectorNRB
ConnectorNames=200.ClientDeviceHttpsConnector
ConnectorNames=201.LoadBalancerHeartBeatHttpConnector
ConnectorNames=202.JsonRequestClient

[/templates/DEG/DeviceInterface/Common_V1Core/Connectors/100.RefreshCacheConnector]

ClassName=com.hp.siu.plugins.dna.collector.rules.SocketConnector
ListenPort=${DEG_DEVICE_INTERFACE_LISTEN_PORT}


[/templates/DEG/DeviceInterface/Common_V1Core/Connectors/200.ClientDeviceHttpsConnector]

AcceptCount=${DEVICE_HTTP_ACCEPT_COUNT}
ClassName=com.hp.siu.plugins.tomcat.HttpConnector
Context=OEMInterface
KeyStoreFile=${SERVER_CERT_KEYSTORE_FILE}
KeyStorePassword=${SERVER_CERT_SIGNATURE_PASSWORD}
Managed=${MANAGED_SETUP}
MaxProcessors=${DEVICE_HTTP_CON_MAX_PROCESSORS}
MinProcessors=${DEVICE_HTTP_CON_MIN_PROCESSORS}
MaxSpareProcessors=${DEVICE_HTTP_CON_MIN_PROCESSORS}
Port=${DEVICE_HTTP_PORT}
ServerXMLTemplate=${SERVER_XML_TEMPLATE}
Secured=true
ConnectionTimeout=5000
MaxKeepAliveRequests=5


[/templates/DEG/DeviceInterface/Common_V1Core/Connectors/200.ClientDeviceHttpsConnector/OEMInterface]

ClassName=JsonContextProvider
ArrayRoot=true
ContextIdentifier=OEMInterface
ErrorMessageAttribute=DEG_OEMDevHttpErrorMessageString
ErrorNameAttribute=DEG_OEMDevHttpErrorNameString
ErrorRuleChain=203.ProcessOEMParsingErrorRuleChain
HeaderRuleChain=201.ProcessOEMRequestHeadersRuleChain
NoLogExceptions=com.hp.usage.listoperations.CustomRuleException
RequestHeaderMap=content-type,DEG_OEMDevContentTypeString,""
RequestHeaderMap=content-encoding,DEG_OEMDevContentEncodingString,""
RequestHeaderMap=accept,DEG_OEMDevAcceptString,""
RequestHeaderMap=accept-encoding,DEG_OEMDevAcceptEncodingString,""
RequestHeaderMap=x-protocol-version,DEG_OEMDevXProtocolVersionString,""
RequestHeaderMap=user-agent,DEG_OEMDevUserAgentString,dummy
RequestHeaderMap=x-country-iso-code,DEG_OEMDevXCountryISOCodeString
RequestHeaderMap=Accept-Language,DEG_OEMDevAcceptLanguageString
RequestNMENamespace=OEMRequest
RequestRootElement=requestRoot
RequestXSDFile=${SERVER_OEM_XSD_FILE}
#RFE71 : Display source ip in device log.
ClientAddressAttribute=DEG_OEMDevSourceIPAddressString
ResponseHandlerAttribute=DEG_OEMDevResponseHandlerString
ResponseHandlers=EmptyResponseHandler
ResponseHandlers=JsonResponseHandler
ResponseHeaderMap=Connection,DEG_OEMDevConnectionString
ResponseHeaderMap=Content-Encoding,DEG_OEMDevEncodingString
ResponseStatusAttribute=DEG_OEMDevHttpStatusInteger
RuleChainName=222.ProcessOEMVersionCheckRuleChain
SSLSessionIDAttribute=DEG_OEMDevSslSessionIdString
VirtualRoot=requestRoot
##RFE82:Issue2:Added new envivariable to specify the time in milliseconds, where a thread will wait for a rulechain to become available.
RuleChainTimeout=${DEVICEINTERFACE_REQUEST_TIMEOUT}


[/templates/DEG/DeviceInterface/Common_V1Core/Connectors/200.ClientDeviceHttpsConnector/OEMInterface/EmptyResponseHandler]

ClassName=EmptyResponseGenerator


[/templates/DEG/DeviceInterface/Common_V1Core/Connectors/200.ClientDeviceHttpsConnector/OEMInterface/JsonResponseHandler]

ClassName=JsonResponseGenerator
ArrayRoot=true
##EncodeAttribute=jsonResponse
EncodeAttribute=%specifier%
ResponseNMENamespace=OEMResponse
ResponseRootElement=responseRoot
ResponseRootElement=responseRoot2
ResponseXSDFile=${SERVER_OEM_XSD_FILE}
RootNMEType=Umbrella:Body
VirtualRoot=responseRoot
VirtualRoot=responseRoot2




[/templates/DEG/DeviceInterface/Common_V1Core/Connectors/201.LoadBalancerHeartBeatHttpConnector]

##RFE82:Issue3:Added new envi variable for accept count in case of 201.LoadBalancerHeartBeatHttpConnector.
AcceptCount=${DEVICE_HTTP_HEARTBEAT_ACCEPT_COUNT}
ClassName=com.hp.siu.plugins.tomcat.HttpConnector
ConnectionTimeout=${DEVICE_HEARTBEAT_CONN_TIMEOUT}
Context=GETStatus
Managed=${MANAGED_SETUP}
MaxKeepAliveRequests=1
MaxProcessors=${DEVICE_HTTP_HEARTBEAT_CON_MAX_PROCESSORS}
MaxSpareProcessors=${DEVICE_HTTP_HEARTBEAT_CON_MIN_PROCESSORS}
MinProcessors=${DEVICE_HTTP_HEARTBEAT_CON_MIN_PROCESSORS}
Port=${DEVICE_HEARTBEAT_HTTP_PORT}


[/templates/DEG/DeviceInterface/Common_V1Core/Connectors/201.LoadBalancerHeartBeatHttpConnector/GETStatus]

ClassName=TextContextProvider
ContextIdentifier=GETStatus
RuleChainName=101.GenerateResponseForLoadBalancerHeartBeat


[/templates/DEG/DeviceInterface/Common_V1Core/Connectors/201.LoadBalancerHeartBeatHttpConnector/GETStatus/ResponseHandler]

ClassName=PlainHttpResponseGenerator
SourceAttribute=DEG_OEMDevLoadBalRespMsgString

[/templates/DEG/DeviceInterface/Common_V1Core/Connectors/202.JsonRequestClient]

ClassName=HttpClientConnector
Requests=JsonRequestPost

[/templates/DEG/DeviceInterface/Common_V1Core/Connectors/202.JsonRequestClient/JsonRequestPost]

ClassName=JsonHttpRequest
HttpMethod=POST
RequestHeaderMap=content-type,DEG_OEMDevHBContentTypeString,application/json
RequestHeaderMap=content-encoding,DEG_OEMDevHBContentEncodingString,gzip
RequestHeaderMap=accept,DEG_OEMDevHBAcceptString,application/json
RequestHeaderMap=accept-encoding,DEG_OEMDevHBAcceptEncodingString,gzip
RequestHeaderMap=x-protocol-version,DEG_OEMDevHBXProtocolVersionString,HB
RequestNMENamespace=OEMRequest
RequestRootElement=requestRoot
RequestXSDFile=${SERVER_OEM_XSD_FILE}
ResponseHandlers=JsonResponseHandler
ResultCodeAttribute=DEG_OEMDevHttpStatusInteger
VirtualRoot=requestRoot

[/templates/DEG/DeviceInterface/Common_V1Core/Connectors/202.JsonRequestClient/JsonRequestPost/JsonResponseHandler]

ClassName=JsonResponseHandler
ResponseNMENamespace=OEMResponse
ResponseRootElement=responseRoot
EncodeAttribute=jsonResponse
ResponseXSDFile=${SERVER_OEM_XSD_FILE}
VirtualRoot=responseRoot
RootNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/Common_V1Core/Connectors/202.JsonRequestClient/EndPoints]

ClassName=DynamicEndPointSelector
KeyAttributeName=RemoteHostURL

[/templates/DEG/DeviceInterface/Common_V1Core/Connectors/202.JsonRequestClient/EndPoints/EndPoint]

ClassName=HttpEndPoint
KeyStoreFile=${SERVER_CERT_KEYSTORE_FILE}
KeyStorePassword=${SERVER_CERT_SIGNATURE_PASSWORD}
RemoteHostURL=${DEGAPPLE_HEALTHCHECK_REQUEST_URL}
NumConnections=${DEGAPPLE_NUM_CONNECTIONS}
ConnectionTimeout=${DEGAPPLE_CONNECTION_TIMEOUT}
SocketTimeout=${DEGAPPLE_SOCKET_TIMEOUT}

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService]

ClassName=com.hp.siu.serverutils.RefDataServiceManager
QueryNames=DEG_MONITORINGID_GENERATOR
QueryNames=DEG_MONITORING_SESSIONS_ActiveSessions
QueryNames=DEG_SYS_PARAMETER_PARA2VAL
QueryNames=DEG_LIC_LIMITS_TokenLifeTime
QueryNames=DEG_COMPANION_UNIQUEID_GENERATOR


####### GetSubscriberSubsAndUsageInternal START ##########
#QueryNames=DEG_SUBS_MSG_USAGE_MDNLOOKUP
#QueryNames=DEG_SUBS_DATA_USAGE_MDNLOOKUP
#QueryNames=DEG_SUBS_VOICE_USAGE_MDNLOOKUP
####### GetSubscriberSubsAndUsageInternal END ############

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_MSESSIONID,DEG_MSESSIONID
#JDBCDataSourceConnectorName=120.RefDataDbConnectorNRB
CommonPolicyID=Policy2
QueryString=SELECT %FIELDS  FROM DEG_MONITORING_SESSIONS WHERE DEG_MSESSIONTYPE in ('MDN','IMSI') AND DEG_MSESSIONSTATUS='AE' AND DEG_MSESSIONKEY=%DEG_MSESSIONKEY
ResultAttribute=DEG_NrbMatchFoundInteger
ResultIndexAttribute=DEG_NrbIndexInteger


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=50.SetErrorInfo
RuleNames=100.LogAlarming

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ErrorRule/50.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0000"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error:"


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_JsonEncodeAttribute
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/FinalRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.Copy_MatchFoundFlag
RuleNames=200.CheckMSessionKey

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/FinalRule/100.Copy_MatchFoundFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_NrbMatchFoundInteger DEG_NrbMatchFoundInteger

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/FinalRule/200.CheckMSessionKey]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_MSESSIONKEY,=,0

TrueRuleChain=100.Set_MSessionKeyFlag

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/FinalRule/200.CheckMSessionKey/100.Set_MSessionKeyFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SessionKeyInteger 1

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_NrbMatchFoundInteger 0
AdornOps=set DEG_MSESSIONID ""
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_MONITORING_SESSIONS"


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ResultRowRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.Set_MatchFound
RuleNames=200.PopulateMonitoringSessionIdsList


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ResultRowRule/100.Set_MatchFound]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_NrbMatchFoundInteger 1


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ResultRowRule/200.PopulateMonitoringSessionIdsList]

ClassName=AddToListAttributeRule
Delimiters=,
InputAttribute=DEG_MSESSIONID
ListAttribute=DEG_NrbMonitoringSessionIdList


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_MSESSIONTRANSID,DEG_MSESSIONTRANSID
#JDBCDataSourceConnectorName=120.RefDataDbConnectorNRB
CommonPolicyID=Policy2
QueryString=SELECT SEQUENCE_NEXTVAL('DEG_MONITORINGID_GENERATOR') AS DEG_MSESSIONTRANSID
ResultAttribute=DEG_NrbMatchFoundInteger
ResultIndexAttribute=DEG_NrbIndexInteger


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorInfo
RuleNames=101.LogAlarming

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/ErrorRule/100.SetErrorInfo]


ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0001"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error:"


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/ErrorRule/101.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_JsonEncodeAttribute
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_NrbMatchFoundInteger DEG_NrbMatchFoundInteger


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_NrbMatchFoundInteger 0
AdornOps=set DEG_NrbIndexInteger 0
AdornOps=set DEG_MSESSIONTRANSID 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_MONITORINGID_GENERATOR.NEXTVAL"


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/ResultRowRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_NrbMatchFoundInteger 1

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL]

ClassName=com.hp.usage.refdatasrv.CachedQuery
ResultAttribute=DEG_CDevMatchFoundInteger
ResultIndexAttribute=DEG_CDevIndexInteger


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/Cache]

ClassName=com.hp.usage.refdatasrv.HashMapLookupCache
CacheAttributes=DEG_SYSVALUE
CacheKeyAttributes=DEG_SYSPARAMETER
NMEKeyAttributes=DEG_CDevSysParameter


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=70.SetErrorInfo
RuleNames=100.LogAlarming
RuleNames=200.SetErrorFlag

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule/70.SetErrorInfo]
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0002"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error"

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_JsonEncodeAttribute
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule/200.SetErrorFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevMatchFoundInteger DEG_CDevMatchFoundInteger


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevMatchFoundInteger 0
AdornOps=set DEG_CDevIndexInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_SYS_PARAMETERS"
AdornOps=set DEG_SYSVALUE ""
AdornOps=set DEG_SYSPARAMETER ""
AdornOps=set DEG_DEVICE_ENTITLEMENT ""


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/Loader]

ClassName=com.hp.usage.refdatasrv.JDBCLoader
FieldExtracted=DEG_SYSPARAMETER,DEG_SYSPARAMETER
FieldExtracted=DEG_SYSVALUE,DEG_SYSVALUE
FieldExtracted=DEG_DEVICE_ENTITLEMENT,DEG_DEVICE_ENTITLEMENT
CommonPolicyID=Policy1
QueryString=select %FIELDS from DEG_SYS_PARAMETERS


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/RefreshPolicy]

ClassName=com.hp.siu.plugins.dna.collector.rules.CronIntervalRefreshPolicy
RefreshCronInterval=0 * * * *


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ResultRowRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevMatchFoundInteger 1
AdornOps=copy DEG_SYSVALUE DEG_CDevSysValueString
AdornOps=copy DEG_DEVICE_ENTITLEMENT DEG_OEMDevSysEntitlementNameString


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime]

ClassName=com.hp.usage.refdatasrv.CachedQuery
ResultAttribute=DEG_CDevMatchFoundInteger
ResultIndexAttribute=DEG_CDevIndexInteger


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/Cache]

ClassName=com.hp.usage.refdatasrv.HashMapLookupCache
CacheAttributes=DEG_TKN_LIFETIME
CacheAttributes=DEG_AUTHTHRESHOLD_COUNT
CacheKeyAttributes=DEG_LIC_TYPE
NMEKeyAttributes=DEG_OEMDevLicenseTypeString


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=150.SetErrorInfo
RuleNames=100.LogAlarming
RuleNames=200.SetErrorFlag

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/ErrorRule/150.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0003"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error"

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_JsonEncodeAttribute
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/ErrorRule/200.SetErrorFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevMatchFoundInteger DEG_CDevMatchFoundInteger


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevMatchFoundInteger 0
AdornOps=set DEG_CDevIndexInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_LIC_LIMITS"
AdornOps=set DEG_TKN_LIFETIME 0
AdornOps=set DEG_LIC_TYPE ""


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/Loader]

ClassName=com.hp.usage.refdatasrv.JDBCLoader
FieldExtracted=DEG_LIC_TYPE,DEG_LIC_TYPE
FieldExtracted=DEG_TKN_LIFETIME,DEG_TKN_LIFETIME
FieldExtracted=DEG_AUTHTHRESHOLD_COUNT,DEG_AUTHTHRESHOLD_COUNT
CommonPolicyID=Policy1
QueryString=select %FIELDS from DEG_LIC_LIMITS


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/RefreshPolicy]

ClassName=com.hp.siu.plugins.dna.collector.rules.CronIntervalRefreshPolicy
RefreshCronInterval=0 * * * *


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/ResultRowRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevMatchFoundInteger 1
AdornOps=copy DEG_TKN_LIFETIME DEG_OEMDevTokenLifetimeLong
AdornOps=copy DEG_AUTHTHRESHOLD_COUNT DEG_OEMDevAuthThresholdCountInteger


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_COMPANION_UNIQUEID_GENERATOR]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_UNIQUE_ID_SEQ,DEG_UNIQUE_ID_SEQ
CommonPolicyID=Policy1
QueryString=SELECT SEQUENCE_NEXTVAL('DEG_COMPANION_UNIQUEID_GENERATOR') AS DEG_UNIQUE_ID_SEQ
ResultAttribute=DEG_NrbMatchFoundInteger
ResultIndexAttribute=DEG_NrbIndexInteger


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_COMPANION_UNIQUEID_GENERATOR/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetLogInfo
RuleNames=101.LogAlarming

[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_COMPANION_UNIQUEID_GENERATOR/ErrorRule/100.SetLogInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0004"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error"


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_COMPANION_UNIQUEID_GENERATOR/ErrorRule/101.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_COMPANION_UNIQUEID_GENERATOR/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_NrbMatchFoundInteger DEG_NrbMatchFoundInteger


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_COMPANION_UNIQUEID_GENERATOR/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_NrbMatchFoundInteger 0
AdornOps=set DEG_NrbIndexInteger 0
AdornOps=set DEG_UNIQUE_ID_SEQ 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_COMPANION_UNIQUEID_GENERATOR.NEXTVAL"


[/templates/DEG/DeviceInterface/Common_V1Core/ReferenceDataService/DEG_COMPANION_UNIQUEID_GENERATOR/ResultRowRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_NrbMatchFoundInteger 1


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains]

ClassName=com.hp.siu.sessionserver.RuleChainManager
MaxPoolSize=${DEVICE_RULECHAIN_MAX_POOL_SIZE}
MinPoolSize=${DEVICE_RULECHAIN_MIN_POOL_SIZE}

##___ Database Operations Rulechain ___##########
RuleChainNames=000.SessionStoreDefaultErrorRuleChain
RuleChainNames=010.HandleNotExistsError
RuleChainNames=001.SessionStoreKeyNotExistsRuleChain
RuleChainNames=002.SessionStoreDuplicateKeyRuleChain
RuleChainNames=003.ReadSystemParameterRuleChain
RuleChainNames=004.ReadTokenLifeTimeRuleChain
RuleChainNames=005.StoreTokenRuleChain


##___ General Purpose Rulechain ___##########
RuleChainNames=101.GenerateResponseForLoadBalancerHeartBeat


##___ OEM Request Processing Rulechains ___##########
RuleChainNames=201.ProcessOEMRequestHeadersRuleChain
RuleChainNames=202.ProcessOEMRequestRuleChain
RuleChainNames=203.ProcessOEMParsingErrorRuleChain
RuleChainNames=222.ProcessOEMVersionCheckRuleChain
RuleChainNames=210G.DEG21CheckEAPAKADefaultRuleChain


##___ Generate Audit and NRB Rulechains ___##########

RuleChainNames=600.GenerateAuditAndNRBEventsRuleChain
RuleChainNames=601.DumpMonitoringTransactionsRuleChain
RuleChainNames=704.CheckSubsAndUsageAvailabilityStatusRuleChain
RuleChainNames=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckVersion

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.CheckVersion]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevXProtocolVersionString,=,2

TrueRuleChain=200.CreateErrorEndAuditRecordV2
FalseRuleChain=100.CreateErrorEndAuditRecordV1

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.CheckVersion/200.CreateErrorEndAuditRecordV2]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.CheckVersion/200.CreateErrorEndAuditRecordV2/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "400"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
#AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.CheckVersion/200.CreateErrorEndAuditRecordV2/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.CheckVersion/200.CreateErrorEndAuditRecordV2/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.CheckVersion/200.CreateErrorEndAuditRecordV2/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.CheckVersion/200.CreateErrorEndAuditRecordV2/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
 
[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.CheckVersion/200.CreateErrorEndAuditRecordV2/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.CheckVersion/100.CreateErrorEndAuditRecordV1]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.CheckVersion/100.CreateErrorEndAuditRecordV1/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "400"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
#AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.CheckVersion/100.CreateErrorEndAuditRecordV1/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getAuthentication response: "

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.CheckVersion/100.CreateErrorEndAuditRecordV1/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.CheckVersion/100.CreateErrorEndAuditRecordV1/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.CheckVersion/100.CreateErrorEndAuditRecordV1/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain/100.CheckVersion/100.CreateErrorEndAuditRecordV1/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/000.SessionStoreDefaultErrorRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetLookupErrorFlag
RuleNames=75.SetErrorInfo
RuleNames=200.LogAlarming


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/000.SessionStoreDefaultErrorRuleChain/100.SetLookupErrorFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 1

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/000.SessionStoreDefaultErrorRuleChain/75.SetErrorInfo]
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0005"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error:"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/000.SessionStoreDefaultErrorRuleChain/200.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/010.HandleNotExistsError]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.SetErrorInfo
RuleNames=001.LogAlarming

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/010.HandleNotExistsError/000.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0006"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error:"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/010.HandleNotExistsError/001.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
Message=Database Error: Session not found for delete
LogLevel=WARNING
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/001.SessionStoreKeyNotExistsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ClearDuplicateKeyFlag


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/001.SessionStoreKeyNotExistsRuleChain/100.ClearDuplicateKeyFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/002.SessionStoreDuplicateKeyRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetDuplicateKeyFlag


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/002.SessionStoreDuplicateKeyRuleChain/100.SetDuplicateKeyFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/003.ReadSystemParameterRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReadSystemParameter


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/003.ReadSystemParameterRuleChain/100.ReadSystemParameter]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_SYS_PARAMETER_PARA2VAL


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/003.ReadSystemParameterRuleChain/100.ReadSystemParameter/ErrorRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/003.ReadSystemParameterRuleChain/100.ReadSystemParameter/NoMatchRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBNoMatchFlagInteger 1

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/004.ReadTokenLifeTimeRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReadTokenLifeTime


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/004.ReadTokenLifeTimeRuleChain/100.ReadTokenLifeTime]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_LIC_LIMITS_TokenLifeTime


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/004.ReadTokenLifeTimeRuleChain/100.ReadTokenLifeTime/ErrorRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/004.ReadTokenLifeTimeRuleChain/100.ReadTokenLifeTime/NoMatchRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBNoMatchFlagInteger 1


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitLookup
RuleNames=200.Lookup
RuleNames=300.CheckLookupStatus

#Sprint Issue Tracker #67 : Unique-id is not being checked for manageDeviceCredentials call
#Previous unique id is fetching from tokens table before(for GPSAS custom template) its get updated with new unique id.

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/100.InitLookup]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_TOKENS"
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set CUST_VOWIFI_IN_PrevUniqueIDString ""

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/200.Lookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_UNIQUE_ID,CUST_VOWIFI_IN_PrevUniqueIDString
MapAttributes=DEG_DAI,DEG_DAI
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckIfSessionKeyExists


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0007"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_TOKENS table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.TokenNotFound
FalseRuleChain=200.TokenFound


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitCreate
RuleNames=200.Create
RuleNames=300.CheckCreateStatus


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/100.InitCreate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=copy DEG_CDevTokenString DEG_SUBSTOKEN
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=set DEG_TOKENSTATUS "AE"
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set DEG_AUTH_COUNT 1
AdornOps=set DEG_BLACKLIST_FLAG 0
AdornOps=set log_DB_Operation "CREATE"
AdornOps=set log_Table_Name "DEG_TOKENS"
AdornOps=set DEG_PUSH_TOKEN ""
AdornOps=set DEG_DAI ""
AdornOps=setifnull DEG_OEMDevUniqueIDString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_UNIQUE_ID
AdornOps=copy DEG_OEMDevUserAgentString DEG_USER_AGENT
AdornOps=setsystime DEG_BLACKLISTWINDOW_STARTTIME


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/200.Create]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckDuplicateKeyError


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0008"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_USER_AGENT
LogLevel=CRITICAL
Message=Database Error: Unable to create entry in DEG_TOKENS session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
TrueRuleChain=100.UpdateRecentlyCreatedToken


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/100.InitUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=copy DEG_CDevTokenString DEG_SUBSTOKEN
AdornOps=set DEG_TOKENSTATUS "AE"
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_TOKENS"
AdornOps=copy DEG_OEMDevUserAgentString DEG_USER_AGENT

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_AUTHENTICATION_TYPE,DEG_AUTHENTICATION_TYPE
MapAttributes=DEG_AUTHENTICATION_SUBTYPE,DEG_AUTHENTICATION_SUBTYPE
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
MapAttributes=DEG_USER_AGENT,DEG_USER_AGENT
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckKeyExists


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0009"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_USER_AGENT
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_TOKENS session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0010"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_USER_AGENT
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_TOKENS session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/100.InitUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=copy DEG_CDevTokenString DEG_SUBSTOKEN
AdornOps=set DEG_TOKENSTATUS "AE"
AdornOps=setifnull DEG_OEMDevUniqueIdString ""
AdornOps=copy DEG_OEMDevUniqueIdString DEG_UNIQUE_ID
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_TOKENS"
AdornOps=copy DEG_OEMDevUserAgentString DEG_USER_AGENT

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_AUTHENTICATION_TYPE,DEG_AUTHENTICATION_TYPE
MapAttributes=DEG_AUTHENTICATION_SUBTYPE,DEG_AUTHENTICATION_SUBTYPE
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
MapAttributes=DEG_APP_TOKEN_FLAG,DEG_APP_TOKEN_FLAG
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_USER_AGENT,DEG_USER_AGENT
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckKeyExists


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0011"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_USER_AGENT
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_TOKENS session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/200.CheckKeyExists]


ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0012"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/005.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_USER_AGENT
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_TOKENS session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckDBStatus
RuleNames=100.InitializeRequestVariables
RuleNames=200.GenerateRequest
RuleNames=110.InvokeJsonServerJsonRequest
RuleNames=120.CheckResultCode
RuleNames=130.SetErrorResponse
RuleNames=200.LogResponse

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdateAttributes
RuleNames=200.UpdateHCData
RuleNames=300.CheckUpdateStatus

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/100.InitUpdateAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_CDevHCDBCheckInteger 0
AdornOps=set DEG_HC_PROCESS_NAME ${DEVICEINTERFACE_PROCESS_NAME}
AdornOps=setsystime DEG_HC_LASTUPDATE

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/200.UpdateHCData]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_HC_LASTUPDATE,DEG_HC_LASTUPDATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_HC_DATA_SessionStore

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0

TrueRuleChain=100.SetErrorInfo
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule

AdornOps=set DEG_CDevHCDBCheckInteger 500

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.InitCreate
TrueRuleChain=200.InsertHCData
TrueRuleChain=300.CheckCreateStatus

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/200.CheckKeyExists/100.InitCreate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_CDevHCDBCheckInteger 0
AdornOps=set DEG_HC_PROCESS_NAME ${DEVICEINTERFACE_PROCESS_NAME}
AdornOps=setsystime DEG_HC_LASTUPDATE

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/200.CheckKeyExists/200.InsertHCData]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_HC_DATA_SessionStore

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/200.CheckKeyExists/300.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

Operations=or

TrueRuleChain=100.SetErrorInfo

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/200.CheckKeyExists/300.CheckCreateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevHCDBCheckInteger 500

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/100.InitializeRequestVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=setifnull DEG_OEMDevRespStatusString 0
AdornOps=set DEG_OEMDevRequestIdString "1"
AdornOps=set DEG_OEMDevActionNameString "healthCheck"
AdornOps=set DEG_OEMDevAuthTypeString "EAP-AKA"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/200.GenerateRequest]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,request_id.CData
NMEToStructuredNMEMap=DEG_OEMDevActionNameString,action_name.CData
NMEToStructuredNMEMap=DEG_OEMDevAuthTypeString,auth_type.CData
SNMEType=OEMRequest:requestRoot2

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/110.InvokeJsonServerJsonRequest]

ClassName=com.hp.usage.lookup.SynchronousLookupRule
ConnectorName=202.JsonRequestClient
ErrorCodeAttribute=DEG_CDevProcessingErrorIdString
ErrorMessageAttribute=DEG_OEMDevErrorMessageString

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/110.InvokeJsonServerJsonRequest/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorResponse
RuleNames=200.ErrorLogs

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/110.InvokeJsonServerJsonRequest/ErrorRule/100.SetErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0013"
AdornOps=set DEG_OEMDevMessageString "JsonRequestClient-ErrorRule"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/110.InvokeJsonServerJsonRequest/ErrorRule/200.ErrorLogs]

ClassName=LogNMERule
LogLevel=DEBUG
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=JsonRequestClient-ErrorRule
NullAlso=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/110.InvokeJsonServerJsonRequest/NoMatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorResponse
RuleNames=200.ErrorLogs

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/110.InvokeJsonServerJsonRequest/NoMatchRule/100.SetErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0014"
AdornOps=set DEG_OEMDevMessageString "JsonRequestClient-NoMatchRule"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/110.InvokeJsonServerJsonRequest/NoMatchRule/200.ErrorLogs]

ClassName=LogNMERule
LogLevel=DEBUG
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=JsonRequestClient-NoMatchRule
NullAlso=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/120.CheckResultCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevHttpStatusInteger,within,[200,400]
Conditions=DEG_CDevHCDBCheckInteger,=,0
Operations=and

TrueRuleChain=100.SetSuccessResponse
FalseRuleChain=200.SetFailureResponse

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/120.CheckResultCode/100.SetSuccessResponse]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevLoadBalRespMsgString "DEG_DeviceInterface Status:UP AND RUNNING"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/120.CheckResultCode/200.SetFailureResponse]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevLoadBalRespMsgString "DEG_DeviceInterface Status:Down or Hanging"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/130.SetErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0015"
AdornOps=set DEG_OEMDevMessageString "F5 HeartBeat"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/101.GenerateResponseForLoadBalancerHeartBeat/200.LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevLoadBalRespMsgString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
LogLevel=DEBUG
Message=F5 HeartBeat: 
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=105.SetErrorInfo
RuleNames=110.LogNewHttRequest
RuleNames=200.HeadersValidation


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/100.InitWorkingVariables]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetVariables
RuleNames=110.CheckUserAgentValue
RuleNames=200.InitReqIdList
RuleNames=210.InitReqActionList


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/100.InitWorkingVariables/100.SetVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=set DEG_OEMDevHttpStatusInteger 200
AdornOps=set DEG_OEMDevResponseHandlerString "dummy"
AdornOps=set DEG_OEMDevActionNameString "dummy"
AdornOps=set DEG_OEMDevRequestIdString "dummy"
AdornOps=set DEG_OEMDevSSLSSDeletedInteger 0
AdornOps=setsystime DEG_CDevProcessStartTimeLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
#AdornOps=set DEG_OEMDevDateTimeZoneString "UTC"
AdornOps=set DEG_OEMDevUniqueIDString ""
AdornOps=set DEG_AuditTransactionTypeString "getAuthentication"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=setifnull DEG_SSL_ID ""
AdornOps=set DEG_MDN 0
AdornOps=setifnull DEG_OEMDevImsiString ""
AdornOps=set DEG_OEMDevDeviceTypeString "Primary"
AdornOps=setifnull DEG_OEMDevSubscriberIdString ""
AdornOps=setifnull DEG_OEMDevUniqueIDString ""
AdornOps=setifnull DEG_OEMDevResultCodeInteger 0
AdornOps=setifnull DEG_OEMDevRespStatusString ""
AdornOps=setifnull DEG_OEMDevUserAgentString ""
AdornOps=set DEG_OEMDev_IllegalCharsResCodeString "2"
AdornOps=set DEG_OEMDev_IllegalCharsResCodeInteger 3
AdornOps=set DEG_OEMDev_ResponseCodeString ""
AdornOps=set DEG_OEMDev_ReturnCodeInteger 1
AdornOps=set DEG_OEMDev_ValueCheckResCodeString "4"
AdornOps=set DEG_OEMDev_ValueCheckRetCodeInteger 5
AdornOps=set DEG_OEMDevNeedLookUPSessionInteger 1

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/100.InitWorkingVariables/110.CheckUserAgentValue]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevUserAgentString,contains,"HttpClient"
TrueRuleChain=100.SetDefaultToNull

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/100.InitWorkingVariables/110.CheckUserAgentValue/100.SetDefaultToNull]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevUserAgentString ""
[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/100.InitWorkingVariables/200.InitReqIdList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevRequestIdString
ListAttribute=DEG_OEMDevRequestIdList


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/100.InitWorkingVariables/210.InitReqActionList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevActionNameString
ListAttribute=DEG_OEMDevActionNameList

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/105.SetErrorInfo]
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0016"
AdornOps=set DEG_OEMDevMessageString "DEVICE TO DEG -> Received new http request"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/110.LogNewHttRequest]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevXProtocolVersionString,=,"HB"
FalseRuleChain=110.LogNewHttRequest

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/110.LogNewHttRequest/110.LogNewHttRequest]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevContentTypeString
Attributes=DEG_OEMDevContentEncodingString
Attributes=DEG_OEMDevAcceptString
Attributes=DEG_OEMDevAcceptEncodingString
Attributes=DEG_OEMDevXProtocolVersionString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevUserAgentString
#RFE71 : Display source ip in device log.
Attributes=DEG_OEMDevSourceIPAddressString
LogLevel=INFO
Message=DEVICE TO DEG -> Received new http request: 
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=ValidateContentTypeHeader
TrueRuleChain=ValidateContentEncodingHeader
TrueRuleChain=ValidateAcceptHeader
TrueRuleChain=ValidateAcceptEncodingHeader
TrueRuleChain=ValidateXProtocolVersionHeader
TrueRuleChain=ValidateXCountryISOCodeHeader
TrueRuleChain=ValidateAcceptLanguageHeader
TrueRuleChain=ValidateUserAgentHeader
TrueRuleChain=LogSuccessfulHeaderProcessing
TrueRuleChain=UpdateSslSession
ValidateContentTypeHeader=000.ValidateContentTypeJason

ValidateContentEncodingHeader=100.ValidateEncodingTypeGzip

ValidateAcceptHeader=200.ValidateAccept

ValidateAcceptEncodingHeader=300.ValidateAcceptEncodingGzip

ValidateXProtocolVersionHeader=400.ValidateXProtocolVersion

ValidateXCountryISOCodeHeader=500.ValidateXCountryISOCode

ValidateAcceptLanguageHeader=600.ValidateAcceptLanguage

ValidateUserAgentHeader=700.ValidateUserAgentHeader


LogSuccessfulHeaderProcessing=100.SetErrorInfo
LogSuccessfulHeaderProcessing=500.CreateLogSuccesfull

UpdateSslSession=600.InitSslSessionLookup
UpdateSslSession=610.ExecuteSslSessionLookup
UpdateSslSession=CopyDAIFromSSLSessionTable
UpdateSslSession=620.CheckSslSessionLookupStatus

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/500.ValidateXCountryISOCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevXCountryISOCodeString,!=,null
TrueRuleChain=100.InitValidationAttributes
TrueRuleChain=100.ValidateXCountryCodeHeaderFormat
TrueRuleChain=100.CheckValidationResponseCode

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/500.ValidateXCountryISOCode/100.InitValidationAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDev_IllegalCharsResCodeString "2"
AdornOps=set DEG_OEMDev_IllegalCharsResCodeInteger 3
AdornOps=set DEG_OEMDev_ResponseCodeString ""
AdornOps=set DEG_OEMDev_ReturnCodeInteger 1
AdornOps=set DEG_OEMDev_ValueCheckResCodeString "4"
AdornOps=set DEG_OEMDev_ValueCheckRetCodeInteger 5

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/500.ValidateXCountryISOCode/100.ValidateXCountryCodeHeaderFormat]

ClassName=com.hp.usage.throttling.NMEAttributesValidationRule
AttributeCheck=DEG_OEMDevXCountryISOCodeString,n,,REGEX:^([a-zA-Z]{2})$

ThrowException=false
Trim=true

IllegalCharsResCodeAttrName=DEG_OEMDev_IllegalCharsResCodeString
IllegalCharsRetCodeAttrName=DEG_OEMDev_IllegalCharsResCodeInteger

ResCodeNMEAttrName=DEG_OEMDev_ResponseCodeString
RetCodeNMEAttrName=DEG_OEMDev_ReturnCodeInteger

ValueCheckResCodeAttrName=DEG_OEMDev_ValueCheckResCodeString
ValueCheckRetCodeAttrName=DEG_OEMDev_ValueCheckRetCodeInteger

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/500.ValidateXCountryISOCode/100.CheckValidationResponseCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDev_ResponseCodeString,!=,""
Conditions=DEG_OEMDev_ReturnCodeInteger,!=,1
Operations=or

#TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
#TrueRuleChain=120.GenerateStartAudit
#TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/500.ValidateXCountryISOCode/100.CheckValidationResponseCode/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 400
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0017"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid x-country-iso-code header"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/500.ValidateXCountryISOCode/100.CheckValidationResponseCode/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevContentTypeString
Attributes=DEG_OEMDevContentEncodingString
Attributes=DEG_OEMDevAcceptString
Attributes=DEG_OEMDevAcceptEncodingString
Attributes=DEG_OEMDevXProtocolVersionString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevXCountryISOCodeString
Attributes=DEG_OEMDevAcceptLanguageString
Attributes=DEG_OEMDev_ResponseCodeString
Attributes=DEG_OEMDev_ReturnCodeInteger
LogLevel=WARNING
Message=Invalid http headers in OEM request - X country-iso-code header format is not correct.
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/500.ValidateXCountryISOCode/100.CheckValidationResponseCode/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/500.ValidateXCountryISOCode/100.CheckValidationResponseCode/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/600.ValidateAcceptLanguage]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAcceptLanguageString,!=,null
TrueRuleChain=100.InitValidationAttributes
TrueRuleChain=100.ValidateAcceptLanguageHeaderFormat
TrueRuleChain=100.CheckValidationResponseCode

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/600.ValidateAcceptLanguage/100.InitValidationAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDev_IllegalCharsResCodeString "2"
AdornOps=set DEG_OEMDev_IllegalCharsResCodeInteger 3
AdornOps=set DEG_OEMDev_ResponseCodeString ""
AdornOps=set DEG_OEMDev_ReturnCodeInteger 1
AdornOps=set DEG_OEMDev_ValueCheckResCodeString "4"
AdornOps=set DEG_OEMDev_ValueCheckRetCodeInteger 5

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/600.ValidateAcceptLanguage/100.ValidateAcceptLanguageHeaderFormat]

ClassName=com.hp.usage.throttling.NMEAttributesValidationRule
AttributeCheck=DEG_OEMDevAcceptLanguageString,n,,REGEX:^([a-zA-Z]{2})-([a-zA-Z]{2}|[a-zA-Z]{3})$

ThrowException=false
Trim=true

IllegalCharsResCodeAttrName=DEG_OEMDev_IllegalCharsResCodeString
IllegalCharsRetCodeAttrName=DEG_OEMDev_IllegalCharsResCodeInteger

ResCodeNMEAttrName=DEG_OEMDev_ResponseCodeString
RetCodeNMEAttrName=DEG_OEMDev_ReturnCodeInteger

ValueCheckResCodeAttrName=DEG_OEMDev_ValueCheckResCodeString
ValueCheckRetCodeAttrName=DEG_OEMDev_ValueCheckRetCodeInteger

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/600.ValidateAcceptLanguage/100.CheckValidationResponseCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDev_ResponseCodeString,!=,""
Conditions=DEG_OEMDev_ReturnCodeInteger,!=,1
Operations=or

#TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
#TrueRuleChain=120.GenerateStartAudit
#TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/600.ValidateAcceptLanguage/100.CheckValidationResponseCode/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 400
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0018"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid Accept_language header"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/600.ValidateAcceptLanguage/100.CheckValidationResponseCode/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevContentTypeString
Attributes=DEG_OEMDevContentEncodingString
Attributes=DEG_OEMDevAcceptString
Attributes=DEG_OEMDevAcceptEncodingString
Attributes=DEG_OEMDevXProtocolVersionString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString

Attributes=DEG_OEMDevAcceptLanguageString
Attributes=DEG_OEMDev_ResponseCodeString
Attributes=DEG_OEMDev_ReturnCodeInteger
LogLevel=WARNING
Message=Invalid http headers in OEM request - Accept language header format is not correct.
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/600.ValidateAcceptLanguage/100.CheckValidationResponseCode/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/600.ValidateAcceptLanguage/100.CheckValidationResponseCode/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/700.ValidateUserAgentHeader]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevUserAgentString,=,"dummy"
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/700.ValidateUserAgentHeader/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 400
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0019"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid header user agent value"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/700.ValidateUserAgentHeader/110.ErrorLog]


ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevContentTypeString
Attributes=DEG_OEMDevContentEncodingString
Attributes=DEG_OEMDevAcceptString
Attributes=DEG_OEMDevAcceptEncodingString
Attributes=DEG_OEMDevXProtocolVersionString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevUserAgentString
LogLevel=WARNING
Message=Invalid http headers in OEM request - user agent header must have value :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=http headers in OEM request - user agent header must have value. Contact HP Support.


#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/700.ValidateUserAgentHeader/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/700.ValidateUserAgentHeader/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/000.ValidateContentTypeJason]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevContentTypeString,!=,"application/json"
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/000.ValidateContentTypeJason/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 400
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0020"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid header content type"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/000.ValidateContentTypeJason/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevContentTypeString
Attributes=DEG_OEMDevContentEncodingString
Attributes=DEG_OEMDevAcceptString
Attributes=DEG_OEMDevAcceptEncodingString
Attributes=DEG_OEMDevXProtocolVersionString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid http headers in OEM request - content-type header must be application/json : 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=http headers in OEM request - content-type header must be application/json.  Contact HP Support.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/000.ValidateContentTypeJason/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/000.ValidateContentTypeJason/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/100.ValidateEncodingTypeGzip]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevContentEncodingString,!=,"gzip"
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/100.ValidateEncodingTypeGzip/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 400
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0021"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid header content encoding"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/100.ValidateEncodingTypeGzip/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevContentTypeString
Attributes=DEG_OEMDevContentEncodingString
Attributes=DEG_OEMDevAcceptString
Attributes=DEG_OEMDevAcceptEncodingString
Attributes=DEG_OEMDevXProtocolVersionString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid http headers in OEM request - content-encoding header must be gzip: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Invalid http headers in OEM request - content-encoding header must be gzip .Contact HP Admin.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/100.ValidateEncodingTypeGzip/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/100.ValidateEncodingTypeGzip/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/200.ValidateAccept]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAcceptString,!=,"application/json"
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/200.ValidateAccept/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 400
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0022"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid Header Accept Type"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/200.ValidateAccept/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevContentTypeString
Attributes=DEG_OEMDevContentEncodingString
Attributes=DEG_OEMDevAcceptString
Attributes=DEG_OEMDevAcceptEncodingString
Attributes=DEG_OEMDevXProtocolVersionString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid http headers in OEM request - accept header must be application/json: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/200.ValidateAccept/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/200.ValidateAccept/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/300.ValidateAcceptEncodingGzip]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAcceptEncodingString,!=,"gzip"
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/300.ValidateAcceptEncodingGzip/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 400
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0023"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid header accept encoding"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/300.ValidateAcceptEncodingGzip/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevContentTypeString
Attributes=DEG_OEMDevContentEncodingString
Attributes=DEG_OEMDevAcceptString
Attributes=DEG_OEMDevAcceptEncodingString
Attributes=DEG_OEMDevXProtocolVersionString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid http headers in OEM request - accept-encoding header must be gzip: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Invalid http headers in OEM request - accept-encoding header must be gzip .Contact HP Admin.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/300.ValidateAcceptEncodingGzip/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/300.ValidateAcceptEncodingGzip/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/400.ValidateXProtocolVersion]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevXProtocolVersionString,!within,[1,2]

TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=200.CheckForHBRequest


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/400.ValidateXProtocolVersion/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 400
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0024"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid header protocol version"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/400.ValidateXProtocolVersion/200.CheckForHBRequest]

ClassName=ConditionalRule
Conditions=DEG_OEMDevXProtocolVersionString,!=,"HB"
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/400.ValidateXProtocolVersion/200.CheckForHBRequest/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevContentTypeString
Attributes=DEG_OEMDevContentEncodingString
Attributes=DEG_OEMDevAcceptString
Attributes=DEG_OEMDevAcceptEncodingString
Attributes=DEG_OEMDevXProtocolVersionString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid http headers in OEM request - x-protocol-version header must be 1 or 2: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Invalid http headers in OEM request - x-protocol-version header must be 1 or 2 .

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/400.ValidateXProtocolVersion/200.CheckForHBRequest/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/400.ValidateXProtocolVersion/200.CheckForHBRequest/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0025"
AdornOps=set DEG_OEMDevMessageString "Request header processed successfully"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/500.CreateLogSuccesfull]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevContentTypeString
Attributes=DEG_OEMDevContentEncodingString
Attributes=DEG_OEMDevAcceptString
Attributes=DEG_OEMDevAcceptEncodingString
Attributes=DEG_OEMDevXProtocolVersionString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_OEMDevUserAgentString
LogLevel=DEBUG
Message=Request header processed successfully: 
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/600.InitSslSessionLookup]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=copy DEG_OEMDevUserAgentString DEG_AuditUserAgentString


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/610.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_STATE,DEG_SSL_AAA_STATE
MapAttributes=DEG_SSL_DAI,DEG_SSL_DAI
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/CopyDAIFromSSLSessionTable]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull DEG_SSL_DAI ""
AdornOps=copy DEG_SSL_DAI DEG_OEMDevDAIString


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/620.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_SSL_ID,=,DEG_SSL_ID

TrueRuleChain=SystemError
TrueRuleChain=NoSslSession
TrueRuleChain=SslSessionExists

SystemError=000.SystemError_SetHttpErrorResponse
SystemError=010.SystemErrorLog
SystemError=020.GenerateStartAudit
SystemError=030.GenerateErrorEndAudit

NoSslSession=100.NoSslSession_InitSslSessionCreate
NoSslSession=110.NoSslSession_ExecuteSslSessionCreate
NoSslSession=120.NoSslSession_CheckSslSessionCreateStatus

SslSessionExists=200.SslSessionExists_InitSslSessionUpdate


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/620.CheckSslSessionLookupStatus/000.SystemError_SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0026"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_SSL_SESSION table"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/620.CheckSslSessionLookupStatus/010.SystemErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access DEG_SSL_SESSION table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/620.CheckSslSessionLookupStatus/020.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/620.CheckSslSessionLookupStatus/030.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/620.CheckSslSessionLookupStatus/100.NoSslSession_InitSslSessionCreate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation INSERT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_STATE "NEW"
AdornOps=set DEG_SSL_REQUEST_STATE "NEW"
AdornOps=set DEG_SSL_NAI ""
AdornOps=set DEG_SSL_IMSI ""
AdornOps=set DEG_SSL_MDN ""
AdornOps=set DEG_SSL_UNIQUE_ID ""
AdornOps=setsystime DEG_SSL_CREATETIMESTAMP
AdornOps=copy DEG_SSL_ID DEG_SSL_AAA_SESSIONID
#AdornOps=set DEG_SSL_AAA_SESSIONID ""
AdornOps=set DEG_SSL_AAA_STATE ""
AdornOps=set DEG_STR_FLAG 0
AdornOps=set DEG_SSL_ID_PROV_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=set DEG_SSL_GW_ADDR "NA"
AdornOps=set DEG_SSL_POSTDATA ""
AdornOps=set DEG_SSL_ADDRESS_UPDATE_URL ${DEVICE_SERVICE_MNGT_URL}
AdornOps=set DEG_SSL_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=set DEG_SSL_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=set DEG_SSL_EntitlementStatus ""
AdornOps=set DEG_SSL_MSCHAP_USERNAME ""
AdornOps=set DEG_SSL_MSCHAP_PASSWORD ""
AdornOps=set DEG_SSL_COMPANION_DEVICE_COUNT ""
AdornOps=set DEG_SSL_CUSTOM_FIELD ""
AdornOps=set DEG_SSL_DAI ""
AdornOps=set DEG_GETAUTH_CONTACTED_AAA ""

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/620.CheckSslSessionLookupStatus/110.NoSslSession_ExecuteSslSessionCreate]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/620.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
Operations=or
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/620.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0027"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to access or create entry in DEG_SSL_SESSION table"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/620.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to access or create entry in DEG_SSL_SESSION table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/620.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/620.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/201.ProcessOEMRequestHeadersRuleChain/200.HeadersValidation/620.CheckSslSessionLookupStatus/200.SslSessionExists_InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_REQUEST_STATE "NEW"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain

RuleNames=001.SetJsonEncoder
RuleNames=100.CheckVersion
RuleNames=200.SetParametersOfHttpResponse
RuleNames=300.CheckIfDeleteSSLSession
RuleNames=999.SetJsonSpecifier

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/001.SetJsonEncoder]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_JsonEncodeAttribute "jsonResponse"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/999.SetJsonSpecifier]

ClassName=NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=false
NMEToStructuredNMEMap=DEG_JsonEncodeAttribute,specifier
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/100.CheckVersion]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_OEMDevXProtocolVersionString,=,1
Conditions=DEG_OEMDevXProtocolVersionString,=,2

TrueRuleChain=ProcessingVersion1RuleChain
TrueRuleChain=ProcessingVersion2RuleChain

ProcessingVersion1RuleChain=100.ProcessingVersion1RuleChain

ProcessingVersion2RuleChain=200.ProcessingVersion2RuleChain

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/100.CheckVersion/100.ProcessingVersion1RuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=202.ProcessOEMRequestRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/100.CheckVersion/200.ProcessingVersion2RuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223.DEG20ProcessOEMRequestRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_SSL_REQUEST_STATE,=,"200"
Conditions=DEG_SSL_REQUEST_STATE,=,"200C"
Conditions=DEG_SSL_REQUEST_STATE,=,"400C"
Conditions=DEG_SSL_REQUEST_STATE,=,"500C"
Conditions=DEG_SSL_REQUEST_STATE,=,"401C"
Conditions=DEG_SSL_REQUEST_STATE,=,"403C"
Conditions=DEG_SSL_REQUEST_STATE,=,"503C"
Conditions=DEG_SSL_REQUEST_STATE,=,DEG_SSL_REQUEST_STATE

TrueRuleChain=Http200
TrueRuleChain=Http200C
TrueRuleChain=Http400C
TrueRuleChain=Http401C
TrueRuleChain=Http500C
TrueRuleChain=Http403C
TrueRuleChain=Http503C
TrueRuleChain=HttpUnknown

Http200=100.Http200_SetHttpResponse

Http200=110.Http200_LogResponse

Http200C=200.Http200C_SetHttpResponse

Http200C=210.Http200C_LogResponse

Http400C=305.Http400C_LogErrorInfo
Http400C=300.Http400C_LogResponse
Http400C=310.Http400C_RaiseException

Http401C=305.Http401C_RaiseException
Http401C=300.Http401C_LogResponse

Http500C=350.Http500C_LogErrorResponse
Http500C=400.Http500C_LogResponse
Http500C=410.Http500C_RaiseException

Http403C=500.Http403C_RaiseException
Http403C=510.Http403C_LogResponse

Http503C=600.Http503C_LogResponse
Http503C=610.Http503C_RaiseException

HttpUnknown=499.HttpUnknown_SetErrorInfo
HttpUnknown=500.HttpUnknown_LogResponse
HttpUnknown=510.HttpUnknown_RaiseException


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/100.Http200_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 200
AdornOps=set DEG_OEMDevResponseHandlerString "JsonResponseHandler"
AdornOps=set DEG_OEMDevConnectionString "keep-alive"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0028"
AdornOps=set DEG_OEMDevMessageString "Action processed successfully - http status set to 200 and http session not closed"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/110.Http200_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_SSL_NAI
Attributes=DEG_OEMDevEntitlementNameString
Attributes=DEG_OEMDevRespPhoneNumberString
Attributes=DEG_OEMDevClientNonceBin
Attributes=DEG_OEMDevEntitlementNameListToStr
Attributes=DEG_OEMDevRespStatusString
Attributes=DEG_OEMDevSubscriptionTypeListToStr
Attributes=DEG_OEMDevUsageTypeListToStr
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_JsonEncodeAttribute
Attributes=DEG_OEMDevUserAgentString
LogLevel=INFO
Message=Action processed successfully - http status set to 200 and http session not closed: 
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/200.Http200C_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 200
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "JsonResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=set DEG_CDevProcessingMessageIdString  "DEG.DI.GA.0029"
AdornOps=set DEG_OEMDevMessageString "Action processed successfully - http status set to 200 and http session closed"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/210.Http200C_LogResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevXProtocolVersionString,=,"HB"
FalseRuleChain=210.Http200C_LogResponse

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/210.Http200C_LogResponse/210.Http200C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SSL_NAI
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevRespPhoneNumberString
Attributes=DEG_OEMDevClientNonceBin
Attributes=DEG_OEMDevEntitlementNameListToStr
Attributes=DEG_OEMDevRespStatusString
Attributes=DEG_SSL_STATE
Attributes=DEG_OEMDevSubscriptionTypeListToStr
Attributes=DEG_OEMDevMasterRespStatusString
Attributes=DEG_OEMDevUsageTypeListToStr
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_JsonEncodeAttribute
Attributes=DEG_OEMDevUserAgentString
LogLevel=INFO
Message=Action processed successfully - http status set to 200 and http session closed: 
PropertyName=LogRequestFlowLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/305.Http400C_LogErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString  "DEG.DI.GA.0030"
AdornOps=set DEG_OEMDevErrorMessageString "OEM action is invalid - http status is set to 400 and http session closed"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/300.Http400C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevResponseHandlerString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_JsonEncodeAttribute
LogLevel=INFO
Message=OEM action is invalid - http status is set to 400 and http session closed:
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/310.Http400C_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=400C
ErrorMessage=Http Request is rejected with http status 400

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/305.Http401C_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=401C
ErrorMessage=Http Request is rejected with http status 401

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/300.Http401C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_JsonEncodeAttribute
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=WARNING
Message=Invalid request Response is http status 401 and http session closed
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/350.Http500C_LogErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0031"
AdornOps=set DEG_OEMDevErrorMessageString "Internal error during OEM action processing - http status set to 500 and http session closed"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/400.Http500C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevResponseHandlerString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
LogLevel=INFO
Message=Internal error during OEM action processing - http status set to 500 and http session closed: 
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/410.Http500C_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=500C
ErrorMessage=Http Request is rejected with http status 500

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/500.Http403C_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=403C
ErrorMessage=Http Request is rejected with http status 403


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/510.Http403C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_JsonEncodeAttribute
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=WARNING
Message=Invalid request – Response is http status 403 and http session closed
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/600.Http503C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_JsonEncodeAttribute
LogLevel=WARNING
Message=Invalid request – Response is http status 503 and http session closed :
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/610.Http503C_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=503C
ErrorMessage=Http Request is rejected with http status 503


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/499.HttpUnknown_SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0032"
AdornOps=set DEG_OEMDevErrorMessageString "Unknown internal error during OEM action processing - http status set to 500 and http session closed"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/500.HttpUnknown_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevResponseHandlerString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_JsonEncodeAttribute
LogLevel=INFO
Message=Unknown internal error during OEM action processing - http status set to 500 and http session closed: 
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/200.SetParametersOfHttpResponse/510.HttpUnknown_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=500C
ErrorMessage=Http Request is rejected with http status 500


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/300.CheckIfDeleteSSLSession]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSSLSSDeletedInteger,=,0
TrueRuleChain=100.CheckSSLSessionStatus

#DEG_SSL_SESSION is not delete after session is done.Issue from DEG3.0 we have given fix for DEGDROID_DeviceInterface.cfg and same added for DEG_DeviceInterface.cfg


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/300.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"NEW"
Conditions=DEG_SSL_STATE,=,UNKNOWN_SUBSCRIBER
Conditions=DEG_SSL_STATE,=,AUTHENTICATED_BY_DEG_TOKEN
Conditions=DEG_SSL_STATE,=,AUTHENTICATED_BY_AAA
Conditions=DEG_SSL_STATE,=,AKA_CHALLENGE_REJECTED_BY_AAA
Conditions=DEG_SSL_STATE,=,AKA_CHALLENGE_REJECTED_BY_DEG_TOKEN
Operations=or,or,or,or,or
TrueRuleChain=100.InitSslSessionDelete
TrueRuleChain=110.ExecuteSslSessionDelete


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/300.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus/100.InitSslSessionDelete]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_OEMDevSSLSSDeletedInteger 1


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/222.ProcessOEMVersionCheckRuleChain/300.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus/110.ExecuteSslSessionDelete]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ExtractAndLogActionDetails
RuleNames=110.CheckHealthCheckDetails
RuleNames=200.ResetProcessedIntegerFlagForUnknownSubscriber
RuleNames=300.ValidateBody
RuleNames=400.SetProcessedIntegerFlagForUnknownSubscriber
RuleNames=500.ResetSSLSessionStatus
RuleNames=600.UnknownSubscriberProcessAction
RuleNames=610.StatusDisallowedProcessAction
RuleNames=700.ProcessAction


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/100.ExtractAndLogActionDetails]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.ExtractActionDetails
RuleNames=001.SetErrorInfo
RuleNames=002.LogStartOfActionProcessing


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/100.ExtractAndLogActionDetails/000.ExtractActionDetails]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
StructuredNMEToNMEMap=request_id.CData,DEG_OEMDevRequestIdString
StructuredNMEToNMEMap=action_name.CData,DEG_OEMDevActionNameString
StructuredNMEToNMEMap=token.CData,DEG_OEMDevRespTokenString

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/100.ExtractAndLogActionDetails/001.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0033"
AdornOps=set DEG_OEMDevMessageString "Processing OEM action:"
AdornOps=setifnull DEG_OEMDevActionNameString ""
AdornOps=copy DEG_OEMDevActionNameString DEG_AuditTransactionTypeString

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/100.ExtractAndLogActionDetails/002.LogStartOfActionProcessing]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevRespTokenString
Attributes=DEG_OEMDevResponseHandlerString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_JsonEncodeAttribute
LogLevel=DEBUG
Message=Processing OEM action: 
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/110.CheckHealthCheckDetails]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,"healthCheck"

TrueRuleChain=100.InitResponse
TrueRuleChain=200.SetSuccessResponse

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/110.CheckHealthCheckDetails/100.InitResponse]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 200
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_OEMDevRespStatusString 6000

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/110.CheckHealthCheckDetails/200.SetSuccessResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/200.ResetProcessedIntegerFlagForUnknownSubscriber]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"

Operations=or

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/200.ResetProcessedIntegerFlagForUnknownSubscriber/TrueRule]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 0


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=CheckIfRequestIdIsPopulated
TrueRuleChain=CheckIfActionNameIsPopulated
TrueRuleChain=ValidateRequestList
TrueRuleChain=CreateRequestList
TrueRuleChain=ValidateRequestAction
TrueRuleChain=CreateRequestActionList


CheckIfRequestIdIsPopulated=100.CheckIfRequestIdIsPopulated

CheckIfActionNameIsPopulated=200.CheckIfActionNameIsPopulated

ValidateRequestList=300.CheckRequestList

CreateRequestList=400.AddRequestToList

ValidateRequestAction=500.CheckRequestActionList

CreateRequestActionList=600.AddRequestActionToList


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/100.CheckIfRequestIdIsPopulated]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestIdString,=,""
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/100.CheckIfRequestIdIsPopulated/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0034"
AdornOps=set DEG_OEMDevErrorMessageString "Request Id is empty"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/100.CheckIfRequestIdIsPopulated/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevResponseHandlerString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid OEM action - request-id is empty: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Request-id Present in the Request should be Numeric and should not be empty.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/100.CheckIfRequestIdIsPopulated/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/100.CheckIfRequestIdIsPopulated/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/200.CheckIfActionNameIsPopulated]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,""
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
#KPI report statistics is based on the action name in the request.As action name is empty, audits are not required.Since its not counted #in KPI report.
#TrueRuleChain=120.GenerateStartAudit
#TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/200.CheckIfActionNameIsPopulated/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0035"
AdornOps=set DEG_OEMDevErrorMessageString "Action name is empty"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/200.CheckIfActionNameIsPopulated/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevResponseHandlerString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid OEM action - action-name is empty: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Action-Name Present in the request should not empty.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/200.CheckIfActionNameIsPopulated/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/200.CheckIfActionNameIsPopulated/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/300.CheckRequestList]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_OEMDevRequestIdList
RuleChain=100.CompareRequestId
TmpAttributeName=DEG_OEMDevTemp1String


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/300.CheckRequestList/100.CompareRequestId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestIdString,=,DEG_OEMDevTemp1String
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/300.CheckRequestList/100.CompareRequestId/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0036"
AdornOps=set DEG_OEMDevErrorMessageString "Duplicate request-id"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/300.CheckRequestList/100.CompareRequestId/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevResponseHandlerString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - duplicate request-id: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Request-id present in the request should be unique.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/300.CheckRequestList/100.CompareRequestId/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/300.CheckRequestList/100.CompareRequestId/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/400.AddRequestToList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevRequestIdString
ListAttribute=DEG_OEMDevRequestIdList


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/500.CheckRequestActionList]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_OEMDevActionNameList
RuleChain=100.CompareActionName
TmpAttributeName=DEG_OEMDevTemp1String


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/500.CheckRequestActionList/100.CompareActionName]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,DEG_OEMDevTemp1String
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/500.CheckRequestActionList/100.CompareActionName/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0037"
AdornOps=set DEG_OEMDevErrorMessageString "Duplicate request action"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/500.CheckRequestActionList/100.CompareActionName/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevResponseHandlerString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - duplicate request action: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Request - ID Present in the request should not be duplicate .

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/500.CheckRequestActionList/100.CompareActionName/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/500.CheckRequestActionList/100.CompareActionName/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/300.ValidateBody/600.AddRequestActionToList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevActionNameString
ListAttribute=DEG_OEMDevActionNameList


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/400.SetProcessedIntegerFlagForUnknownSubscriber]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"

Operations=or

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/400.SetProcessedIntegerFlagForUnknownSubscriber/TrueRule]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/500.ResetSSLSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,!=,0
Conditions=DEG_SSL_STATE,!=,"WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA"
Conditions=DEG_SSL_STATE,!=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,!=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,!=,"DISALLOWED_ACTION"
Operations=and,and,and,and
TrueRuleChain=100.ResetSslStateToNew


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/500.ResetSSLSessionStatus/100.ResetSslStateToNew]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_STATE "NEW"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/600.UnknownSubscriberProcessAction]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
TrueRuleChain=100.SetUnknowSubscriberResponse
TrueRuleChain=110.SendUnknowSubscriberResponse


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/600.UnknownSubscriberProcessAction/100.SetUnknowSubscriberResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/600.UnknownSubscriberProcessAction/110.SendUnknowSubscriberResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/610.StatusDisallowedProcessAction]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
TrueRuleChain=100.SetDisallowedActionResponse
TrueRuleChain=110.SendDisallowedActionResponse


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/610.StatusDisallowedProcessAction/100.SetDisallowedActionResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/610.StatusDisallowedProcessAction/110.SendDisallowedActionResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.LookUpSslSession
TrueRuleChain=120.CheckSslSessionLookupStatus


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/100.LookUpSslSession]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevNeedLookUPSessionInteger,=,1
TrueRuleChain=100.InitSslSessionLookup
TrueRuleChain=110.ExecuteSslSessionLookup
TrueRuleChain=120.BackUPSessionFlags
FalseRuleChain=200.CopyToSSFlags


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/100.LookUpSslSession/200.CopyToSSFlags]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevSSTempErrorFlagInteger DEG_CDevSessionStoreErrorFlagInteger
AdornOps=copy DEG_CDevSSTempKeyExistsFlagInteger DEG_CDevSessionStoreKeyExistsFlagInteger


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/100.LookUpSslSession/100.InitSslSessionLookup]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_OEMDevNeedLookUPSessionInteger 0


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/100.LookUpSslSession/110.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_ID_PROV_STATUS,DEG_SSL_ID_PROV_STATUS
MapAttributes=DEG_SSL_GW_ADDR,DEG_SSL_GW_ADDR
MapAttributes=DEG_SSL_ADDRESS_UPDATE_URL,DEG_SSL_ADDRESS_UPDATE_URL
MapAttributes=DEG_SSL_ADDRESS_STATUS,DEG_SSL_ADDRESS_STATUS
MapAttributes=DEG_SSL_TC_STATUS,DEG_SSL_TC_STATUS
MapAttributes=DEG_SSL_POSTDATA,DEG_SSL_POSTDATA
MapAttributes=DEG_SSL_EntitlementStatus,DEG_SSL_EntitlementStatus
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/100.LookUpSslSession/120.BackUPSessionFlags]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevSessionStoreErrorFlagInteger DEG_CDevSSTempErrorFlagInteger
AdornOps=copy DEG_CDevSessionStoreKeyExistsFlagInteger DEG_CDevSSTempKeyExistsFlagInteger


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_SSL_REQUEST_STATE,=,"NEW"
Conditions=DEG_SSL_REQUEST_STATE,within,[400C,500C]
Conditions=DEG_SSL_REQUEST_STATE,within,[200,200C]
Conditions=DEG_SSL_REQUEST_STATE,=,DEG_SSL_REQUEST_STATE

TrueRuleChain=SystemError
TrueRuleChain=NoSslSession
TrueRuleChain=NewRequest
TrueRuleChain=RequestError
TrueRuleChain=RequestOk
TrueRuleChain=UnknownStatus

SystemError=96.SystemErrorInfo
SystemError=100.SystemErrorLog
SystemError=110.SetSslRequestState_500C
SystemError=120.GenerateStartAudit
SystemError=130.GenerateErrorEndAudit

NoSslSession=195.NoSslSessionErrorInfo
NoSslSession=200.NoSslSessionLog
NoSslSession=210.SetSslRequestState_500C
NoSslSession=220.GenerateStartAudit
NoSslSession=230.GenerateErrorEndAudit

NewRequest=300.NewRequest_CheckSslSessionStatus

RequestError=355.RequestErrorInfo
RequestError=400.RequestErrorLog

RequestOk=500.RequestOk_CheckSslSessionStatus

UnknownStatus=550.UnknownStatusErrorLog
UnknownStatus=600.UnknownStatusLog
UnknownStatus=610.SetSslRequestState_500C

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/96.SystemErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0038"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to lookup or access DEG_SSL_SESSION table"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/100.SystemErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access DEG_SSL_SESSION table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/110.SetSslRequestState_500C]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "500C"

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/195.NoSslSessionErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0039"
AdornOps=set DEG_OEMDevErrorMessageString "Internal system error as SSL Session does exist in DEG_SSL_SESSION store:"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/200.NoSslSessionLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=WARNING
Message=Internal system error as SSL Session does exist in DEG_SSL_SESSION store: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/210.SetSslRequestState_500C]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "500C"

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/220.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/230.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/300.NewRequest_CheckSslSessionStatus]


ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_SSL_STATE,=,"NEW"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE

TrueRuleChain=NewSslSession
TrueRuleChain=AkaWait
TrueRuleChain=UnknownSslSessionState

NewSslSession=100.NewSslSession_ProcessAction

AkaWait=200.AkaWait_ProcessAction

UnknownSslSessionState=300.Unknown_UpdateRequestStateTo500C


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/300.NewRequest_CheckSslSessionStatus/100.NewSslSession_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=204.ProcessOEMGetAuthenticationRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/300.NewRequest_CheckSslSessionStatus/200.AkaWait_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=205.ProcessOEMPostChallengeRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/300.NewRequest_CheckSslSessionStatus/300.Unknown_UpdateRequestStateTo500C]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=210.CheckSslSessionUpdateStatus


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/300.NewRequest_CheckSslSessionStatus/300.Unknown_UpdateRequestStateTo500C/100.InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_REQUEST_STATE "500C"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/300.NewRequest_CheckSslSessionStatus/300.Unknown_UpdateRequestStateTo500C/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/300.NewRequest_CheckSslSessionStatus/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus]


ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=SystemErrorLog
TrueRuleChain=RowNotExistsLog

SystemErrorLog=95.SystemErrorInfo
SystemErrorLog=100.SystemErrorLog
SystemErrorLog=120.GenerateErrorEndAudit
RowNotExistsLog=125.RowNotExistsLogErrorInfo
RowNotExistsLog=200.RowNotExistsLog

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/300.NewRequest_CheckSslSessionStatus/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/95.SystemErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0040"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: System error while Connecting DEG_SSL_SESSION store while Processing request"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/300.NewRequest_CheckSslSessionStatus/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/100.SystemErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
LogLevel=CRITICAL
Message=Database Error: System error while Connecting DEG_SSL_SESSION store while Processing request
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/300.NewRequest_CheckSslSessionStatus/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/120.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=507.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/300.NewRequest_CheckSslSessionStatus/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/125.RowNotExistsLogErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0041"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION store while Processing Request"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/300.NewRequest_CheckSslSessionStatus/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.RowNotExistsLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store while Processing Request
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Check whether TimesTen is up. If it is up, Then there is no row found.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/355.RequestErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0042"
AdornOps=set DEG_OEMDevErrorMessageString "Skipping processing OEM action - request is in error state:"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/400.RequestErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
LogLevel=WARNING
Message=Skipping processing OEM action - request is in error state: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus]
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
#Fix for QXCM1001521530 -- Value set in custom template is not reflecting in the getauth response
Conditions=DEG_SSL_STATE,within,[DISALLOWED_ACTION,UNKNOWN_DEVICE]
Conditions=DEG_SSL_STATE,starts,"AUTHENTICATED"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE

TrueRuleChain=UnknownSubscriber
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=StatusDisallowed
TrueRuleChain=Authenticated
TrueRuleChain=Unknown

UnknownSubscriber=100.UnknownSubscriber_ProcessAction

AkaWait=200.AkaWait_InitResponse
AkaWait=210.AkaWait_GenerateResponse

AkaRejected=300.AkaRejected_InitResponse
AkaRejected=310.AkaRejected_GenerateResponse

Authenticated=400.Authenticated_ProcessAction

Unknown=500.Unknown_UpdateRequestStateTo500C

StatusDisallowed=600.DisallowedAction_InitResponse
StatusDisallowed=610.DisallowedAction_GenerateResponse


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=200.ExtractActionDetails
RuleNames=300.ValidateAndGenerateResponse
RuleNames=400.UpdateSslSessionState


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/100.InitWorkingVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 0


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/200.ExtractActionDetails]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
StructuredNMEToNMEMap=request_id.CData,DEG_OEMDevRequestIdString,""
StructuredNMEToNMEMap=action_name.CData,DEG_OEMDevActionNameString,""


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=CheckIfRequestIdIsPopulated
TrueRuleChain=CheckIfActionNameIsPopulated
TrueRuleChain=CheckIfUnqIdAndAction
TrueRuleChain=InitResponse
TrueRuleChain=GenerateResponse

CheckIfRequestIdIsPopulated=100.CheckIfRequestIdIsPopulated

CheckIfActionNameIsPopulated=200.CheckIfActionNameIsPopulated

CheckIfUnqIdAndAction=300.CheckIfUnqIdAndAction

InitResponse=400.AddActionToList
InitResponse=410.InitResponse

GenerateResponse=500.GenerateResponse


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestIdString,=,""
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0043"
AdornOps=set DEG_OEMDevErrorMessageString "Request Id is empty"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - request-id is empty: 
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Request-ID should not be empty which is present in the request .

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,""
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0044"
AdornOps=set DEG_OEMDevErrorMessageString "Action name is empty"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - action-name is empty: 
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Action-Name Present in the request should not empty.

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitValues
RuleNames=110.CheckListAttr


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/100.InitValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevRequestIdString DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString _ DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString DEG_OEMDevActionNameString DEG_OEMDevRequestIdAndNameString


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_OEMDevRequestIdAndNameList
RuleChain=100.CompareRequestName
TmpAttributeName=DEG_OEMDevTmpRequestIdAndNameString


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestIdAndNameString,=,DEG_OEMDevTmpRequestIdAndNameString
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0045"
AdornOps=set DEG_OEMDevErrorMessageString "Duplicate request-id or Action Name"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=WARNING
Message=Request processed with error -  request-id and request-name are not unique
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Request-id and Request -Name are not unique in the Request parameter.


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse/400.AddActionToList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevRequestIdAndNameString
ListAttribute=DEG_OEMDevRequestIdAndNameList


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse/410.InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/300.ValidateAndGenerateResponse/500.GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/400.UpdateSslSessionState]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=210.CheckSslSessionUpdateStatus


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/400.UpdateSslSessionState/100.InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/400.UpdateSslSessionState/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/400.UpdateSslSessionState/210.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=SystemErrorLog
TrueRuleChain=RowNotExistsLog

SystemErrorLog=100.SetErrorInfo
SystemErrorLog=100.SystemErrorLog

RowNotExistsLog=200.SetErrorInfo
RowNotExistsLog=200.RowNotExistsLog

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/400.UpdateSslSessionState/210.CheckSslSessionUpdateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0046"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: in updating DEG_SSL_SESSION store"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/400.UpdateSslSessionState/210.CheckSslSessionUpdateStatus/100.SystemErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Database Error: in updating DEG_SSL_SESSION store
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/400.UpdateSslSessionState/210.CheckSslSessionUpdateStatus/200.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0047"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION store while Processing Request"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/100.UnknownSubscriber_ProcessAction/400.UpdateSslSessionState/210.CheckSslSessionUpdateStatus/200.RowNotExistsLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
ClassName=LogNMERule
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store while Processing Request
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Check whether TimesTen is up. If it is up, Then there is no row found.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/200.AkaWait_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/210.AkaWait_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/300.AkaRejected_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/310.AkaRejected_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/600.DisallowedAction_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/610.DisallowedAction_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=200.ExtractActionDetails
RuleNames=300.ValidateAndGenerateResponse
RuleNames=400.UpdateSslSessionState


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/100.InitWorkingVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=set DEG_SSL_REQUEST_STATE "200C"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/200.ExtractActionDetails]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
StructuredNMEToNMEMap=request_id.CData,DEG_OEMDevRequestIdString,""
StructuredNMEToNMEMap=action_name.CData,DEG_OEMDevActionNameString,""

#start from here
[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=CheckIfRequestIdIsPopulated
TrueRuleChain=CheckIfActionNameIsPopulated
TrueRuleChain=CheckIfUnqIdAndAction
TrueRuleChain=InitResponse

CheckIfRequestIdIsPopulated=100.CheckIfRequestIdIsPopulated

CheckIfActionNameIsPopulated=200.CheckIfActionNameIsPopulated

CheckIfUnqIdAndAction=300.CheckIfUnqIdAndAction

InitResponse=400.AddActionToList
InitResponse=410.IdentifyActionTypeAndProcess


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestIdString,=,""
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0048"
AdornOps=set DEG_OEMDevErrorMessageString "Request Id is empty"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - request-id is empty: 
PropertyName=LogRequestIssueLevel1
UseProperty=true

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,""
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0049"
AdornOps=set DEG_OEMDevErrorMessageString "Action name is empty"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - action-name is empty: 
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Action-Name Present in the request should not empty.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitValues
RuleNames=110.CheckListAttr


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/100.InitValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevRequestIdString DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString _ DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString DEG_OEMDevActionNameString DEG_OEMDevRequestIdAndNameString


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_OEMDevRequestIdAndNameList
RuleChain=100.CompareRequestName
TmpAttributeName=DEG_OEMDevTmpRequestIdAndNameString


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestIdAndNameString,=,DEG_OEMDevTmpRequestIdAndNameString
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0050"
AdornOps=set DEG_OEMDevErrorMessageString "Duplicate request-id or Action Name"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - request-id and request-name are not unique.
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Request-id and Request-name Present in the request should be unique.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/400.AddActionToList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevRequestIdAndNameString
ListAttribute=DEG_OEMDevRequestIdAndNameList


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_OEMDevActionNameString,within,[getAuthentication,postChallenge]
Conditions=DEG_OEMDevActionNameString,=,"getPhoneNumber"
Conditions=DEG_OEMDevActionNameString,=,"getEntitlement"
Conditions=DEG_OEMDevActionNameString,=,"updatePushToken"
Conditions=DEG_OEMDevActionNameString,=,"getSubscriptionAndUsageStatus"
Conditions=DEG_OEMDevActionNameString,=,"setEntitlement"
Conditions=DEG_OEMDevActionNameString,=,"getPreferredRoamingNetworks"
Conditions=DEG_OEMDevActionNameString,=,"getCarrierSpaceUpdates"
Conditions=DEG_OEMDevActionNameString,=,"updateAccountWithFeatureOrService"
Conditions=DEG_OEMDevActionNameString,=,DEG_OEMDevActionNameString

TrueRuleChain=AUTH
TrueRuleChain=GPN
TrueRuleChain=GE
TrueRuleChain=PT
TrueRuleChain=GSAUS
TrueRuleChain=SE
TrueRuleChain=GPRN
TrueRuleChain=GCSU
TrueRuleChain=UAWFOS
TrueRuleChain=Unknown

AUTH=100.AUTH_InitResponse
AUTH=110.AUTH_GenerateResponseEntry


GPN=200.ProcessGetPhoneNumberAction

GE=300.ProcessGetEntitlementAction

PT=400.ProcessUpdatePushTokenAction

GSAUS=500.ProcessGetSubscriptionAndUsageStatusAction
SE=410.ProcessSetEntitlementAction

GPRN=700.ProcessGetPreferredRoamingNetworks
GCSU=800.ProcessGetCarrierSpaceUpdates

UAWFOS=900.ProcessUpdateAccountWithFeatureOrService


Unknown=600.Unknown_InitResponse
Unknown=610.Unknown_GenerateResponseEntry

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/900.ProcessUpdateAccountWithFeatureOrService]


ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=333.ProcessOEMUpdateAccountWithFeatureOrService
UseRuleChainManagerPool=true



[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/800.ProcessGetCarrierSpaceUpdates]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=514.ProcessOEMGetCarrierSpaceUpdatesRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/700.ProcessGetPreferredRoamingNetworks]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=220.DEG32ProcessOEMGetPreferredRoamingNetworsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/410.ProcessSetEntitlementAction]


ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=214.DEG20ProcessOEMSetEntitlementRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/100.AUTH_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/110.AUTH_GenerateResponseEntry]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/200.ProcessGetPhoneNumberAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=206.ProcessOEMGetPhoneNumberRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/300.ProcessGetEntitlementAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=207.ProcessOEMGetEntitlementRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/400.ProcessUpdatePushTokenAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=208.ProcessOEMUpdatePushTokenRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/500.ProcessGetSubscriptionAndUsageStatusAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=209.ProcessOEMGetSubscriptionAndUsageStatusRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/600.Unknown_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6001


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/300.ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/610.Unknown_GenerateResponseEntry]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/400.UpdateSslSessionState]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSSLSSDeletedInteger,=,0
TrueRuleChain=100.InitSslSessionUpdate
TrueRuleChain=200.ExecuteSslSessionUpdate
TrueRuleChain=300.CheckSslSessionUpdateStatus


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/400.UpdateSslSessionState/100.InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/400.UpdateSslSessionState/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_STATE,DEG_SSL_AAA_STATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/400.UpdateSslSessionState/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=SystemErrorLog
TrueRuleChain=RowNotExistsLog

SystemErrorLog=97.SystemErrorInfo
SystemErrorLog=100.SystemErrorLog

RowNotExistsLog=155.RowNotExistsErrorInfo
RowNotExistsLog=200.RowNotExistsLog

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/400.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/97.SystemErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0051"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: while updating DEG_SSL_SESSION store while Processing the Request"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/400.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/100.SystemErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store while Processing the Request
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/400.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/155.RowNotExistsErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0052"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/400.Authenticated_ProcessAction/400.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.RowNotExistsLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/500.Unknown_UpdateRequestStateTo500C]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=300.CheckSslSessionUpdateStatus


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/500.Unknown_UpdateRequestStateTo500C/100.InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_REQUEST_STATE "500C"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/500.Unknown_UpdateRequestStateTo500C/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/500.Unknown_UpdateRequestStateTo500C/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=SystemErrorLog
TrueRuleChain=RowNotExistsLog

SystemErrorLog=98.SystemErrorInfo
SystemErrorLog=100.SystemErrorLog
SystemErrorLog=120.GenerateStartAudit
SystemErrorLog=130.GenerateErrorEndAudit
RowNotExistsLog=156.RowNotExistsErrorLog
RowNotExistsLog=200.RowNotExistsLog

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/500.Unknown_UpdateRequestStateTo500C/300.CheckSslSessionUpdateStatus/98.SystemErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0053"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: while updating DEG_SSL_SESSION store while Processing the Request"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/500.Unknown_UpdateRequestStateTo500C/300.CheckSslSessionUpdateStatus/100.SystemErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_SSL_STATE
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store while Processing the Request
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/500.Unknown_UpdateRequestStateTo500C/300.CheckSslSessionUpdateStatus/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/500.Unknown_UpdateRequestStateTo500C/300.CheckSslSessionUpdateStatus/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/500.Unknown_UpdateRequestStateTo500C/300.CheckSslSessionUpdateStatus/156.RowNotExistsErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0054"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION store while Processing the Request"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/500.RequestOk_CheckSslSessionStatus/500.Unknown_UpdateRequestStateTo500C/300.CheckSslSessionUpdateStatus/200.RowNotExistsLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_SSL_STATE
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store while Processing the Request
PropertyName=LogRequestIssueLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/550.UnknownStatusErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0055"
AdornOps=set DEG_OEMDevErrorMessageString "Action processed with error - SSL SESSION is in inconsistent state"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/600.UnknownStatusLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=WARNING
Message=Action processed with error - SSL SESSION is in inconsistent state
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/202.ProcessOEMRequestRuleChain/700.ProcessAction/120.CheckSslSessionLookupStatus/610.SetSslRequestState_500C]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "500C"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain]

ClassName=RuleChain
RuleNames=100.SetParametersOfHttpResponse
RuleNames=200.CheckIfDeleteSSLSession


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_OEMDevHttpErrorMessageString,contains,"Unsupported"
Conditions=DEG_OEMDevHttpErrorNameString,contains,DecodeException
Conditions=DEG_OEMDevHttpErrorNameString,contains,XMLStreamException
Conditions=DEG_SSL_REQUEST_STATE,=,"400C"
Conditions=DEG_SSL_REQUEST_STATE,=,"500C"
Conditions=DEG_SSL_REQUEST_STATE,=,"401C"
Conditions=DEG_SSL_REQUEST_STATE,=,"403C"
Conditions=DEG_SSL_REQUEST_STATE,=,"503C"
Conditions=DEG_SSL_REQUEST_STATE,=,DEG_SSL_REQUEST_STATE

TrueRuleChain=GzipParseError
TrueRuleChain=JsonParseError
TrueRuleChain=JsonParseError2
TrueRuleChain=Http400C
TrueRuleChain=Http500C
TrueRuleChain=Http401C
TrueRuleChain=Http403C
TrueRuleChain=Http503C
TrueRuleChain=HttpUnknown

GzipParseError=100.GzipParseError_SetHttpResponse
GzipParseError=110.GzipParseError_LogResponse

JsonParseError=200.JsonParseError_SetHttpResponse
JsonParseError=210.JsonParseError_LogResponse

JsonParseError2=200.JsonParseError_SetHttpResponse
JsonParseError2=210.JsonParseError_LogResponse

Http400C=300.Http400C_SetHttpResponse
Http400C=310.Http400C_LogResponse

Http500C=400.Http500C_SetHttpResponse
Http500C=410.Http500C_LogResponse

Http401C=000.Http401C_SetHttpResponse
Http401C=000.Http401C_LogResponse

Http403C=000.Http403C_SetHttpResponse
Http403C=000.Http403C_LogResponse

Http503C=600.Http503C_SetHttpResponse
Http503C=610.Http503C_LogResponse

HttpUnknown=500.HttpUnknown_SetHttpResponse
HttpUnknown=510.HttpUnknown_LogResponse


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/100.GzipParseError_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 400
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0056"
AdornOps=set DEG_OEMDevErrorMessageString "GZIP decopmressing error - request processed with http status 400 and http session closed"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/110.GzipParseError_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=WARNING
Message=GZIP decopmressing error - request processed with http status 400 and http session closed: 
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Request processed with http status 400 and http session is closed .Please contact HP Admin.

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/200.JsonParseError_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 400
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0057"
AdornOps=set DEG_OEMDevErrorMessageString "JSON parsing error - request processed with http status 400 and http session closed"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/210.JsonParseError_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=WARNING
Message=JSON parsing error - request processed with http status 400 and http session closed: 
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/300.Http400C_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 400
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0058"
Attributes=DEG_JsonEncodeAttribute
AdornOps=set DEG_OEMDevErrorMessageString "Invalid request – Response is http status 400 and http session closed"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/310.Http400C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_JsonEncodeAttribute
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=WARNING
Message=Invalid request – Response is http status 400 and http session closed
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/400.Http500C_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0059"
Attributes=DEG_JsonEncodeAttribute
AdornOps=set DEG_OEMDevErrorMessageString "Internal error – Response is http status 500 and http session closed"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/410.Http500C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_JsonEncodeAttribute
LogLevel=WARNING
Message=Internal error – Response is http status 500 and http session closed
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/000.Http401C_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 401
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0060"
Attributes=DEG_JsonEncodeAttribute
AdornOps=set DEG_OEMDevErrorMessageString "Invalid request Response is http status 401 and http session closed"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/000.Http401C_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=GZIP decopmressing error - request processed with http status 401 and http session closed:
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/000.Http403C_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 403
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
#AdornOps=set DEG_OEMDevEncodingString "gzip"
#AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0061"
Attributes=DEG_JsonEncodeAttribute
AdornOps=set DEG_OEMDevErrorMessageString "Invalid request Response is http status 403 and http session closed"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/000.Http403C_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=GZIP decopmressing error - request processed with http status 403 and http session closed:
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/600.Http503C_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 503
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
#AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0062"
Attributes=DEG_JsonEncodeAttribute
AdornOps=set DEG_OEMDevErrorMessageString "Invalid request Response is http status 503 and http session closed"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/610.Http503C_LogResponse]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=GZIP decopmressing error - request processed with http status 503 and http session closed:
PropertyName=LogRequestIssueLevel1
UseProperty=true



[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/500.HttpUnknown_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0063"
AdornOps=set DEG_OEMDevErrorMessageString "Unrecognized internal state - request processed with http status 500 and http session closed"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/510.HttpUnknown_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_JsonEncodeAttribute
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=WARNING
Message=Unrecognized internal state - request processed with http status 500 and http session closed: 
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/200.CheckIfDeleteSSLSession]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSSLSSDeletedInteger,=,0
TrueRuleChain=100.CheckSSLSessionStatus

#DEG_SSL_SESSION is not delete after session is done.Issue from DEG3.0 we have given fix for DEGDROID_DeviceInterface.cfg and same added for DEG_DeviceInterface.cfg
[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/200.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"NEW"
Conditions=DEG_SSL_STATE,=,UNKNOWN_SUBSCRIBER
Conditions=DEG_SSL_STATE,=,AUTHENTICATED_BY_DEG_TOKEN
Conditions=DEG_SSL_STATE,=,AUTHENTICATED_BY_AAA
Conditions=DEG_SSL_STATE,=,AKA_CHALLENGE_REJECTED_BY_AAA
Conditions=DEG_SSL_STATE,=,AKA_CHALLENGE_REJECTED_BY_DEG_TOKEN
Operations=or,or,or,or,or
TrueRuleChain=100.InitSslSessionDelete
TrueRuleChain=110.ExecuteSslSessionDelete


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/200.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus/100.InitSslSessionDelete]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_OEMDevSSLSSDeletedInteger 1


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/203.ProcessOEMParsingErrorRuleChain/200.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus/110.ExecuteSslSessionDelete]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/600.GenerateAuditAndNRBEventsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpAuditRecord
RuleNames=200.DumpMonitoringTransactions


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/600.GenerateAuditAndNRBEventsRuleChain/100.DumpAuditRecord]

ClassName=com.hp.siu.sessionserver.rules.NMEStoreRule
NMEStore=AuditNmeStore


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/600.GenerateAuditAndNRBEventsRuleChain/200.DumpMonitoringTransactions]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_NrbMonitoringSessionIdList
RequestAttributes=DEG_AuditProcessingNodeString
RequestAttributes=DEG_AuditTimestampLong
RequestAttributes=DEG_AuditInterfaceString
RequestAttributes=DEG_AuditInOutString
RequestAttributes=DEG_AuditResultCodeString
RequestAttributes=DEG_AuditMdnString
RequestAttributes=DEG_AuditIMSIString
RequestAttributes=DEG_AuditTransactionTypeString
RequestAttributes=DEG_AuditSourceDestinationString
RequestAttributes=DEG_AuditNRBMessageString
RequestAttributes=DEG_AuditMessageString
RuleChain=601.DumpMonitoringTransactionsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpMonitoringTransactions


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.DumpMonitoringTransactions


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_NrbMonitoringSessionIdList != null


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_NrbMonitoringSessionIdList
RuleChain=100.InsertMonitoringTransactionToDb
TmpAttributeName=DEG_NrbMonitoringSessionIdString



[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORINGID_GENERATOR


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateTransactionId
RuleNames=110.PopulateMonitoringTransactionAttributes
RuleNames=120.InitInsert2Db
RuleNames=200.Insert2Db
RuleNames=300.CheckCreateStatus


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/100.GenerateTransactionId]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_Tmp1Long
AdornOps=copy DEG_Tmp1Long DEG_Tmp1String
AdornOps=+ DEG_Tmp1String DEG_MSESSIONTRANSID DEG_MSESSIONTRANSID


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/110.PopulateMonitoringTransactionAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_AuditProcessingNodeString DEG_MSESSIONPROCID
AdornOps=copy DEG_AuditTimestampLong DEG_MSESSIONTIMESTAMP
AdornOps=copy DEG_AuditInterfaceString DEG_MSESSIONINTERFACE
AdornOps=copy DEG_AuditInOutString DEG_MSESSIONINOUT
AdornOps=copy DEG_AuditResultCodeString DEG_MSESSIONRESULTCODE
AdornOps=copy DEG_AuditMdnString DEG_MSESSIONMDN
AdornOps=copy DEG_AuditIMSIString DEG_MSESSIONIMSI
AdornOps=copy DEG_AuditTransactionTypeString DEG_MSESSIONTRANSACTIONTYPE
AdornOps=copy DEG_AuditSourceDestinationString DEG_MSESSIONSOURCEDESTINATION
AdornOps=copy DEG_AuditNRBMessageString DEG_MSESSIONMESSAGE
AdornOps=set DEG_MSESSIONUNIQUE_ID ""


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/120.InitInsert2Db]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_NrbMonitoringSessionIdString DEG_MSESSIONID
AdornOps=set log_DB_Operation "CREATE"
AdornOps=set log_Table_Name "DEG_MONITORING_TRANSACTIONS"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/200.Insert2Db]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_MONITORING_TRANSACTIONS_SessionStore


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
Operations=or
TrueRuleChain=99.SetErrorInfo
TrueRuleChain=100.ErrorLog

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus/99.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0064"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error: Unable to create entry in DEG_MONITORING_TRANSACTIONS session store"

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus/100.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_MSESSIONID
Attributes=DEG_JsonEncodeAttribute
Attributes=DEG_MSESSIONTRANSID
Attributes=DEG_MSESSIONPROCID
Attributes=DEG_MSESSIONTIMESTAMP
Attributes=DEG_MSESSIONINTERFACE
Attributes=DEG_MSESSIONINOUT
Attributes=DEG_MSESSIONRESULTCODE
Attributes=DEG_MSESSIONMDN
Attributes=DEG_MSESSIONTRANSACTIONTYPE
Attributes=DEG_MSESSIONSOURCEDESTINATION
Attributes=DEG_MSESSIONMESSAGE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=ERROR
Message=Database Error: Unable to create entry in DEG_MONITORING_TRANSACTIONS session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetEmptyTransactionId
RuleNames=154.InitErrorLog
RuleNames=200.Log


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/100.SetEmptyTransactionId]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_MSESSIONTRANSID ""

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/154.InitErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0065"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to generate unique value of monitoring transaction id:"


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/200.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_MSESSIONTRANSID
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=ERROR
Message=Unable to generate unique value of monitoring transaction id: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckAvailabilityStatus


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll
Conditions=DEG_OEMDevSubsVoiceSourceFlagInteger,=,0
Conditions=DEG_OEMDevSubsMsgSourceFlagInteger,=,0
Conditions=DEG_OEMDevSubsDataSourceFlagInteger,=,0
Conditions=DEG_OEMDevSubsAccInfoSourceFlagInteger,=,0
Conditions=DEG_OEMDevUsageVoiceSourceFlagInteger,=,0
Conditions=DEG_OEMDevUsageDataSourceFlagInteger,=,0
Conditions=DEG_OEMDevUsageMsgSourceFlagInteger,=,0


TrueRuleChain=SubscriptionVoiceNotAvailable
TrueRuleChain=SubscriptionMessageNotAvailable
TrueRuleChain=SubscriptionDataNotAvailable
TrueRuleChain=SubscriptionAccInfoNotAvailable
TrueRuleChain=UsageVoiceNotAvailable
TrueRuleChain=UsageDataNotAvailable
TrueRuleChain=UsageMessageNotAvailable


SubscriptionVoiceNotAvailable=100.EaiSubscriptionVoiceNotAvailable
SubscriptionMessageNotAvailable=200.EaiSubscriptionMessageNotAvailable
SubscriptionDataNotAvailable=300.EaiSubscriptionDataNotAvailable
SubscriptionAccInfoNotAvailable=400.EaiSubscriptionAccInfoNotAvailable
UsageVoiceNotAvailable=500.EaiUsageVoiceNotAvailable
UsageDataNotAvailable=600.EaiUsageDataNotAvailable
UsageMessageNotAvailable=700.EaiUsageMessageNotAvailable


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/100.EaiSubscriptionVoiceNotAvailable]


ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubsVoiceInFlagInteger,=,1
TrueRuleChain=100.SetEaiSubscriptionVoiceNotAvailableReponse

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/100.EaiSubscriptionVoiceNotAvailable/100.SetEaiSubscriptionVoiceNotAvailableReponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.SetStatusCode
RuleNames=120.SetResponseStatus
RuleNames=130.SetResponseForLog


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/100.EaiSubscriptionVoiceNotAvailable/100.SetEaiSubscriptionVoiceNotAvailableReponse/110.SetStatusCode]

AdornOps=set DEG_OEMDevRespStatusString 6201
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/100.EaiSubscriptionVoiceNotAvailable/100.SetEaiSubscriptionVoiceNotAvailableReponse/120.SetResponseStatus]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.account_info_response.subscription_info.voice.status_code.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/100.EaiSubscriptionVoiceNotAvailable/100.SetEaiSubscriptionVoiceNotAvailableReponse/130.SetResponseForLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp3String "RespSubsVoice: "
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr DEG_Tmp3String DEG_OEMDevSubscriptionTypeListToStr
AdornOps=set DEG_Tmp3String "Status="
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr DEG_Tmp3String DEG_OEMDevSubscriptionTypeListToStr
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr DEG_OEMDevRespStatusString DEG_OEMDevSubscriptionTypeListToStr
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr ; DEG_OEMDevSubscriptionTypeListToStr


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/200.EaiSubscriptionMessageNotAvailable]


ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubsMsgInFlagInteger,=,1
TrueRuleChain=200.EaiSubscriptionMessageNotAvailableresponse

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/200.EaiSubscriptionMessageNotAvailable/200.EaiSubscriptionMessageNotAvailableresponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.SetStatusCode
RuleNames=120.SetResponseStatus
RuleNames=130.SetResponseForLog


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/200.EaiSubscriptionMessageNotAvailable/200.EaiSubscriptionMessageNotAvailableresponse/110.SetStatusCode]

AdornOps=set DEG_OEMDevRespStatusString 6201
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/200.EaiSubscriptionMessageNotAvailable/200.EaiSubscriptionMessageNotAvailableresponse/120.SetResponseStatus]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.account_info_response.subscription_info.message.status_code.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/200.EaiSubscriptionMessageNotAvailable/200.EaiSubscriptionMessageNotAvailableresponse/130.SetResponseForLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp3String "RespSubsMessage: "
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr DEG_Tmp3String DEG_OEMDevSubscriptionTypeListToStr
AdornOps=set DEG_Tmp3String "Status="
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr DEG_Tmp3String DEG_OEMDevSubscriptionTypeListToStr
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr DEG_OEMDevRespStatusString DEG_OEMDevSubscriptionTypeListToStr
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr ; DEG_OEMDevSubscriptionTypeListToStr


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/300.EaiSubscriptionDataNotAvailable]


ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubsDataInFlagInteger,=,1
TrueRuleChain=300.EaiSubscriptionDataNotAvailableResponse

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/300.EaiSubscriptionDataNotAvailable/300.EaiSubscriptionDataNotAvailableResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.SetStatusCode
RuleNames=120.SetResponseStatus
RuleNames=130.SetResponseForLog


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/300.EaiSubscriptionDataNotAvailable/300.EaiSubscriptionDataNotAvailableResponse/110.SetStatusCode]

AdornOps=set DEG_OEMDevRespStatusString 6201
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/300.EaiSubscriptionDataNotAvailable/300.EaiSubscriptionDataNotAvailableResponse/120.SetResponseStatus]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.account_info_response.subscription_info.data.status_code.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/300.EaiSubscriptionDataNotAvailable/300.EaiSubscriptionDataNotAvailableResponse/130.SetResponseForLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp3String "RespSubsData: "
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr DEG_Tmp3String DEG_OEMDevSubscriptionTypeListToStr
AdornOps=set DEG_Tmp3String "Status="
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr DEG_Tmp3String DEG_OEMDevSubscriptionTypeListToStr
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr DEG_OEMDevRespStatusString DEG_OEMDevSubscriptionTypeListToStr
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr ; DEG_OEMDevSubscriptionTypeListToStr


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/400.EaiSubscriptionAccInfoNotAvailable]


ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubsAccInfoInFlagInteger,=,1
TrueRuleChain=400.EaiSubscriptionAccInfoNotAvailableResponse

[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/400.EaiSubscriptionAccInfoNotAvailable/400.EaiSubscriptionAccInfoNotAvailableResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.SetStatusCode
RuleNames=120.SetResponseStatus
RuleNames=130.SetResponseForLog


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/400.EaiSubscriptionAccInfoNotAvailable/400.EaiSubscriptionAccInfoNotAvailableResponse/110.SetStatusCode]

AdornOps=set DEG_OEMDevRespStatusString 6201
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/400.EaiSubscriptionAccInfoNotAvailable/400.EaiSubscriptionAccInfoNotAvailableResponse/120.SetResponseStatus]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.account_info_response.subscription_info.account_info.status_code.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/400.EaiSubscriptionAccInfoNotAvailable/400.EaiSubscriptionAccInfoNotAvailableResponse/130.SetResponseForLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp3String "RespSubsAccInfo: "
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr DEG_Tmp3String DEG_OEMDevSubscriptionTypeListToStr
AdornOps=set DEG_Tmp3String "Status="
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr DEG_Tmp3String DEG_OEMDevSubscriptionTypeListToStr
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr DEG_OEMDevRespStatusString DEG_OEMDevSubscriptionTypeListToStr
AdornOps=+ DEG_OEMDevSubscriptionTypeListToStr ; DEG_OEMDevSubscriptionTypeListToStr


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/500.EaiUsageVoiceNotAvailable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.SetStatusCode
RuleNames=120.SetResponseStatus
RuleNames=130.SetResponseForLog


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/500.EaiUsageVoiceNotAvailable/110.SetStatusCode]

AdornOps=set DEG_OEMDevRespStatusString 6201
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/500.EaiUsageVoiceNotAvailable/120.SetResponseStatus]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.account_info_response.usage_info.voice[0].status_code.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/500.EaiUsageVoiceNotAvailable/130.SetResponseForLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp3String "RespUsageVoice: "
AdornOps=+ DEG_OEMDevUsageTypeListToStr DEG_Tmp3String DEG_OEMDevUsageTypeListToStr
AdornOps=set DEG_Tmp3String "Status="
AdornOps=+ DEG_OEMDevUsageTypeListToStr DEG_Tmp3String DEG_OEMDevUsageTypeListToStr
AdornOps=+ DEG_OEMDevUsageTypeListToStr DEG_OEMDevRespStatusString DEG_OEMDevUsageTypeListToStr
AdornOps=+ DEG_OEMDevUsageTypeListToStr ; DEG_OEMDevUsageTypeListToStr


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/600.EaiUsageDataNotAvailable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.SetStatusCode
RuleNames=120.SetResponseStatus
RuleNames=130.SetResponseForLog


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/600.EaiUsageDataNotAvailable/110.SetStatusCode]

AdornOps=set DEG_OEMDevRespStatusString 6201
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/600.EaiUsageDataNotAvailable/120.SetResponseStatus]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.account_info_response.usage_info.data[0].status_code.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/600.EaiUsageDataNotAvailable/130.SetResponseForLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp3String "RespUsageData: "
AdornOps=+ DEG_OEMDevUsageTypeListToStr DEG_Tmp3String DEG_OEMDevUsageTypeListToStr
AdornOps=set DEG_Tmp3String "Status="
AdornOps=+ DEG_OEMDevUsageTypeListToStr DEG_Tmp3String DEG_OEMDevUsageTypeListToStr
AdornOps=+ DEG_OEMDevUsageTypeListToStr DEG_OEMDevRespStatusString DEG_OEMDevUsageTypeListToStr
AdornOps=+ DEG_OEMDevUsageTypeListToStr ; DEG_OEMDevUsageTypeListToStr


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/700.EaiUsageMessageNotAvailable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.SetStatusCode
RuleNames=120.SetResponseStatus
RuleNames=130.SetResponseForLog


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/700.EaiUsageMessageNotAvailable/110.SetStatusCode]

AdornOps=set DEG_OEMDevRespStatusString 6201
ClassName=AdornmentRule


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/700.EaiUsageMessageNotAvailable/120.SetResponseStatus]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.account_info_response.usage_info.message[0].status_code.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/704.CheckSubsAndUsageAvailabilityStatusRuleChain/100.CheckAvailabilityStatus/700.EaiUsageMessageNotAvailable/130.SetResponseForLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp3String "RespUsageMessage: "
AdornOps=+ DEG_OEMDevUsageTypeListToStr DEG_Tmp3String DEG_OEMDevUsageTypeListToStr
AdornOps=set DEG_Tmp3String "Status="
AdornOps=+ DEG_OEMDevUsageTypeListToStr DEG_Tmp3String DEG_OEMDevUsageTypeListToStr
AdornOps=+ DEG_OEMDevUsageTypeListToStr DEG_OEMDevRespStatusString DEG_OEMDevUsageTypeListToStr
AdornOps=+ DEG_OEMDevUsageTypeListToStr ; DEG_OEMDevUsageTypeListToStr


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/210G.DEG21CheckEAPAKADefaultRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequestVariables
RuleNames=110.ReadValue
RuleNames=120.CheckErrorAndNoMatchFlag


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/210G.DEG21CheckEAPAKADefaultRuleChain/100.InitRequestVariables]

AdornOps=set DEG_CDevSysParameter "EAPAKADefaultAuthWhenError"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/210G.DEG21CheckEAPAKADefaultRuleChain/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/210G.DEG21CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
Conditions=DEG_CDevSysValueString,=,"Enabled"
FalseRuleChain=200.InitResponse
FalseRuleChain=210.SetErrorResponse
Operations=and,and
TrueRuleChain=100.SetSessionStatus


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/210G.DEG21CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag/100.SetSessionStatus]

AdornOps=set DEG_AUTHENTICATION_SUBTYPE "DFT"
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_SSL_STATE AUTHENTICATED_BY_DEG_TOKEN
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/210G.DEG21CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag/200.InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 6005
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set  DEG_SSL_STATE "AKA_CHALLENGE_REJECTED_BY_AAA"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V1Core/RuleChains/210G.DEG21CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag/210.SetErrorResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/Common_V1Core/SessionStores]

ClassName=com.hp.siu.sessionserver.SessionStoreManager
SessionStoreNames=DEG_MONITORING_TRANSACTIONS_SessionStore
SessionStoreNames=DEG_SSL_SESSION_SessionStore
SessionStoreNames=DEG_TOKENS_SessionStore
SessionStoreNames=DEG_HC_DATA_SessionStore

####### GetSubscriberProfileInternal START ##########
#SessionStoreNames=DEG_SUBSCRIBERS_SessionStore
####### GetSubscriberProfileInternal END ############

#QXCM1001530845 -- JDBC Pooling in not working for NRB DSN
[/templates/DEG/DeviceInterface/Common_V1Core/SessionStores/DEG_MONITORING_TRANSACTIONS_SessionStore]

Attributes=DEG_MSESSIONID,key
Attributes=DEG_MSESSIONTRANSID,key
Attributes=DEG_MSESSIONIMSI
Attributes=DEG_MSESSIONPROCID
Attributes=DEG_MSESSIONTIMESTAMP
Attributes=DEG_MSESSIONINTERFACE
Attributes=DEG_MSESSIONINOUT
Attributes=DEG_MSESSIONRESULTCODE
Attributes=DEG_MSESSIONMDN
Attributes=DEG_MSESSIONTRANSACTIONTYPE
Attributes=DEG_MSESSIONSOURCEDESTINATION
Attributes=DEG_MSESSIONMESSAGE
Attributes=DEG_MSESSIONUNIQUE_ID
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy2
DbSchema=${DBSCHEMA_NRB}
DatabaseId=DEG_MONITORING_TRANSACTIONS
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_MONI_TRANS}
SQLTypeMap=DEG_MSESSIONID,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONTRANSID,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONPROCID,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONTIMESTAMP,BIGINT
SQLTypeMap=DEG_MSESSIONINTERFACE,VARCHAR(10)
SQLTypeMap=DEG_MSESSIONINOUT,VARCHAR(3)
SQLTypeMap=DEG_MSESSIONRESULTCODE,VARCHAR(15)
SQLTypeMap=DEG_MSESSIONMDN,BIGINT
SQLTypeMap=DEG_MSESSIONTRANSACTIONTYPE,VARCHAR(50)
SQLTypeMap=DEG_MSESSIONSOURCEDESTINATION,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONMESSAGE,VARCHAR(512)
SQLTypeMap=DEG_MSESSIONIMSI,VARCHAR(64)
SQLTypeMap=DEG_MSESSIONUNIQUE_ID,VARCHAR(64)


[/templates/DEG/DeviceInterface/Common_V1Core/SessionStores/DEG_SSL_SESSION_SessionStore]

Attributes=DEG_SSL_ID,key
Attributes=DEG_SSL_STATE
Attributes=DEG_SSL_AAA_STATE
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_SSL_NAI
Attributes=DEG_SSL_IMSI
Attributes=DEG_SSL_MDN
Attributes=DEG_SSL_UNIQUE_ID
Attributes=DEG_SSL_CREATETIMESTAMP
Attributes=DEG_STR_FLAG
Attributes=DEG_SSL_GW_ADDR
Attributes=DEG_SSL_ID_PROV_STATUS
Attributes=DEG_SSL_POSTDATA
Attributes=DEG_SSL_ADDRESS_UPDATE_URL
Attributes=DEG_SSL_ADDRESS_STATUS
Attributes=DEG_SSL_TC_STATUS
Attributes=DEG_SSL_EntitlementStatus
Attributes=DEG_SSL_MSCHAP_USERNAME
Attributes=DEG_SSL_MSCHAP_PASSWORD
Attributes=DEG_SSL_COMPANION_DEVICE_COUNT
Attributes=DEG_SSL_CUSTOM_FIELD
Attributes=DEG_SSL_DAI
Attributes=DEG_GETAUTH_CONTACTED_AAA
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DatabaseId=DEG_SSL_SESSION
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_SSL_SESSION}
SQLTypeMap=DEG_SSL_ID,VARCHAR(256)
SQLTypeMap=DEG_SSL_STATE,VARCHAR(256)
SQLTypeMap=DEG_SSL_AAA_SESSIONID,VARCHAR(256)
SQLTypeMap=DEG_SSL_AAA_STATE,VARBINARY(50)
SQLTypeMap=DEG_SSL_NAI,VARCHAR(256)
SQLTypeMap=DEG_SSL_IMSI,VARCHAR(256)
SQLTypeMap=DEG_SSL_MDN,VARCHAR(256)
SQLTypeMap=DEG_SSL_UNIQUE_ID,VARCHAR(256)
SQLTypeMap=DEG_SSL_CREATETIMESTAMP,BIGINT
SQLTypeMap=DEG_STR_FLAG,TINYINT
SQLTypeMap=DEG_SSL_GW_ADDR,VARCHAR(256)
SQLTypeMap=DEG_SSL_ID_PROV_STATUS,TINYINT
SQLTypeMap=DEG_SSL_POSTDATA,VARCHAR(1024)
SQLTypeMap=DEG_SSL_ADDRESS_UPDATE_URL,VARCHAR(1024),
SQLTypeMap=DEG_SSL_ADDRESS_STATUS,TINYINT,
SQLTypeMap=DEG_SSL_TC_STATUS,TINYINT,
SQLTypeMap=DEG_SSL_EntitlementStatus,VARCHAR(256),
SQLTypeMap=DEG_SSL_MSCHAP_USERNAME,VARCHAR(256),
SQLTypeMap=DEG_SSL_MSCHAP_PASSWORD,VARCHAR(256),
SQLTypeMap=DEG_SSL_COMPANION_DEVICE_COUNT,VARCHAR(32),
SQLTypeMap=DEG_SSL_CUSTOM_FIELD,VARCHAR(2048)
SQLTypeMap=DEG_SSL_DAI,VARCHAR(128)
SQLTypeMap=DEG_GETAUTH_CONTACTED_AAA,VARCHAR(256)
CommonPolicyID=Policy1
NativeConditions=MatchingSession
NativeConditions=MatchingSessionID


[/templates/DEG/DeviceInterface/Common_V1Core/SessionStores/DEG_SSL_SESSION_SessionStore/MatchingSession]

Condition=where DEG_SSL_AAA_SESSIONID = %DEG_SSL_AAA_SESSIONID

[/templates/DEG/DeviceInterface/Common_V1Core/SessionStores/DEG_SSL_SESSION_SessionStore/MatchingSessionID]

Condition=where DEG_SSL_ID = %DEG_SSL_ID


[/templates/DEG/DeviceInterface/Common_V1Core/SessionStores/DEG_TOKENS_SessionStore]

Attributes=DEG_MDN
Attributes=DEG_IMSI,key
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_APP_TOKEN_FLAG
Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_FULLAUTHTIMESTAMP
Attributes=DEG_PUSH_TOKEN
Attributes=DEG_UNIQUE_ID
Attributes=DEG_DAI
Attributes=DEG_USER_AGENT
Attributes=DEG_BLACKLISTWINDOW_STARTTIME
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DbSchema=${DBSCHEMA_DEG}
DatabaseId=DEG_TOKENS
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
NativeConditions=1.MatchingByMDN
SQLTypeMap=DEG_MDN,BIGINT
SQLTypeMap=DEG_IMSI,VARCHAR(64)
SQLTypeMap=DEG_UNIQUE_ID,VARCHAR(64)
SQLTypeMap=DEG_SUBSTOKEN,CHAR(28)
SQLTypeMap=DEG_TOKENSTATUS,CHAR(2)
SQLTypeMap=DEG_AUTHENTICATION_TYPE,CHAR(3)
SQLTypeMap=DEG_AUTHENTICATION_SUBTYPE,CHAR(3)
SQLTypeMap=DEG_APP_TOKEN_FLAG,TINYINT
SQLTypeMap=DEG_AUTH_COUNT,BIGINT
SQLTypeMap=DEG_BLACKLIST_FLAG,BIGINT
SQLTypeMap=DEG_EVENTTIMESTAMP,BIGINT
SQLTypeMap=DEG_FULLAUTHTIMESTAMP,BIGINT
SQLTypeMap=DEG_PUSH_TOKEN,VARCHAR(100)
SQLTypeMap=DEG_DAI,VARCHAR(128)
SQLTypeMap=DEG_USER_AGENT,VARCHAR(256)
SQLTypeMap=DEG_BLACKLISTWINDOW_STARTTIME,BIGINT
CommonPolicyID=Policy1

[/templates/DEG/DeviceInterface/Common_V1Core/SessionStores/DEG_TOKENS_SessionStore/1.MatchingByMDN]

Condition=where DEG_MDN=%DEG_MDN

[/templates/DEG/DeviceInterface/Common_V1Core/SessionStores/DEG_HC_DATA_SessionStore]

Attributes=DEG_HC_LASTUPDATE
Attributes=DEG_HC_PROCESS_NAME,key
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DbSchema=${DBSCHEMA_DEG}
DatabaseId=DEG_HC_DATA
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
SQLTypeMap=DEG_HC_PROCESS_NAME,VARCHAR(256)
SQLTypeMap=DEG_HC_LASTUPDATE,DATE
CommonPolicyID=Policy1