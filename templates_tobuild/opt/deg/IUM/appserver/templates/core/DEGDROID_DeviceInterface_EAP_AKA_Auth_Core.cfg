[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core]

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains]

ClassName=com.hp.siu.sessionserver.RuleChainManager
RuleChainNames=200.DEG30ProcessRequestRuleChain
RuleChainNames=200a.DEG30PrcessEAP_AKAAuthRuleChain
RuleChainNames=200A.DEG30ValidationAndProcessRequestRuleChain

RuleChainNames=200D.DEG30InvalidToken

RuleChainNames=200D.DEG30FullAuthRuleChain
RuleChainNames=200E.DEG30FastPathAuthRuleChain
RuleChainNames=200F.DEG30GenerateOEMResponseRuleChain

RuleChainNames=200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain
RuleChainNames=200I.DEG30ProcessActionRuleChain
RuleChainNames=200J.DEG30SslSessionLookupStatusRuleChain
RuleChainNames=200K.DEG30NewRequest_CheckSslSessionStatusRuleChain
RuleChainNames=200L.DEG30RequestOk_CheckSslSessionStatusRuleChain
RuleChainNames=200M.DEG30DeviceDataLookupRuleChain
RuleChainNames=200N.DEG30DeviceDataProcessRuleChain
RuleChainNames=200P.DEG30ImsiBasedDeviceDataLookupRuleChain

RuleChainNames=701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain
RuleChainNames=702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain
RuleChainNames=703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain
RuleChainNames=704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
RuleChainNames=705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain
RuleChainNames=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
RuleChainNames=708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain
RuleChainNames=709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain
RuleChainNames=710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=99.SetResponseAction
RuleNames=100.LogActionDetails
RuleNames=200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber
RuleNames=300.ValidateBody
RuleNames=400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber
RuleNames=500.ResetSSLSessionStatus
#RuleNames=600.UnknownSubscriberProcessAction
#RuleNames=610.StatusDisallowedProcessAction
#RuleNames=650.BlackListSubscriberProcessAction
RuleNames=700.ProcessAction

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/99.SetResponseAction]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0201"
AdornOps=set DEG_OEMDevMessageString "Processing OEM action"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/100.LogActionDetails]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevRespTokenString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
LogLevel=DEBUG
Message=Processing OEM action: 
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"

Operations=or,or

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber/TrueRule]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 0

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/300.ValidateBody]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=110.DEG30ValidateInitialRequestRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"

Operations=or,or

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber/TrueRule]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/500.ResetSSLSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,!=,0
Conditions=DEG_SSL_STATE,!=,"WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA"
Conditions=DEG_SSL_STATE,!=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,!=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,!=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,!=,"DISALLOWED_ACTION"
Operations=and,and,and,and,and
TrueRuleChain=100.ResetSslStateToNew

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/500.ResetSSLSessionStatus/100.ResetSslStateToNew]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_STATE "NEW"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200.DEG30ProcessRequestRuleChain/700.ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200I.DEG30ProcessActionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200I.DEG30ProcessActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ProcessAction

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200I.DEG30ProcessActionRuleChain/100.ProcessAction]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitSslSessionLookup
TrueRuleChain=110.ExecuteSslSessionLookup
TrueRuleChain=120.CheckSslSessionLookupStatus

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200I.DEG30ProcessActionRuleChain/100.ProcessAction/100.InitSslSessionLookup]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200I.DEG30ProcessActionRuleChain/100.ProcessAction/110.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
MapAttributes=DEG_SSL_ID_PROV_STATUS,DEG_SSL_ID_PROV_STATUS
MapAttributes=DEG_SSL_GW_ADDR,DEG_SSL_GW_ADDR
MapAttributes=DEG_SSL_ADDRESS_UPDATE_URL,DEG_SSL_ADDRESS_UPDATE_URL
MapAttributes=DEG_SSL_ADDRESS_STATUS,DEG_SSL_ADDRESS_STATUS
MapAttributes=DEG_SSL_TC_STATUS,DEG_SSL_TC_STATUS
MapAttributes=DEG_SSL_POSTDATA,DEG_SSL_POSTDATA
MapAttributes=DEG_SSL_EntitlementStatus,DEG_SSL_EntitlementStatus
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200I.DEG30ProcessActionRuleChain/100.ProcessAction/120.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200J.DEG30SslSessionLookupStatusRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SslSessionLookup

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_SSL_REQUEST_STATE,=,"NEW"
Conditions=DEG_SSL_REQUEST_STATE,within,[403C,500C]
Conditions=DEG_SSL_REQUEST_STATE,within,[200,200C]
Conditions=DEG_SSL_REQUEST_STATE,=,DEG_SSL_REQUEST_STATE
Operations=None

TrueRuleChain=SystemError
TrueRuleChain=NoSslSession
TrueRuleChain=NewRequest
TrueRuleChain=RequestError
TrueRuleChain=RequestOk
TrueRuleChain=UnknownStatus

SystemError=100.SetSslRequestState_500C
SystemError=110.SystemErrorLog
SystemError=120.GenerateStartAuditDataRuleChain

NoSslSession=200.SetSslRequestState_500C
NoSslSession=210.NoSslSessionLog

NewRequest=300.NewRequest_CheckSslSessionStatus

RequestError=350.RequestErrorInfo
RequestError=400.RequestErrorLog

RequestOk=500.RequestOk_CheckSslSessionStatus

UnknownStatus=600.SetSslRequestState_500C
UnknownStatus=610.UnknownStatusLog


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/110.SystemErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access DEG_SSL_SESSION table
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/100.SetSslRequestState_500C]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0202"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_SSL_SESSION table"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/120.GenerateStartAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/210.NoSslSessionLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=WARNING
Message=Internal system error as SSL Session does exist in DEG_SSL_SESSION store: 
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/200.SetSslRequestState_500C]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0203"
AdornOps=set DEG_OEMDevErrorMessageString "Internal system error as SSL Session does exist in DEG_SSL_SESSION store"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/300.NewRequest_CheckSslSessionStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200K.DEG30NewRequest_CheckSslSessionStatusRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/350.RequestErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0204"
AdornOps=set DEG_OEMDevErrorMessageString "Skipping processing OEM action"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/400.RequestErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=WARNING
Message=Skipping processing OEM action - request is in error state: 
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/500.RequestOk_CheckSslSessionStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200L.DEG30RequestOk_CheckSslSessionStatusRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/610.UnknownStatusLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=WARNING
Message=Action processed with error - SSL SESSION is in unrecognized state: 
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200J.DEG30SslSessionLookupStatusRuleChain/100.SslSessionLookup/600.SetSslRequestState_500C]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0205"
AdornOps=set DEG_OEMDevErrorMessageString "SSL SESSION is in unrecognized state"


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.NewRequest_Check

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_SSL_STATE,=,"NEW"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE

TrueRuleChain=NewSslSession
TrueRuleChain=AkaWait
TrueRuleChain=UnknownSslSessionState

NewSslSession=100.NewSslSession_ProcessAction

AkaWait=200.AkaWait_ProcessAction

UnknownSslSessionState=300.Unknown_UpdateRequestStateTo500C

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/100.NewSslSession_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200a.DEG30PrcessEAP_AKAAuthRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/200.AkaWait_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=250.DEG30ProcessEAPAKAPayloadRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.GenerateStartAudit
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=210.CheckSslSessionUpdateStatus

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/000.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/100.InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1

TrueRuleChain=95.SetErrorInfo
TrueRuleChain=100.SystemErrorLog
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/95.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0206"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEG_SSL_SESSION store"


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/100.SystemErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=99.InitErrorLog
TrueRuleChain=100.RowNotFound

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists/99.InitErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0207"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION table"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200K.DEG30NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.RowNotFound]


ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.



[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200L.DEG30RequestOk_CheckSslSessionStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=098.SetInfo
RuleNames=100.LogNMERule20

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200L.DEG30RequestOk_CheckSslSessionStatusRuleChain/098.SetInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0208"
AdornOps=set DEG_OEMDevMessageString "Inside Customize 200L.DEG30RequestOk_CheckSslSessionStatusRuleChain"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200L.DEG30RequestOk_CheckSslSessionStatusRuleChain/100.LogNMERule20]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
LogLevel=DEBUG
Message=entired Inside Customize 200L.DEG30RequestOk_CheckSslSessionStatusRuleChain
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=200.ValidationAndProcessRequest
RuleNames=300.UpdateSSLSessionStore
RuleNames=400.SetResponseHandler

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/100.InitWorkingVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
#AdornOps=set DEG_OEMDevSubscriberIdString ""
AdornOps=set DEG_OEMDevImsiString ""
AdornOps=set DEG_MDN 0
AdornOps=set DEG_IMSI ""
AdornOps=set DEG_OEMDevRespPhoneNumberString ""

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/200.ValidationAndProcessRequest]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200A.DEG30ValidationAndProcessRequestRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"NEW"
FalseRuleChain=200.UpdateSslSessionState

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState]

ClassName=RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=300.CheckSslSessionUpdateStatus

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/100.InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI
AdornOps=copy DEG_OEMDevImsiString DEG_SSL_IMSI
AdornOps=copy DEG_OEMDevUniqueIDString DEG_SSL_UNIQUE_ID
AdornOps=copy DEG_MDN DEG_SSL_MDN
#AdornOps=copy DEG_OEMDevGatewayAddressString DEG_SSL_GW_ADDR
AdornOps=set DEG_SSL_GW_ADDR ""
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDRESS_UPDATE_URL ""
AdornOps=setifnull DEG_EntitlementStatus ""
AdornOps=copy DEG_PROVISIONING_STATUS DEG_SSL_ID_PROV_STATUS
AdornOps=copy DEG_ADDR_UPDATE_POSTDATA DEG_SSL_POSTDATA
AdornOps=copy DEG_ADDRESS_STATUS DEG_SSL_ADDRESS_STATUS
AdornOps=copy DEG_TC_STATUS DEG_SSL_TC_STATUS
AdornOps=copy DEG_ADDRESS_UPDATE_URL DEG_SSL_ADDRESS_UPDATE_URL
AdornOps=copy DEG_EntitlementStatus DEG_SSL_EntitlementStatus
AdornOps=setifnull DEGDROID_SSL_COOKIE_ID ""
AdornOps=setifnull DEGDROID_SSL_OTP 0
#AdornOps=copy DEGDROID_SSL_COOKIE_ID DEGDROID_SSL_COOKIE_ID
#AdornOps=copy DEGDROID_OTP DEGDROID_SSL_OTP

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_STATE,DEG_SSL_AAA_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
MapAttributes=DEG_SSL_ID_PROV_STATUS,DEG_SSL_ID_PROV_STATUS
MapAttributes=DEG_SSL_GW_ADDR,DEG_SSL_GW_ADDR
MapAttributes=DEG_SSL_POSTDATA,DEG_SSL_POSTDATA
MapAttributes=DEG_SSL_ADDRESS_STATUS,DEG_SSL_ADDRESS_STATUS
MapAttributes=DEG_SSL_TC_STATUS,DEG_SSL_TC_STATUS
MapAttributes=DEG_SSL_ADDRESS_UPDATE_URL,DEG_SSL_ADDRESS_UPDATE_URL
MapAttributes=DEG_SSL_EntitlementStatus,DEG_SSL_EntitlementStatus
MapAttributes=DEGDROID_SSL_COOKIE_ID,DEGDROID_SSL_COOKIE_ID
MapAttributes=DEGDROID_SSL_OTP,DEGDROID_SSL_OTP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=99.InitErrorLog
TrueRuleChain=100.LogError
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/99.InitErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0209"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update row in DEG_SSL_SESSION table"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/100.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=99.InitErrorLog
TrueRuleChain=100.LogError

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/99.InitErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0210"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update row in DEG_SSL_SESSION table"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/300.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/400.SetResponseHandler]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,within,[200,200C]
FalseRuleChain=200.SetEmptyResponseHandler
TrueRuleChain=100.SetTextResponseHandler

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/400.SetResponseHandler/100.SetTextResponseHandler]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200a.DEG30PrcessEAP_AKAAuthRuleChain/400.SetResponseHandler/200.SetEmptyResponseHandler]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ProcessRequest

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
#Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=ExtractNAIFromSubscriberIdAttribute
TrueRuleChain=ValidateToken
TrueRuleChain=CallInitialValidationCustom
TrueRuleChain=CheckIfSubscriberBlackListed
TrueRuleChain=CheckIfDeviceDataExists
TrueRuleChain=CheckIfSubscriberProvisioned
#QXCM1001541408 -- Device interface reporting 0 as MDN for IN message
TrueRuleChain=GenerateStartAuditData
TrueRuleChain=ProcessPerAuthType
#TrueRuleChain=ProcessDeviceData
TrueRuleChain=GenerateEapAkaInitialEndAuditData
TrueRuleChain=GenerateOEMResponse

ExtractNAIFromSubscriberIdAttribute=110.DecodePayload
ExtractNAIFromSubscriberIdAttribute=120.CheckPlayloadIfBase64
ExtractNAIFromSubscriberIdAttribute=130.SetLogInfo
ExtractNAIFromSubscriberIdAttribute=130.Log

ValidateToken=140.ValidateToken

GenerateStartAuditData=125.MonitorSessionRuleChain
GenerateStartAuditData=130.GenerateStartAuditData

CallInitialValidationCustom=150.CallInitialValidationCustom

CheckIfSubscriberBlackListed=300.CheckIfSubscriberBlackListed
CheckIfDeviceDataExists=310.CheckIfDeviceDataExists
CheckIfSubscriberProvisioned=400.CheckIfSubscriberProvisioned
CheckIfSubscriberProvisioned=410.CopyEntitlementValues

ProcessPerAuthType=500.InitVariables
ProcessPerAuthType=510.LookupDEGToken
ProcessPerAuthType=520.CheckDEGToken

#ProcessDeviceData=530.ProcessDeviceData

GenerateOEMResponse=600.GenerateOEMResponse

GenerateEapAkaInitialEndAuditData=700.GenerateEapAkaInitialEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/130.SetLogInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0237"
AdornOps=set DEG_OEMDevMessageString "Subscriber-id in the incoming request"


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/130.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_OEMDevSubscriberIdString
LogLevel=INFO
Message=Subscriber-id in the incoming request: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/110.DecodePayload]


ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_OEMDevEAPSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy

TrueRuleChain=DecpdeEAPSubscriberId
TrueRuleChain=DecodeSubscriberId

DecpdeEAPSubscriberId=100.DecodeEAPSubscriberId

DecodeSubscriberId=200.DecodeSubscriberId

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/110.DecodePayload/100.DecodeEAPSubscriberId]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=decBase64 DEG_OEMDevEAPSubscriberIdString DEG_OEMDevEAPPayloadBinary

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/110.DecodePayload/200.DecodeSubscriberId]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=decBase64 DEG_OEMDevSubscriberIdString DEG_OEMDevEAPPayloadBinary

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.ConvertPayload2String
FalseRuleChain=210.DecodeNAI
TrueRuleChain=000.GenerateStartAudit
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/000.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=(DEG_OEMDevEAPPayloadBinary =="") || (DEG_OEMDevEAPPayloadBinary == null)

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0211"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber-id is empty or Unable to Extract NAI From Subscriber-id"
AdornOps=set DEG_CDevOutReturnCodeString "403"


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_OEMDevTempSubscriberIdString
Attributes=DEG_OEMDevSubscriberIdLengthInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Either Subscriber-id is empty or Unable to Extract NAI From Subscriber-id : 
NullAlso=true
#Action=Data Error in EAP Payload.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/200.ConvertPayload2String]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=bin2str DEG_OEMDevEAPPayloadBinary DEG_OEMDevTempSubscriberIdString "ISO8859_1"
AdornOps=length DEG_OEMDevTempSubscriberIdString DEG_OEMDevSubscriberIdLengthInteger

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdLengthInteger,>=,6
TrueRuleChain=100.ExtractNAI

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_OEMDevEAPSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy

TrueRuleChain=ExtractEAPSubscriberId
TrueRuleChain=ExtractSubscriberId

ExtractEAPSubscriberId=100.ExtractEAPSubscriberId
ExtractEAPSubscriberId=130.ValidateEAPSubscriberIdAttribute
ExtractEAPSubscriberId=145.ExtractImsiFromEAPSubscriberIdAttribute

ExtractSubscriberId=200.ExtractSubscriberId
ExtractSubscriberId=135.ValidateSubscriberIdAttribute
ExtractSubscriberId=150.ExtractImsiFromSubscriberIdAttribute

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/100.ExtractEAPSubscriberId]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr 5 length DEG_OEMDevTempSubscriberIdString DEG_OEMDevEAPSubscriberIdString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/200.ExtractSubscriberId]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevTempSubscriberIdString DEG_OEMDevSubscriberIdString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/130.ValidateEAPSubscriberIdAttribute]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
FalseRuleChain=000.GenerateStartAudit
FalseRuleChain=200.SetHttpErrorResponse
FalseRuleChain=210.ErrorLog
Operation=match
RegExPattern=${SUBSCRIBERID_PATTERN}
SourceAttribute=DEG_OEMDevEAPSubscriberIdString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/130.ValidateEAPSubscriberIdAttribute/000.GenerateStartAudit]


ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/130.ValidateEAPSubscriberIdAttribute/200.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0212"
AdornOps=set DEG_OEMDevErrorMessageString "EAP-Subscriber-id attribute not NAI format"
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/130.ValidateEAPSubscriberIdAttribute/210.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request - EAP-subscriber-id attribute must be in NAI format: 
NullAlso=true
#Action=Invalid initial-auth-request - EAP-subscriber-id attribute must be in NAI format . Contact HP Admin.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/135.ValidateSubscriberIdAttribute]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
FalseRuleChain=200.SetHttpErrorResponse
FalseRuleChain=210.ErrorLog
Operation=match
RegExPattern=${SUBSCRIBERID_PATTERN}
SourceAttribute=DEG_OEMDevSubscriberIdString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/135.ValidateSubscriberIdAttribute/200.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0213"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber-id attribute not NAI format"
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/135.ValidateSubscriberIdAttribute/210.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request - subscriber-id attribute must be in NAI format: 
NullAlso=true
#Action=Invalid initial-auth-request - subscriber-id attribute must be in NAI format . Contact HP Admin.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/145.ExtractImsiFromEAPSubscriberIdAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr "0" "@" DEG_OEMDevEAPSubscriberIdString DEG_OEMDevImsiString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/120.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI/150.ExtractImsiFromSubscriberIdAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr "0" "@" DEG_OEMDevSubscriberIdString DEG_OEMDevImsiString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/140.ValidateToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/140.ValidateToken/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0214"
AdornOps=set DEG_OEMDevErrorMessageString "Token is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/140.ValidateToken/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request - token is empty: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/125.MonitorSessionRuleChain]

ClassName=LocalRuleChainInvoker
RuleChain=400A.ProcessSubscriberExistsResponseRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/130.GenerateStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom]

ClassName=RuleChain
#RuleNames=100.InitVariables
RuleNames=200.CopyBeforeInitialValidation
RuleNames=300.LogBeforeInitialValidation
RuleNames=400.ProcessInitialValidation
RuleNames=401.SetLogInfo
RuleNames=402.LogAfterInitialValidation
RuleNames=500.CheckCustomStatus

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/200.CopyBeforeInitialValidation]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull CUST_DDIV_OUT_Status 0
AdornOps=setifnull CUST_DDIV_OUT_RespHttpStatusInteger 0
AdornOps=copy DEG_OEMDevEAPSubscriberIdString CUST_DDIV_IN_SubscriberIdString
AdornOps=copy DEG_OEMDevSipUserNameString CUST_DDIV_IN_SipUserNameString
AdornOps=copy DEG_OEMDevTerminalVendorString CUST_DDIV_IN_TerminalVendorString
AdornOps=copy DEG_OEMDevImsiString CUST_DDIV_IN_IMSIString
AdornOps=copy DEG_OEMDevRequestProcessedInteger CUST_DDIV_OUT_Status
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0215"
AdornOps=set DEG_OEMDevMessageString "before processing Initial validation"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/300.LogBeforeInitialValidation]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=CUST_DDIV_IN_SubscriberIdString
Attributes=CUST_DDIV_IN_SipUserNameString
Attributes=CUST_DDIV_IN_TerminalVendorString
Attributes=CUST_DDIV_IN_IMSIString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
LogLevel=DEBUG2
Message=Log before processing Initial validation
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/400.ProcessInitialValidation]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_Android_InputValidation
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/401.SetLogInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0216"
AdornOps=set DEG_OEMDevMessageString "after processing Initial validation"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/402.LogAfterInitialValidation]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=CUST_DDIV_OUT_Status
Attributes=CUST_DDIV_OUT_RespHttpStatusInteger
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
LogLevel=DEBUG2
Message=Log after processing Initial validation
NullAlso=true


#QXCM1001480474:DEGDROID Input Custom Validation fails, DEG should return 403/500 error.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/500.CheckCustomStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=CUST_DDIV_OUT_Status,=,1
#QXCM1001541408 -- Device interface reporting 0 as MDN for IN message
TrueRuleChain=50.GenerateStartAuditDataRuleChain
TrueRuleChain=100.CopyAfterInitialValidation
TrueRuleChain=200.SetStatusValues

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/500.CheckCustomStatus/50.GenerateStartAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/500.CheckCustomStatus/100.CopyAfterInitialValidation]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy CUST_DDIV_OUT_RespHttpStatusInteger DEG_OEMDevHttpStatusInteger

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/500.CheckCustomStatus/200.SetStatusValues]


ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_OEMDevHttpStatusInteger,=,"403"
Conditions=DEG_OEMDevHttpStatusInteger,=,"500"
Conditions=DEG_OEMDevHttpStatusInteger,=,DEG_OEMDevHttpStatusInteger

TrueRuleChain=Http403
TrueRuleChain=Http500
TrueRuleChain=Http500

Http403=100.Set403Error
Http403=101.Log403Error
Http500=200.Set500Error
Http500=201.Log500Error

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/500.CheckCustomStatus/200.SetStatusValues/100.Set403Error]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "Degdroid Initial Validation Custom Configuration Http403 Failure"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0217"
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/500.CheckCustomStatus/200.SetStatusValues/101.Log403Error]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
LogLevel=WARNING
Message=Degdroid Initial Validation Custom Configuration Http403 Failure : 
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/500.CheckCustomStatus/200.SetStatusValues/200.Set500Error]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "Degdroid Initial Validation Custom Configuration Http500 Failure"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0218"
AdornOps=set DEG_CDevOutReturnCodeString "500"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/150.CallInitialValidationCustom/500.CheckCustomStatus/200.SetStatusValues/201.Log500Error]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
LogLevel=ERROR
Message=Degdroid Initial Validation Custom Configuration Http500 Failure : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/300.CheckIfSubscriberBlackListed]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=150.DEG30BlackListeSubscriberRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/310.CheckIfDeviceDataExists]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200M.DEG30DeviceDataLookupRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/400.CheckIfSubscriberProvisioned]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400.GetSubscriberProfileRuleChain
UseRuleChainManagerPool=true

###QXCM1001473060:Response XML where "Status" is used it was displaying "Entitlement status" instead of "Provisioning status"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/410.CopyEntitlementValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_EntitlementStatus DEG_SSL_EntitlementStatus
AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDRESS_UPDATE_URL ""
AdornOps=copy DEG_TC_STATUS DEGDROID_XML_TC_STATUS
AdornOps=copy DEG_ADDRESS_STATUS DEGDROID_XML_ADDRESS_STATUS
AdornOps=copy DEG_PROVISIONING_STATUS DEGDROID_XML_PROVISIONING_STATUS
AdornOps=copy DEG_ADDR_UPDATE_POSTDATA DEGDROID_XML_ADDR_UPDATE_POSTDATA
AdornOps=copy DEG_ADDRESS_UPDATE_URL DEGDROID_XML_ADDRESS_UPDATE_URL


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/500.InitVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=copy DEG_MDN DEG_CDevMobileNumberString
AdornOps=set DEG_CDevTokenString ""
#AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_OEMDevFastAuthFlag 0

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/510.LookupDEGToken]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_AUTHENTICATION_TYPE,DEG_AUTHENTICATION_TYPE
MapAttributes=DEG_AUTHENTICATION_SUBTYPE,DEG_AUTHENTICATION_SUBTYPE
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
#TrueRuleChain=120.GenerateEapAkaInitialSystemErrorEndAuditData
FalseRuleChain=200.CheckTokenTimeStamp
FalseRuleChain=210.CheckProcessIntegerFlag

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0219"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_TOKENS table"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_TOKENS table
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/120.GenerateEapAkaInitialSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/200.CheckTokenTimeStamp]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=130.DEG30CheckTokenTimeStampRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=210.GetToken

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0

TrueRuleChain=100.CheckSubType

FalseRuleChain=200.CheckIMSI

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"DFT"
Conditions=DEG_OEMDevFastAuthFlag,=,0

Operations=or

TrueRuleChain=100.CheckIMSI
FalseRuleChain=200.CheckAuthToken


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/100.CheckIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,=,"dummy"
TrueRuleChain=200.EAPAKAAuth
FalseRuleChain=100.InvalidToken


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/100.CheckIMSI/200.EAPAKAAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200D.DEG30FullAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/100.CheckIMSI/100.InvalidToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200D.DEG30InvalidToken
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/200.CheckAuthToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevFastAuthFlag,=,1
Conditions=DEG_TOKENSTATUS,=,"AE"
Conditions=DEG_OEMDevTokenString,=,DEG_SUBSTOKEN
Operations=and,and
TrueRuleChain=100.FastPathAuth
FalseRuleChain=200.CheckIMSI

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/200.CheckAuthToken/100.FastPathAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200E.DEG30FastPathAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/200.CheckAuthToken/200.CheckIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,=,"dummy"
TrueRuleChain=200.EAPAKAAuth
FalseRuleChain=100.InvalidToken

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/200.CheckAuthToken/200.CheckIMSI/200.EAPAKAAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200D.DEG30FullAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/100.CheckSubType/200.CheckAuthToken/200.CheckIMSI/100.InvalidToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200D.DEG30InvalidToken
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/200.CheckIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,=,"dummy"
TrueRuleChain=200.EAPAKAAuth
FalseRuleChain=100.InvalidToken

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/200.CheckIMSI/200.EAPAKAAuth]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200D.DEG30FullAuthRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/520.CheckDEGToken/210.CheckProcessIntegerFlag/210.GetToken/200.CheckIMSI/100.InvalidToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200D.DEG30InvalidToken
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/530.ProcessDeviceData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200N.DEG30DeviceDataProcessRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/600.GenerateOEMResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200F.DEG30GenerateOEMResponseRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200A.DEG30ValidationAndProcessRequestRuleChain/100.ProcessRequest/700.GenerateEapAkaInitialEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateEapAkaInitialEndAuditData

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,!=,UNKNOWN_SUBSCRIBER
Description=Unknown Subscriber case already Handled
Operations=or

TrueRuleChain=000.SetTranscationType
TrueRuleChain=100.CheckAuthenticationState


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/000.SetTranscationType]

ClassName=ConditionalRule
Conditions=DEG_OEMDevRequestAttributeString,contains,"IMSI_EAP"
FalseRuleChain=SetTranscationType
TrueRuleChain=SetFullAuthTranscationType


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/000.SetTranscationType/SetFullAuthTranscationType]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditTransactionTypeString "full-auth-init"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/000.SetTranscationType/SetTranscationType]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditTransactionTypeString "fast-auth"


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

#Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
#Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
#Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_AAA"
#Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"

#TrueRuleChain=AkaWait
#TrueRuleChain=AkaRejected
#TrueRuleChain=AuthenticatedAAA
#TrueRuleChain=AuthenticatedDEGToken
TrueRuleChain=BlackListSubscriber
TrueRuleChain=StatusDisallowed

#AkaRejected=100.GenerateEapAkaInitialRejectedEndAuditData

#AkaWait=200.GenerateEapAkaInitialWaitEndAuditData

#AuthenticatedAAA=300.GenerateEapAkaInitialAAAAuthenticatedEndAuditData

#AuthenticatedDEGToken=400.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData

BlackListSubscriber=500.GenerateEapAkaInitialBlackListSubscriberEndAuditData

StatusDisallowed=600.GenerateEapAkaInitialDisallowedActionEndAuditData

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/100.GenerateEapAkaInitialRejectedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/200.GenerateEapAkaInitialWaitEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/300.GenerateEapAkaInitialAAAAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/400.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"TKN"
TrueRuleChain=100.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData
FalseRuleChain=200.GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditData

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/400.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData/100.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/400.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData/200.GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/500.GenerateEapAkaInitialBlackListSubscriberEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200H.DEG30GenerateEapAkaInitialEndAuditDataRuleChain/100.GenerateEapAkaInitialEndAuditData/100.CheckAuthenticationState/600.GenerateEapAkaInitialDisallowedActionEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateOEMResponse

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Conditions=DEG_SSL_STATE,starts,"AUTHENTICATED"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE

TrueRuleChain=UnknownSubscriber
TrueRuleChain=BlacListedSubscriber
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=StatusDisallowed
TrueRuleChain=Authenticated
TrueRuleChain=Unknown

UnknownSubscriber=100.UnknownSubscriber_InitResponse

BlacListedSubscriber=200.BlackListedSubscriber_InitResponse

AkaWait=300.AkaWait_InitResponse
AkaWait=310.AkaWait_GenerateResponse

AkaRejected=400.AkaRejected_InitResponse
AkaRejected=410.AkaRejected_DeactiveToken
#AkaRejected=420.AkaRejected_GenerateResponse
AkaRejected=420.AkaRejected_GenerateEndAuditData

Authenticated=500.Authenticated_InitResponse
Authenticated=501.Authenticated_GetResponseTemplate
Authenticated=502.Authenticated_CheckProcessedInteger

Unknown=600.Unknown_SetHttpErrorResponseTo500C

StatusDisallowed=700.DisallowedAction_InitResponse


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/100.UnknownSubscriber_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevRespStatusString 403


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/200.BlackListedSubscriber_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevRespStatusString 511

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/300.AkaWait_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "200"
AdornOps=set DEG_OEMDevRespStatusString 200

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
#TrueRuleChain=100.GenerateNullPayloadResponse
FalseRuleChain=200.EncodePayload
FalseRuleChain=203.InitVariableAuthXMLTemplate
FalseRuleChain=205.LookUpAuthXMLTemplate
FalseRuleChain=215.AssignMessagetoResponse
FalseRuleChain=220.GenerateAKAWaitEndAuditDataRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/100.GenerateNullPayloadResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/200.EncodePayload]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/203.InitVariableAuthXMLTemplate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEGDROID_auth_step_Integer 1
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/205.LookUpAuthXMLTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/215.AssignMessagetoResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.AssignResponse

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/215.AssignMessagetoResponse/100.AssignResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull DEG_XML_TEMPLATES_FILE ""
AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/220.GenerateAKAWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,!=,"500C"
TrueRuleChain=100.GenerateEndAuditDataRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/310.AkaWait_GenerateResponse/220.GenerateAKAWaitEndAuditDataRuleChain/100.GenerateEndAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


#5001 is due to unknown user.  This error might get rectified if carrier systems are in sync.  So, 503 is responded.
#5003 is due to DIAMETER_ERROR_IDENTITY_NOT_REGISTERED as per SWx.  This may rectified after carrier systems are in sync.  So, 503 is responded.
#4001 is DIAMETER_AUTHENTICATION_REJECTED may be due to incorrect password sent by device due to unsynced authentication requests.  So, 503 is responded.
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/400.AkaRejected_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 503
AdornOps=set DEG_SSL_REQUEST_STATE "503C"
AdornOps=set DEG_TOKENSTATUS "DE"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/410.AkaRejected_DeactiveToken]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/420.AkaRejected_GenerateResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger "500"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/420.AkaRejected_GenerateEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,!=,"500C"
TrueRuleChain=100.GenerateEndAuditDataRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/420.AkaRejected_GenerateEndAuditData/100.GenerateEndAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/500.Authenticated_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_APP_TOKEN_FLAG 1
AdornOps=setifnull DEGDROID_SSL_COOKIE_ID ""
AdornOps=set DEGDROID_auth_step_Integer 3
AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEG_OEMDevRespTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEG_CDevTokenString
#AdornOps=copy DEG_OEMDevRespTokenString DEGDROID_SSL_COOKIE_ID
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_AUTH_XML_TEMPLATES"
AdornOps=copy DEG_DevAuthTypeString DEG_AUTH_TYPE
AdornOps=copy DEGDROID_auth_step_Integer DEG_AUTH_STEP
AdornOps=set DEG_TOKEN_VALIDITY_SECONDS ${DEGDROID_DEVICE_TOKEN_VALIDITY}

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/501.Authenticated_GetResponseTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=160.DEG30GetResponseTemplatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=Authenticated_StoreToken
TrueRuleChain=Authenticated_ResponseCustomization
TrueRuleChain=Authenticated_DeviceData
TrueRuleChain=Authenticated_GenerateEndAuditDataRuleChain
TrueRuleChain=Authenticated_ServiceConfiguration
TrueRuleChain=Authenticated_GenerateResponse

Authenticated_StoreToken=510.Authenticated_StoreToken
Authenticated_ResponseCustomization=520.Authenticated_ResponseCustomization
Authenticated_DeviceData=530.Authenticated_DeviceData
Authenticated_GenerateEndAuditDataRuleChain=540.Authenticated_GenerateEndAuditDataRuleChain
Authenticated_ServiceConfiguration=550.Authenticated_ServiceConfiguration
Authenticated_GenerateResponse=560.Authenticated_GenerateResponse

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/510.Authenticated_StoreToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevMobileNumberString
RequestAttributes=DEG_IMSI
RequestAttributes=DEG_CDevTokenString
RequestAttributes=DEG_AUTHENTICATION_TYPE
RequestAttributes=DEG_AUTHENTICATION_SUBTYPE
RequestAttributes=DEG_APP_TOKEN_FLAG
RequestAttributes=DEG_FULLAUTHTIMESTAMP
ResponseAttributes=DEG_OEMDevErrorMessageString
ResponseAttributes=DEG_EVENTTIMESTAMP
RuleChain=005.DEG30StoreTokenRuleChain
UseRuleChainManagerPool=true


##QXCM1001465742-When response attribute was set in custom template, it was not reflecting in the response.Fix was done by calling "180.ProcessResponseAttributeCustomization" rule chain when forming the response.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/520.Authenticated_ResponseCustomization]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=180.ProcessResponseAttributeCustomization
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/530.Authenticated_DeviceData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200N.DEG30DeviceDataProcessRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/540.Authenticated_GenerateEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,!=,"500C"
TrueRuleChain=100.GenerateEndAuditDataRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/540.Authenticated_GenerateEndAuditDataRuleChain/100.GenerateEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
TrueRuleChain=GenerateAAAAuthenticatedEndAuditData
TrueRuleChain=GenerateDEGTokenAuthenticatedEndAuditData
GenerateAAAAuthenticatedEndAuditData=100.GenerateEapAkaInitialAAAAuthenticatedEndAuditData
GenerateDEGTokenAuthenticatedEndAuditData=200.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/540.Authenticated_GenerateEndAuditDataRuleChain/100.GenerateEndAuditDataRuleChain/100.GenerateEapAkaInitialAAAAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/540.Authenticated_GenerateEndAuditDataRuleChain/100.GenerateEndAuditDataRuleChain/200.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"TKN"
TrueRuleChain=100.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData
FalseRuleChain=200.GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditData

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/540.Authenticated_GenerateEndAuditDataRuleChain/100.GenerateEndAuditDataRuleChain/200.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData/100.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/540.Authenticated_GenerateEndAuditDataRuleChain/100.GenerateEndAuditDataRuleChain/200.GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditData/200.GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/550.Authenticated_ServiceConfiguration]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.DEG30ProcessServiceConfigurationRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckEAPPayload
RuleNames=150.CheckResponseXMLEmptyAfterServiceConfigProcess

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse/100.CheckEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.GenerateNullPayloadResponse
FalseRuleChain=200.EncodePayload

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse/100.CheckEAPPayload/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse/100.CheckEAPPayload/100.GenerateNullPayloadResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger "511"


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse/100.CheckEAPPayload/200.EncodePayload]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_XMLTemplateResponseString,!=,""
TrueRuleChain=10.AssignResponseFromServiceConfigTemplate
FalseRuleChain=20.AssignResponseFromAuthConfigTemplate


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess/10.AssignResponseFromServiceConfigTemplate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_XMLTemplateResponseString ResponseMessage


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/502.Authenticated_CheckProcessedInteger/560.Authenticated_GenerateResponse/150.CheckResponseXMLEmptyAfterServiceConfigProcess/20.AssignResponseFromAuthConfigTemplate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_XML_TEMPLATES_FILE ResponseMessage


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/600.Unknown_SetHttpErrorResponseTo500C]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevHttpStatusInteger "511"


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200F.DEG30GenerateOEMResponseRuleChain/100.GenerateOEMResponse/700.DisallowedAction_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevHttpStatusInteger "511"


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30InvalidToken]

ClassName=RuleChain
RuleNames=100.SetErrorInfo
RuleNames=110.ErrorLog
RuleNames=120.GenerateInvalidTokenErrorEndAuditData

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30InvalidToken/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0220"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevErrorMessageString "Network Authentication Required"
AdornOps=set DEG_CDevOutReturnCodeString "511"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30InvalidToken/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_OEMDevTokenString
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=DEBUG
Message=Invalid Input Token: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30InvalidToken/120.GenerateInvalidTokenErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain]

ClassName=RuleChain
RuleNames=100.CheckEAPSubscriberID
RuleNames=200.CheckProcessIntegerFlag

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/100.CheckEAPSubscriberID]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPSubscriberIdString,=,dummy

TrueRuleChain=100.InitRequestVariables
FalseRuleChain=200.InitRequestVariables

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/100.CheckEAPSubscriberID/200.InitRequestVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSysParameter "EAPAKAAuth"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
AdornOps=copy DEG_OEMDevEAPSubscriberIdString DEG_SSL_NAI
AdornOps=copy DEG_OEMDevEAPSubscriberIdString DEG_OEMDevSubscriberIdString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/100.CheckEAPSubscriberID/100.InitRequestVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_OEMDevHttpStatusInteger "511"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=200.ReadValue
TrueRuleChain=300.CheckErrorAndNoMatchFlag

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/200.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
Conditions=DEG_CDevSysValueString,=,"Enabled"
Operations=and,and
TrueRuleChain=100.AAAProcessingRule
TrueRuleChain=109.SetLogInfo
TrueRuleChain=110.LogEAPAKAAtuhEnabled
TrueRuleChain=120.UpdateTokenTable
FalseRuleChain=200.SetSessionStatus
FalseRuleChain=210.LogEAPAKAAtuhDisabled


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/100.AAAProcessingRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_OEMDevSubscriberIdString
RequestAttributes=DEG_OEMDevEAPPayloadBinary
ResponseAttributes=DEG_OEMDevRequestIdString
RequestAttributes=DEG_SSL_NAI
ResponseAttributes=DEG_SSL_STATE
ResponseAttributes=DEG_SSL_AAA_STATE
ResponseAttributes=DEG_AUTHENTICATION_TYPE
ResponseAttributes=DEG_AUTHENTICATION_SUBTYPE
ResponseAttributes=DEG_OEMDevEAPPayloadBinary
RuleChain=301.DEG30AAAProcessingRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/109.SetLogInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0221"
AdornOps=setifnull DEG_OEMDevMessageString "Perform EAPAKAAtuh Enable"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/110.LogEAPAKAAtuhEnabled]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_DevAuthTypeString
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_SSL_STATE
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
LogLevel=DEBUG
Message=Perform EAPAKAAtuh Enable: 
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0

TrueRuleChain=100.InitUpdate
TrueRuleChain=200.Update
TrueRuleChain=300.CheckUpdateStatus
FalseRuleChain=400.SetAuditTransactionType


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/400.SetAuditTransactionType]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditTransactionTypeString "full-auth-init"


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/100.InitUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=setifnull DEG_BLACKLIST_FLAG 0
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=set DEG_AuditTransactionTypeString "full-auth-init"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0222"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS table during blacklist processing"
AdornOps=set DEG_CDevOutReturnCodeString "500"


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_TOKENS session store during blacklist processing
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0223"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS table"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/120.UpdateTokenTable/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_TOKENS BLACKLISTED session store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/200.SetSessionStatus]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "DFT"
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0224"
AdornOps=set DEG_OEMDevErrorMessageString "EAPAKAAtuh Disabled or Transient System Error"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200D.DEG30FullAuthRuleChain/200.CheckProcessIntegerFlag/300.CheckErrorAndNoMatchFlag/210.LogEAPAKAAtuhDisabled]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=DEBUG
Message=Perform EAPAKAAtuh Disabled:
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetSystemTime
RuleNames=110.CheckTokenValidity

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/100.SetSystemTime]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_EVENTTIMESTAMP DEG_OEMDevTokenTimeStampDiffLong
AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_FULLAUTHTIMESTAMP DEG_OEMDevFullAuthTimeStampDiffLong
AdornOps=set DEG_AuditTransactionTypeString "fast-auth"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenTimeStampDiffLong,<=,DEG_OEMDeviceTokenValidityLong
Conditions=DEG_OEMDevFullAuthTimeStampDiffLong,<=,DEG_OEMDeviceFullAuthMustWindowLong

Operations=and

TrueRuleChain=100.SetSessionStatus
TrueRuleChain=200.LogFastPathAuth

FalseRuleChain=200.SetErrorInfo
FalseRuleChain=210.ErrorLog
FalseRuleChain=220.GenerateInitialAuthSystemErrorEndAuditData

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/200.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0225"
AdornOps=set DEG_SSL_STATE "NEW"
AdornOps=set DEG_CDevOutReturnCodeString "511"
AdornOps=set DEG_OEMDevErrorMessageString "Network Authentication Required"

#QXCM1001538551: Log level is changed from CRITICAL to INFO.
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/210.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevCurrentTimeStampLong
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_OEMDevTokenTimeStampDiffLong
Attributes=DEG_OEMDeviceTokenValidityLong
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=INFO
Message=Database Error: Token Expired Network Authentication Required
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/220.GenerateInitialAuthSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/100.SetSessionStatus]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_STATE "AUTHENTICATED_BY_DEG_TOKEN"
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "TKN"
#AdornOps=+ DEG_AUTH_COUNT 1 DEG_AUTH_COUNT
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0226"
AdornOps=set DEG_OEMDevMessageString "Perform FastPathAuth"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/200.LogFastPathAuth]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_AUTH_COUNT
Attributes=DEG_OEMDevAuthThresholdCountInteger
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Perform FastPathAuth: 
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/300.CheckCounter]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_AUTH_COUNT,>,DEG_OEMDevAuthThresholdCountInteger

TrueRuleChain=100.SetBlackListed

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/300.CheckCounter/100.SetBlackListed]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_BLACKLIST_FLAG 1
AdornOps=set DEG_AUTH_COUNT 0

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/100.InitUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
#AdornOps=copy DEG_CDevTokenString DEG_SUBSTOKEN
AdornOps=setifnull DEG_AUTH_COUNT 0
AdornOps=setifnull DEG_BLACKLIST_FLAG 0
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0227"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS table"
AdornOps=set DEG_CDevOutReturnCodeString "500"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_TOKENS session store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0228"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_TOKENS table"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/400.UpdateAsBlackListed/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_TOKENS session store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/500.GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_BLACKLIST_FLAG,=,1

TrueRuleChain=100.GenerateBlackListedResponse

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200E.DEG30FastPathAuthRuleChain/110.CheckTokenValidity/500.GenerateResponse/100.GenerateBlackListedResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=140.DEG30GenerateBlackListedResponseRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.InitDeviceDataLookup
RuleNames=120.ExecuteDeviceDataLookup
RuleNames=130.CheckDeviceDataLookupStatus

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/110.InitDeviceDataLookup]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_DevAndroidEntitlementNameString ${ANDROIDVOWIFI_ENTITLEMENT_NAME}
AdornOps=copy DEG_DevAndroidEntitlementNameString DEG_ENTITLEMENT_NAME
AdornOps=copy DEGDROID_TerminalUniqueIdString DEG_UNIQUE_ID
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/120.ExecuteDeviceDataLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
MapAttributes=DEG_ENTITLEMENT_NAME,DEG_ENTITLEMENT_NAME
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_APNS_TOKEN,DEG_APNS_TOKEN
MapAttributes=DEG_OLD_APNS_TOKEN,DEG_OLD_APNS_TOKEN
MapAttributes=DEG_PROVISIONING_STATUS,DEG_PROVISIONING_STATUS
MapAttributes=DEG_PUSH_NOTIFICATION_STATUS,DEG_PUSH_NOTIFICATION_STATUS
MapAttributes=DEG_SERVICE_MGMT_POSTDATA,DEG_SERVICE_MGMT_POSTDATA
MapAttributes=DEG_DISPLAY_NAME,DEG_DISPLAY_NAME
MapAttributes=DEG_ADDRESS_STATUS,DEG_ADDRESS_STATUS
MapAttributes=DEG_TC_STATUS,DEG_TC_STATUS
MapAttributes=DEG_ADDR_UPDATE_POSTDATA,DEG_ADDR_UPDATE_POSTDATA
MapAttributes=DEG_ADDR_REFID,DEG_ADDR_REFID
MapAttributes=DEG_ADDR_REFID_EXP_DATE,DEG_ADDR_REFID_EXP_DATE
MapAttributes=DEG_LASTUPDATE,DEG_LASTUPDATE
MapAttributes=DEG_SIP_USERNAME,DEG_SIP_USERNAME
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/130.CheckDeviceDataLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExistsFlag
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.PrintError

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/130.CheckDeviceDataLookupStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0229"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_DEVICE_DATA table"
AdornOps=set DEG_CDevOutReturnCodeString "500"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/130.CheckDeviceDataLookupStatus/110.PrintError]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_UNIQUE_ID
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_DevAndroidEntitlementNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: in looking up DEG_DEVICE_DATA table
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/130.CheckDeviceDataLookupStatus/200.CheckKeyExistsFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
TrueRuleChain=100.RowFound
FalseRuleChain=200.RowNotFound

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/130.CheckDeviceDataLookupStatus/200.CheckKeyExistsFlag/100.RowFound]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_DevRowExistsFlagInteger 1

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200M.DEG30DeviceDataLookupRuleChain/130.CheckDeviceDataLookupStatus/200.CheckKeyExistsFlag/200.RowNotFound]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_DevRowExistsFlagInteger 0

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=85.InitErrorLog
RuleNames=100.Log
RuleNames=100.Initialise
RuleNames=100.CheckRowExistsFlag
#RuleNames=200.ImsiConditionCheck

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.Initialise]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevPrevImsiString ""
AdornOps=set DEG_OEMPrevUniqueId ""
AdornOps=set DEG_OEMCurrUniqueId ""

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/85.InitErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0230"
AdornOps=set DEG_OEMDevMessageString "Device Data process rule chain is called"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.Log]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_IMSI
Attributes=DEG_OEMDevPrevImsiString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Device Data process rule chain is called : 
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/200.ImsiConditionCheck]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevImsiString,=,DEG_IMSI
FalseRuleChain=100.DeleteRowMatchingCurrentUniqueId
TrueRuleChain=200.SetPrevAndCurrentUniqueIdAttribute

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/200.ImsiConditionCheck/200.SetPrevAndCurrentUniqueIdAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_UNIQUE_ID DEG_OEMPrevUniqueId
AdornOps=copy DEGDROID_TerminalUniqueIdString DEG_OEMCurrUniqueId


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_DevRowExistsFlagInteger,=,0
Conditions=DEG_DevRowExistsFlagInteger,=,1

TrueRuleChain=InsertDeviceData
TrueRuleChain=UpdateDeviceData

InsertDeviceData=100.CopyRequestImsiToPrevImsi
InsertDeviceData=110.ImsiandEntitlementLookup
InsertDeviceData=100.InitInsertDeviceDataLookup
InsertDeviceData=110.InsertDeviceData
InsertDeviceData=120.CheckDBErrorFlag

UpdateDeviceData=200.CheckImsiValue
UpdateDeviceData=200.InitUpdate
UpdateDeviceData=210.UpdateDeviceData
UpdateDeviceData=220.CheckUpdateStatus
UpdateDeviceData=230.ImsiandEntitlementLookup

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/110.ImsiandEntitlementLookup]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200P.DEG30ImsiBasedDeviceDataLookupRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/100.CopyRequestImsiToPrevImsi]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevImsiString DEG_OEMDevPrevImsiString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.InitDeviceDataLookup
RuleNames=120.ExecuteDeviceDataLookup
RuleNames=130.CheckDBErrorFlag

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/110.InitDeviceDataLookup]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevPrevImsiString DEG_IMSI

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/120.ExecuteDeviceDataLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
NativeCondition=4.MatchByIMSIAndEntitelementName
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
MapAttributes=DEG_ENTITLEMENT_NAME,DEG_ENTITLEMENT_NAME
MapAttributes=DEG_APNS_TOKEN,DEG_APNS_TOKEN
MapAttributes=DEG_PUSH_NOTIFICATION_STATUS,DEG_PUSH_NOTIFICATION_STATUS
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.PrintError
FalseRuleChain=200.CheckKeyExistFlag

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0231"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_DEVICE_DATA table"
AdornOps=set DEG_CDevOutReturnCodeString "500"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/110.PrintError]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevUniqueIDString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: while looking up in DEG_DEVICE_DATA table
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.CheckRowExistFlag

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
TrueRuleChain=110.RowFound
TrueRuleChain=120.DeleteRowMatchingCurrentImsi
FalseRuleChain=200.RowNotFound

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/110.RowFound]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMPrevUniqueId DEG_UNIQUE_ID

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitDeviceDataUpdate
RuleNames=200.DeleteDeviceDataTable
RuleNames=300.CheckDeleteStatus

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/100.InitDeviceDataUpdate]

AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/200.DeleteDeviceDataTable]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
NativeCondition=4.MatchByIMSIAndEntitelementName
SessionStore=DEG_DEVICE_DATA_SessionStore
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/300.CheckDeleteStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SystemError_SetResponse
TrueRuleChain=110.SystemError_Log
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/300.CheckDeleteStatus/100.SystemError_SetResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0232"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform delete a row in DEG_DEVICE_DATA table"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevOutReturnCodeString "500"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/300.CheckDeleteStatus/110.SystemError_Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
Message=Unable to perform delete operation on DEG_DEVICE_DATA table: 
NullAlso=true
LogLevel=CRITICAL
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/300.CheckDeleteStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/300.CheckDeleteStatus/200.CheckKeyExists/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0233"
AdornOps=set DEG_OEMDevErrorMessageString "No data in DEG_DEVICE_DATA table"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/120.DeleteRowMatchingCurrentImsi/300.CheckDeleteStatus/200.CheckKeyExists/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=DEBUG
Message=Database Error: No data in DEG_DEVICE_DATA session store
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200P.DEG30ImsiBasedDeviceDataLookupRuleChain/130.CheckDBErrorFlag/200.CheckKeyExistFlag/110.CheckRowExistFlag/200.RowNotFound]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMPrevUniqueId ""

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/230.ImsiandEntitlementLookup]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200P.DEG30ImsiBasedDeviceDataLookupRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/200.CheckImsiValue]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevImsiString,=,DEG_IMSI
FalseRuleChain=100.CopyTableImsiToPrevImsi

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/200.CheckImsiValue/100.CopyTableImsiToPrevImsi]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_IMSI DEG_OEMDevPrevImsiString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/100.InitInsertDeviceDataLookup]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation INSERT
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=copy DEGDROID_TerminalUniqueIdString DEG_UNIQUE_ID
AdornOps=set DEG_DevAndroidEntitlementNameString ${ANDROIDVOWIFI_ENTITLEMENT_NAME}
AdornOps=copy DEG_DevAndroidEntitlementNameString DEG_ENTITLEMENT_NAME
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=setifnull DEG_APNS_TOKEN ""
AdornOps=setifnull DEG_OLD_APNS_TOKEN ""
AdornOps=setifnull DEG_SUB_STATUS 0
AdornOps=setifnull DEG_PUSH_NOTIFICATION_STATUS 0
AdornOps=setifnull DEG_SERVICE_MGMT_POSTDATA ""
AdornOps=setifnull DEG_DISPLAY_NAME ""
AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDR_REFID ""
AdornOps=setsystime DEG_ADDR_REFID_EXP_DATE
AdornOps=setsystime DEG_LASTUPDATE
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_SIP_USERNAME ""
AdornOps=setifnull DEG_SSL_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_SSL_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_SSL_POSTDATA ""
AdornOps=setifnull DEG_SSL_ID_PROV_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=copy DEG_SIP_USERNAME DEG_SIP_USERNAME
AdornOps=copy DEG_SSL_ADDRESS_STATUS DEG_ADDRESS_STATUS
AdornOps=copy DEG_SSL_TC_STATUS DEG_TC_STATUS
AdornOps=copy DEG_SSL_POSTDATA DEG_ADDR_UPDATE_POSTDATA
AdornOps=copy DEG_SSL_ID_PROV_STATUS DEG_PROVISIONING_STATUS

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/110.InsertDeviceData]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
SessionStore=DEG_DEVICE_DATA_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/120.CheckDBErrorFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.PrintError

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/120.CheckDBErrorFlag/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0234"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to access or create entry in DEG_DEVICE_DATA table"
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevOutReturnCodeString "500"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/120.CheckDBErrorFlag/110.PrintError]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: unable to add row in DEG_DEVICE_DATA table
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/200.InitUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_DEVICE_DATA"
AdornOps=copy DEGDROID_TerminalUniqueIdString DEG_UNIQUE_ID
AdornOps=copy DEG_DevAndroidEntitlementNameString DEG_ENTITLEMENT_NAME
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=setifnull DEG_APNS_TOKEN ""
AdornOps=setifnull DEG_OLD_APNS_TOKEN ""
AdornOps=setifnull DEG_SUB_STATUS 0
AdornOps=setifnull DEG_PUSH_NOTIFICATION_STATUS 0
AdornOps=setifnull DEG_SERVICE_MGMT_POSTDATA ""
AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDR_REFID ""
AdornOps=setsystime DEG_ADDR_REFID_EXP_DATE
AdornOps=setsystime DEG_LASTUPDATE
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_SIP_USERNAME ""
AdornOps=copy DEG_SIP_USERNAME DEG_SIP_USERNAME
AdornOps=copy DEG_SSL_ID_PROV_STATUS DEG_PROVISIONING_STATUS
AdornOps=copy DEG_SSL_ADDRESS_STATUS DEG_ADDRESS_STATUS
AdornOps=copy DEG_SSL_TC_STATUS DEG_TC_STATUS
AdornOps=copy DEG_SSL_POSTDATA DEG_ADDR_UPDATE_POSTDATA

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/210.UpdateDeviceData]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
MapAttributes=DEG_ENTITLEMENT_NAME,DEG_ENTITLEMENT_NAME
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_APNS_TOKEN,DEG_APNS_TOKEN
MapAttributes=DEG_OLD_APNS_TOKEN,DEG_OLD_APNS_TOKEN
MapAttributes=DEG_PROVISIONING_STATUS,DEG_PROVISIONING_STATUS
MapAttributes=DEG_PUSH_NOTIFICATION_STATUS,DEG_PUSH_NOTIFICATION_STATUS
MapAttributes=DEG_SERVICE_MGMT_POSTDATA,DEG_SERVICE_MGMT_POSTDATA
MapAttributes=DEG_DISPLAY_NAME,DEG_DISPLAY_NAME
MapAttributes=DEG_ADDRESS_STATUS,DEG_ADDRESS_STATUS
MapAttributes=DEG_TC_STATUS,DEG_TC_STATUS
MapAttributes=DEG_ADDR_UPDATE_POSTDATA,DEG_ADDR_UPDATE_POSTDATA
MapAttributes=DEG_ADDR_REFID,DEG_ADDR_REFID
MapAttributes=DEG_ADDR_REFID_EXP_DATE,DEG_ADDR_REFID_EXP_DATE
MapAttributes=DEG_LASTUPDATE,DEG_LASTUPDATE
MapAttributes=DEG_SIP_USERNAME,DEG_SIP_USERNAME
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/220.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/220.CheckUpdateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0235"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_DEVICE_DATA table"
AdornOps=set DEG_CDevOutReturnCodeString "500"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/220.CheckUpdateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_DEVICE_DATA session store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/220.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/220.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0236"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_DEVICE_DATA table"

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/200N.DEG30DeviceDataProcessRuleChain/100.CheckRowExistsFlag/220.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_DEVICE_DATA session store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.



[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
#AdornOps=set DEG_AuditUniqueIDString ""
#AdornOps=set DEG_AuditTransactionTypeString "initial-auth-request"
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Successful authentication by AAA,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/701.DEG30GenerateEapAkaInitialAAAAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
#AdornOps=set DEG_AuditUniqueIDString ""
#AdornOps=set DEG_AuditTransactionTypeString "initial-auth-request"
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Sent EAP-AKA message to Device,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/702.DEG30GenerateEapAkaInitialAkaWaitEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
#AdornOps=set DEG_AuditUniqueIDString ""
#AdornOps=set DEG_AuditTransactionTypeString "initial-auth-request"
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Successful authentication by DEG_TOKEN,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/703.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
#AdornOps=set DEG_AuditUniqueIDString ""
#AdornOps=set DEG_AuditTransactionTypeString "initial-auth-request"
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Successful authentication by default,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/704.DEG30GenerateEapAkaInitialDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

#QXCM1001475098 -DEG_CDevOutReturnCodeString is changed from 12 to 500.

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=setifnull DEG_CDevOutReturnCodeString "500"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
#AdornOps=set DEG_AuditUniqueIDString ""
#AdornOps=set DEG_AuditTransactionTypeString "initial-auth-request"
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Authentication attempt rejected by AAA,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

#QXCM1001545582:3.2.4 Degdroid Defect(NullPOinterException)
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=setifnull DEG_AuditTransactionTypeStringtemp ""
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
#AdornOps=set DEG_AuditUniqueIDString ""
#AdornOps=set DEG_AuditTransactionTypeString "initial-auth-request"
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

#QXCM1001475098 -DEG_CDevOutReturnCodeString is changed from 12 to 511 in below rule chain

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "511"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
#AdornOps=set DEG_AuditUniqueIDString ""
#AdornOps=set DEG_AuditTransactionTypeString "initial-auth-request"
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "BlackListed Subscriber,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

#QXCM1001475098 -DEG_CDevOutReturnCodeString is changed from 12 to 511 in below rule chain

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "511"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
#AdornOps=set DEG_AuditUniqueIDString ""
#AdornOps=set DEG_AuditTransactionTypeString "initial-auth-request"
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Status Disallowed Action,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevHttpStatusInteger DEG_AuditNRBMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/709.DEG30GenerateEapAkaInitialDisallowedActionEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true




[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
#AdornOps=set DEG_AuditUniqueIDString ""
#AdornOps=set DEG_AuditTransactionTypeString "initial-auth-request"
AdornOps=copy DEG_AuditTransactionTypeStringtemp DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_AuditSourceDestinationVersionString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_AuditTransactionTypeString DEG_AuditMessageString
AdornOps=set DEG_TempString " error response: "
AdornOps=+ DEG_AuditMessageString DEG_TempString DEG_AuditMessageString


[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString

[/templates/DEG/DEGDROID_DeviceInterface/EAP_AKA_Auth_Core/RuleChains/710.DEG30GenerateEapAkaInitialInvalidTokenEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


