[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01]

CCFLoader=CcfLoader
ClassName=com.hp.siu.adminagent.procmgr.SessionServerProcess
Description=DEG_WifiAuthInterface_02
MBeanServerConnection=service:jmx:rmi://192.85.143.62/jndi/rmi://192.85.143.62:46971/jmxconnector
QueryInterface=
RepositoryLoader=RepositoryLoader
SNMESchemaLoader=SNMELoader
StartClassName=com.hp.siu.sessionserver.SessionServer
JDBCConnectionPoolService=PoolService
@Include(pattern="**")
@Include(pattern="**#*", merge=true)
Link=/templates/DEG/WifiAuthInterface/Common_Customize

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/CcfLoader]

ClassName=com.hp.usage.ccf.framework.CCFLoader
FormatPath=datamodel/format
TransformationPath=datamodel/transform


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/NMEStores]

ClassName=NMEStoreManager
NMEStoreNames=AuditNMEStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/NMEStores/AuditNMEStore]

ClassName=AsynchNMEStore
NMEBatchSize=100
QueueSize=10000
SkipStructuredNME=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/NMEStores/AuditNMEStore/PersistentStore]

Attributes=DEG_AuditFormatIdString
Attributes=DEG_AuditTimestampLong
Attributes=DEG_AuditProcessingNodeString
Attributes=DEG_AuditInterfaceString
Attributes=DEG_AuditInOutString
Attributes=DEG_AuditResultCodeString
Attributes=DEG_AuditMdnString
Attributes=DEG_AuditTransactionTypeString
Attributes=DEG_AuditSourceDestinationString
Attributes=DEG_AuditSourceDestinationVersionString
Attributes=DEG_AuditDurationLong
Attributes=DEG_AuditChannelIdString
Attributes=DEG_AuditChannelNameString
Attributes=DEG_AuditASPServiceIdString
Attributes=DEG_AuditASPServiceNameString
Attributes=DEG_AuditASPIdString
Attributes=DEG_AuditASPNameString
Attributes=DEG_AuditNRBMessageString
Attributes=DEG_AuditMessageString
Attributes=DEG_AuditSessionIdString
Attributes=DEG_AuditIMSIString
ClassName=FilePersistentStore
DataDir=${WIFI_AUDIT_DATA_DIR}
FileNameTemplate=${WIFI_AUDIT_BINARY_FILE_NAME}
FileNameTZ=UTC
GenerateEmptyFiles=false


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/NMEStores/AuditNMEStore/PersistentStore/FlushPolicy]

ClassName=ClockTimeSessionServerFlushPolicy
ClockInterval=10s
MaxNMEs=100000


####### Common START ##########
[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors]

Link=/templates/DEG/WifiAuthInterface/Common/Connectors

####### Common END ############


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/600.RadiusSessionScheduler]

ClassName=com.hp.siu.scheduler.Scheduler
ScheduledJobs=100.RadiusSessionExpirationValidator

#QXCM1001544811: TaskLogLevel attribute for all of ScheduledJob is set.
[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/600.RadiusSessionScheduler/100.RadiusSessionExpirationValidator]

MaxExecutions=-1
PollIntervalClassName=com.hp.siu.utils.SecondsInterval
QueryInterval=100ms
TaskLogLevel=DEBUG4
Tasks=100.ProcessRadiusAuthenticationTimeouts


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/600.RadiusSessionScheduler/100.RadiusSessionExpirationValidator/100.ProcessRadiusAuthenticationTimeouts]

ClassName=com.hp.siu.sessionserver.InvokeRuleChainTask
InputNMEAttributes=EndTime,%current_time%
RuleChain=3000.ProcessRadiusAuthenticationTimeouts


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter]

ClassName=com.hp.usage.radius.adapter.RadiusAdapter
Codec=RadiusCodec
IOCoreThreadPoolSize=10
IOMaxThreadPoolSize=${DEVICE_RADIUS_IOMAX_POOL_SIZE}
ProcessorCoreThreadPoolSize=${DEVICE_RADIUS_PROC_CORE_POOL_SIZE}
ProcessorMaxThreadPoolSize=${DEVICE_RADIUS_PROC_MAX_POOL_SIZE}


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter/Server]

ClassName=RadiusServer
CacheResponse=true
Host=${WIFI_RADIUS_SERVER_HOST_IP}
Port=${WIFI_RADIUS_SERVER_HOST_PORT}
RecvBufferSize=65536
EnableProxy=false
RequestProcessor=ServerRequestProcessor
ErrorProcessor=RadiusAdapterErrorProcessor
RequestTTL=6000
SessionTTL=60000
SendBufferSize=65536
SharedSecretStores=dynamicstore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter/Server/dynamicstore]

ClassName=RuleChainSharedSecretStore
HostAddressAttribute=ClientAddress
RuleChain=800.SharedSecretFetch
SharedSecretAttribute=SharedSecret


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter/Server/RadiusAdapterErrorProcessor]

ClassName=com.hp.usage.radius.adapter.RuleChainErrorProcessor
ErrorCodeAttribute=DEG_WifiRadiusErrorString
ErrorMessageAttribute=DEG_WifiReplyMessageString
ErrorPacketAttribute=DEG_WifiErrorPacketBinary
ErrorRuleChain=700.RadiusErrorLog
HostAttribute=DEG_WifiErrorHostString
PortAttribute=DEG_WifiErrorPortInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter/Server/ServerRequestProcessor]

ClassName=com.hp.usage.radius.adapter.RuleChainMessageProcessor
DecodeAttributes=radius:RadiusMessage,DeviceRadiusMessage
DecodedAttributeSpecifier=specifier
EncodeAttribute=DeviceRadiusMessage
IgnoreInvalidResponse=true
RootNMEType=radius:Umbrella
SynchronousMode=false
RuleChainMapping=1,100.ProcessRadiusRequest


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter/RadiusCodec]


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter/RadiusCodec/Decoder]

UseRepository=true
XfdList=radius.AccessRequest
XfdList=radius.AccessReject
XfdList=radius.AccessAccept
XfdList=radius.AccessChallenge


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter/RadiusCodec/Decoder/radius.AccessAccept]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter/RadiusCodec/Decoder/radius.AccessChallenge]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius//


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter/RadiusCodec/Decoder/radius.AccessReject]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter/RadiusCodec/Decoder/radius.AccessRequest]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter/RadiusCodec/Encoder]
UseRepository=true
XfdList=radius.AccessRequest
XfdList=radius.AccessReject
XfdList=radius.AccessAccept
XfdList=radius.AccessChallenge


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter/RadiusCodec/Encoder/radius.AccessAccept]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter/RadiusCodec/Encoder/radius.AccessChallenge]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter/RadiusCodec/Encoder/radius.AccessReject]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/100.RadiusServerProtocolAdapter/RadiusCodec/Encoder/radius.AccessRequest]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


####### EAPAKAAuthenticatorRadius START ##########
[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/200.RadiusClientProtocolAdapter]

Link=/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter
####### EAPAKAAuthenticatorRadius END ############


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/300.CorbaConnector]

ClassName=CorbaConnector

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Connectors/700.RefreshCacheConnector]

ClassName=com.hp.siu.plugins.dna.collector.rules.SocketConnector
ListenPort=${WIFI_LISTEN_PORT}





[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/License]


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ManagementService]

ClassName=com.hp.usage.management.ManagementService

#RFE 86 : Include Bell Changes into Product. Introduced new Environment variable to define timezone.
[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Properties]

JVMOPTS=%DEFAULTS%
JVMOPTS=${WIFI_MIN_HEAP_SIZE}
JVMOPTS=${WIFI_MAX_HEAP_SIZE}
JVMOPTS=-Duser.timezone=${SYSTIMEZONE}
JVMOPTS=-XX:+DisableExplicitGC
JVMOPTS=-XX:+UseParNewGC
JVMOPTS=-verbose:gc
JVMOPTS=-XX:+PrintGCDetails
JVMOPTS=-XX:+PrintGCTimeStamps
JVMOPTS=-Xloggc:%VARROOT%/DEG_GcLogs/DEG_WifiAuthInterface_gc.log
JVMOPTS=-XX:+UseConcMarkSweepGC
JVMOPTS=-XX:+UseFastAccessorMethods
JVMOPTS=-XX:+ScavengeBeforeFullGC
JVMOPTS=-XX:SurvivorRatio=1
JVMPROPERTIES=%DEFAULTS%
JVMPROPERTIES=LogRequestInOutLevel1=true
JVMPROPERTIES=LogRequestFlowLevel1=true
JVMPROPERTIES=LogRequestIssueLevel1=true
PROCESSARGS=-l 4
STARTUPMODE=${STARTUPMODE}


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RepositoryLoader]

ClassName=com.hp.usage.jcr.repository.RepositoryContentLoader
ContentPath=datamodel


####### Common START ##########
[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService]

Link=/templates/DEG/WifiAuthInterface/Common/ReferenceDataService
####### Common END ############


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/100.GetSysParameterValue]

ClassName=com.hp.usage.refdatasrv.CachedQuery
ResultAttribute=DEG_WifiRecordFoundInteger
ResultIndexAttribute=DEG_WifiIndexInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/100.GetSysParameterValue/Cache]

ClassName=com.hp.usage.refdatasrv.HashMapLookupCache
CacheAttributes=DEG_SYSVALUE
CacheKeyAttributes=DEG_SYSPARAMETER
NMEKeyAttributes=DEG_WifiSysParameter


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/100.GetSysParameterValue/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogAlarming


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/100.GetSysParameterValue/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/100.GetSysParameterValue/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_WifiRecordFoundInteger DEG_WifiRecordFoundInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/100.GetSysParameterValue/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiRecordFoundInteger 0
AdornOps=set DEG_WifiIndexInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_SYS_PARAMETERS"
AdornOps=set DEG_SYSVALUE ""
AdornOps=set DEG_SYSPARAMETER ""


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/100.GetSysParameterValue/Loader]

ClassName=com.hp.usage.refdatasrv.JDBCLoader
FieldExtracted=DEG_SYSPARAMETER,DEG_SYSPARAMETER
FieldExtracted=DEG_SYSVALUE,DEG_SYSVALUE
CommonPolicyID=Policy1
QueryString=select %FIELDS from DEG_SYS_PARAMETERS


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/100.GetSysParameterValue/RefreshPolicy]

ClassName=com.hp.siu.plugins.dna.collector.rules.CronIntervalRefreshPolicy
RefreshCronInterval=0 * * * *


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/100.GetSysParameterValue/ResultRowRule]

AdornOps=copy DEG_SYSVALUE DEG_WifiSysValueString
AdornOps=set DEG_WifiRecordFoundInteger 1
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/200.GetMonitoringSessionActiveSession]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_MSESSIONID,DEG_MSESSIONID
##JDBCDataSourceConnectorName=500.RefDataDbConnectorNRB
CommonPolicyID=Policy2
QueryConditionColumns=DEG_MSESSIONKEY,VarChar
QueryString=SELECT %FIELDS FROM DEG_MONITORING_SESSIONS WHERE DEG_MSESSIONTYPE in ('MDN','IMSI') AND DEG_MSESSIONSTATUS='AE' AND DEG_MSESSIONKEY = %DEG_MSESSIONKEY
ResultAttribute=DEG_WifiNrbRecordFoundInteger
ResultIndexAttribute=DEG_WifiNrbIndexInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/200.GetMonitoringSessionActiveSession/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.SetErrorProcessingFlag
RuleNames=100.LogAlarming


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/200.GetMonitoringSessionActiveSession/ErrorRule/000.SetErrorProcessingFlag]

ClassName=AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/200.GetMonitoringSessionActiveSession/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/200.GetMonitoringSessionActiveSession/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_WifiRecordFoundInteger DEG_WifiRecordFoundInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/200.GetMonitoringSessionActiveSession/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiNrbRecordFoundInteger 0
AdornOps=set DEG_WifiNrbIndexInteger 0
AdornOps=set DEG_MSESSIONID ""
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_MONITORING_SESSIONS"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/200.GetMonitoringSessionActiveSession/ResultRowRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetRecordFound
RuleNames=200.PopulateMonitoringSessionIdsList


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/200.GetMonitoringSessionActiveSession/ResultRowRule/100.SetRecordFound]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiNrbRecordFoundInteger 1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/200.GetMonitoringSessionActiveSession/ResultRowRule/200.PopulateMonitoringSessionIdsList]

ClassName=AddToListAttributeRule
Delimiters=,
InputAttribute=DEG_MSESSIONID
ListAttribute=DEG_WifiNrbMonitoringSessionIdList


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/300.GenerateMonitoringID]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_MSESSIONTRANSID,DEG_MSESSIONTRANSID
##JDBCDataSourceConnectorName=500.RefDataDbConnectorNRB
CommonPolicyID=Policy2
QueryString=SELECT SEQUENCE_NEXTVAL('DEG_MONITORINGID_GENERATOR') AS DEG_MSESSIONTRANSID
ResultAttribute=DEG_WifiNrbRecordFoundInteger
ResultIndexAttribute=DEG_WifiNrbIndexInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/300.GenerateMonitoringID/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogAlarming


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/300.GenerateMonitoringID/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/300.GenerateMonitoringID/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_WifiNrbRecordFoundInteger DEG_WifiNrbRecordFoundInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/300.GenerateMonitoringID/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiNrbRecordFoundInteger 0
AdornOps=set DEG_WifiNrbIndexInteger 0
AdornOps=set DEG_MSESSIONTRANSID 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "GenerateMonitoringID.NEXTVAL"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/300.GenerateMonitoringID/ResultRowRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiNrbRecordFoundInteger 1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/400.GetSharedSecretFromWifiIPAddress]

ClassName=com.hp.usage.refdatasrv.CachedQuery
ResultAttribute=DEG_WifiRecordFoundInteger
ResultIndexAttribute=DEG_WifiIndexInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/400.GetSharedSecretFromWifiIPAddress/Cache]

ClassName=com.hp.usage.refdatasrv.HashMapLookupCache
CacheAttributes=DEG_WIFISZSECRET
CacheKeyAttributes=DEG_WIFIIPV4ADDRESS
NMEKeyAttributes=ClientAddress


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/400.GetSharedSecretFromWifiIPAddress/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogAlarming


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/400.GetSharedSecretFromWifiIPAddress/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/400.GetSharedSecretFromWifiIPAddress/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_WifiRecordFoundInteger DEG_WifiRecordFoundInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/400.GetSharedSecretFromWifiIPAddress/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiRecordFoundInteger 0
AdornOps=set DEG_WifiIndexInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_WIFIIPADDRESS"
AdornOps=set DEG_WIFIIPV4ADDRESS ""
AdornOps=set DEG_WIFISZSECRET ""


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/400.GetSharedSecretFromWifiIPAddress/Loader]

ClassName=com.hp.usage.refdatasrv.JDBCLoader
FieldExtracted=DEG_WIFISZSECRET,DEG_WIFISZSECRET
FieldExtracted=DEG_WIFIIPV4ADDRESS,DEG_WIFIIPV4ADDRESS
CommonPolicyID=Policy1
QueryString=SELECT %FIELDS FROM DEG_WIFIIPADDRESS


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/400.GetSharedSecretFromWifiIPAddress/RefreshPolicy]

ClassName=com.hp.siu.plugins.dna.collector.rules.CronIntervalRefreshPolicy
RefreshCronInterval=0 * * * *


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/400.GetSharedSecretFromWifiIPAddress/ResultRowRule]

AdornOps=copy DEG_WIFISZSECRET DEG_WifiSecretString
AdornOps=set DEG_WifiRecordFoundInteger 1
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/500.GetSharedSecretAndStatusFromWifiIPAddress]

ClassName=com.hp.usage.refdatasrv.CachedQuery
ResultAttribute=DEG_WifiRecordFoundInteger
ResultIndexAttribute=DEG_WifiIndexInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/500.GetSharedSecretAndStatusFromWifiIPAddress/Cache]

ClassName=com.hp.usage.refdatasrv.HashMapLookupCache
CacheAttributes=DEG_WIFISZSECRET
CacheAttributes=DEG_WIFIIPSTATUS
CacheKeyAttributes=DEG_WIFIIPV4ADDRESS
NMEKeyAttributes=DEG_WifiHostString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/500.GetSharedSecretAndStatusFromWifiIPAddress/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogAlarming


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/500.GetSharedSecretAndStatusFromWifiIPAddress/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/500.GetSharedSecretAndStatusFromWifiIPAddress/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_WifiRecordFoundInteger DEG_WifiRecordFoundInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/500.GetSharedSecretAndStatusFromWifiIPAddress/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiRecordFoundInteger 0
AdornOps=set DEG_WifiIndexInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_WIFIIPADDRESS"
AdornOps=set DEG_WIFISZSECRET ""
AdornOps=set DEG_WIFIIPV4ADDRESS ""
AdornOps=set DEG_WIFIIPSTATUS ""


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/500.GetSharedSecretAndStatusFromWifiIPAddress/Loader]

ClassName=com.hp.usage.refdatasrv.JDBCLoader
FieldExtracted=DEG_WIFISZSECRET,DEG_WIFISZSECRET
FieldExtracted=DEG_WIFIIPSTATUS,DEG_WIFIIPSTATUS
FieldExtracted=DEG_WIFIIPV4ADDRESS,DEG_WIFIIPV4ADDRESS
CommonPolicyID=Policy1
QueryString=SELECT %FIELDS FROM DEG_WIFIIPADDRESS


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/500.GetSharedSecretAndStatusFromWifiIPAddress/RefreshPolicy]

ClassName=com.hp.siu.plugins.dna.collector.rules.CronIntervalRefreshPolicy
RefreshCronInterval=0 * * * *


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/500.GetSharedSecretAndStatusFromWifiIPAddress/ResultRowRule]

AdornOps=copy DEG_WIFISZSECRET DEG_WifiSecretString
AdornOps=copy DEG_WIFIIPSTATUS DEG_WifiIPAddressStatusString
AdornOps=set DEG_WifiRecordFoundInteger 1
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/600.GetRadiusCountFromSessionStore]

ClassName=JDBCQuery
CommitQuery=false
FieldExtracted=count(DEG_WIFIRPROCID),DEG_WifiCountInteger,0
CommonPolicyID=Policy1
QueryString=select %FIELDS from DEG_WIFIRADIUSSESSION
ResultAttribute=DEG_WifiRecordFoundInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/600.GetRadiusCountFromSessionStore/ErrorRule]

ClassName=RuleChain
RuleNames=100.LogAlarming

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/600.GetRadiusCountFromSessionStore/ErrorRule/100.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/600.GetRadiusCountFromSessionStore/InitialRule]

AdornOps=set DEG_WifiCountInteger 0
AdornOps=set DEG_WifiRecordFoundInteger 0
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_WIFIRADIUSSESSION"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/700.QueryRadiuSessionFromSessionStore]

ClassName=JDBCQuery
CommitQuery=false
FieldExtracted=DEG_WIFIRSTATE,DEG_WifiRadiusStateString,""
FieldExtracted=DEG_WIFIRUPDATETIMESTAMP,DEG_WifiRadiusUpdateTimeStamp,0
FieldExtracted=DEG_WIFIRORIGIPADDR,DEG_WifiHostString,""
FieldExtracted=DEG_WIFIRACCTSESSID,DEG_WifiAcctSessionIdString,""
FieldExtracted=DEG_WIFIRUSERNAME,DEG_WifiUserNameString,""
FieldExtracted=DEG_WIFIRIMSI,DEG_WifiIMSIString,""
FieldExtracted=DEG_WIFIRMDN,DEG_WifiMDNString,""
FieldExtracted=DEG_WIFIRORIGCODE,DEG_WifiCodeInteger,0
FieldExtracted=DEG_WIFIRORIGLENGTH,DEG_WifiLengthInteger,0
FieldExtracted=DEG_WIFIRORIGAUTHENTICATOR,DEG_WifiAuthenticatorString,0
CommonPolicyID=Policy1
QueryString=select %FIELDS from DEG_WIFIRADIUSSESSION
ResultAttribute=DEG_WifiRecordFoundInteger
ResultIndexAttribute=DEG_WifiIndexInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/700.QueryRadiuSessionFromSessionStore/ErrorRule]

ClassName=RuleChain
RuleNames=100.LogAlarming


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/700.QueryRadiuSessionFromSessionStore/ErrorRule/100.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/700.QueryRadiuSessionFromSessionStore/InitialRule]

ClassName=RuleChain
RuleNames=100.InitParams
RuleNames=200.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/700.QueryRadiuSessionFromSessionStore/InitialRule/100.InitParams]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiRecordFoundInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_WIFIRADIUSSESSION"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/700.QueryRadiuSessionFromSessionStore/InitialRule/200.LogNME]

Attributes=DEG_WifiRecordFoundInteger
ClassName=LogNMERule
Message=Radius Session Timeout QUERY STARTS:
LogLevel=DEBUG4
PropertyName=LogRequestFlowLevel1
UseProperty=false


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/700.QueryRadiuSessionFromSessionStore/ResultRowRule]

ClassName=RuleChain
RuleNames=100.SetMatchFound
RuleNames=200.InitRadiusParams
RuleNames=300.DeleteRadiusOldSessions


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/700.QueryRadiuSessionFromSessionStore/ResultRowRule/100.SetMatchFound]

AdornOps=set DEG_WifiRecordFoundInteger 1
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/700.QueryRadiuSessionFromSessionStore/ResultRowRule/200.InitRadiusParams]

AdornOps=copy DEG_WifiHostString DEG_WIFIRORIGIPADDR
AdornOps=copy DEG_WifiAcctSessionIdString DEG_WIFIRACCTSESSID
AdornOps=copy DEG_WifiUserNameString DEG_WIFIRUSERNAME
AdornOps=copy DEG_WifiRadiusUpdateTimeStamp DEG_WIFIRUPDATETIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/ReferenceDataService/700.QueryRadiuSessionFromSessionStore/ResultRowRule/300.DeleteRadiusOldSessions]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=4000.ProcessingRadiusSessionsRuleChain
UseRuleChainManagerPool=true


####### Common START ##########
[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains]

Link=/templates/DEG/WifiAuthInterface/Common/RuleChains
####### Common END ############



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetRequestStartTime
RuleNames=200.CheckErrorCode
RuleNames=300.SetResponse
RuleNames=400.SendResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/100.SetRequestStartTime]

AdornOps=setsystime DEG_WifiJMSTempReqStartTime
AdornOps=- DEG_WifiJMSTempReqStartTime 1 DEG_WifiJMSTempReqStartTime
AdornOps=set DEG_WifiNrbMonitoringSessionIdList null
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/300.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,11
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.answer.accessChallenge.action,2
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.request.accessRequest.action,2
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/400.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode]


ClassName=SwitchConditionRule
Operations=None
Conditions=DEG_WifiRadiusErrorString,=,"AUTHENTICATOR_CHECK_FAILED"
Conditions=DEG_WifiRadiusErrorString,=,"DECODE_ERROR"
Conditions=DEG_WifiRadiusErrorString,=,"DUPLICATE_PACKET"
Conditions=DEG_WifiRadiusErrorString,=,"ENCODE_ERROR"
Conditions=DEG_WifiRadiusErrorString,=,"MESSAGE_AUTHENTICATOR_CHECK_FAILED"
#Conditions=DEG_WifiRadiusErrorString,=,"INVALID_MESSAGE_TYPE"
Conditions=DEG_WifiRadiusErrorString,=,"REQUEST_PROCESSING_FAILED"
Conditions=DEG_WifiRadiusErrorString,=,"REQUEST_TIMEOUT"
Conditions=DEG_WifiRadiusErrorString,=,"RESPONSE_SEND_FAILED"
Conditions=DEG_WifiRadiusErrorString,=,"UNKNOWN"
Conditions=DEG_WifiRadiusErrorString,=,"SHAREDSECRET_NOT_FOUND"
Conditions=DEG_WifiRadiusErrorString,=,"SHAREDSECRET_GET_FAILED"


AUTHENTICATOR_CHECK_FAILED=100.InvokeAUTHENTICATOR_CHECK_FAILED
DECODE_ERROR=110.InvokeDECODE_ERROR
DUPLICATE_PACKET=120.InvokeDUPLICATE_PACKET
ENCODE_ERROR=130.InvokeENCODE_ERROR
MESSAGE_AUTHENTICATOR_CHECK_FAILED=140.InvokeMESSAGE_AUTHENTICATOR_CHECK_FAILED
#INVALID_MESSAGE_TYPE=150.InvokeINVALID_MESSAGE_TYPE
REQUEST_PROCESSING_FAILED=160.InvokeREQUEST_PROCESSING_FAILED
REQUEST_TIMEOUT=170.InvokeREQUEST_TIMEOUT
RESPONSE_SEND_FAILED=180.InvokeRESPONSE_SEND_FAILED
UNKNOWN=190.InvokeUNKNOWN
SHAREDSECRET_GET_FAILED=200.InvokeSHAREDSECRET_GET_FAILED
SHAREDSECRET_NOT_FOUND=210.InvokeSHAREDSECRET_NOT_FOUND

TrueRuleChain=AUTHENTICATOR_CHECK_FAILED
TrueRuleChain=DECODE_ERROR
TrueRuleChain=DUPLICATE_PACKET
TrueRuleChain=ENCODE_ERROR
TrueRuleChain=MESSAGE_AUTHENTICATOR_CHECK_FAILED
#TrueRuleChain=INVALID_MESSAGE_TYPE
TrueRuleChain=REQUEST_PROCESSING_FAILED
TrueRuleChain=REQUEST_TIMEOUT
TrueRuleChain=RESPONSE_SEND_FAILED
TrueRuleChain=UNKNOWN
TrueRuleChain=SHAREDSECRET_NOT_FOUND
TrueRuleChain=SHAREDSECRET_GET_FAILED


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/100.InvokeAUTHENTICATOR_CHECK_FAILED]

ClassName=RuleChain
RuleNames=100.LogNME
#RuleNames=200.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/100.InvokeAUTHENTICATOR_CHECK_FAILED/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=AUTHENTICATOR_CHECK_FAILED :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/100.InvokeAUTHENTICATOR_CHECK_FAILED/200.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/100.InvokeAUTHENTICATOR_CHECK_FAILED/200.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=set DEG_AuditMdnString ""
AdornOps=set DEG_AuditIMSIString ""
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=set DEG_AuditChannelNameString ""
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiErrorHostString DEG_AuditASPIdString
AdornOps=set DEG_AuditASPNameString ""
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/100.InvokeAUTHENTICATOR_CHECK_FAILED/200.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO DEGAUTH -> Discarding RADIUS Access request(error): DEG_WifiOutReturnCodeString = "
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/100.InvokeAUTHENTICATOR_CHECK_FAILED/200.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiErrorHostString DEG_AuditMessageString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/100.InvokeAUTHENTICATOR_CHECK_FAILED/200.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Invalid Authenticator RADIUS attribute"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/100.InvokeAUTHENTICATOR_CHECK_FAILED/200.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR]

ClassName=RuleChain
RuleNames=100.LogNME
RuleNames=200.CheckRadiusCode
RuleNames=300.CheckUDPLength
RuleNames=400.CheckRecordLength
RuleNames=500.CheckUDPPacketLength


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=DECODE_ERROR :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/200.CheckRadiusCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiReplyMessageString,contains,"Missing AVP with code"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/200.CheckRadiusCode/TrueRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogNME
#RuleNames=200.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/200.CheckRadiusCode/TrueRule/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=Radius Code NOT equal to 1 Malformed UDP/RADIUS message :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/200.CheckRadiusCode/TrueRule/200.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/200.CheckRadiusCode/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=set DEG_AuditMdnString ""
AdornOps=set DEG_AuditIMSIString ""
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=set DEG_AuditChannelNameString ""
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiErrorHostString DEG_AuditASPIdString
AdornOps=set DEG_AuditASPNameString ""

ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/200.CheckRadiusCode/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO DEGAUTH -> Discarding RADIUS Access request(error): DEG_WifiOutReturnCodeString = "
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/200.CheckRadiusCode/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiErrorHostString DEG_AuditMessageString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/200.CheckRadiusCode/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "RADIUS Access expected"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/200.CheckRadiusCode/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/300.CheckUDPLength]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiReplyMessageString,contains,"Invalid packet length "


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/300.CheckUDPLength/TrueRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogNME
#RuleNames=200.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/300.CheckUDPLength/TrueRule/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=Invalid packet length Malformed UDP/RADIUS Message :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/300.CheckUDPLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/300.CheckUDPLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=set DEG_AuditMdnString ""
AdornOps=set DEG_AuditIMSIString ""
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=set DEG_AuditChannelNameString ""
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiErrorHostString DEG_AuditASPIdString
AdornOps=set DEG_AuditASPNameString ""
ClassName=AdornmentRule

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/300.CheckUDPLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO DEGAUTH -> Discarding RADIUS Access request(error): DEG_WifiOutReturnCodeString = "
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/300.CheckUDPLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiErrorHostString DEG_AuditMessageString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/300.CheckUDPLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

ClassName=AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Invalid UDP packet length "


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/300.CheckUDPLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/400.CheckRecordLength]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiReplyMessageString,contains,"Invalid record length"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/400.CheckRecordLength/TrueRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogNME
#RuleNames=200.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/400.CheckRecordLength/TrueRule/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=Unable to parse RADIUS attributes Malformed UDP/RADIUS message :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/400.CheckRecordLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/400.CheckRecordLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString "DEG_WifiAuthInterface_"
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=set DEG_AuditMdnString ""
AdornOps=set DEG_AuditIMSIString ""
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=set DEG_AuditChannelNameString ""
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiErrorHostString DEG_AuditASPIdString
AdornOps=set DEG_AuditASPNameString ""
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/400.CheckRecordLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO DEGAUTH -> Discarding RADIUS Access request(error): DEG_WifiOutReturnCodeString = "
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/400.CheckRecordLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiErrorHostString DEG_AuditMessageString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/400.CheckRecordLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

ClassName=AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Unable to parse RADIUS attributes"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/400.CheckRecordLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/500.CheckUDPPacketLength]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiReplyMessageString,=,""
TrueRuleChain=TrueRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/500.CheckUDPPacketLength/TrueRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogNME
#RuleNames=200.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/500.CheckUDPPacketLength/TrueRule/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=Invalid UDP packet length Malformed UDP/RADIUS Message :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/500.CheckUDPPacketLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/500.CheckUDPPacketLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=set DEG_AuditMdnString ""
AdornOps=set DEG_AuditIMSIString ""
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=set DEG_AuditChannelNameString ""
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiErrorHostString DEG_AuditASPIdString
AdornOps=set DEG_AuditASPNameString ""
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/500.CheckUDPPacketLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO DEGAUTH -> Discarding RADIUS Access request(error): DEG_WifiOutReturnCodeString = "
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/500.CheckUDPPacketLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiErrorHostString DEG_AuditMessageString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/500.CheckUDPPacketLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Invalid UDP packet length "
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/500.CheckUDPPacketLength/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/120.InvokeDUPLICATE_PACKET]

ClassName=RuleChain
RuleNames=100.LogNME
#RuleNames=200.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/120.InvokeDUPLICATE_PACKET/100.LogNME]

Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
ClassName=LogNMERule
LogLevel=INFO
Message=Duplicate Radius packet received :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/120.InvokeDUPLICATE_PACKET/200.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/120.InvokeDUPLICATE_PACKET/200.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=set DEG_AuditMdnString ""
AdornOps=set DEG_AuditIMSIString ""
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=set DEG_AuditChannelNameString ""
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiErrorHostString DEG_AuditASPIdString
AdornOps=set DEG_AuditASPNameString ""
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/120.InvokeDUPLICATE_PACKET/200.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO DEGAUTH -> Discarding RADIUS Access request(error): DEG_WifiOutReturnCodeString = "
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/120.InvokeDUPLICATE_PACKET/200.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiErrorHostString DEG_AuditMessageString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/120.InvokeDUPLICATE_PACKET/200.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

ClassName=AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Duplicate request is being currently processed"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/120.InvokeDUPLICATE_PACKET/200.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/130.InvokeENCODE_ERROR]

ClassName=RuleChain
RuleNames=100.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/130.InvokeENCODE_ERROR/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=Error while Encoding the request


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/140.InvokeMESSAGE_AUTHENTICATOR_CHECK_FAILED]

ClassName=RuleChain
RuleNames=100.LogNME
#RuleNames=200.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/140.InvokeMESSAGE_AUTHENTICATOR_CHECK_FAILED/100.LogNME]

Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
ClassName=LogNMERule
LogLevel=INFO
Message=Malformed UDP/RADIUS message - wrong value of Message Authenticator AVP MESSAGE_AUTHENTICATOR_CHECK_FAILED :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/140.InvokeMESSAGE_AUTHENTICATOR_CHECK_FAILED/200.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/140.InvokeMESSAGE_AUTHENTICATOR_CHECK_FAILED/200.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=set DEG_AuditMdnString ""
AdornOps=set DEG_AuditIMSIString ""
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=- DEG_AuditTimestampLong DEG_WifiDeviceInterfaceProcessStartTimeLong DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=set DEG_AuditChannelNameString ""
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiErrorHostString DEG_AuditASPIdString
AdornOps=set DEG_AuditASPNameString ""
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/140.InvokeMESSAGE_AUTHENTICATOR_CHECK_FAILED/200.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO DEGAUTH -> Discarding RADIUS Access request(error): DEG_WifiOutReturnCodeString = "
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/140.InvokeMESSAGE_AUTHENTICATOR_CHECK_FAILED/200.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiErrorHostString DEG_AuditMessageString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/140.InvokeMESSAGE_AUTHENTICATOR_CHECK_FAILED/200.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

ClassName=AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Invalid Message Authenticator RADIUS attribute"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/140.InvokeMESSAGE_AUTHENTICATOR_CHECK_FAILED/200.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/160.InvokeREQUEST_PROCESSING_FAILED]

ClassName=RuleChain
RuleNames=100.LogNME
RuleNames=200.CheckRadiusCode


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/160.InvokeREQUEST_PROCESSING_FAILED/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=REQUEST_PROCESSING_FAILED :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/160.InvokeREQUEST_PROCESSING_FAILED/200.CheckRadiusCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiReplyMessageString,contains,"Accounting request processor failed to process request"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/160.InvokeREQUEST_PROCESSING_FAILED/200.CheckRadiusCode/TrueRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogNME
#RuleNames=200.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/160.InvokeREQUEST_PROCESSING_FAILED/200.CheckRadiusCode/TrueRule/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=Radius Code NOT equal to 1 Malformed UDP/RADIUS message :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/160.InvokeREQUEST_PROCESSING_FAILED/200.CheckRadiusCode/TrueRule/200.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/160.InvokeREQUEST_PROCESSING_FAILED/200.CheckRadiusCode/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditFormatIdString "V02"
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=set DEG_AuditMdnString ""
AdornOps=set DEG_AuditIMSIString ""
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=set DEG_AuditChannelNameString ""
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiErrorHostString DEG_AuditASPIdString
AdornOps=set DEG_AuditASPNameString ""
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/160.InvokeREQUEST_PROCESSING_FAILED/200.CheckRadiusCode/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO DEGAUTH -> Discarding RADIUS Access request(error): DEG_WifiOutReturnCodeString = "
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/160.InvokeREQUEST_PROCESSING_FAILED/200.CheckRadiusCode/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiErrorHostString DEG_AuditMessageString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/160.InvokeREQUEST_PROCESSING_FAILED/200.CheckRadiusCode/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "RADIUS Access expected"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/160.InvokeREQUEST_PROCESSING_FAILED/200.CheckRadiusCode/TrueRule/200.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/170.InvokeREQUEST_TIMEOUT]

ClassName=RuleChain
RuleNames=100.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/170.InvokeREQUEST_TIMEOUT/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=Request Timeout :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED]

ClassName=RuleChain
RuleNames=100.LogNME
#RuleNames=200.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED/200.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED/200.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditFormatIdString "V02"
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=set DEG_AuditMdnString ""
AdornOps=set DEG_AuditIMSIString ""
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=set DEG_AuditChannelNameString ""
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiErrorHostString DEG_AuditASPIdString
AdornOps=set DEG_AuditASPNameString ""
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED/200.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO DEGAUTH -> Discarding RADIUS Access request(error): DEG_WifiOutReturnCodeString = "
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED/200.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiErrorHostString DEG_AuditMessageString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED/200.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Unable to send response"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED/200.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=RESPONSE_SEND_FAILED :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/190.InvokeUNKNOWN]

ClassName=RuleChain
RuleNames=100.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/190.InvokeUNKNOWN/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=Unknown Error :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/200.InvokeSHAREDSECRET_GET_FAILED]

ClassName=RuleChain
RuleNames=100.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/200.InvokeSHAREDSECRET_GET_FAILED/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=Shared Secret failed :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/210.InvokeSHAREDSECRET_NOT_FOUND]

ClassName=RuleChain
RuleNames=100.LogNME
#RuleNames=200.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/210.InvokeSHAREDSECRET_NOT_FOUND/100.LogNME]

Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
ClassName=LogNMERule
LogLevel=INFO
Message=Shared Secret not found :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/210.InvokeSHAREDSECRET_NOT_FOUND/200.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/210.InvokeSHAREDSECRET_NOT_FOUND/200.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditFormatIdString "V02"
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "1157"
AdornOps=set DEG_AuditMdnString ""
AdornOps=set DEG_AuditIMSIString ""
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=set DEG_AuditChannelNameString ""
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiErrorHostString DEG_AuditASPIdString
AdornOps=set DEG_AuditASPNameString ""
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/210.InvokeSHAREDSECRET_NOT_FOUND/200.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG -> EAP Access Request Discarded :"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/210.InvokeSHAREDSECRET_NOT_FOUND/200.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiErrorHostString DEG_AuditMessageString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/210.InvokeSHAREDSECRET_NOT_FOUND/200.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Shared secret not found"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/700.RadiusErrorLog/200.CheckErrorCode/210.InvokeSHAREDSECRET_NOT_FOUND/200.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/000.SessionStoreDefaultErrorRuleChain]

ClassName=RuleChain
RuleNames=SetLookupErrorFlag
RuleNames=LogAlarming


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/000.SessionStoreDefaultErrorRuleChain/LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Database Error:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/000.SessionStoreDefaultErrorRuleChain/SetLookupErrorFlag]

AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 1
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/001.SessionStoreKeyNotExistsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ClearDuplicateKeyFlag


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/001.SessionStoreKeyNotExistsRuleChain/100.ClearDuplicateKeyFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 0


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/002.SessionStoreDuplicateKeyRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetDuplicateKeyFlag


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/002.SessionStoreDuplicateKeyRuleChain/100.SetDuplicateKeyFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/003.ReadSystemParameterRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReadSystemParameter


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/003.ReadSystemParameterRuleChain/100.ReadSystemParameter]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=100.GetSysParameterValue


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/003.ReadSystemParameterRuleChain/100.ReadSystemParameter/ErrorRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiValidDBReturnInteger 1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/003.ReadSystemParameterRuleChain/100.ReadSystemParameter/NoMatchRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiNoRecordFoundInteger 1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/004.ReadMonitoringSessionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReadMonitoringSession


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/004.ReadMonitoringSessionRuleChain/100.ReadMonitoringSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=200.GetMonitoringSessionActiveSession


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/004.ReadMonitoringSessionRuleChain/100.ReadMonitoringSession/ErrorRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiValidDBReturnInteger 1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/004.ReadMonitoringSessionRuleChain/100.ReadMonitoringSession/NoMatchRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiNoRecordFoundInteger 1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/005.ReadSharedSecretFromWifiIPAddressRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReadSharedSecretFromWifiIPAddress


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/005.ReadSharedSecretFromWifiIPAddressRuleChain/100.ReadSharedSecretFromWifiIPAddress]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=400.GetSharedSecretFromWifiIPAddress


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/005.ReadSharedSecretFromWifiIPAddressRuleChain/100.ReadSharedSecretFromWifiIPAddress/ErrorRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiValidDBReturnInteger 1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/005.ReadSharedSecretFromWifiIPAddressRuleChain/100.ReadSharedSecretFromWifiIPAddress/NoMatchRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiNoRecordFoundInteger 1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/006.ReadSharedSecretAndStatusFromWifiIPAddressRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReadSharedSecretAndStatusFromWifiIPAddress


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/006.ReadSharedSecretAndStatusFromWifiIPAddressRuleChain/100.ReadSharedSecretAndStatusFromWifiIPAddress]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=500.GetSharedSecretAndStatusFromWifiIPAddress


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/006.ReadSharedSecretAndStatusFromWifiIPAddressRuleChain/100.ReadSharedSecretAndStatusFromWifiIPAddress/ErrorRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiValidDBReturnInteger 1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/006.ReadSharedSecretAndStatusFromWifiIPAddressRuleChain/100.ReadSharedSecretAndStatusFromWifiIPAddress/NoMatchRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiNoRecordFoundInteger 1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/007.ReadRadiusCountFromSessionStoreRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReadRadiusCountFromSessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/007.ReadRadiusCountFromSessionStoreRuleChain/100.ReadRadiusCountFromSessionStore]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=600.GetRadiusCountFromSessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/007.ReadRadiusCountFromSessionStoreRuleChain/100.ReadRadiusCountFromSessionStore/ErrorRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiValidDBReturnInteger 1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/007.ReadRadiusCountFromSessionStoreRuleChain/100.ReadRadiusCountFromSessionStore/NoMatchRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiNoRecordFoundInteger 1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitLookup
RuleNames=200.Lookup
RuleNames=300.CheckLookupStatus


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/100.InitLookup]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_TOKENS"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/200.Lookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
NativeCondition=1.MatchingByMDN
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=100.SetErrorValues
TrueRuleChain=110.LogErrorValues
TrueRuleChain=120.GenerateDiscardedRadiusAccessAuditData

FalseRuleChain=200.CheckIfSessionKeyExists

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/120.GenerateDiscardedRadiusAccessAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=509.GenerateDiscardedRadiusAccessAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/100.SetErrorValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiOutReturnCodeString "3004"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.DEGT.10"
AdornOps=set DEG_WifiReplyMessageString "Unable to do Lookup in DEG_TOKENS table"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/110.LogErrorValues]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiUserNameIMSIString
Attributes=DEG_MDN
Attributes=DEG_WifiProcessingErrorIdString
LogLevel=CRITICAL
Message=Database Error: in lookup on DEG_TOKENS Table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.TokenNotFound
FalseRuleChain=200.TokenFound


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitCreate
RuleNames=200.Create
RuleNames=300.CheckCreateStatus


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/100.InitCreate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 0
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_WIFIRMDN DEG_MDN
AdornOps=copy DEG_WifiTokenString DEG_SUBSTOKEN
AdornOps=set DEG_TOKENSTATUS "AE"
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=setsystime DEG_FULLAUTHTIMESTAMP
AdornOps=set log_DB_Operation "CREATE"
AdornOps=set log_Table_Name "DEG_TOKENS"
AdornOps=set DEG_PUSH_TOKEN ""


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/200.Create]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_TOKENS_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckDuplicateKeyError


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.DEGT.11"
AdornOps=set DEG_WifiReplyMessageString "Unable to access or create entry in DEG_TOKENS table"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiUserNameIMSIString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_WifiProcessingErrorIdString
LogLevel=CRITICAL
Message=Database Error: unable to add record to DEG_TOKENS session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreKeyExistsFlagInteger,!=,0
TrueRuleChain=100.UpdateRecentlyCreatedToken


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/100.InitUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 0
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_WIFIRMDN DEG_MDN
AdornOps=copy DEG_WifiTokenString DEG_SUBSTOKEN
AdornOps=set DEG_TOKENSTATUS "AE"
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_TOKENS"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_AUTHENTICATION_TYPE,DEG_AUTHENTICATION_TYPE
MapAttributes=DEG_AUTHENTICATION_SUBTYPE,DEG_AUTHENTICATION_SUBTYPE
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,!=,0
Conditions=DEG_WifiSessionStoreKeyExistsFlagInteger,=,0
Operations=or
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.DEGT.12"
AdornOps=set DEG_WifiReplyMessageString "Unable to do update in DEG_TOKENS table"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiUserNameIMSIString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_WifiProcessingErrorIdString
LogLevel=CRITICAL
Message=Database Error: unable to update DEG_TOKENS session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/100.InitUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 0
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_WIFIRMDN DEG_MDN
AdornOps=copy DEG_WifiTokenString DEG_SUBSTOKEN
AdornOps=set DEG_TOKENSTATUS "AE"
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_TOKENS"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_AUTHENTICATION_TYPE,DEG_AUTHENTICATION_TYPE
MapAttributes=DEG_AUTHENTICATION_SUBTYPE,DEG_AUTHENTICATION_SUBTYPE
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
MapAttributes=DEG_APP_TOKEN_FLAG,DEG_APP_TOKEN_FLAG
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,!=,0
Conditions=DEG_WifiSessionStoreKeyExistsFlagInteger,=,0
Operations=or
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.DEG.13"
AdornOps=set DEG_WifiReplyMessageString "Unable to do update in DEG_TOKENS table"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/008.StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiUserNameIMSIString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_WifiProcessingErrorIdString
LogLevel=CRITICAL
Message=Database Error: unable to update DEG_TOKENS session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitParams
RuleNames=300.SNMEToNME
RuleNames=400.LogNME
RuleNames=500.ConvertBinaryToString
RuleNames=600.ValidateUserName
RuleNames=610.ValidateCallingStationID
#RuleNames=620.ValidateMessageAuthenticatorLength
RuleNames=630.ValidateRadiusCode
RuleNames=640.ValidateIPAddress
RuleNames=660.ValidateCallAuthenticationProcess
RuleNames=700.CheckErrorProcessingFlag


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/100.InitParams]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiUserNameString ""
AdornOps=set DEG_WifiEAPMessageBinary 0
AdornOps=set DEG_WifiStateBinary 0
AdornOps=set DEG_WifiCallingStationIdBinary 0
AdornOps=set DEG_WifiNASIPAddressBinary 0
AdornOps=set DEG_WifiCodeInteger 0
AdornOps=set DEG_WifiErrorProcessingFlagInteger 0
AdornOps=set DEG_WifiMessageAuthenticatorBinary 0
AdornOps=set DEG_WifiLengthMessageAuthenticatorInteger 0
AdornOps=set DEG_WifiAuthRequestTypeInteger 8
AdornOps=set DEG_WifiLengthMessageAuthenticatorInteger 0
AdornOps=set DEG_WifiIPAddressStatusConstantString "AE"
AdornOps=set DEG_WifiChallengeErrorCodeString ""
AdornOps=set DEG_WifiMDNString "0"
AdornOps=set DEG_WifiNrbMonitoringSessionIdList null
AdornOps=setsystime DEG_WifiJMSTempReqStartTime
AdornOps=set DEG_WIFIRPROCID 3
AdornOps=setsystime DEG_WifiDeviceInterfaceProcessStartTimeLong


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/300.SNMEToNME]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
SNMEType=radius:Umbrella
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.UserName,DEG_WifiUserNameString,""
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.SrcHost,DEG_WifiHostString,""
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.length,DEG_WifiLengthInteger,0
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.code,DEG_WifiCodeInteger,0
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.EAPMessage,DEG_WifiEAPMessageBinary,0
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.State,DEG_WifiStateBinary,0
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.CallingStationId,DEG_WifiCallingStationIdBinary,0
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.CalledStationId,DEG_WifiCalledStationIdBinary,0
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.ServiceType,DEG_WifiAuthRequestTypeInteger,0
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.NASIPAddress,DEG_WifiNASIPAddressBinary,0
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.NASPort,DEG_WifiNASPortLong,0
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.NASPortType,DEG_WifiNASPortTypeLong,0
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.NASIdentifier,DEG_WifiNASIdentifierBinary,0
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.MessageAuthenticator,DEG_WifiMessageAuthenticatorBinary,0
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.authenticator,DEG_WifiAuthenticatorBinary,0
StructuredNMEToNMEMap=DeviceRadiusMessage.request.accessRequest.FramedMTU,DEG_WifiFramedMTULong,0
CreateSNMEIfNeeded=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/400.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiUserNameString
Attributes=DEG_WifiHostString
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiStateBinary
Attributes=DEG_WifiCallingStationIdBinary
Attributes=DEG_WifiCodeInteger
LogLevel=INFO
Message= Received Access-Request From WIFIGW :
PropertyName=LogRequestInOutLevel1
UseProperty=false



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/500.ConvertBinaryToString]

AdornOps=bin2str DEG_WifiEAPMessageBinary DEG_WifiEAPMessageString
AdornOps=bin2str DEG_WifiStateBinary DEG_WifiStateString
AdornOps=bin2str DEG_WifiCallingStationIdBinary DEG_WifiCallingStationIdString
AdornOps=bin2str DEG_WifiNASIPAddressBinary DEG_WifiNASIPAddressString
AdornOps=bin2str DEG_WifiMessageAuthenticatorBinary DEG_WifiMessageAuthenticatorString
AdornOps=bin2str DEG_WifiAuthenticatorBinary DEG_WifiAuthenticatorString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitParams
RuleNames=200.CheckErrorProcessingFlag


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/100.InitParams]

AdornOps=setifnull DEG_WifiStateString ""
AdornOps=setifnull DEG_WifiCallingStationIdString ""
AdornOps=setifnull DEG_WifiUserNameString ""
AdornOps=set DEG_WifiUserNameIMSIString ""
AdornOps=set DEG_WifiUserNameMNCString ""
AdornOps=set DEG_WifiUserNameMCCString ""
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag]

ClassName=ConditionalRule
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag/TrueRule]

ClassName=PerlRegExStringRule
FalseRuleChain=100.NoMatchUserNameExpression
Operation=match
RegExPattern=^[0|1](\d*)@nai.epc.mnc(\d{3}).mcc(\d{3}).3gppnetwork.org
SourceAttribute=DEG_WifiUserNameString
TrueRuleChain=100.ExtractValuesFromUserName
TrueRuleChain=200.ExtractMCCAndMNCFromIMSI
TrueRuleChain=300.UserNameMCCAgainstIMSIMCC
TrueRuleChain=400.UserNameMNCAgainstIMSIMNC


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag/TrueRule/100.ExtractValuesFromUserName]

ClassName=PerlRegExStringRule
DestinationAttribute=DEG_WifiUserNameIMSIString
DestinationAttribute=DEG_WifiUserNameMNCString
DestinationAttribute=DEG_WifiUserNameMCCString
Operation=split
RegExPattern=^[0|1](\d*)@nai.epc.mnc(\d{3}).mcc(\d{3}).3gppnetwork.org
SourceAttribute=DEG_WifiUserNameString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag/TrueRule/200.ExtractMCCAndMNCFromIMSI]

AdornOps=substr 0 3 DEG_WifiUserNameIMSIString DEG_WifiIMSIMCCString
AdornOps=substr 3 6 DEG_WifiUserNameIMSIString DEG_WifiIMSIMNCString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag/TrueRule/300.UserNameMCCAgainstIMSIMCC]

ClassName=ConditionalRule
Conditions=DEG_WifiUserNameMCCString,!=,DEG_WifiIMSIMCCString
TrueRuleChain=100.NoMatchUserNameMCCAgainstIMSIMCC


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag/TrueRule/300.UserNameMCCAgainstIMSIMCC/100.NoMatchUserNameMCCAgainstIMSIMCC]

ClassName=RuleChain
RuleNames=100.SetErrorValues
RuleNames=200.LogNME

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag/TrueRule/300.UserNameMCCAgainstIMSIMCC/100.NoMatchUserNameMCCAgainstIMSIMCC/100.SetErrorValues]

AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiReplyMessageString "UserName MCC does not match with IMSI MCC"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.14"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag/TrueRule/300.UserNameMCCAgainstIMSIMCC/100.NoMatchUserNameMCCAgainstIMSIMCC/200.LogNME]

Attributes=DEG_WifiUserNameString
Attributes=DEG_WifiUserNameMCCString
Attributes=DEG_WifiIMSIMCCString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiProcessingErrorIdString
ClassName=LogNMERule
LogLevel=WARNING
Message=UserName MCC does not match with IMSI MCC :
PropertyName=LogRequestInOutLevel1
UseProperty=true
#Action=UserName MCC does not match with IMSI MCC.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag/TrueRule/400.UserNameMNCAgainstIMSIMNC]

ClassName=ConditionalRule
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag/TrueRule/400.UserNameMNCAgainstIMSIMNC/TrueRule]

ClassName=ConditionalRule
Conditions=DEG_WifiUserNameMNCString,!=,DEG_WifiIMSIMNCString
TrueRuleChain=100.NoMatchUserNameMNCAgainstIMSIMNC


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag/TrueRule/400.UserNameMNCAgainstIMSIMNC/TrueRule/100.NoMatchUserNameMNCAgainstIMSIMNC]

ClassName=RuleChain
RuleNames=100.SetErrorValues
RuleNames=200.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag/TrueRule/400.UserNameMNCAgainstIMSIMNC/TrueRule/100.NoMatchUserNameMNCAgainstIMSIMNC/100.SetErrorValues]

AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiReplyMessageString "UserName MNC does not match with IMSI MNC"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.15"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag/TrueRule/400.UserNameMNCAgainstIMSIMNC/TrueRule/100.NoMatchUserNameMNCAgainstIMSIMNC/200.LogNME]

Attributes=DEG_WifiUserNameString
Attributes=DEG_WifiUserNameMNCString
Attributes=DEG_WifiIMSIMNCString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiProcessingErrorIdString
ClassName=LogNMERule
LogLevel=WARNING
Message=UserName MNC does not match with IMSI MNC :
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true
#Action=UserName MCC does not match with IMSI MCC.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag/TrueRule/100.NoMatchUserNameExpression]

ClassName=RuleChain
RuleNames=100.SetErrorValues
RuleNames=200.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag/TrueRule/100.NoMatchUserNameExpression/100.SetErrorValues]

AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiActionInteger 2
AdornOps=set DEG_WifiReplyMessageString "Invalid UserName"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.16"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/600.ValidateUserName/200.CheckErrorProcessingFlag/TrueRule/100.NoMatchUserNameExpression/200.LogNME]

Attributes=DEG_WifiUserNameString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiProcessingErrorIdString
ClassName=LogNMERule
LogLevel=WARNING
Message=Invalid UserName :
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true
#Action=UserName MCC does not match with IMSI MCC.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/610.ValidateCallingStationID]

ClassName=ConditionalRule
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/610.ValidateCallingStationID/TrueRule]

ClassName=ConditionalRule
Conditions=DEG_WifiCallingStationIdString,!=,DEG_WifiUserNameIMSIString
TrueRuleChain=100.NoMatchCallingStationIDAndIMSI
FalseRuleChain=200.MatchCallingStationIDAndIMSI


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/610.ValidateCallingStationID/TrueRule/200.MatchCallingStationIDAndIMSI]

ClassName=RuleChain
RuleNames=100.CalculateIMSILength
RuleNames=200.CheckIMSILength


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/610.ValidateCallingStationID/TrueRule/200.MatchCallingStationIDAndIMSI/100.CalculateIMSILength]

ClassName=AdornmentRule
AdornOps=length DEG_WifiCallingStationIdString DEG_WifiCallingStationIdLengthInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/610.ValidateCallingStationID/TrueRule/200.MatchCallingStationIDAndIMSI/200.CheckIMSILength]

ClassName=ConditionalRule
Conditions=DEG_WifiCallingStationIdLengthInteger,>,15
Conditions=DEG_WifiCallingStationIdLengthInteger,<,15
Operations=or
FalseRuleChain=100.CheckCallingStationIDPattern


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/610.ValidateCallingStationID/TrueRule/200.MatchCallingStationIDAndIMSI/200.CheckIMSILength/100.CheckCallingStationIDPattern]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
RegExPattern=[0-9]
Operation=match
SourceAttribute=DEG_WifiCallingStationIdString
FalseRuleChain=100.SetErrorValues
FalseRuleChain=200.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/610.ValidateCallingStationID/TrueRule/200.MatchCallingStationIDAndIMSI/200.CheckIMSILength/100.CheckCallingStationIDPattern/100.SetErrorValues]

AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiReplyMessageString "Calling StationId is Malformed"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.17"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/610.ValidateCallingStationID/TrueRule/200.MatchCallingStationIDAndIMSI/200.CheckIMSILength/100.CheckCallingStationIDPattern/200.LogNME]

Attributes=DEG_WifiUserNameString
Attributes=DEG_WifiCallingStationIdString
Attributes=DEG_WifiUserNameIMSIString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiProcessingErrorIdString
ClassName=LogNMERule
LogLevel=WARNING
Message=Calling StationId does not match with UserName IMSI :
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true
#Action=Calling StationId does not match with UserName IMSI . Contact HP Admin.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/610.ValidateCallingStationID/TrueRule/100.NoMatchCallingStationIDAndIMSI]

ClassName=RuleChain
RuleNames=100.SetErrorValues
RuleNames=200.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/610.ValidateCallingStationID/TrueRule/100.NoMatchCallingStationIDAndIMSI/100.SetErrorValues]

AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiReplyMessageString "Calling StationId does not match with UserName IMSI"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.18"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/610.ValidateCallingStationID/TrueRule/100.NoMatchCallingStationIDAndIMSI/200.LogNME]

Attributes=DEG_WifiUserNameString
Attributes=DEG_WifiCallingStationIdString
Attributes=DEG_WifiUserNameIMSIString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiProcessingErrorIdString
ClassName=LogNMERule
LogLevel=WARNING
Message=Calling StationId does not match with UserName IMSI :
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/620.ValidateMessageAuthenticatorLength]

ClassName=ConditionalRule
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0
TrueRuleChain=100.CheckMessageAuthenticator


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/620.ValidateMessageAuthenticatorLength/100.CheckMessageAuthenticator]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiMessageAuthenticatorBinary,!=,""
FalseRuleChain=100.MessageAuthenticatorIsEmpty
TrueRuleChain=200.MessageAuthenticatorIsNotEmpty


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/620.ValidateMessageAuthenticatorLength/100.CheckMessageAuthenticator/100.MessageAuthenticatorIsEmpty]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorValues
RuleNames=200.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/620.ValidateMessageAuthenticatorLength/100.CheckMessageAuthenticator/100.MessageAuthenticatorIsEmpty/100.SetErrorValues]

AdornOps=set DEG_WifiReplyMessageString "Message Authenticator is Malformed"
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.19"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/620.ValidateMessageAuthenticatorLength/100.CheckMessageAuthenticator/100.MessageAuthenticatorIsEmpty/200.LogNME]

Attributes=DEG_WifiMessageAuthenticatorBinary
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiProcessingErrorIdString
ClassName=LogNMERule
LogLevel=WARNING
Message=NOT valid Message Authenticator Malformed != 32 bits :
PropertyName=LogRequestInOutLevel1
UseProperty=true
#Action=NOT valid Message Authenticator Malformed != 32 bits .Please contact HP Admin.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/620.ValidateMessageAuthenticatorLength/100.CheckMessageAuthenticator/200.MessageAuthenticatorIsNotEmpty]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CalculateMessageAuthenticatorLength


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/620.ValidateMessageAuthenticatorLength/100.CheckMessageAuthenticator/200.MessageAuthenticatorIsNotEmpty/100.CalculateMessageAuthenticatorLength]

AdornOps=setifnull DEG_WifiMessageAuthenticatorBinary 0
AdornOps=length DEG_WifiMessageAuthenticatorBinary DEG_WifiLengthMessageAuthenticatorInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/630.ValidateRadiusCode]

ClassName=ConditionalRule
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0
TrueRuleChain=100.CheckRadiusCode


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/630.ValidateRadiusCode/100.CheckRadiusCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiCodeInteger,=,1
FalseRuleChain=200.NotValidCodeInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/630.ValidateRadiusCode/100.CheckRadiusCode/200.NotValidCodeInteger]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorValues
RuleNames=200.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/630.ValidateRadiusCode/100.CheckRadiusCode/200.NotValidCodeInteger/100.SetErrorValues]

AdornOps=set DEG_WifiReplyMessageString "Code is incorrect"
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.20"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/630.ValidateRadiusCode/100.CheckRadiusCode/200.NotValidCodeInteger/200.LogNME]

Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiCodeInteger
ClassName=LogNMERule
LogLevel=WARNING
Message=Invalid Radius code :
PropertyName=LogRequestInOutLevel1
UseProperty=true
#Action=Not a Valid Radius Code .Contact HP Admin

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/640.ValidateIPAddress]

ClassName=ConditionalRule
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0
TrueRuleChain=100.CheckIPAddress


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/640.ValidateIPAddress/100.CheckIPAddress]

ClassName=RuleChain
RuleNames=100.SetInitParams
RuleNames=200.QueryIPAddress
RuleNames=300.CheckDBError


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/640.ValidateIPAddress/100.CheckIPAddress/100.SetInitParams]

ClassName=AdornmentRule
AdornOps=set DEG_WifiNoRecordFoundInteger 0
AdornOps=set DEG_WifiValidDBReturnInteger 0


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/640.ValidateIPAddress/100.CheckIPAddress/200.QueryIPAddress]

ClassName=LocalRuleChainInvoker
RequestAttributes=DEG_WifiHostString
ResponseAttributes=DEG_WifiSecretString
ResponseAttributes=DEG_WifiValidDBReturnInteger
ResponseAttributes=DEG_WifiNoRecordFoundInteger
ResponseAttributes=DEG_WifiIPAddressStatusString
RuleChain=006.ReadSharedSecretAndStatusFromWifiIPAddressRuleChain
UseRuleChainManagerPool=true

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/640.ValidateIPAddress/100.CheckIPAddress/300.CheckDBError]

ClassName=ConditionalRule
Conditions=DEG_WifiValidDBReturnInteger,=,0
TrueRuleChain=100.CheckDBResult


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/640.ValidateIPAddress/100.CheckIPAddress/300.CheckDBError/100.CheckDBResult]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiRecordFoundInteger,=,1
FalseRuleChain=100.RecordNotFound
TrueRuleChain=200.RecordFound


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/640.ValidateIPAddress/100.CheckIPAddress/300.CheckDBError/100.CheckDBResult/100.RecordNotFound]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiReplyMessageString "IP Address is Invalid"
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.21"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/640.ValidateIPAddress/100.CheckIPAddress/300.CheckDBError/100.CheckDBResult/200.RecordFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckIfIPAddressActive


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/640.ValidateIPAddress/100.CheckIPAddress/300.CheckDBError/100.CheckDBResult/200.RecordFound/100.CheckIfIPAddressActive]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiIPAddressStatusString,=,DEG_WifiIPAddressStatusConstantString
FalseRuleChain=100.IPAddressNotActive


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/640.ValidateIPAddress/100.CheckIPAddress/300.CheckDBError/100.CheckDBResult/200.RecordFound/100.CheckIfIPAddressActive/100.IPAddressNotActive]

ClassName=RuleChain
RuleNames=100.SetErrorMessage
RuleNames=200.LogErrorMessage


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/640.ValidateIPAddress/100.CheckIPAddress/300.CheckDBError/100.CheckDBResult/200.RecordFound/100.CheckIfIPAddressActive/100.IPAddressNotActive/100.SetErrorMessage]

AdornOps=set DEG_WifiReplyMessageString "IP Address Is Not Active"
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.22"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/640.ValidateIPAddress/100.CheckIPAddress/300.CheckDBError/100.CheckDBResult/200.RecordFound/100.CheckIfIPAddressActive/100.IPAddressNotActive/200.LogErrorMessage]

Attributes=DEG_WifiHostString
Attributes=DEG_WifiIPAddressStatusString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiProcessingErrorIdString
ClassName=LogNMERule
LogLevel=WARNING
Message= IP Address is inactive :
PropertyName=LogRequestInOutLevel1
UseProperty=true
#Action=IP address is not Active .Contact HP Admin.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/660.ValidateCallAuthenticationProcess]

ClassName=ConditionalRule
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/660.ValidateCallAuthenticationProcess/TrueRule]

ClassName=LocalRuleChainInvoker
RuleChain=200.AuthenticationProcess


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/660.ValidateCallAuthenticationProcess/FalseRule]

ClassName=RuleChain
#RuleNames=100.GenerateValidationFailedAuditRecords
RuleNames=200.SetResponse
RuleNames=300.SendResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/660.ValidateCallAuthenticationProcess/FalseRule/100.GenerateValidationFailedAuditRecords]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=513.GenerateValidationFailedAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/660.ValidateCallAuthenticationProcess/FalseRule/200.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,11
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.answer.accessChallenge.action,2
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.request.accessRequest.action,2
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/660.ValidateCallAuthenticationProcess/FalseRule/300.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/700.CheckErrorProcessingFlag]

ClassName=ConditionalRule
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0
FalseRuleChain=100.SetResponse
FalseRuleChain=200.SendResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/700.CheckErrorProcessingFlag/100.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,11
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.answer.accessChallenge.action,2
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.request.accessRequest.action,2
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/100.ProcessRadiusRequest/700.CheckErrorProcessingFlag/200.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.CheckEAPMessageNull
RuleNames=120.LogNME
RuleNames=130.CheckEAPMessage
RuleNames=200.ExecuteRadiusSessionLookup


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/110.CheckEAPMessageNull]

AdornOps=setifnull DEG_WifiEAPMessageBinary 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/120.LogNME]

Attributes=DEG_WifiEAPMessageBinary
ClassName=LogNMERule
LogLevel=DEBUG
Message=Intizialize EAPMessage:
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/130.CheckEAPMessage]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiEAPMessageBinary,=,0
FalseRuleChain=100.EAPMessageIsEmpty
TrueRuleChain=200.EAPMessageIsNotEmpty


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/130.CheckEAPMessage/200.EAPMessageIsNotEmpty]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ConvertEAPMessageToString
RuleNames=200.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/130.CheckEAPMessage/200.EAPMessageIsNotEmpty/100.ConvertEAPMessageToString]

AdornOps=bin2str DEG_WifiEAPMessageBinary DEG_WifiEAPMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/130.CheckEAPMessage/200.EAPMessageIsNotEmpty/200.LogNME]

Attributes=DEG_WifiEAPMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=EAPMessage NOT NULL :


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/130.CheckEAPMessage/100.EAPMessageIsEmpty]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.HardcodeEAPMessage
RuleNames=200.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/130.CheckEAPMessage/100.EAPMessageIsEmpty/100.HardcodeEAPMessage]

AdornOps=set DEG_WifiEAPMessageString "EAP_OK"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/130.CheckEAPMessage/100.EAPMessageIsEmpty/200.LogNME]

Attributes=DEG_WifiEAPMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=EAPMessage NULL :
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup]

ClassName=RuleChain
RuleNames=100.InitLookUpValues
RuleNames=200.LogNME
RuleNames=300.QuerySessionState
RuleNames=310.CheckDBError


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/100.InitLookUpValues]

AdornOps=set DEG_WifiRecordFoundInteger 0
AdornOps=set DEG_WifiRadiusStateString ""
AdornOps=set DEG_WifiSessionIdString ""
AdornOps=set DEG_WifiAAASessionStateTbString ""
AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 0
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_WifiHostString DEG_WIFIRORIGIPADDR
AdornOps=copy DEG_WifiUserNameIMSIString DEG_WifiAcctSessionIdString
AdornOps=copy DEG_WifiAcctSessionIdString DEG_WIFIRACCTSESSID
AdornOps=copy DEG_WifiUserNameString DEG_WIFIRUSERNAME
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/200.LogNME]

Attributes=DEG_WIFIRORIGIPADDR
Attributes=DEG_WIFIRACCTSESSID
Attributes=DEG_WIFIRUSERNAME
ClassName=LogNMERule
LogLevel=DEBUG
Message=Before doing RadiusSessionLookup :
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/300.QuerySessionState]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_WIFIRSTATE,DEG_WIFIRSTATE
MapAttributes=DEG_WIFIAAASTATE,DEG_WIFIAAASTATE
MapAttributes=DEG_WIFIRAAASESSID,DEG_WIFIRAAASESSID
MapAttributes=DEG_WIFIRMDN,DEG_WIFIRMDN
MapAttributes=DEG_WIFIRIMSI,DEG_WIFIRIMSI
MapAttributes=DEG_WIFIRUSERNAME,DEG_WIFIRUSERNAME
MapAttributes=DEG_WIFIRUPDATETIMESTAMP,DEG_WIFIRUPDATETIMESTAMP
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError]

ClassName=ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,=,0
TrueRuleChain=100.ProcessRadiusSession
FalseRuleChain=200.SetErrorValues
FalseRuleChain=210.LogErrorValues
FalseRuleChain=220.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/200.SetErrorValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiOutReturnCodeString "3004"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.23"
AdornOps=set DEG_WifiReplyMessageString "DB Access Error"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/210.LogErrorValues]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WIFIRORIGIPADDR
Attributes=DEG_WIFIRACCTSESSID
Attributes=DEG_WIFIRUSERNAME
LogLevel=CRITICAL
Message=Unable to perform lookup or access DEG_WIFIRADIUSSESSION table :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/220.GenerateDiscardedRadiusAccessAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=509.GenerateDiscardedRadiusAccessAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckSessionStoreExistsFlag


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=200.CreateNewSession
FalseRuleChain=100.ExistingSession


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogNME
RuleNames=300.CheckErrorProcessingFlag


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/100.LogNME]

Attributes=DEG_WIFIRSTATE
Attributes=DEG_WIFIAAASTATE
Attributes=DEG_WIFIRAAASESSID
Attributes=DEG_WIFIRMDN
Attributes=DEG_WIFIRIMSI
Attributes=DEG_WIFIRUSERNAME
ClassName=LogNMERule
LogLevel=INFO
Message=Existing Radius Session :
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_WifiErrorProcessingFlagInteger,=,0
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0

TrueRuleChain=GetActiveMonitoringSessionsByMDN
TrueRuleChain=GetActiveMonitoringSessionsByIMSI
TrueRuleChain=ProcessingRadiusState

GetActiveMonitoringSessionsByMDN=200.InitParams
GetActiveMonitoringSessionsByMDN=210.LogNME
GetActiveMonitoringSessionsByMDN=220.QueryMonitoredSessionsMDN

GetActiveMonitoringSessionsByIMSI=230.InitParams
GetActiveMonitoringSessionsByIMSI=240.LogNME
GetActiveMonitoringSessionsByIMSI=250.QueryMonitoredSessionsIMSI

ProcessingRadiusState=300.InitParams
ProcessingRadiusState=310.ProcessingRadiusState


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/200.InitParams]

AdornOps=copy DEG_WIFIRMDN DEG_MSESSIONKEY
AdornOps=set DEG_MSESSIONID ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/210.LogNME]

ClassName=LogNMERule
Attributes=DEG_MSESSIONKEY
Message=QueryMonitoring Session Table lookup :
LogLevel=DEBUG
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/220.QueryMonitoredSessionsMDN]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_WifiSessionKey
ResponseAttributes=DEG_MSESSIONID
ResponseAttributes=DEG_WifiValidDBReturnInteger
ResponseAttributes=DEG_WifiNoRecordFoundInteger
RuleChain=004.ReadMonitoringSessionRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/230.InitParams]

AdornOps=copy DEG_WIFIRIMSI DEG_MSESSIONKEY
AdornOps=set DEG_MSESSIONID ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/240.LogNME]

ClassName=LogNMERule
Attributes=DEG_MSESSIONKEY
Message=QueryMonitoring Session Table lookup :
LogLevel=DEBUG
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/250.QueryMonitoredSessionsIMSI]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_WifiSessionKey
ResponseAttributes=DEG_MSESSIONID
ResponseAttributes=DEG_WifiValidDBReturnInteger
ResponseAttributes=DEG_WifiNoRecordFoundInteger
RuleChain=004.ReadMonitoringSessionRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/300.InitParams]

ClassName=AdornmentRule
AdornOps=copy DEG_WIFIRSTATE DEG_WifiRadiusStateString
AdornOps=copy DEG_WIFIAAASTATE DEG_WifiAAASessionStateTbString
AdornOps=copy DEG_WIFIRUPDATETIMESTAMP DEG_WifiJMSTempReqStartTime
AdornOps=copy DEG_WIFIRIMSI DEG_WifiUserNameIMSIString
AdornOps=copy DEG_WIFIRUSERNAME DEG_WifiUserNameString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState]

ClassName=SwitchConditionRule
Conditions=DEG_WifiRadiusStateString,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_WifiRadiusStateString,=,"RADIUS_ACCESS_CHALLENGE_AKA_NOTIFICATION"
Conditions=DEG_WifiRadiusStateString,=,DEG_WifiRadiusStateString

RadiusAccessRequestSend=000.GenerateNRBAndAuditData
RadiusAccessRequestSend=010.LogNME
RadiusAccessRequestSend=100.RadiusProcessingToAAA
RadiusAccessRequestSend=200.CheckErrorProcessingFlag

RadiusAccessChallengeAKA_NotificationSent=300.GenerateNRBAndAuditData
RadiusAccessChallengeAKA_NotificationSent=310.InvokeRadiusAccessChallengeAKA_NotificationSent

InvalidSessionState=320.InvalidSessionState

TrueRuleChain=RadiusAccessRequestSend
TrueRuleChain=RadiusAccessChallengeAKA_NotificationSent
TrueRuleChain=InvalidSessionState


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/300.GenerateNRBAndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=503.GenerateAccessRequestExistingSessionStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/310.InvokeRadiusAccessChallengeAKA_NotificationSent]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorProcessingFlag
RuleNames=200.RadiusAccessChallengeAKANotificationSent


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/310.InvokeRadiusAccessChallengeAKA_NotificationSent/100.SetErrorProcessingFlag]

AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/310.InvokeRadiusAccessChallengeAKA_NotificationSent/200.RadiusAccessChallengeAKANotificationSent]

ClassName=LocalRuleChainInvoker
RuleChain=1000.SendRadiusRejectWithEAPFailure


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/320.InvalidSessionState]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateDiscardedRadiusAccessAuditData
RuleNames=200.SetErrorValues
RuleNames=300.LogErrorValues


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/320.InvalidSessionState/100.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/320.InvalidSessionState/100.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=copy DEG_WifiMDNString DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiHostString DEG_AuditASPIdString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/320.InvalidSessionState/100.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString " DEG TO DEVICE -> Discarding RADIUS Access request(error): DEG_WifiReturnCodeString = "
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/320.InvalidSessionState/100.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiHostString DEG_AuditMessageString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/320.InvalidSessionState/100.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

ClassName=AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Unexpected radius session state"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/320.InvalidSessionState/100.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/320.InvalidSessionState/200.SetErrorValues]

ClassName=AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.24"
AdornOps=set DEG_WifiReplyMessageString "Unexpected radius session state"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/320.InvalidSessionState/300.LogErrorValues]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiRadiusStateString
LogLevel=INFO
Message=Unexpected session state :
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/000.GenerateNRBAndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=503.GenerateAccessRequestExistingSessionStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/010.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusStateString
Message=Sending AccessRequest To AAA :
LogLevel=INFO
PropertyName=LogRequestFlowLevel1
UseProperty=false



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/100.RadiusProcessingToAAA]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_WifiUserNameIMSIString
RequestAttributes=DEG_WifiEAPMessageBinary
RequestAttributes=DEG_WifiStateBinary
RequestAttributes=DEG_WifiUserNameString
RequestAttributes=DEG_WifiAAASessionStateTbString
RequestAttributes=DEG_WIFIRUSERNAME
ResponseAttributes=DEG_WIFIAAASTATE
ResponseAttributes=DEG_WIFIRSTATE
ResponseAttributes=DEG_WifiEAPMessageBinary
RuleChain=400.SendRadiusEAPPayloadToAAA
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag]

ClassName=ConditionalRule
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0
TrueRuleChain=200.CheckRadiusState


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_WIFIRSTATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_WIFIRSTATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
Conditions=DEG_WIFIRSTATE,starts,"AUTHENTICATED"

TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=Authenticated


AkaWait=100.AkaWait_InitResponse
AkaWait=110.AkaWait_GenerateAuditAndNRB
AkaWait=120.AkaWait_GenerateResponse


AkaRejected=200.AkaRejected_CheckReplyMessage


Authenticated=300.Authenticated_InitResponse
Authenticated=310.Authenticated_GenerateAuditAndNRB
Authenticated=330.Authenticated_StoreToken
Authenticated=340.Authenticated_DeleteSession
Authenticated=350.Authenticated_GenerateResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/100.AkaWait_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiAnswerTypeInteger 11


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/110.AkaWait_GenerateAuditAndNRB]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=505.GenerateAccessRequestAkaWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/120.AkaWait_GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.SetNullPayloadResponse
TrueRuleChain=110.GenerateNullPayloadResponse
TrueRuleChain=120.SendNullPayloadResponse
FalseRuleChain=200.EncodePayload
FalseRuleChain=210.LogNME
FalseRuleChain=220.GenerateResponse
FalseRuleChain=230.SendResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/120.AkaWait_GenerateResponse/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_WifiEAPMessageBinary == null


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/120.AkaWait_GenerateResponse/100.SetNullPayloadResponse]

ClassName=AdornmentRule
AdornOps=set DEG_WifiReplyMessageString "Payload is Null - AkaWait"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/120.AkaWait_GenerateResponse/110.GenerateNullPayloadResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiAAASessionStateBinary,DeviceRadiusMessage.answer.accessChallenge.State
NMEToStructuredNMEMap=DEG_WifiAuthenticatorBinary,DeviceRadiusMessage.answer.accessChallenge.authenticator
NMEToStructuredNMEMap=DEG_WifiMessageAuthenticatorBinary,DeviceRadiusMessage.answer.accessChallenge.MessageAuthenticator,
NMEToStructuredNMEMap=DEG_WifiEAPMessageBinary,DeviceRadiusMessage.answer.accessChallenge.EAPMessage
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.answer.accessChallenge.action
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,11
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/120.AkaWait_GenerateResponse/120.SendNullPayloadResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/120.AkaWait_GenerateResponse/200.EncodePayload]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=encBase64 DEG_WifiEAPMessageBinary DEG_WifiEAPMessageString
AdornOps=set DEG_WifiReplyMessageString "Payload Encoded sucessfully - AkaWait"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/120.AkaWait_GenerateResponse/210.LogNME]

ClassName=LogNMERule
LogLevel=INFO
Message=Access Challenge sent To WIFIGW From DEG :
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiUserNameString
Attributes=DEG_WifiAAASessionStateBinary
Attributes=DEG_WifiAuthenticatorBinary
Attributes=DEG_WifiMessageAuthenticatorBinary
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/120.AkaWait_GenerateResponse/220.GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiAAASessionStateBinary,DeviceRadiusMessage.answer.accessChallenge.State
NMEToStructuredNMEMap=DEG_WifiAuthenticatorBinary,DeviceRadiusMessage.answer.accessChallenge.authenticator
NMEToStructuredNMEMap=DEG_WifiMessageAuthenticatorBinary,DeviceRadiusMessage.answer.accessChallenge.MessageAuthenticator,
NMEToStructuredNMEMap=DEG_WifiEAPMessageBinary,DeviceRadiusMessage.answer.accessChallenge.EAPMessage
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.answer.accessChallenge.action
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,11
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/120.AkaWait_GenerateResponse/230.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_WifiReplyMessageString,=,"5003"
Conditions=DEG_WifiReplyMessageString,=,"4001"
Conditions=DEG_WifiReplyMessageString,=,"5004"
Conditions=DEG_WifiReplyMessageString,=,"5012"

TrueRuleChain=EAPAdapterRejectedRequest
TrueRuleChain=EAPCodeError
TrueRuleChain=ValidationError
TrueRuleChain=InternalOrCommunicatioError

EAPAdapterRejectedRequest=100.SendAccessReject
EAPCodeError=200.EAPCodeErrorDiscardRequest
ValidationError=300.ValidationErrorDiscardRequest
InternalOrCommunicatioError=400.InternalOrCommunicatioErrorDiscardRequest


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/100.SendAccessReject]

ClassName=RuleChain
RuleNames=100.InitResponse
RuleNames=200.GenerateAuditAndNRB
RuleNames=300.DeleteSession
RuleNames=310.LogNME
RuleNames=400.GenerateResponse
RuleNames=500.SendResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/100.SendAccessReject/100.InitResponse]

ClassName=AdornmentRule
AdornOps=set DEG_WifiOutReturnCodeString "3002"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/100.SendAccessReject/200.GenerateAuditAndNRB]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateAccessRequestAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/100.SendAccessReject/300.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=2000.DeleteRadiusSession
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/100.SendAccessReject/310.LogNME]

ClassName=LogNMERule
LogLevel=INFO
Message=Access Reject sent To WIFIGW From DEG :
Attributes=DEG_WifiOutReturnCodeString
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiReplyMessageString
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/100.SendAccessReject/400.GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiReplyMessageString,DeviceRadiusMessage.answer.accessReject.ReplyMessages[0].value
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,3
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/100.SendAccessReject/500.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/200.EAPCodeErrorDiscardRequest]

ClassName=RuleChain
RuleNames=100.InitResponse
RuleNames=200.GenerateAuditAndNRB
RuleNames=300.DeleteSession
RuleNames=310.LogNME
RuleNames=400.SetResponse
RuleNames=500.SendResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/200.EAPCodeErrorDiscardRequest/100.InitResponse]

ClassName=AdornmentRule
AdornOps=set DEG_WifiOutReturnCodeString "3002"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/200.EAPCodeErrorDiscardRequest/200.GenerateAuditAndNRB]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateAccessRequestAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/200.EAPCodeErrorDiscardRequest/300.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=2000.DeleteRadiusSession
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/200.EAPCodeErrorDiscardRequest/310.LogNME]

ClassName=LogNMERule
LogLevel=INFO
Message=Access Reject sent To WIFIGW From DEG :
Attributes=DEG_WifiOutReturnCodeString
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiReplyMessageString
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/200.EAPCodeErrorDiscardRequest/400.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,11
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.answer.accessReject.action,2
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.request.accessRequest.action,2
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/200.EAPCodeErrorDiscardRequest/500.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/300.ValidationErrorDiscardRequest]

ClassName=RuleChain
RuleNames=100.InitResponse
RuleNames=200.GenerateAuditAndNRB
RuleNames=300.DeleteSession
RuleNames=310.LogNME
RuleNames=400.SetResponse
RuleNames=500.SendResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/300.ValidationErrorDiscardRequest/100.InitResponse]

ClassName=AdornmentRule
AdornOps=set DEG_WifiOutReturnCodeString "3002"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/300.ValidationErrorDiscardRequest/200.GenerateAuditAndNRB]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateAccessRequestAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/300.ValidationErrorDiscardRequest/300.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=2000.DeleteRadiusSession
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/300.ValidationErrorDiscardRequest/310.LogNME]

ClassName=LogNMERule
LogLevel=INFO
Message=Access Reject sent To WIFIGW From DEG :
Attributes=DEG_WifiOutReturnCodeString
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiReplyMessageString
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/300.ValidationErrorDiscardRequest/400.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,11
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.answer.accessReject.action,2
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.request.accessRequest.action,2
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/300.ValidationErrorDiscardRequest/500.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/400.InternalOrCommunicatioErrorDiscardRequest]

ClassName=RuleChain
RuleNames=100.InitResponse
RuleNames=200.GenerateAuditAndNRB
RuleNames=300.DeleteSession
RuleNames=310.LogNME
RuleNames=400.SetResponse
RuleNames=500.SendResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/400.InternalOrCommunicatioErrorDiscardRequest/100.InitResponse]

ClassName=AdornmentRule
AdornOps=set DEG_WifiOutReturnCodeString "3002"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/400.InternalOrCommunicatioErrorDiscardRequest/200.GenerateAuditAndNRB]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateAccessRequestAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/400.InternalOrCommunicatioErrorDiscardRequest/300.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=2000.DeleteRadiusSession
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/400.InternalOrCommunicatioErrorDiscardRequest/310.LogNME]

ClassName=LogNMERule
LogLevel=INFO
Message=Access Reject sent To WIFIGW From DEG :
Attributes=DEG_WifiOutReturnCodeString
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiReplyMessageString
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/400.InternalOrCommunicatioErrorDiscardRequest/400.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,11
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.answer.accessReject.action,2
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.request.accessRequest.action,2
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/200.AkaRejected_CheckReplyMessage/400.InternalOrCommunicatioErrorDiscardRequest/500.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/300.Authenticated_InitResponse]

ClassName=AdornmentRule
AdornOps=set DEG_AUTHENTICATION_TYPE "WIFI"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "WIFI"
AdornOps=copy DEG_WifiUserNameIMSIString DEG_IMSI
AdornOps=set DEG_APP_TOKEN_FLAG 1
AdornOps=copy DEG_WIFIRMDN DEG_MDN
AdornOps=genKey "HmacSHA1" 160 - DEG_WifiSha1KeyBinary
AdornOps=encBase64 DEG_WifiSha1KeyBinary DEG_WifiRespTokenString
AdornOps=copy DEG_WifiRespTokenString DEG_WifiTokenString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/310.Authenticated_GenerateAuditAndNRB]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=507.GenerateAccessRequestAkaAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/330.Authenticated_StoreToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_MDN
RequestAttributes=DEG_IMSI
RequestAttributes=DEG_WifiTokenString
RequestAttributes=DEG_AUTHENTICATION_TYPE
RequestAttributes=DEG_AUTHENTICATION_SUBTYPE
RequestAttributes=DEG_APP_TOKEN_FLAG
RequestAttributes=DEG_FULLAUTHTIMESTAMP
ResponseAttributes=DEG_WifiReplyMessageString
ResponseAttributes=DEG_EVENTTIMESTAMP
RuleChain=008.StoreTokenRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/340.Authenticated_DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=2000.DeleteRadiusSession
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/350.Authenticated_GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.SetNullPayloadResponse
TrueRuleChain=110.GenerateNullPayloadResponse
TrueRuleChain=120.SendNullPayloadResponse
FalseRuleChain=200.EncodePayload
FalseRuleChain=210.LogNME
FalseRuleChain=220.GenerateResponse
FalseRuleChain=230.SendResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/350.Authenticated_GenerateResponse/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_WifiEAPMessageBinary == null


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/350.Authenticated_GenerateResponse/100.SetNullPayloadResponse]

ClassName=AdornmentRule
AdornOps=set DEG_WifiReplyMessageString "Payload is null - Authenticated"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/350.Authenticated_GenerateResponse/110.GenerateNullPayloadResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiUserNameString,DeviceRadiusMessage.answer.accessAccept.UserName
NMEToStructuredNMEMap=DEG_WifiEAPMessageBinary,DeviceRadiusMessage.answer.accessAccept.EAPMessage
NMEToStructuredNMEMap=DEG_WifiMessageAuthenticatorBinary,DeviceRadiusMessage.answer.accessAccept.MessageAuthenticator
NMEToStructuredNMEMap=DEG_WifiReplyMessageString,DeviceRadiusMessage.answer.accessAccept.ReplyMessages[0].value
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,2
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/350.Authenticated_GenerateResponse/120.SendNullPayloadResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/350.Authenticated_GenerateResponse/200.EncodePayload]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=encBase64 DEG_WifiEAPMessageBinary DEG_WifiEAPMessageString
AdornOps=set DEG_WifiReplyMessageString "Payload encoded successfully - Authenticated"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/350.Authenticated_GenerateResponse/210.LogNME]

ClassName=LogNMERule
LogLevel=INFO
Message=Access Accept sent To WIFIGW From DEG :
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiUserNameString
Attributes=DEG_WifiAAASessionStateString
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/350.Authenticated_GenerateResponse/220.GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiUserNameString,DeviceRadiusMessage.answer.accessAccept.UserName
NMEToStructuredNMEMap=DEG_WifiEAPMessageBinary,DeviceRadiusMessage.answer.accessAccept.EAPMessage
NMEToStructuredNMEMap=DEG_WifiMessageAuthenticatorBinary,DeviceRadiusMessage.answer.accessAccept.MessageAuthenticator
NMEToStructuredNMEMap=DEG_WifiReplyMessageString,DeviceRadiusMessage.answer.accessAccept.ReplyMessages[0].value
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,2
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/100.ExistingSession/300.CheckErrorProcessingFlag/310.ProcessingRadiusState/200.CheckErrorProcessingFlag/200.CheckRadiusState/350.Authenticated_GenerateResponse/230.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/200.CreateNewSession]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.LogNME
RuleNames=100.InvokeNewAuthenticationSession


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/200.CreateNewSession/000.LogNME]

ClassName=LogNMERule
Attributes=DEG_WIFIRORIGIPADDR
Attributes=DEG_WIFIRAAASESSID
Attributes=DEG_WIFIRUSERNAME
Message=Create new Radius Session RuleChain called :
LogLevel=INFO
PropertyName=LogRequestFlowLevel1
UseProperty=false


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/200.AuthenticationProcess/200.ExecuteRadiusSessionLookup/310.CheckDBError/100.ProcessRadiusSession/100.CheckSessionStoreExistsFlag/200.CreateNewSession/100.InvokeNewAuthenticationSession]

ClassName=LocalRuleChainInvoker
RuleChain=300.NewAuthenticationSession
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitParams
RuleNames=200.RadiusSesionStoreCount
RuleNames=300.ValidateFirstWifiAccessRequest


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/100.InitParams]

AdornOps=set DEG_WifiErrorProcessingFlagInteger 0
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.QueryRadiusSesionStoreCount
RuleNames=200.LogNME
RuleNames=300.CheckDBResult


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/100.QueryRadiusSesionStoreCount]

ClassName=LocalRuleChainInvoker
ResponseAttributes=DEG_WifiValidDBReturnInteger
ResponseAttributes=DEG_WifiNoRecordFoundInteger
ResponseAttributes=DEG_WifiCountInteger
RuleChain=007.ReadRadiusCountFromSessionStoreRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/200.LogNME]

Attributes=DEG_WifiCountInteger
ClassName=LogNMERule
LogLevel=DEBUG
Message=Radius Session Count :
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult]

ClassName=ConditionalRule
Conditions=DEG_WifiValidDBReturnInteger,=,0
TrueRuleChain=100.CheckRadiusSessionStoreCount
FalseRuleChain=200.SetErrorValues
FalseRuleChain=210.LogErrorValues
FalseRuleChain=220.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiRecordFoundInteger,=,1
FalseRuleChain=100.RecordNotFound
TrueRuleChain=200.RecordFound


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/100.RecordNotFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorProcessorFlag
RuleNames=200.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/100.RecordNotFound/100.SetErrorProcessorFlag]

AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/100.RecordNotFound/200.logNME]

Attributes=DEG_WifiCountInteger
ClassName=LogNMERule
LogLevel=WARNING
Message=Not valid Radius Count from Session Store:
PropertyName=LogRequestFlowLevel1
UseProperty=true
#Action=Not valid Radius Count from Session Store

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogNME
RuleNames=200.InitRequestParams
RuleNames=300.GetRowCountInSysParameter
RuleNames=400.CheckErrorAndNoMatchFlag


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/100.LogNME]

Attributes=DEG_WifiCountInteger
ClassName=LogNMERule
LogLevel=DEBUG
Message=Radius Count Result:
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/200.InitRequestParams]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiSysParameter "DEG_RADIUSSESSION_COUNT"
AdornOps=set DEG_WifiSysValueString ""
AdornOps=set DEG_WifiValidDBReturnInteger 0
AdornOps=set DEG_WifiNoRecordFoundInteger 0
AdornOps=setsystime DEG_WifiDeviceInterfaceProcessStartTimeLong


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/300.GetRowCountInSysParameter]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_WifiSysParameter
ResponseAttributes=DEG_WifiSysValueString
ResponseAttributes=DEG_WifiValidDBReturnInteger
ResponseAttributes=DEG_WifiNoRecordFoundInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiValidDBReturnInteger,=,0
Conditions=DEG_WifiNoRecordFoundInteger,=,0
Operations=and
TrueRuleChain=000.LogNME
TrueRuleChain=100.SetNME
TrueRuleChain=100.CheckNumberOfRows
FalseRuleChain=200.SetErrorValues
FalseRuleChain=300.LogErrorValues
FalseRuleChain=400.GenerateAccessRequestSystemErrorEndAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/000.LogNME]

Attributes=DEG_WifiSysValueString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Maximum number of radius session :
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.SetNME]

ClassName=AdornmentRule
AdornOps=copy DEG_WifiSysValueString DEG_WifiSysValueInteger


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiCountInteger,>=,DEG_WifiSysValueInteger
#FalseRuleChain=100.ValidNumberofRows
TrueRuleChain=200.InvalidNumberofRows


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/200.InvalidNumberofRows]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorValues
RuleNames=200.LogErrorValues
RuleNames=300.GenerateAccessRequestSystemErrorEndAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/200.InvalidNumberofRows/100.SetErrorValues]

ClassName=AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiOutReturnCodeString "3004"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.25"
AdornOps=set DEG_WifiReplyMessageString "Too many active EAP-AKA sessions"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/200.InvalidNumberofRows/200.LogErrorValues]

Attributes=DEG_WifiCountInteger
Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
ClassName=LogNMERule
LogLevel=WARNING
Message=Too many active EAP-AKA Sessions :
PropertyName=LogRequestInOutLevel1
UseProperty=true
#Action=Too many active EAP-AKA Sessions Present in the Tables .Contact HP Admin.


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/200.InvalidNumberofRows/300.GenerateAccessRequestSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=509.GenerateDiscardedRadiusAccessAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ExtractValuesFromEAPMessage
RuleNames=200.LogNME
RuleNames=300.CheckEAPResponseIdentity


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/100.ExtractValuesFromEAPMessage]

AdornOps=substr 0 2 DEG_WifiEAPMessageBinary DEG_WifiEAPMessageCodeString
AdornOps=substr 2 4 DEG_WifiEAPMessageBinary DEG_WifiEAPMessageIdString
AdornOps=substr 4 8 DEG_WifiEAPMessageBinary DEG_WifiEAPMessageLengthString
AdornOps=substr 8 10 DEG_WifiEAPMessageBinary DEG_WifiEAPMessageTypeString
AdornOps=substr 5 100 DEG_WifiEAPMessageBinary DEG_WifiEAPMessageIdentityString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/200.LogNME]

Attributes=DEG_WifiEAPMessageString
Attributes=DEG_WifiEAPMessageCodeString
Attributes=DEG_WifiEAPMessageIdString
Attributes=DEG_WifiEAPMessageLengthString
Attributes=DEG_WifiEAPMessageTypeString
Attributes=DEG_WifiEAPMessageIdentityString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Extract NAI From EAPMessage:
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/300.CheckEAPResponseIdentity]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiEAPMessageTypeString,=,"01"
FalseRuleChain=100.NotValidEAPMessageType
TrueRuleChain=200.ValidEAPMessageType


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/300.CheckEAPResponseIdentity/100.NotValidEAPMessageType]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogNME
RuleNames=200.SetErrorProcessingFlag
RuleNames=300.SetChallengeErrorCode
RuleNames=400.CallSendRadiusChallengeWithAKANotification


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/300.CheckEAPResponseIdentity/100.NotValidEAPMessageType/100.LogNME]

Attributes=DEG_WifiEAPMessageTypeString
Attributes=DEG_WifiEAPMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Not Valid EAP type :
PropertyName=LogRequestFlowLevel1
UseProperty=true

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/300.CheckEAPResponseIdentity/100.NotValidEAPMessageType/200.SetErrorProcessingFlag]

AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/300.CheckEAPResponseIdentity/100.NotValidEAPMessageType/300.SetChallengeErrorCode]

AdornOps=set DEG_WifiChallengeErrorCodeString 16384
AdornOps=set DEG_WifiEAPMessageBinary 0100000c170c00000c014000
AdornOps=set
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/300.CheckEAPResponseIdentity/100.NotValidEAPMessageType/400.CallSendRadiusChallengeWithAKANotification]

ClassName=LocalRuleChainInvoker
RuleChain=900.SendRadiusChallengeWithAKANotification


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/300.CheckEAPResponseIdentity/200.ValidEAPMessageType]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogNME
RuleNames=200.CheckUserNameVsNAI


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/300.CheckEAPResponseIdentity/200.ValidEAPMessageType/100.LogNME]

Attributes=DEG_WifiEAPMessageTypeString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Valid Radius EAP Response/Identity:
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/300.CheckEAPResponseIdentity/200.ValidEAPMessageType/200.CheckUserNameVsNAI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiUserNameString,=,DEG_WifiEAPMessageIdentityString
FalseRuleChain=100.NotValidEAPMessageIdentity


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/300.CheckEAPResponseIdentity/200.ValidEAPMessageType/200.CheckUserNameVsNAI/100.NotValidEAPMessageIdentity]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogNME
RuleNames=200.SetErrorProcessingFlag
RuleNames=300.SetChallengeErrorCode
RuleNames=400.CallSendRadiusChallengeWithAKANotification


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/300.CheckEAPResponseIdentity/200.ValidEAPMessageType/200.CheckUserNameVsNAI/100.NotValidEAPMessageIdentity/100.LogNME]

Attributes=DEG_WifiEAPMessageIdentityString
Attributes=DEG_WifiEAPMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Invalid EAPMessage Identity :
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/300.CheckEAPResponseIdentity/200.ValidEAPMessageType/200.CheckUserNameVsNAI/100.NotValidEAPMessageIdentity/200.SetErrorProcessingFlag]

AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/300.CheckEAPResponseIdentity/200.ValidEAPMessageType/200.CheckUserNameVsNAI/100.NotValidEAPMessageIdentity/300.SetChallengeErrorCode]

AdornOps=set DEG_WifiChallengeErrorCodeString 16384
AdornOps=set DEG_WifiEAPMessageBinary 0100000c170c00000c014000
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/100.CheckNumberOfRows/100.ValidNumberofRows/300.CheckEAPResponseIdentity/200.ValidEAPMessageType/200.CheckUserNameVsNAI/100.NotValidEAPMessageIdentity/400.CallSendRadiusChallengeWithAKANotification]

ClassName=LocalRuleChainInvoker
RuleChain=900.SendRadiusChallengeWithAKANotification


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/200.SetErrorValues]

ClassName=AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiOutReturnCodeString "3004"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.40"
AdornOps=set DEG_WifiReplyMessageString "Value of Maximum Number of radius connections not present in DEG_SYSPARAMETER table"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/300.LogErrorValues]

Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiNoRecordFoundInteger
Attributes=DEG_WifiValidDBReturnInteger
ClassName=LogNMERule
LogLevel=WARNING
Message=Value not present in table :
PropertyName=LogRequestInOutLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/200.RecordFound/400.CheckErrorAndNoMatchFlag/400.GenerateAccessRequestSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=509.GenerateDiscardedRadiusAccessAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/100.RecordNotFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorProcessingFlag
RuleNames=200.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/100.RecordNotFound/100.SetErrorProcessingFlag]

AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.26"
AdornOps=set DEG_WifiReplyMessageString "Not valid Radius Count from Session Store"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/100.CheckRadiusSessionStoreCount/100.RecordNotFound/200.LogNME]

Attributes=DEG_WifiCountInteger
Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
ClassName=LogNMERule
LogLevel=WARNING
Message=Not valid Radius Count from Session Store:
PropertyName=LogRequestInOutLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/200.SetErrorValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiOutReturnCodeString "3004"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.27"
AdornOps=set DEG_WifiActionInteger 2
AdornOps=set DEG_WifiReplyMessageString "DB Access Error"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/210.LogErrorValues]

Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Unable To lookup radius session Table :
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/200.RadiusSesionStoreCount/300.CheckDBResult/220.GenerateDiscardedRadiusAccessAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=509.GenerateDiscardedRadiusAccessAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest]


ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_WifiErrorProcessingFlagInteger,=,0
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0

TrueRuleChain=GenerateNewSessionId
TrueRuleChain=CheckIfSubscriberProvisioned
TrueRuleChain=GetActiveMonitoringSessionsByMDN
TrueRuleChain=GetActiveMonitoringSessionsByIMSI
TrueRuleChain=CreateNewRadiusSession

GenerateNewSessionId=100.GenerateNewSessionId

CheckIfSubscriberProvisioned=200.CheckIfSubscriberProvisioned

GetActiveMonitoringSessionsByMDN=300.InitParams
GetActiveMonitoringSessionsByMDN=310.LogNME
GetActiveMonitoringSessionsByMDN=320.QueryMonitoredSessionsMDN

GetActiveMonitoringSessionsByIMSI=330.InitParams
GetActiveMonitoringSessionsByIMSI=340.LogNME
GetActiveMonitoringSessionsByIMSI=350.QueryMonitoredSessionsIMSI

CreateNewRadiusSession=400.CreateNewRadiusSession


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/100.GenerateNewSessionId]

AdornOps=setsystime DEG_WifiSessionIdTimeInMilliSecs
AdornOps=% DEG_WifiSessionIdTimeInMilliSecs 1000 DEG_WifiSessionIdTimeInNanoSecsLong
AdornOps=* DEG_WifiSessionIdTimeInNanoSecsLong 1000000 DEG_WifiSessionIdTimeInNanoSecsLong
AdornOps=/ DEG_WifiSessionIdTimeInMilliSecs 1000 DEG_WifiSessionIdTimeInSecs
AdornOps=set DEG_WifiInterfaceString ${WIFI_PROCESS_NAME}
AdornOps=+ DEG_WifiSessionIdString DEG_WifiInterfaceString DEG_WifiSessionIdString
AdornOps=+ DEG_WifiSessionIdString ; DEG_WifiSessionIdString
AdornOps=set DEG_WifiHostNameString ${WIFI_HOST_NAME}
AdornOps=+ DEG_WifiSessionIdString DEG_WifiHostNameString DEG_WifiSessionIdString
AdornOps=+ DEG_WifiSessionIdString ; DEG_WifiSessionIdString
AdornOps=+ DEG_WifiSessionIdString DEG_WifiSessionIdTimeInSecs DEG_WifiSessionIdString
AdornOps=+ DEG_WifiSessionIdString ; DEG_WifiSessionIdString
AdornOps=+ DEG_WifiSessionIdString DEG_WifiSessionIdTimeInNanoSecsLong DEG_WifiSessionIdString
AdornOps=+ DEG_WifiSessionIdString ; DEG_WifiSessionIdString
AdornOps=+ DEG_WifiSessionIdString DEG_WifiUserNameIMSIString DEG_WifiSessionIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/200.CheckIfSubscriberProvisioned]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequest
RuleNames=110.ReadValue
RuleNames=120.CheckErrorAndNoMatchFlag
RuleNames=130.ExecuteDependingOnSysParameterValue


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/200.CheckIfSubscriberProvisioned/100.InitRequest]

AdornOps=set DEG_WifiSysParameter "DEG_SUBSCRIBER"
AdornOps=set DEG_WifiSubscriberTableSysValueString ""
AdornOps=set DEG_WifiSysValueString ""
AdornOps=set DEG_WifiValidDBReturnInteger 0
AdornOps=set DEG_WifiNoRecordFoundInteger 0
AdornOps=setsystime DEG_WifiDeviceInterfaceProcessStartTimeLong
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/200.CheckIfSubscriberProvisioned/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_WifiSysParameter
ResponseAttributes=DEG_WifiSysValueString
ResponseAttributes=DEG_WifiValidDBReturnInteger
ResponseAttributes=DEG_WifiNoRecordFoundInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/200.CheckIfSubscriberProvisioned/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiValidDBReturnInteger,=,0
Conditions=DEG_WifiNoRecordFoundInteger,=,0
FalseRuleChain=200.DefaultValue
Operations=and
TrueRuleChain=100.SetSysValue


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/200.CheckIfSubscriberProvisioned/120.CheckErrorAndNoMatchFlag/100.SetSysValue]

AdornOps=copy DEG_WifiSysValueString DEG_WifiSubscriberTableSysValueString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/200.CheckIfSubscriberProvisioned/120.CheckErrorAndNoMatchFlag/200.DefaultValue]

AdornOps=set DEG_WifiSubscriberTableSysValueString "internal"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/200.CheckIfSubscriberProvisioned/130.ExecuteDependingOnSysParameterValue]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_WifiSubscriberTableSysValueString,=,"internal"
Conditions=DEG_WifiSubscriberTableSysValueString,=,DEG_WifiSubscriberTableSysValueString
Default=120.GetSubscriberInformationFromDEGSubscribersTable
Default=130.AppendMDNToSessionID
InternalTable=120.GetSubscriberInformationFromDEGSubscribersTable
InternalTable=130.AppendMDNToSessionID
Operations=None
TrueRuleChain=InternalTable
TrueRuleChain=Default


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/200.CheckIfSubscriberProvisioned/130.ExecuteDependingOnSysParameterValue/120.GetSubscriberInformationFromDEGSubscribersTable]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=301.GetSubscriberProfileInternalRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/200.CheckIfSubscriberProvisioned/130.ExecuteDependingOnSysParameterValue/130.AppendMDNToSessionID]

AdornOps=+ DEG_WifiSessionIdString ; DEG_WifiSessionIdString
AdornOps=+ DEG_WifiSessionIdString DEG_WifiMDNString DEG_WifiSessionIdString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/300.InitParams]

AdornOps=copy DEG_MDN DEG_MSESSIONKEY
AdornOps=set DEG_MSESSIONID ""
AdornOps=set DEG_WifiValidDBReturnInteger 0
AdornOps=set DEG_WifiNoRecordFoundInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/310.LogNME]

ClassName=LogNMERule
Attributes=DEG_MSESSIONKEY
Message=Monitoring Session Lookup By MDN:
LogLevel=DEBUG
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/320.QueryMonitoredSessionsMDN]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_WifiSessionKey
ResponseAttributes=DEG_MSESSIONID
ResponseAttributes=DEG_WifiValidDBReturnInteger
ResponseAttributes=DEG_WifiNoRecordFoundInteger
RuleChain=004.ReadMonitoringSessionRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/330.InitParams]

AdornOps=copy DEG_IMSI DEG_MSESSIONKEY
AdornOps=set DEG_MSESSIONID ""
AdornOps=set DEG_WifiValidDBReturnInteger 0
AdornOps=set DEG_WifiNoRecordFoundInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/340.LogNME]

ClassName=LogNMERule
Attributes=DEG_MSESSIONKEY
Message=Monitoring Session Lookup By IMSI :
LogLevel=DEBUG
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/350.QueryMonitoredSessionsIMSI]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_WifiSessionKey
ResponseAttributes=DEG_MSESSIONID
ResponseAttributes=DEG_WifiValidDBReturnInteger
ResponseAttributes=DEG_WifiNoRecordFoundInteger
RuleChain=004.ReadMonitoringSessionRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitCreateSession
RuleNames=400.LogNME
RuleNames=500.CreateSession
RuleNames=510.CheckCreateSessionStatus
RuleNames=520.LogNME
RuleNames=600.GenerateAccessRequestStartAuditData
RuleNames=610.LogNME
RuleNames=700.RadiusProcessingToAAA
RuleNames=800.CheckErrorProcessingFlag


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/100.InitCreateSession]

AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 0
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 0
AdornOps=set log_DB_Operation "CREATE"
AdornOps=set log_Table_Name "DEG_WIFI_RADIUSSESSION"
AdornOps=set DEG_WIFIRPROCID 3
AdornOps=copy DEG_WifiUserNameString DEG_WIFIRUSERNAME
AdornOps=copy DEG_WifiUserNameIMSIString DEG_WIFIRIMSI
AdornOps=set DEG_WifiRadiusStateString "NEW"
AdornOps=copy DEG_WifiRadiusStateString DEG_WIFIRSTATE
AdornOps=setsystime DEG_WifiDeviceInterfaceProcessStartTimeLong 
AdornOps=copy DEG_WifiDeviceInterfaceProcessStartTimeLong DEG_WIFIRUPDATETIMESTAMP
AdornOps=copy DEG_WifiSessionIdString DEG_WIFIRAAASESSID
AdornOps=copy DEG_WifiAcctSessionIdString DEG_WIFIRACCTSESSID
AdornOps=copy DEG_MDN DEG_WIFIRMDN
AdornOps=copy DEG_WifiAAASessionStateTbString DEG_WIFIAAASTATE
AdornOps=set DEG_WifiChallengeErrorCodeString 16384
AdornOps=copy DEG_WifiHostString DEG_WIFIRORIGIPADDR
AdornOps=copy DEG_WifiChallengeErrorCodeString DEG_WIFIRERRCODE
AdornOps=copy DEG_WificodeInteger DEG_WIFIRORIGCODE
AdornOps=copy DEG_WifiAuthenticatorString DEG_WIFIRORIGAUTHENTICATOR
AdornOps=copy DEG_WifiMessageAuthenticatorString DEG_WIFIRORIGMESAUTHENTICATOR
AdornOps=copy DEG_WifiLengthInteger DEG_WIFIRORIGLENGTH
AdornOps=set DEG_WifiNrbMonitoringSessionIdString ""
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/400.LogNME]

ClassName=LogNMERule
Attributes=DEG_WIFIRSTATE
Attributes=DEG_WIFIRAAASESSID
Attributes=DEG_WIFIRACCTSESSID
Attributes=DEG_WIFIRMDN
Attributes=DEG_WIFIAAASTATE
Attributes=DEG_WIFIRORIGIPADDR
Attributes=DEG_WIFIRUSERNAME
LogLevel=DEBUG
Message=Intialize before creating radius Session :
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/500.CreateSession]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/510.CheckCreateSessionStatus]

ClassName=ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetErrorValues
TrueRuleChain=110.LogErrorValues
TrueRuleChain=120.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/510.CheckCreateSessionStatus/100.SetErrorValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiActionInteger 2
AdornOps=set DEG_WifiOutReturnCodeString "3004"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.28"
AdornOps=set DEG_WifiReplyMessageString "DB Access Error"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/510.CheckCreateSessionStatus/110.LogErrorValues]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiAcctSessionIdString
Attributes=DEG_WifiUserNameString
Attributes=DEG_WifiHostString
Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
LogLevel=CRITICAL
Message=Unable to access or create entry in DEG_WIFI_RADIUSSESSION table : 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/510.CheckCreateSessionStatus/120.GenerateDiscardedRadiusAccessAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=509.GenerateDiscardedRadiusAccessAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/520.LogNME]

Attributes=DEG_WIFIRSTATE
Attributes=DEG_WIFIRAAASESSID
Attributes=DEG_WIFIRACCTSESSID
Attributes=DEG_WIFIRMDN
Attributes=DEG_WIFIAAASTATE
Attributes=DEG_WIFIRORIGIPADDR
Attributes=DEG_WIFIRUSERNAME
ClassName=LogNMERule
LogLevel=INFO
Message=Created New Radius Session:


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/600.GenerateAccessRequestStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=504.GenerateAccessRequestNewSessionStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/610.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiUserNameIMSIString
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiStateBinary
Attributes=DEG_WifiUserNameString
Attributes=DEG_WifiAAASessionStateTbString
Attributes=DEG_WIFIRUSERNAME
Message=Sending Access-Request To AAA :
LogLevel=DEBUG4
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/700.RadiusProcessingToAAA]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_WifiUserNameIMSIString
RequestAttributes=DEG_WifiEAPMessageBinary
RequestAttributes=DEG_WifiStateBinary
RequestAttributes=DEG_WifiUserNameString
RequestAttributes=DEG_WifiAAASessionStateTbString
RequestAttributes=DEG_WIFIRUSERNAME
ResponseAttributes=DEG_WIFIAAASTATE
ResponseAttributes=DEG_WIFIRSTATE
ResponseAttributes=DEG_WifiEAPMessageBinary
RuleChain=400.SendRadiusEAPPayloadToAAA
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag]

ClassName=ConditionalRule
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0
TrueRuleChain=100.CheckRadiusState


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_WIFIRSTATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_WIFIRSTATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
Conditions=DEG_WIFIRSTATE,starts,"AUTHENTICATED"
#Conditions=DEG_WIFIRSTATE,=,DEG_WIFIRSTATE

TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=Authenticated
#TrueRuleChain=Unknown


AkaWait=200.AkaWait_InitResponse
AkaWait=210.AkaWait_GenerateAuditAndNRB
AkaWait=220.AkaWait_GenerateResponse


AkaRejected=300.AkaRejected_CheckReplyMessage


Authenticated=400.Authenticated_InitResponse
Authenticated=410.Authenticated_GenerateAuditAndNRB
Authenticated=420.Authenticated_StoreToken
Authenticated=430.Authenticated_DeleteSession
Authenticated=440.Authenticated_GenerateResponse

#Unknown=500.Unknown_SetHttpErrorResponseTo500C



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/200.AkaWait_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiAnswerTypeInteger 11


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/210.AkaWait_GenerateAuditAndNRB]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=505.GenerateAccessRequestAkaWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/220.AkaWait_GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.SetNullPayloadResponse
TrueRuleChain=110.GenerateNullPayloadResponse
TrueRuleChain=120.SendNullPayloadResponse
FalseRuleChain=200.EncodePayload
FalseRuleChain=210.LogNME
FalseRuleChain=220.GenerateResponse
FalseRuleChain=230.SendResponse



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/220.AkaWait_GenerateResponse/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_WifiEAPMessageBinary == null


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/220.AkaWait_GenerateResponse/100.SetNullPayloadResponse]

ClassName=AdornmentRule
AdornOps=set DEG_WifiReplyMessageString "Payload is Null - AkaWait"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/220.AkaWait_GenerateResponse/110.GenerateNullPayloadResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiAAASessionStateBinary,DeviceRadiusMessage.answer.accessChallenge.State
NMEToStructuredNMEMap=DEG_WifiAuthenticatorBinary,DeviceRadiusMessage.answer.accessChallenge.authenticator
NMEToStructuredNMEMap=DEG_WifiMessageAuthenticatorBinary,DeviceRadiusMessage.answer.accessChallenge.MessageAuthenticator,
NMEToStructuredNMEMap=DEG_WifiEAPMessageBinary,DeviceRadiusMessage.answer.accessChallenge.EAPMessage
#NMEToStructuredNMEMap=DEG_WifiProxyStatesString,DeviceRadiusMessage.answer.accessChallenge.ProxyStates[0].value
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.answer.accessChallenge.action
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,11
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/220.AkaWait_GenerateResponse/120.SendNullPayloadResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/220.AkaWait_GenerateResponse/200.EncodePayload]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=encBase64 DEG_WifiEAPMessageBinary DEG_WifiEAPMessageString
AdornOps=set DEG_WifiReplyMessageString "Payload Encoded sucessfully - AkaWait"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/220.AkaWait_GenerateResponse/210.LogNME]

ClassName=LogNMERule
LogLevel=INFO
Message=Access Challenge sent To WIFIGW From DEG :
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiUserNameString
Attributes=DEG_WifiAAASessionStateBinary
Attributes=DEG_WifiAuthenticatorBinary
Attributes=DEG_WifiMessageAuthenticatorBinary
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/220.AkaWait_GenerateResponse/220.GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiAAASessionStateBinary,DeviceRadiusMessage.answer.accessChallenge.State
NMEToStructuredNMEMap=DEG_WifiAuthenticatorBinary,DeviceRadiusMessage.answer.accessChallenge.authenticator
NMEToStructuredNMEMap=DEG_WifiMessageAuthenticatorBinary,DeviceRadiusMessage.answer.accessChallenge.MessageAuthenticator,
NMEToStructuredNMEMap=DEG_WifiEAPMessageBinary,DeviceRadiusMessage.answer.accessChallenge.EAPMessage
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.answer.accessChallenge.action
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,11
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/220.AkaWait_GenerateResponse/230.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_WifiReplyMessageString,=,"5003"
Conditions=DEG_WifiReplyMessageString,=,"4001"
Conditions=DEG_WifiReplyMessageString,=,"5004"
Conditions=DEG_WifiReplyMessageString,=,"5012"

TrueRuleChain=EAPAdapterRejectedRequest
TrueRuleChain=EAPCodeError
TrueRuleChain=ValidationError
TrueRuleChain=InternalOrCommunicatioError

EAPAdapterRejectedRequest=100.SendAccessReject
EAPCodeError=200.EAPCodeErrorDiscardRequest
ValidationError=300.ValidationErrorDiscardRequest
InternalOrCommunicatioError=400.InternalOrCommunicatioErrorDiscardRequest


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/100.SendAccessReject]

ClassName=RuleChain
RuleNames=100.InitResponse
RuleNames=200.GenerateAuditAndNRB
RuleNames=300.DeleteSession
RuleNames=310.LogNME
RuleNames=400.GenerateResponse
RuleNames=500.SendResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/100.SendAccessReject/100.InitResponse]

ClassName=AdornmentRule
AdornOps=set DEG_WifiOutReturnCodeString "3002"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/100.SendAccessReject/200.GenerateAuditAndNRB]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateAccessRequestAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/100.SendAccessReject/300.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=2000.DeleteRadiusSession
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/100.SendAccessReject/310.LogNME]

ClassName=LogNMERule
LogLevel=INFO
Message=Access Reject sent To WIFIGW From DEG :
Attributes=DEG_WifiOutReturnCodeString
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiReplyMessageString
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/100.SendAccessReject/400.GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiReplyMessageString,DeviceRadiusMessage.answer.accessReject.ReplyMessages[0].value
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,3
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/100.SendAccessReject/500.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/200.EAPCodeErrorDiscardRequest]

ClassName=RuleChain
RuleNames=100.InitResponse
RuleNames=200.GenerateAuditAndNRB
RuleNames=300.DeleteSession
RuleNames=310.LogNME
RuleNames=400.SetResponse
RuleNames=500.SendResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/200.EAPCodeErrorDiscardRequest/100.InitResponse]

ClassName=AdornmentRule
AdornOps=set DEG_WifiOutReturnCodeString "3002"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/200.EAPCodeErrorDiscardRequest/200.GenerateAuditAndNRB]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateAccessRequestAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/200.EAPCodeErrorDiscardRequest/300.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=2000.DeleteRadiusSession
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/200.EAPCodeErrorDiscardRequest/310.LogNME]

ClassName=LogNMERule
LogLevel=INFO
Message=Access Reject sent To WIFIGW From DEG :
Attributes=DEG_WifiOutReturnCodeString
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiReplyMessageString
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/200.EAPCodeErrorDiscardRequest/400.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,11
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.answer.accessReject.action,2
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.request.accessRequest.action,2
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/200.EAPCodeErrorDiscardRequest/500.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/300.ValidationErrorDiscardRequest]

ClassName=RuleChain
RuleNames=100.InitResponse
RuleNames=200.GenerateAuditAndNRB
RuleNames=300.DeleteSession
RuleNames=310.LogNME
RuleNames=400.SetResponse
RuleNames=500.SendResponse



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/300.ValidationErrorDiscardRequest/100.InitResponse]

ClassName=AdornmentRule
AdornOps=set DEG_WifiOutReturnCodeString "3002"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/300.ValidationErrorDiscardRequest/200.GenerateAuditAndNRB]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateAccessRequestAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/300.ValidationErrorDiscardRequest/300.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=2000.DeleteRadiusSession
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/300.ValidationErrorDiscardRequest/310.LogNME]

ClassName=LogNMERule
LogLevel=INFO
Message=Access Reject sent To WIFIGW From DEG :
Attributes=DEG_WifiOutReturnCodeString
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiReplyMessageString
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/300.ValidationErrorDiscardRequest/400.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,11
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.answer.accessReject.action,2
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.request.accessRequest.action,2
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/300.ValidationErrorDiscardRequest/500.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/400.InternalOrCommunicatioErrorDiscardRequest]

ClassName=RuleChain
RuleNames=100.InitResponse
RuleNames=200.GenerateAuditAndNRB
RuleNames=300.DeleteSession
RuleNames=310.LogNME
RuleNames=400.SetResponse
RuleNames=500.SendResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/400.InternalOrCommunicatioErrorDiscardRequest/100.InitResponse]

ClassName=AdornmentRule
AdornOps=set DEG_WifiOutReturnCodeString "3002"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/400.InternalOrCommunicatioErrorDiscardRequest/200.GenerateAuditAndNRB]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateAccessRequestAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/400.InternalOrCommunicatioErrorDiscardRequest/300.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=2000.DeleteRadiusSession
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/400.InternalOrCommunicatioErrorDiscardRequest/310.LogNME]

ClassName=LogNMERule
LogLevel=INFO
Message=Access Reject sent To WIFIGW From DEG :
Attributes=DEG_WifiOutReturnCodeString
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiReplyMessageString
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/400.InternalOrCommunicatioErrorDiscardRequest/400.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,11
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.answer.accessReject.action,2
NMEToStructuredNMEMap=DEG_WifiActionInteger,DeviceRadiusMessage.request.accessRequest.action,2
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/300.AkaRejected_CheckReplyMessage/400.InternalOrCommunicatioErrorDiscardRequest/500.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/400.Authenticated_InitResponse]

ClassName=AdornmentRule
AdornOps=set DEG_AUTHENTICATION_TYPE "WIFI"
AdornOps=set DEG_AUTHENTICATION_SUBTYPE "WIFI"
AdornOps=copy DEG_WifiUserNameIMSIString DEG_IMSI
AdornOps=set DEG_APP_TOKEN_FLAG 1
AdornOps=copy DEG_WIFIRMDN DEG_MDN
AdornOps=genKey "HmacSHA1" 160 - DEG_WifiSha1KeyBinary
AdornOps=encBase64 DEG_WifiSha1KeyBinary DEG_WifiRespTokenString
AdornOps=copy DEG_WifiRespTokenString DEG_WifiTokenString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/410.Authenticated_GenerateAuditAndNRB]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=507.GenerateAccessRequestAkaAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/420.Authenticated_StoreToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_MDN
RequestAttributes=DEG_IMSI
RequestAttributes=DEG_WifiTokenString
RequestAttributes=DEG_AUTHENTICATION_TYPE
RequestAttributes=DEG_AUTHENTICATION_SUBTYPE
RequestAttributes=DEG_APP_TOKEN_FLAG
RequestAttributes=DEG_FULLAUTHTIMESTAMP
ResponseAttributes=DEG_WifiReplyMessageString
ResponseAttributes=DEG_EVENTTIMESTAMP
RuleChain=008.StoreTokenRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/430.Authenticated_DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=2000.DeleteRadiusSession
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/440.Authenticated_GenerateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.SetNullPayloadResponse
TrueRuleChain=110.GenerateNullPayloadResponse
TrueRuleChain=120.SendNullPayloadResponse
FalseRuleChain=200.EncodePayload
FalseRuleChain=210.LogNME
FalseRuleChain=220.GenerateResponse
FalseRuleChain=230.SendResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/440.Authenticated_GenerateResponse/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_WifiEAPMessageBinary == null


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/440.Authenticated_GenerateResponse/100.SetNullPayloadResponse]

ClassName=AdornmentRule
AdornOps=set DEG_WifiReplyMessageString "Payload is null - Authenticated"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/440.Authenticated_GenerateResponse/110.GenerateNullPayloadResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiUserNameString,DeviceRadiusMessage.answer.accessAccept.UserName
NMEToStructuredNMEMap=DEG_WifiReplyMessageString,DeviceRadiusMessage.answer.accessAccept.ReplyMessages[0].value
NMEToStructuredNMEMap=DEG_WifiEAPMessageBinary,DeviceRadiusMessage.answer.accessAccept.EAPMessage
NMEToStructuredNMEMap=DEG_WifiMessageAuthenticatorBinary,DeviceRadiusMessage.answer.accessAccept.MessageAuthenticator
NMEToStructuredNMEMap=DEG_WifiReplyMessageString,DeviceRadiusMessage.answer.accessAccept.ReplyMessages[0].value
#NMEToStructuredNMEMap=DEG_WifiMDNString,DeviceRadiusMessage.answer.accessAccept.ChargeableUserID
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,2
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/440.Authenticated_GenerateResponse/120.SendNullPayloadResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/440.Authenticated_GenerateResponse/200.EncodePayload]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=encBase64 DEG_WifiEAPMessageBinary DEG_WifiEAPMessageString
AdornOps=set DEG_WifiReplyMessageString "Payload encoded successfully - Authenticated"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/440.Authenticated_GenerateResponse/210.LogNME]

ClassName=LogNMERule
LogLevel=INFO
Message=Access Accept sent To WIFIGW From DEG :
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiUserNameString
Attributes=DEG_WifiAAASessionStateString
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/440.Authenticated_GenerateResponse/220.GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiUserNameString,DeviceRadiusMessage.answer.accessAccept.UserName
NMEToStructuredNMEMap=DEG_WifiReplyMessageString,DeviceRadiusMessage.answer.accessAccept.ReplyMessages[0].value
NMEToStructuredNMEMap=DEG_WifiEAPMessageBinary,DeviceRadiusMessage.answer.accessAccept.EAPMessage
NMEToStructuredNMEMap=DEG_WifiMessageAuthenticatorBinary,DeviceRadiusMessage.answer.accessAccept.MessageAuthenticator
NMEToStructuredNMEMap=DEG_WifiReplyMessageString,DeviceRadiusMessage.answer.accessAccept.ReplyMessages[0].value
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,2
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/300.NewAuthenticationSession/300.ValidateFirstWifiAccessRequest/400.CreateNewRadiusSession/800.CheckErrorProcessingFlag/100.CheckRadiusState/440.Authenticated_GenerateResponse/230.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella



####### GetSubscriberProfileInternal START ##########
[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/301.GetSubscriberProfileInternalRuleChain]

Link=/templates/DEG/WifiAuthInterface/GetSubscriberProfileInternal/RuleChains/301.GetSubscriberProfileInternalRuleChain
####### GetSubscriberProfileInternal END ##########


####### WifiEAPAKAAuthenticatorRadius START ##########

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/400.SendRadiusEAPPayloadToAAA]

Link=/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/401.RadiusErrorLog]

Link=/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/501.GenerateAAARadiusCallStartAuditDataRuleChain]

Link=/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/501.GenerateAAARadiusCallStartAuditDataRuleChain


####### EAPAKAAuthenticatorRadius END ############


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/503.GenerateAccessRequestExistingSessionStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CreateAuditRecord
RuleNames=200.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/503.GenerateAccessRequestExistingSessionStartAuditDataRuleChain/100.CreateAuditRecord]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/503.GenerateAccessRequestExistingSessionStartAuditDataRuleChain/100.CreateAuditRecord/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_WifiDeviceInterfaceProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_WifiAcctSessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditDurationLong 0
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_WifiMDNString DEG_AuditMdnString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "WifiAccessRequest"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString
AdornOps=set DEG_WifiNrbRecordFoundInteger 0


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/503.GenerateAccessRequestExistingSessionStartAuditDataRuleChain/100.CreateAuditRecord/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "WIFIGW TO DEGWIFI -> Access Request Received from WIFIGW:"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/503.GenerateAccessRequestExistingSessionStartAuditDataRuleChain/100.CreateAuditRecord/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiTmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WIFIRMDN DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameIMSIString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiUserNameIMSIString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiUserNameString DEG_AuditMessageString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/503.GenerateAccessRequestExistingSessionStartAuditDataRuleChain/100.CreateAuditRecord/400.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Access Request Received from WIFIGW"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/503.GenerateAccessRequestExistingSessionStartAuditDataRuleChain/200.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/504.GenerateAccessRequestNewSessionStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CreateAuditRecord
RuleNames=200.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/504.GenerateAccessRequestNewSessionStartAuditDataRuleChain/100.CreateAuditRecord]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/504.GenerateAccessRequestNewSessionStartAuditDataRuleChain/100.CreateAuditRecord/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_WifiDeviceInterfaceProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_WifiAcctSessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditDurationLong 0
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_WifiMDNString DEG_AuditMdnString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPStart"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString
AdornOps=set DEG_WifiNrbRecordFoundInteger 0


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/504.GenerateAccessRequestNewSessionStartAuditDataRuleChain/100.CreateAuditRecord/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "WIFIGW TO DEGWIFI -> EAP Transaction Start:"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/504.GenerateAccessRequestNewSessionStartAuditDataRuleChain/100.CreateAuditRecord/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiTmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameIMSIString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiUserNameIMSIString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiUserNameString DEG_AuditMessageString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/504.GenerateAccessRequestNewSessionStartAuditDataRuleChain/100.CreateAuditRecord/400.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "EAP Transaction Start"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/504.GenerateAccessRequestNewSessionStartAuditDataRuleChain/200.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/505.GenerateAccessRequestAkaWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_WifiOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/505.GenerateAccessRequestAkaWaitEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_WifiDeviceInterfaceProcessStartTimeLong DEG_AuditDurationLong
AdornOps=copy DEG_WIFIRACCTSESSID DEG_AuditSessionIdString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_WifiOutReturnCodeString "3001"
AdornOps=copy DEG_WifiOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_WifiMDNString DEG_AuditMdnString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "WifiAccessChallenge"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/505.GenerateAccessRequestAkaWaitEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEGWIFI TO WIFIGW -> Sending AccessChallenge response: "


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/505.GenerateAccessRequestAkaWaitEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiTmp1String "DEG_WifiMDNString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiMDNString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameIMSIString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiUserNameIMSIString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiUserNameString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WIFIRSTATE="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WIFIRSTATE DEG_AuditMessageString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/505.GenerateAccessRequestAkaWaitEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_WifiOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiTmp1String ", DEG_WifiOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiOutReturnCodeString DEG_AuditMessageString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/505.GenerateAccessRequestAkaWaitEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Access Challenge Response Sent to WIFIGW"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/505.GenerateAccessRequestAkaWaitEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/506.GenerateAccessRequestAkaRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_WifiOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/506.GenerateAccessRequestAkaRejectedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_WifiDeviceInterfaceProcessStartTimeLong DEG_AuditDurationLong
AdornOps=copy DEG_WIFIRACCTSESSID DEG_AuditSessionIdString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3002"
AdornOps=copy DEG_WifiMDNString DEG_AuditMdnString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPReject"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/506.GenerateAccessRequestAkaRejectedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEGWIFI TO WIFIGW -> Sending AccessReject response: "


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/506.GenerateAccessRequestAkaRejectedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiTmp1String "DEG_WifiMDNString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiMDNString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameIMSIString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiUserNameIMSIString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameIMSIString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiUserNameString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WIFIRSTATE="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WIFIRSTATE DEG_AuditMessageString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/506.GenerateAccessRequestAkaRejectedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_WifiOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiTmp1String ", DEG_WifiOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiOutReturnCodeString DEG_AuditMessageString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/506.GenerateAccessRequestAkaRejectedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "EAP Access request Rejected"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/506.GenerateAccessRequestAkaRejectedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/507.GenerateAccessRequestAkaAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_WifiOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/507.GenerateAccessRequestAkaAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_WifiDeviceInterfaceProcessStartTimeLong DEG_AuditDurationLong
AdornOps=copy DEG_WIFIRACCTSESSID DEG_AuditSessionIdString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_WifiOutReturnCodeString "3003"
AdornOps=copy DEG_WifiOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_WifiMDNString DEG_AuditMdnString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPAccept"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/507.GenerateAccessRequestAkaAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEGWIFI TO WIFIGW -> EAP Access request accepted: "


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/507.GenerateAccessRequestAkaAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiTmp1String "DEG_WifiMDNString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiMDNString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameIMSIString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiUserNameIMSIString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiUserNameString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WIFIRSTATE="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WIFIRSTATE DEG_AuditMessageString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/507.GenerateAccessRequestAkaAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_WifiOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiTmp1String ", DEG_WifiOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiOutReturnCodeString DEG_AuditMessageString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/507.GenerateAccessRequestAkaAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "EAP Access request accepted"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/507.GenerateAccessRequestAkaAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/508.GenerateAccessRequestUnknownSubscriberEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/508.GenerateAccessRequestUnknownSubscriberEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_WifiDeviceInterfaceProcessStartTimeLong DEG_AuditDurationLong
AdornOps=copy DEG_WifiAcctSessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_WifiOutReturnCodeString "3004"
AdornOps=copy DEG_WifiOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString
AdornOps=set DEG_WifiNrbMonitoringSessionIdList null


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/508.GenerateAccessRequestUnknownSubscriberEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEGWIFI TO WIFIGW -> Sending AccessRequest response: "


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/508.GenerateAccessRequestUnknownSubscriberEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiTmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameIMSIString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiUserNameIMSIString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiUserNameString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WIFIRSTATE="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WIFIRSTATE DEG_AuditMessageString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/508.GenerateAccessRequestUnknownSubscriberEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiTmp1String ", DEG_WifiOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiOutReturnCodeString DEG_AuditMessageString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/508.GenerateAccessRequestUnknownSubscriberEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Unknown Subscriber"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/508.GenerateAccessRequestUnknownSubscriberEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/509.GenerateDiscardedRadiusAccessAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/509.GenerateDiscardedRadiusAccessAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=copy DEG_WifiAcctSessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=copy DEG_WifiOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_WifiMDNString DEG_AuditMdnString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/509.GenerateDiscardedRadiusAccessAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO WIFIGW -> Discarding RADIUS Access request(error): "


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/509.GenerateDiscardedRadiusAccessAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiTmp1String "DEG_WifiMDNString ="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiMDNString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameIMSIString ="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiRadiusStateString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiRadiusStateString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiHostString DEG_AuditMessageString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/509.GenerateDiscardedRadiusAccessAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiTmp1String ", DEG_WifiOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiOutReturnCodeString DEG_AuditMessageString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/509.GenerateDiscardedRadiusAccessAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_WifiReplyMessageString DEG_AuditNRBMessageString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/509.GenerateDiscardedRadiusAccessAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


####### WifiEAPAKAAuthenticatorRadius START ##########

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/510.GenerateAAARadiusAkaChallengeEndAuditDataRuleChain]

Link=/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/510.GenerateAAARadiusAkaChallengeEndAuditDataRuleChain


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/511.GenerateAAARadiusAkaRejectEndAuditDataRuleChain]

Link=/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/511.GenerateAAARadiusAkaRejectEndAuditDataRuleChain


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/512.GenerateAAARadiusAkaAuthenticatedEndAuditDataRuleChain]

Link=/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/512.GenerateAAARadiusAkaAuthenticatedEndAuditDataRuleChain

####### WifiEAPAKAAuthenticatorRadius END ##########


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/513.GenerateValidationFailedAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CreateAuditRecord
RuleNames=200.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/513.GenerateValidationFailedAuditDataRuleChain/100.CreateAuditRecord]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/513.GenerateValidationFailedAuditDataRuleChain/100.CreateAuditRecord/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_WifiDeviceInterfaceProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=set DEG_AuditSessionIdString ""
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditDurationLong 0
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=set DEG_AuditMdnString ""
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString
AdornOps=set DEG_WifiNrbRecordFoundInteger 0


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/513.GenerateValidationFailedAuditDataRuleChain/100.CreateAuditRecord/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "WIFIGW TO DEGWIFI -> Validation failed for Access Request parameter"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/513.GenerateValidationFailedAuditDataRuleChain/100.CreateAuditRecord/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameIMSIString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiUserNameIMSIString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiUserNameString DEG_AuditMessageString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/513.GenerateValidationFailedAuditDataRuleChain/100.CreateAuditRecord/400.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_WifiReplyMessageString DEG_AuditNRBMessageString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/513.GenerateValidationFailedAuditDataRuleChain/200.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/600.GenerateAuditAndNRBEventsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpAuditRecord
RuleNames=200.DumpMonitoringTransactions


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/600.GenerateAuditAndNRBEventsRuleChain/100.DumpAuditRecord]

ClassName=com.hp.siu.sessionserver.rules.NMEStoreRule
NMEStore=AuditNMEStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/600.GenerateAuditAndNRBEventsRuleChain/200.DumpMonitoringTransactions]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_WifiNrbMonitoringSessionIdList
RequestAttributes=DEG_AuditProcessingNodeString
RequestAttributes=DEG_AuditTimestampLong
RequestAttributes=DEG_AuditInterfaceString
RequestAttributes=DEG_AuditInOutString
RequestAttributes=DEG_AuditResultCodeString
RequestAttributes=DEG_AuditMdnString
RequestAttributes=DEG_AuditIMSIString
RequestAttributes=DEG_AuditTransactionTypeString
RequestAttributes=DEG_AuditSourceDestinationString
RequestAttributes=DEG_AuditNRBMessageString
RequestAttributes=DEG_AuditMessageString
RuleChain=601.DumpMonitoringTransactionsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/601.DumpMonitoringTransactionsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpMonitoringTransactions


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.DumpMonitoringTransactions


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_WifiNrbMonitoringSessionIdList != null


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_WifiNrbMonitoringSessionIdList
RuleChain=100.InsertMonitoringTransactionToDb
TmpAttributeName=DEG_WifiNrbMonitoringSessionIdString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=300.GenerateMonitoringID


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateTransactionId
RuleNames=110.PopulateMonitoringTransactionAttributes
RuleNames=120.InitInsert2Db
RuleNames=200.Insert2Db
RuleNames=300.CheckCreateStatus


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/100.GenerateTransactionId]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_WifiTmp1Long
AdornOps=copy DEG_WifiTmp1Long DEG_WifiTmp1String
AdornOps=+ DEG_WifiTmp1String DEG_MSESSIONTRANSID DEG_MSESSIONTRANSID


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/110.PopulateMonitoringTransactionAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_AuditProcessingNodeString DEG_MSESSIONPROCID
AdornOps=copy DEG_AuditTimestampLong DEG_MSESSIONTIMESTAMP
AdornOps=copy DEG_AuditInterfaceString DEG_MSESSIONINTERFACE
AdornOps=copy DEG_AuditInOutString DEG_MSESSIONINOUT
AdornOps=copy DEG_AuditResultCodeString DEG_MSESSIONRESULTCODE
AdornOps=copy DEG_AuditMdnString DEG_MSESSIONMDN
AdornOps=copy DEG_AuditIMSIString DEG_MSESSIONIMSI
AdornOps=copy DEG_AuditTransactionTypeString DEG_MSESSIONTRANSACTIONTYPE
AdornOps=copy DEG_AuditSourceDestinationString DEG_MSESSIONSOURCEDESTINATION
AdornOps=copy DEG_AuditNRBMessageString DEG_MSESSIONMESSAGE


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/120.InitInsert2Db]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 0
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_WifiNrbMonitoringSessionIdString DEG_MSESSIONID
AdornOps=set log_DB_Operation "CREATE"
AdornOps=set log_Table_Name "DEG_MONITORING_TRANSACTIONS"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/200.Insert2Db]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_Wifi_MonitoringTransactions_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,!=,0
Conditions=DEG_WifiSessionStoreKeyExistsFlagInteger,!=,0
Operations=or
TrueRuleChain=100.ErrorLog


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus/100.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_MSESSIONID
Attributes=DEG_MSESSIONTRANSID
Attributes=DEG_MSESSIONPROCID
Attributes=DEG_MSESSIONTIMESTAMP
Attributes=DEG_MSESSIONINTERFACE
Attributes=DEG_MSESSIONINOUT
Attributes=DEG_MSESSIONRESULTCODE
Attributes=DEG_MSESSIONMDN
Attributes=DEG_MSESSIONTRANSACTIONTYPE
Attributes=DEG_MSESSIONSOURCEDESTINATION
Attributes=DEG_MSESSIONMESSAGE
LogLevel=WARNING
Message=Database Error: Unable to create entry in DEG_MONITORING_TRANSACTIONS session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetEmptyTransactionId
RuleNames=200.Log


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/100.SetEmptyTransactionId]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_MSESSIONTRANSID ""


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/200.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_MSESSIONTRANSID
LogLevel=CRITICAL
Message=Unable to generate unique value of monitoring transaction id: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/800.SharedSecretFetch]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.LogSharedSecretFetchStart
RuleNames=200.SetInitParams
RuleNames=300.RetrieveSharedSecret
RuleNames=400.CheckDBResult
RuleNames=500.LogSharedSecretFetchEnd


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/800.SharedSecretFetch/100.LogSharedSecretFetchStart]

Attributes=ClientAddress
ClassName=LogNMERule
LogLevel=DEBUG
Message=Fetch shared Secret from Database :
#PropertyName=LogRequestFlowLevel1
#UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/800.SharedSecretFetch/200.SetInitParams]

ClassName=AdornmentRule
AdornOps=set DEG_WifiValidDBReturnInteger 0
AdornOps=set DEG_WifiNoRecordFoundInteger 0
AdornOps=set DEG_WifiRecordFoundInteger 0



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/800.SharedSecretFetch/300.RetrieveSharedSecret]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=ClientAddress
ResponseAttributes=DEG_WifiSecretString
ResponseAttributes=DEG_WifiValidDBReturnInteger
ResponseAttributes=DEG_WifiNoRecordFoundInteger
RuleChain=005.ReadSharedSecretFromWifiIPAddressRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/800.SharedSecretFetch/400.CheckDBResult]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiValidDBReturnInteger,=,1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/800.SharedSecretFetch/400.CheckDBResult/FalseRule]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiNoRecordFoundInteger,=,1
TrueRuleChain=100.RecordNotFound
FalseRuleChain=200.RecordFound


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/800.SharedSecretFetch/400.CheckDBResult/FalseRule/200.RecordFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CopySharedSecret


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/800.SharedSecretFetch/400.CheckDBResult/FalseRule/200.RecordFound/100.CopySharedSecret]

AdornOps=copy DEG_WifiSecretString SharedSecret
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/800.SharedSecretFetch/400.CheckDBResult/FalseRule/100.RecordNotFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorValues
RuleNames=200.LogErrorValues


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/800.SharedSecretFetch/400.CheckDBResult/FalseRule/100.RecordNotFound/100.SetErrorValues]

AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiReplyMessageString "No shared secret found corresponding to host"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.29"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/800.SharedSecretFetch/400.CheckDBResult/FalseRule/100.RecordNotFound/200.LogErrorValues]

Attributes=ClientAddress
Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
ClassName=LogNMERule
LogLevel=WARNING
Message=No shared secret found corresponding to Host :
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/800.SharedSecretFetch/400.CheckDBResult/TrueRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorValues
RuleNames=200.LogErrorValues


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/800.SharedSecretFetch/400.CheckDBResult/TrueRule/100.SetErrorValues]

AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiReplyMessageString "DB error"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.30"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/800.SharedSecretFetch/400.CheckDBResult/TrueRule/200.LogErrorValues]

Attributes=ClientAddress
Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Database Error :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/800.SharedSecretFetch/500.LogSharedSecretFetchEnd]

Attributes=ClientAddress
Attributes=DEG_WifiSecretString
Attributes=SharedSecret
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Shared Secret found :
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ValidateChallengeErrorCode
RuleNames=200.SetCodeTo11
RuleNames=300.LookupSession


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/100.ValidateChallengeErrorCode]

Attributes=DEG_WifiChallengeErrorCodeString
ClassName=LogNMERule
LogLevel=DEBUG
Message=Set Challenge Error Code:
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/200.SetCodeTo11]

AdornOps=set DEG_WifiCodeInteger 11
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession]

ClassName=RuleChain
RuleNames=000.GenerateAccessRequestStartAuditData
RuleNames=100.InitLookup
RuleNames=200.Lookup
RuleNames=300.CheckLookupResult


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/000.GenerateAccessRequestStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=504.GenerateAccessRequestNewSessionStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/100.InitLookup]

AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 0
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_WifiHostString DEG_WIFIRORIGIPADDR
AdornOps=copy DEG_WifiAcctSessionIdString DEG_WIFIRACCTSESSID
AdornOps=copy DEG_WifiUserNameString DEG_WIFIRUSERNAME
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_WIFI_RADIUSSESSION"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/200.Lookup]

ClassName=LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_WIFIRORIGIPADDR,DEG_WIFIRORIGIPADDR
MapAttributes=DEG_WIFIRACCTSESSID,DEG_WIFIRACCTSESSID
MapAttributes=DEG_WIFIRUSERNAME,DEG_WIFIRUSERNAME
MapAttributes=DEG_WIFIRMDN,DEG_WifiMDNString
MapAttributes=DEG_WIFIRIMSI,DEG_WifiIMSIString
MapAttributes=DEG_WIFIRUPDATETIMESTAMP,DEG_WifiJMSTempReqStartTime
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult]

ClassName=ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=100.CheckIfSessionIdExists
TrueRuleChain=200.DBAccessErrorRuleChain


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists]

ClassName=ConditionalRule
Conditions=DEG_WifiSessionStoreKeyExistsFlagInteger,!=,0
FalseRuleChain=100.SessionIdNotExists_CreateNewSession
TrueRuleChain=200.SessionIDExists_UpdateSession


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession]

ClassName=RuleChain
RuleNames=100.InitUpdate
RuleNames=200.UpdateSession
RuleNames=300.CheckUpdateStatus


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/100.InitUpdate]

AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_WIFI_RADIUSSESSION"
AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 0
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_WIFIRSTATE "RADIUS_ACCESS_CHALLENGE_AKA_NOTIFICATION"
AdornOps=copy DEG_WifiSessionIdString DEG_WIFIAAASTATE
AdornOps=copy DEG_WifiChallengeErrorCodeString DEG_WIFIRERRCODE
AdornOps=setsystime DEG_WIFIRUPDATETIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/200.UpdateSession]

ClassName=UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_WIFIRSTATE,DEG_WIFIRSTATE
MapAttributes=DEG_WIFIRERRCODE,DEG_WIFIRERRCODE
MapAttributes=DEG_WIFIAAASTATE,DEG_WIFIAAASTATE
MapAttributes=DEG_WIFIRUPDATETIMESTAMP,DEG_WIFIRUPDATETIMESTAMP
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus]

ClassName=ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,=,1
Conditions=DEG_WifiSessionStoreKeyExistsFlagInteger,=,0
FalseRuleChain=200.SuccessfulUpdate
Operations=or
TrueRuleChain=100.LogUpdateError


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/100.LogUpdateError]

ClassName=RuleChain
RuleNames=100.SetErrorValues
RuleNames=200.LogErrorValues
RuleNames=300.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/100.LogUpdateError/300.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/100.LogUpdateError/300.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3168"
AdornOps=copy DEG_WifiMDNString DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiHostString DEG_AuditASPIdString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/100.LogUpdateError/300.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString " DEG TO DEVICE -> Discarding RADIUS Access request(error): DEG_WifiReturnCodeString = "
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/100.LogUpdateError/300.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiHostString DEG_AuditMessageString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/100.LogUpdateError/300.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

ClassName=AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "DB access error"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/100.LogUpdateError/300.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/100.LogUpdateError/100.SetErrorValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.31"
AdornOps=set DEG_WifiReplyMessageString "DB access error"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/100.LogUpdateError/200.LogErrorValues]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiAcctSessionIdString
Attributes=DEG_WifiSessionIdString
Attributes=DEG_WifiRadiusStateString
LogLevel=INFO
Message=Unexpected session state :
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/200.SuccessfulUpdate]

ClassName=RuleChain
RuleNames=100.GenerateRadiusAccessChallengeAuditData
RuleNames=200.GetActiveMonitoringSessionsByMDN
RuleNames=210.GetActiveMonitoringSessionsByIMSI
RuleNames=300.SetResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/200.SuccessfulUpdate/100.GenerateRadiusAccessChallengeAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=505.GenerateAccessRequestAkaWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/200.SuccessfulUpdate/200.GetActiveMonitoringSessionsByMDN]

ClassName=RuleChain
RuleNames=100.InitParams
RuleNames=200.QueryActiveSessions


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/200.SuccessfulUpdate/200.GetActiveMonitoringSessionsByMDN/100.InitParams]

AdornOps=copy DEG_WifiMDNString DEG_MSESSIONKEY
AdornOps=set DEG_WifiNrbMonitoringSessionIdList null
AdornOps=copy DEG_WifiSessionIdString DEG_WifiAAASessionStateString
AdornOps=str2bin DEG_WifiAAASessionStateString DEG_WifiAAASessionStateBinary
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/200.SuccessfulUpdate/200.GetActiveMonitoringSessionsByMDN/200.QueryActiveSessions]

ClassName=RefDataLookupRule
QueryName=200.GetMonitoringSessionActiveSession

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/200.SuccessfulUpdate/210.GetActiveMonitoringSessionsByIMSI]

ClassName=RuleChain
RuleNames=100.InitParams
RuleNames=200.QueryActiveSessions


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/200.SuccessfulUpdate/210.GetActiveMonitoringSessionsByIMSI/100.InitParams]

AdornOps=copy DEG_WifiUserNameIMSIString DEG_MSESSIONKEY
AdornOps=set DEG_WifiNrbMonitoringSessionIdList null
AdornOps=copy DEG_WifiSessionIdString DEG_WifiAAASessionStateString
AdornOps=str2bin DEG_WifiAAASessionStateString DEG_WifiAAASessionStateBinary
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/200.SuccessfulUpdate/210.GetActiveMonitoringSessionsByIMSI/200.QueryActiveSessions]

ClassName=RefDataLookupRule
QueryName=200.GetMonitoringSessionActiveSession


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.SessionIDExists_UpdateSession/300.CheckUpdateStatus/200.SuccessfulUpdate/300.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiAAASessionStateString,DeviceRadiusMessage.answer.accessChallenge.State
NMEToStructuredNMEMap=DEG_WifiEAPMessageBinary,DeviceRadiusMessage.answer.accessChallenge.EAPMessage
NMEToStructuredNMEMap=DEG_WifiMessageAuthenticatorBinary,DeviceRadiusMessage.answer.accessChallenge.MessageAuthenticator
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,2
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession]

ClassName=RuleChain
RuleNames=100.InitCreate
RuleNames=200.CreateSession
RuleNames=300.CheckCreateStatus


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/100.InitCreate]

AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 0
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "CREATE"
AdornOps=set log_Table_Name "DEG_WIFI_RADIUSSESSION"
AdornOps=set DEG_WIFIRPROCID "3"
AdornOps=copy DEG_WifiHostString DEG_WIFIRORIGIPADDR
AdornOps=copy DEG_WifiAcctSessionIdString DEG_WIFIRACCTSESSID
AdornOps=copy DEG_WifiUserNameString DEG_WIFIRUSERNAME
AdornOps=copy DEG_WifiUserNameIMSIString DEG_WIFIRIMSI
AdornOps=set DEG_WIFIRSTATE "RADIUS_ACCESS_CHALLENGE_AKA_NOTIFICATION"
AdornOps=setsystime DEG_WIFIRUPDATETIMESTAMP
AdornOps=copy DEG_WifiMDNString DEG_WIFIRMDN
AdornOps=copy DEG_WifiSessionIdString DEG_WIFIRAAASESSID
AdornOps=copy DEG_WifiSessionIdString DEG_WIFIAAASTATE
AdornOps=copy DEG_WifiChallengeErrorCodeString DEG_WIFIRERRCODE
AdornOps=copy DEG_WifiHostString DEG_WIFIRORIGIPADDR
AdornOps=copy DEG_WifiAuthenticatorBinary DEG_WIFIRORIGAUTHENTICATOR
AdornOps=copy DEG_WifiCodeInteger DEG_WIFIRORIGCODE
AdornOps=copy DEG_WifiLengthInteger DEG_WIFIRORIGLENGTH
AdornOps=copy DEG_WifiMessageAuthenticatorBinary DEG_WIFIRORIGMESAUTHENTICATOR
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/200.CreateSession]

ClassName=CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus]

ClassName=ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.SuccessfullyCreatedSession
TrueRuleChain=100.LogCreateError


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/100.LogCreateError]

ClassName=RuleChain
RuleNames=100.SetErrorValues
RuleNames=200.LogErrorValues
RuleNames=300.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/100.LogCreateError/100.SetErrorValues]

ClassName=AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.32"
AdornOps=set DEG_WifiReplyMessageString "DB Access error"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/100.LogCreateError/200.LogErrorValues]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiAcctSessionIdString
Attributes=DEG_WifiSessionIdString
LogLevel=CRITICAL
Message=Database error :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/100.LogCreateError/300.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/100.LogCreateError/300.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=copy DEG_WifiMDNString DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiHostString DEG_AuditASPIdString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/100.LogCreateError/300.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString " DEG TO DEVICE -> Discarding RADIUS Access request(error): DEG_WifiReturnCodeString = "
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/100.LogCreateError/300.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiHostString DEG_AuditMessageString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/100.LogCreateError/300.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

ClassName=AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "DB access error"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/100.LogCreateError/300.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/200.SuccessfullyCreatedSession]

ClassName=RuleChain
RuleNames=100.GenerateRadiusAccessChallengeAuditData
RuleNames=200.GetActiveMonitoringSessions
RuleNames=210.LogNME
RuleNames=300.SetResponse
RuleNames=400.SendResponse


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/200.SuccessfullyCreatedSession/100.GenerateRadiusAccessChallengeAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=505.GenerateAccessRequestAkaWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/200.SuccessfullyCreatedSession/200.GetActiveMonitoringSessions]

ClassName=RuleChain
RuleNames=100.InitParams
RuleNames=200.QueryActiveSessions


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/200.SuccessfullyCreatedSession/200.GetActiveMonitoringSessions/100.InitParams]

AdornOps=copy DEG_WifiMDNString DEG_MSESSIONKEY
AdornOps=set DEG_WifiNrbMonitoringSessionIdList null
AdornOps=copy DEG_WifiSessionIdString DEG_WifiAAASessionStateString
AdornOps=str2bin DEG_WifiAAASessionStateString DEG_WifiAAASessionStateBinary
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/200.SuccessfullyCreatedSession/200.GetActiveMonitoringSessions/200.QueryActiveSessions]

ClassName=RefDataLookupRule
QueryName=200.GetMonitoringSessionActiveSession


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/200.SuccessfullyCreatedSession/210.LogNME]

ClassName=LogNMERule
LogLevel=INFO
Message=Access Challenge sent To WIFIGW From DEG :
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiUserNameString
Attributes=DEG_WifiAAASessionStateBinary
Attributes=DEG_WifiAuthenticatorBinary
Attributes=DEG_WifiMessageAuthenticatorBinary
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/200.SuccessfullyCreatedSession/300.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiAAASessionStateBinary,DeviceRadiusMessage.answer.accessChallenge.State
NMEToStructuredNMEMap=DEG_WifiAuthenticatorBinary,DeviceRadiusMessage.answer.accessChallenge.authenticator
NMEToStructuredNMEMap=DEG_WifiMessageAuthenticatorBinary,DeviceRadiusMessage.answer.accessChallenge.MessageAuthenticator
NMEToStructuredNMEMap=DEG_WifiEAPMessageBinary,DeviceRadiusMessage.answer.accessChallenge.EAPMessage
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,11
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIdNotExists_CreateNewSession/300.CheckCreateStatus/200.SuccessfullyCreatedSession/400.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/200.DBAccessErrorRuleChain]

ClassName=RuleChain
RuleNames=100.GenerateDiscardedRadiusAccessAuditData
RuleNames=200.SetErrorProcessorFlag


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/200.DBAccessErrorRuleChain/200.SetErrorProcessorFlag]

AdornOps=set DEG_WifiActionInteger 2
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/200.DBAccessErrorRuleChain/100.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/200.DBAccessErrorRuleChain/100.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3168"
AdornOps=copy DEG_WifiMDNString DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiHostString DEG_AuditASPIdString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/200.DBAccessErrorRuleChain/100.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString " DEG TO DEVICE -> Discarding RADIUS Access request(error): DEG_WifiReturnCodeString = "
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/200.DBAccessErrorRuleChain/100.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiHostString DEG_AuditMessageString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/200.DBAccessErrorRuleChain/100.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

ClassName=AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "DB access error"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/900.SendRadiusChallengeWithAKANotification/300.LookupSession/300.CheckLookupResult/200.DBAccessErrorRuleChain/100.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetEAPFailurePayload
RuleNames=200.SetCodeTo3
RuleNames=300.LookupSession


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/100.SetEAPFailurePayload]

AdornOps=set DEG_WifiEAPMessageBinary 0401000700
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/200.SetCodeTo3]

AdornOps=set DEG_WifiCodeInteger 3
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession]

ClassName=RuleChain
RuleNames=100.InitLookup
RuleNames=200.Lookup
RuleNames=300.CheckLookupResult


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/100.InitLookup]

AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 0
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_WifiHostString DEG_WIFIRORIGIPADDR
AdornOps=copy DEG_WifiAcctSessionIdString DEG_WIFIRACCTSESSID
AdornOps=copy DEG_WifiUserNameString DEG_WIFIRUSERNAME
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_WIFI_RADIUSSESSION"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/200.Lookup]

ClassName=LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_WIFIRORIGIPADDR,DEG_WIFIRORIGIPADDR
MapAttributes=DEG_WIFIRACCTSESSID,DEG_WIFIRACCTSESSID
MapAttributes=DEG_WIFIRUSERNAME,DEG_WIFIRUSERNAME
MapAttributes=DEG_WIFIRERRCODE,DEG_WIFIRERRCODE
MapAttributes=DEG_WIFIRMDN,DEG_WifiMDNString
MapAttributes=DEG_WIFIRIMSI,DEG_WifiIMSIString
MapAttributes=DEG_WIFIRUPDATETIMESTAMP,DEG_WifiJMSTempReqStartTime
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult]

ClassName=ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=100.CheckIfSessionIdExists
TrueRuleChain=200.DBAccessErrorRuleChain


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists]

ClassName=ConditionalRule
Conditions=DEG_WifiSessionStoreKeyExistsFlagInteger,!=,0
TrueRuleChain=100.SessionIDExists_DeleteSession


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIDExists_DeleteSession]

ClassName=RuleChain
RuleNames=100.InitDelete
RuleNames=200.DeleteSession
RuleNames=300.SetResponse
RuleNames=310.SendResponse
RuleNames=400.LogNME
RuleNames=500.GenerateRadiusAccessRejectAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIDExists_DeleteSession/100.InitDelete]

AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_WIFI_RADIUSSESSION
AdornOps=set DEG_WifiReplyMessageString "Unknown Subscriber or Subscriber is not Active"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIDExists_DeleteSession/200.DeleteSession]

ClassName=DeleteSessionRule
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIDExists_DeleteSession/300.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiReplyMessageString,DeviceRadiusMessage.answer.accessReject.ReplyMessages[0].value
NMEToStructuredNMEMap=DEG_WifiAnswerTypeInteger,DeviceRadiusMessage.answer.answerType,3
NMEToStructuredNMEMap=DEG_WifiIsAnswerBoolean,DeviceRadiusMessage.isAnswer,true
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,DeviceRadiusMessage.request.requestType,1
SNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIDExists_DeleteSession/310.SendResponse]

ClassName=RadiusResponseRule
ConnectorName=100.RadiusServerProtocolAdapter
EncodeAttribute=DeviceRadiusMessage
RootNMEType=radius:Umbrella


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIDExists_DeleteSession/400.LogNME]

Attributes=DEG_WIFIRERRCODE
Attributes=DEG_WIFIRACCTSESSID
Attributes=DEG_WIFIRUSERNAME
Attributes=DEG_WIFIRMDN
Attributes=DEG_WIFIRIMSI
Attributes=DEG_WIFIRUPDATETIMESTAMP
ClassName=LogNMERule
LogLevel=INFO
Message=Radius Reject with EAP failure :
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIDExists_DeleteSession/500.GenerateRadiusAccessRejectAuditData]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditNRBMessageAttribute
RuleNames=400.GenerateAuditAndNRBEvents


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIDExists_DeleteSession/500.GenerateRadiusAccessRejectAuditData/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=- DEG_AuditTimestampLong DEG_WifiDeviceInterfaceProcessStartTimeLong DEG_AuditDurationLong
AdornOps=copy DEG_WifiAcctSessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "1"
AdornOps=copy DEG_WifiMDNString DEG_AuditMdnString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "WifiAccessReject"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIDExists_DeleteSession/500.GenerateRadiusAccessRejectAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO WIFIGW-> Processed RADIUS Access Reject request: DEG_WifiGatewayIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiHostString DEG_AuditMessageString
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIDExists_DeleteSession/500.GenerateRadiusAccessRejectAuditData/300.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Unknown Subscriber or Subscriber not Active"
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIDExists_DeleteSession/500.GenerateRadiusAccessRejectAuditData/400.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/200.DBAccessErrorRuleChain]

ClassName=RuleChain
RuleNames=100.SetErrorValues
RuleNames=200.LogErrorValues
RuleNames=300.GenerateDiscardedRadiusAccessAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/200.DBAccessErrorRuleChain/100.SetErrorValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiOutReturnCodeString "3004"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.33"
AdornOps=set DEG_WifiReplyMessageString "DB Access Error"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/200.DBAccessErrorRuleChain/200.LogErrorValues]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiAcctSessionIdString
Attributes=DEG_WifiUserNameIMSIString
LogLevel=CRITICAL
Message=Unable to perform lookup or access DEG_WIFIRADIUSSESSION table :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/1000.SendRadiusRejectWithEAPFailure/300.LookupSession/300.CheckLookupResult/200.DBAccessErrorRuleChain/300.GenerateDiscardedRadiusAccessAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=509.GenerateDiscardedRadiusAccessAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/2000.DeleteRadiusSession]

ClassName=RuleChain
RuleNames=100.InitLookup
RuleNames=200.LookupSession
RuleNames=300.CheckLookupResult


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/2000.DeleteRadiusSession/100.InitLookup]

AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 0
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_WIFI_RADIUSSESSION
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/2000.DeleteRadiusSession/200.LookupSession]

ClassName=LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_WIFIRORIGIPADDR,DEG_WIFIRORIGIPADDR
MapAttributes=DEG_WIFIRACCTSESSID,DEG_WIFIRACCTSESSID
MapAttributes=DEG_WIFIRUSERNAME,DEG_WIFIRUSERNAME
MapAttributes=DEG_WIFIRMDN,DEG_WifiMDNString
MapAttributes=DEG_WIFIRIMSI,DEG_WifiImsiString
MapAttributes=DEG_WIFIRUPDATETIMESTAMP,DEG_WifiJMSTempReqStartTime
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/2000.DeleteRadiusSession/300.CheckLookupResult]

ClassName=ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=100.CheckIfSessionIdExists
TrueRuleChain=200.DBAccessErrorRuleChain


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/2000.DeleteRadiusSession/300.CheckLookupResult/100.CheckIfSessionIdExists]

ClassName=ConditionalRule
Conditions=DEG_WifiSessionStoreKeyExistsFlagInteger,!=,0
TrueRuleChain=100.SessionIDExists_DeleteSession
TrueRuleChain=200.LogNME


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/2000.DeleteRadiusSession/300.CheckLookupResult/100.CheckIfSessionIdExists/100.SessionIDExists_DeleteSession]

ClassName=DeleteSessionRule
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/2000.DeleteRadiusSession/300.CheckLookupResult/100.CheckIfSessionIdExists/200.LogNME]

ClassName=LogNMERule
Attributes=DEG_WIFIRACCTSESSID
Attributes=DEG_WIFIRORIGIPADDR
Attributes=DEG_WIFIRUSERNAME
LogLevel=DEBUG
Message=Radius session deleted :
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/2000.DeleteRadiusSession/300.CheckLookupResult/200.DBAccessErrorRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorValues
RuleNames=200.LogErrorValues
RuleNames=300.GenerateAccessRequestSystemErrorEndAuditData


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/2000.DeleteRadiusSession/300.CheckLookupResult/200.DBAccessErrorRuleChain/100.SetErrorValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiOutReturnCodeString "3004"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.27"
AdornOps=set DEG_WifiReplyMessageString "DB Access Error"


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/2000.DeleteRadiusSession/300.CheckLookupResult/200.DBAccessErrorRuleChain/200.LogErrorValues]

Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiRadiusStateString
Attributes=DEG_WifiReplyMessageString
Attributes=log_DB_Operation
Attributes=log_Table_Name
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Unable to do lookup in DEG_WIFIRADIUSSESSION Table :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/2000.DeleteRadiusSession/300.CheckLookupResult/200.DBAccessErrorRuleChain/300.GenerateAccessRequestSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=509.GenerateDiscardedRadiusAccessAuditDataRuleChain
UseRuleChainManagerPool=true


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/3000.ProcessRadiusAuthenticationTimeouts]

ClassName=RuleChain
RuleNames=100.InitTimestamp
RuleNames=200.QueryRadiusSessions


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/3000.ProcessRadiusAuthenticationTimeouts/100.InitTimestamp]

AdornOps=setsystime DEG_WifiCreateTimeStampSixSecLong
AdornOps=- DEG_WifiCreateTimeStampSixSecLong 6000 DEG_WifiCreateTimeStampSixSecLong
AdornOps=setsystime DEG_WifiCreateTimeStampSixtySecLong
AdornOps=- DEG_WifiCreateTimeStampSixtySecLong 60000 DEG_WifiCreateTimeStampSixtySecLong
ClassName=AdornmentRule


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/3000.ProcessRadiusAuthenticationTimeouts/200.QueryRadiusSessions]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=700.QueryRadiuSessionFromSessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain]

ClassName=RuleChain
RuleNames=100.CheckSessionState


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState]

ClassName=SwitchConditionRule
Conditions=DEG_WifiRadiusStateString,=,"RADIUS_ACCESS_CHALLENGE_AKA_NOTIFICATION"
Conditions=DEG_WifiRadiusStateString,=,"WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA"
Conditions=DEG_WifiRadiusStateString,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_WifiRadiusStateString,=,"NEW"
Conditions=DEG_WifiRadiusStateString,=,DEG_WifiRadiusStateString

NewSent=200.InvokeNew

RadiusAccessChallengeDeviceResponse=300.InvokeRadiusAccessChallenge

RadiusAccessChallengeNotification=400.InvokeRadiusAccessChallengeAKASent
RadiusAccessChallengeCheckAAA=400.InvokeRadiusAccessChallengeAKASent

InvalidState=400.InvokeInvalidState

TrueRuleChain=RadiusAccessChallengeNotification
TrueRuleChain=RadiusAccessChallengeCheckAAA
TrueRuleChain=RadiusAccessChallengeDeviceResponse
TrueRuleChain=NewSent
TrueRuleChain=InvalidState


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/300.InvokeRadiusAccessChallenge]

ClassName=RuleChain
RuleNames=100.CheckSessionGreaterThan6Sec


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/300.InvokeRadiusAccessChallenge/100.CheckSessionGreaterThan6Sec]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WIFIRUPDATETIMESTAMP,<=,DEG_WifiCreateTimeStampSixSecLong


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/300.InvokeRadiusAccessChallenge/100.CheckSessionGreaterThan6Sec/TrueRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DeleteSession
RuleNames=200.LogNME
RuleNames=300.CheckDeleteStatus


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/300.InvokeRadiusAccessChallenge/100.CheckSessionGreaterThan6Sec/TrueRule/100.DeleteSession]

ClassName=DeleteSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInTrueRuleSession=false
MapAttributes=DEG_WIFIRORIGIPADDR,DEG_WIFIRORIGIPADDR
MapAttributes=DEG_WIFIRACCTSESSID,DEG_WIFIRACCTSESSID
MapAttributes=DEG_WIFIRUSERNAME,DEG_WIFIRUSERNAME
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/300.InvokeRadiusAccessChallenge/100.CheckSessionGreaterThan6Sec/TrueRule/200.LogNME]

ClassName=LogNMERule
Attributes=DEG_WIFIRSTATE
Attributes=DEG_WIFIRUPDATETIMESTAMP
Message=Session Greater Than 6 Second :
LogLevel=DEBUG4
PropertyName=LogRequestFlowLevel1
UseProperty=false


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/300.InvokeRadiusAccessChallenge/100.CheckSessionGreaterThan6Sec/TrueRule/300.CheckDeleteStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,!=,0


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/300.InvokeRadiusAccessChallenge/100.CheckSessionGreaterThan6Sec/TrueRule/300.CheckDeleteStatus/TrueRule]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WIFIRORIGIPADDR
Attributes=DEG_WIFIRACCTSESSID
Attributes=DEG_WIFIRUSERNAME
LogLevel=CRITICAL
Message=Unable to delete entry from DEG_WIFIRADIUSSESSION table :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/200.InvokeNew]

ClassName=RuleChain
RuleNames=100.CheckSessionGreaterThan60Sec


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/200.InvokeNew/100.CheckSessionGreaterThan60Sec]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WIFIRUPDATETIMESTAMP,<=,DEG_WifiCreateTimeStampSixtySecLong


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/200.InvokeNew/100.CheckSessionGreaterThan60Sec/TrueRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DeleteRadiusSession
RuleNames=200.LogNME
RuleNames=300.CheckDeleteStatus



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/200.InvokeNew/100.CheckSessionGreaterThan60Sec/TrueRule/100.DeleteRadiusSession]

ClassName=DeleteSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInTrueRuleSession=false
MapAttributes=DEG_WIFIRORIGIPADDR,DEG_WIFIRORIGIPADDR
MapAttributes=DEG_WIFIRACCTSESSID,DEG_WIFIRACCTSESSID
MapAttributes=DEG_WIFIRUSERNAME,DEG_WIFIRUSERNAME
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/200.InvokeNew/100.CheckSessionGreaterThan60Sec/TrueRule/200.LogNME]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WIFIRUPDATETIMESTAMP
Attributes=DEG_WIFIRMDN
Message=Session more that 60 second old :
LogLevel=DEBUG4
PropertyName=LogRequestFlowLevel1
UseProperty=false
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/200.InvokeNew/100.CheckSessionGreaterThan60Sec/TrueRule/300.CheckDeleteStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,!=,0


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/200.InvokeNew/100.CheckSessionGreaterThan60Sec/TrueRule/300.CheckDeleteStatus/TrueRule]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WIFIRORIGIPADDR
Attributes=DEG_WIFIRACCTSESSID
Attributes=DEG_WIFIRUSERNAME
LogLevel=CRITICAL
Message=Unable to delete entry from DEG_WIFIRADIUSESSION table :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/400.InvokeRadiusAccessChallengeAKASent]

ClassName=RuleChain
RuleNames=100.CheckSessionGreaterThan6Sec


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/400.InvokeRadiusAccessChallengeAKASent/100.CheckSessionGreaterThan6Sec]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WIFIRUPDATETIMESTAMP,<=,DEG_WifiCreateTimeStampSixSecLong


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/400.InvokeRadiusAccessChallengeAKASent/100.CheckSessionGreaterThan6Sec/TrueRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DeleteRadiusSession
RuleNames=200.LogNME
RuleNames=300.CheckDeleteStatus



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/400.InvokeRadiusAccessChallengeAKASent/100.CheckSessionGreaterThan6Sec/TrueRule/100.DeleteRadiusSession]

ClassName=DeleteSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInTrueRuleSession=false
MapAttributes=DEG_WIFIRORIGIPADDR,DEG_WIFIRORIGIPADDR
MapAttributes=DEG_WIFIRACCTSESSID,DEG_WIFIRACCTSESSID
MapAttributes=DEG_WIFIRUSERNAME,DEG_WIFIRUSERNAME
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/400.InvokeRadiusAccessChallengeAKASent/100.CheckSessionGreaterThan6Sec/TrueRule/200.LogNME]

ClassName=LogNMERule
Attributes=DEG_WIFIRSTATE
Attributes=DEG_WIFIRUPDATETIMESTAMP
Message=Challenge Session Greater Than 60 Seconds:
LogLevel=DEBUG4
PropertyName=LogRequestFlowLevel1
UseProperty=false
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/400.InvokeRadiusAccessChallengeAKASent/100.CheckSessionGreaterThan6Sec/TrueRule/300.CheckDeleteStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,!=,0


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/400.InvokeRadiusAccessChallengeAKASent/100.CheckSessionGreaterThan6Sec/TrueRule/300.CheckDeleteStatus/TrueRule]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WIFIRORIGIPADDR
Attributes=DEG_WIFIRACCTSESSID
Attributes=DEG_WIFIRUSERNAME
LogLevel=CRITICAL
Message=Unable to delete entry from DEG_WIFIRADIUSSESSION table :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/400.InvokeInvalidState]

ClassName=RuleChain
RuleNames=100.CheckSessionGreaterThan60Sec


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/400.InvokeInvalidState/100.CheckSessionGreaterThan60Sec]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WIFIRUPDATETIMESTAMP,<=,DEG_WifiCreateTimeStampSixtySecLong


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/400.InvokeInvalidState/100.CheckSessionGreaterThan60Sec/TrueRule]

ClassName=RuleChain
RuleNames=100.DeleteRadiusSession
RuleNames=200.LogNME
RuleNames=300.CheckDeleteStatus


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/400.InvokeInvalidState/100.CheckSessionGreaterThan60Sec/TrueRule/100.DeleteRadiusSession]

ClassName=DeleteSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInTrueRuleSession=false
MapAttributes=DEG_WIFIRORIGIPADDR,DEG_WIFIRORIGIPADDR
MapAttributes=DEG_WIFIRACCTSESSID,DEG_WIFIRACCTSESSID
MapAttributes=DEG_WIFIRUSERNAME,DEG_WIFIRUSERNAME
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/400.InvokeInvalidState/100.CheckSessionGreaterThan60Sec/TrueRule/200.LogNME]

ClassName=LogNMERule
Attributes=DEG_WIFIRSTATE
Attributes=DEG_WIFIRUPDATETIMESTAMP
Message=Invalid Session State:
LogLevel=DEBUG4
PropertyName=LogRequestFlowLevel1
UseProperty=false

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/400.InvokeInvalidState/100.CheckSessionGreaterThan60Sec/TrueRule/300.CheckDeleteStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,!=,0


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/RuleChains/4000.ProcessingRadiusSessionsRuleChain/100.CheckSessionState/400.InvokeInvalidState/100.CheckSessionGreaterThan60Sec/TrueRule/300.CheckDeleteStatus/TrueRule]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WIFIRORIGIPADDR
Attributes=DEG_WIFIRACCTSESSID
Attributes=DEG_WIFIRUSERNAME
LogLevel=CRITICAL
Message=Unable to delete entry from DEG_WIFIRADIUSSESSION table :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

####### Common START ##########
[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/SessionStores]

Link=/templates/DEG/WifiAuthInterface/Common/SessionStores

####### Common END ############

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/SessionStores/DEG_Wifi_Subscribers_SessionStore]

Link=/templates/DEG/WifiAuthInterface/GetSubscriberProfileInternal/SessionStores/DEG_Wifi_Subscribers_SessionStore


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/SessionStores/DEG_TOKENS_SessionStore]

Attributes=DEG_MDN
Attributes=DEG_IMSI,key
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_APP_TOKEN_FLAG
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_FULLAUTHTIMESTAMP
Attributes=DEG_PUSH_TOKEN
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DbSchema=${DBSCHEMA_DEG}
DatabaseId=DEG_TOKENS
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
NativeConditions=1.MatchingByMDN
SQLTypeMap=DEG_MDN,BIGINT
SQLTypeMap=DEG_IMSI,VARCHAR(64)
SQLTypeMap=DEG_SUBSTOKEN,CHAR(28)
SQLTypeMap=DEG_TOKENSTATUS,CHAR(2)
SQLTypeMap=DEG_AUTHENTICATION_TYPE,CHAR(4)
SQLTypeMap=DEG_AUTHENTICATION_SUBTYPE,CHAR(4)
SQLTypeMap=DEG_APP_TOKEN_FLAG,TINYINT
SQLTypeMap=DEG_EVENTTIMESTAMP,BIGINT
SQLTypeMap=DEG_FULLAUTHTIMESTAMP,BIGINT
SQLTypeMap=DEG_PUSH_TOKEN,VARCHAR(64)
CommonPolicyID=Policy1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/SessionStores/DEG_TOKENS_SessionStore/1.MatchingByMDN]

Condition=where DEG_MDN=%DEG_MDN and DEG_AUTHENTICATION_TYPE = %DEG_AUTHENTICATION_TYPE



[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/SessionStores/DEG_Wifi_Sys_SessionStore]

Attributes=DEG_SYSPARAMETER,key
Attributes=DEG_SYSVALUE
Attributes=DEG_USERID
Attributes=DEG_LASTUPDATE
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DbSchema=TTDEGUSER
DatabaseId=DEG_SYS_PARAMETERS
MaxDatabaseConnections=20
SQLTypeMap=DEG_SYSPARAMETER,VARCHAR(32)
SQLTypeMap=DEG_SYSVALUE,VARCHAR(32)
SQLTypeMap=DEG_USERID,VARCHAR(32)
SQLTypeMap=DEG_LASTUPDATE,DATE
CommonPolicyID=Policy1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/SessionStores/DEG_Wifi_MonitoringTransactions_SessionStore]

Attributes=DEG_MSESSIONID,key
Attributes=DEG_MSESSIONTRANSID,key
Attributes=DEG_MSESSIONIMSI
Attributes=DEG_MSESSIONPROCID
Attributes=DEG_MSESSIONTIMESTAMP
Attributes=DEG_MSESSIONINTERFACE
Attributes=DEG_MSESSIONINOUT
Attributes=DEG_MSESSIONRESULTCODE
Attributes=DEG_MSESSIONMDN
Attributes=DEG_MSESSIONTRANSACTIONTYPE
Attributes=DEG_MSESSIONSOURCEDESTINATION
Attributes=DEG_MSESSIONMESSAGE
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy2
DbSchema=${DBSCHEMA_NRB}
DatabaseId=DEG_MONITORING_TRANSACTIONS
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_MONI_TRANS}
SQLTypeMap=DEG_MSESSIONID,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONTRANSID,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONPROCID,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONTIMESTAMP,BIGINT
SQLTypeMap=DEG_MSESSIONINTERFACE,VARCHAR(10)
SQLTypeMap=DEG_MSESSIONINOUT,VARCHAR(3)
SQLTypeMap=DEG_MSESSIONRESULTCODE,VARCHAR(15)
SQLTypeMap=DEG_MSESSIONMDN,BIGINT
SQLTypeMap=DEG_MSESSIONTRANSACTIONTYPE,VARCHAR(50)
SQLTypeMap=DEG_MSESSIONSOURCEDESTINATION,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONMESSAGE,VARCHAR(512)
SQLTypeMap=DEG_MSESSIONIMSI,VARCHAR(64)


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/SessionStores/DEG_Wifi_RadiusSession_SessionStore]

Attributes=DEG_WIFIRPROCID
Attributes=DEG_WIFIRORIGIPADDR,key
Attributes=DEG_WIFIRACCTSESSID,key
Attributes=DEG_WIFIRUSERNAME,key
Attributes=DEG_WIFIRIMSI
Attributes=DEG_WIFIRSTATE
Attributes=DEG_WIFIAAASTATE
Attributes=DEG_WIFIRUPDATETIMESTAMP
Attributes=DEG_WIFIRMDN
Attributes=DEG_WIFIRERRCODE
Attributes=DEG_WIFIRORIGCODE
Attributes=DEG_WIFIRORIGMESAUTHENTICATOR
Attributes=DEG_WIFIRORIGLENGTH
Attributes=DEG_WIFIRAAASESSID
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DatabaseId=DEG_WIFIRADIUSSESSION
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=30
NativeConditions=MatchingSession
SQLTypeMap=DEG_WIFIRPROCID,VARCHAR(32)
SQLTypeMap=DEG_WIFIRORIGIPADDR,VARCHAR(256)
SQLTypeMap=DEG_WIFIRACCTSESSID,VARCHAR(256)
SQLTypeMap=DEG_WIFIRUSERNAME,VARCHAR(256)
SQLTypeMap=DEG_WIFIRIMSI,VARCHAR(15)
SQLTypeMap=DEG_WIFIRSTATE,VARCHAR(64)
SQLTypeMap=DEG_WIFIAAASTATE,VARCHAR(64)
SQLTypeMap=DEG_WIFIRUPDATETIMESTAMP,BIGINT
SQLTypeMap=DEG_WIFIRMDN,BIGINT
SQLTypeMap=DEG_WIFIRAAASESSID,VARCHAR(256)
SQLTypeMap=DEG_WIFIRERRCODE,VARCHAR(32)
SQLTypeMap=DEG_WIFIRORIGMESAUTHENTICATOR,VARCHAR(100)
SQLTypeMap=DEG_WIFIRORIGCODE,BIGINT
SQLTypeMap=DEG_WIFIRORIGLENGTH,BIGINT
CommonPolicyID=Policy1


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/SessionStores/DEG_Wifi_RadiusSession_SessionStore/MatchingSession]

Condition=where DEG_WIFIRUSERNAME = %DEG_WIFIRUSERNAME and DEG_WIFIRORIGIPADDR = %DEG_WIFIRORIGIPADDR and DEG_WIFIRACCTSESSID = %DEG_WIFIRACCTSESSID


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Logging]

ClassName=com.hp.siu.serverutils.SvrLogManager
HandlerNames=LogHandler
Loggers=org.jsmpp,INFO,false
COMPRESS=true
FILECOUNT=50
LOGLINELIMIT=500000

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/Logging/LogHandler]

ClassName=com.hp.siu.serverutils.LogClassLoader
FILECOUNT=-1
FormatterClass=com.hp.siu.utils.LegacyLogFormatter
HandlerClass=com.hp.usage.logging.RollingLogFileHandler
LogFile=${IUM_LOG_DIR}/Alarming_${WIFI_PROCESS_NAME}.log
LogFileRollPolicyClass=TimestampLogFileRollPolicy
LoggerNames=com.hp
LogLevel=WARNING
LOGLINELIMIT=50000
TIMESTAMPSUFFIX='.'yyyyMMddHHmmss

[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/SNMELoader]

ClassName=com.hp.usage.nme.schemaloader.NMESchemaLoader
Schema=SnmeSchemaLink
SchemaPath=datamodel/nme/radius


[/deployment/<%SIU_INSTANCE%>/DEG_WifiAuthInterface_01/SNMELoader/SnmeSchemaLink]

Link=/SNMESchema


