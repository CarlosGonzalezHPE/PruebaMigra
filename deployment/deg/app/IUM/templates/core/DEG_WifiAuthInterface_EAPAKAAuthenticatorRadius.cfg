
[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius]


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors]


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter]

ClassName=com.hp.usage.radius.adapter.RadiusAdapter
Codec=RadiusCodec
IOCoreThreadPoolSize=10
IOMaxThreadPoolSize=${DEVICE_RADIUS_IOMAX_POOL_SIZE}
ProcessorCoreThreadPoolSize=${DEVICE_RADIUS_PROC_CORE_POOL_SIZE}
ProcessorMaxThreadPoolSize=${DEVICE_RADIUS_PROC_MAX_POOL_SIZE}


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/Client]

AuthPool=RadiusServer
ClassName=RadiusClient
AuthenticationMethod=eap


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/HomeServerPools]

ClassName=com.hp.usage.radius.adapter.HomeServerPools
PoolNames=RadiusServer


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/HomeServerPools/RadiusServer]

ClassName=HomeServerPool
LoadBalancerType=FirstAvailable
HomeServers=PrimaryHomeServer
ServerType=Auth


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/HomeServerPools/RadiusServer/PrimaryHomeServer]

ClassName=HomeServer
FailedCount=0
TimeoutCount=0
ZombieTime=600000
LocalPort=${LOCAL_WIFI_RADIUS_CLIENT_PORT}
RemoteHost=${PRIMARY_WIFI_RADIUS_CLIENT_HOST_IP}
RemotePort=${PRIMARY_WIFI_RADIUS_CLIENT_HOST_PORT}
ResponseTimeout=6000
SharedSecret=${PRIMARY_WIFI_RADIUS_CLIENT_SHARED_KEY}


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/RadiusCodec]

[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/RadiusCodec/Decoder]

UseRepository=true
XfdList=radius.AccessRequest
XfdList=radius.AccessReject
XfdList=radius.AccessAccept
XfdList=radius.AccessChallenge
XfdList=radius.AccountingRequest
XfdList=radius.AccountingResponse


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/RadiusCodec/Decoder/radius.AccessAccept]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/RadiusCodec/Decoder/radius.AccessChallenge]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/RadiusCodec/Decoder/radius.AccessReject]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/RadiusCodec/Decoder/radius.AccessRequest]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/RadiusCodec/Decoder/radius.AccountingRequest]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/RadiusCodec/Decoder/radius.AccountingResponse]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/
[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/RadiusCodec/Encoder]

UseRepository=true
XfdList=radius.AccessRequest
XfdList=radius.AccessReject
XfdList=radius.AccessAccept
XfdList=radius.AccessChallenge
XfdList=radius.AccountingRequest
XfdList=radius.AccountingResponse


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/RadiusCodec/Encoder/radius.AccessAccept]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/RadiusCodec/Encoder/radius.AccessChallenge]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/RadiusCodec/Encoder/radius.AccessReject]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/RadiusCodec/Encoder/radius.AccessRequest]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/RadiusCodec/Encoder/radius.AccountingRequest]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/Connectors/200.RadiusClientProtocolAdapter/RadiusCodec/Encoder/radius.AccountingResponse]

NameSpace=http://www.hp.com/usage/datastruct/transform/radius/



[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains]


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA]

ClassName=RuleChain
RuleNames=100.SetRequestParams
RuleNames=110.LogNME
RuleNames=120.QuerySessionState
RuleNames=130.CheckDBError
RuleNames=140.CheckDBAAASessionState


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/100.SetRequestParams]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiRadiusStateString ""
AdornOps=copy DEG_WifiAcctSessionIdString DEG_WIFIRACCTSESSID
AdornOps=str2bin DEG_WifiUserNameIMSIString DEG_WifiUserNameIMSIBinary
AdornOps=setsystime DEG_WifiAAAProcessStartTimeLong
AdornOps=set DEG_WifiAAASessionStateTbString ""
AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 0
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_AuditTimestampLong 0
AdornOps=copy DEG_WifiHostString DEG_WIFIRORIGIPADDR
AdornOps=copy DEG_WifiAcctSessionIdString DEG_WIFIRACCTSESSID
AdornOps=copy DEG_WifiUserNameString DEG_WIFIRUSERNAME


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/110.LogNME]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiUserNameIMSIString
Attributes=DEG_WifiEAPMessageString
Attributes=DEG_WIFIRACCTSESSID
Attributes=DEG_WIFIRORIGIPADDR
Attributes=DEG_WIFIRUSERNAME
LogLevel=INFO
Message=Sending AccessRequest To AAA :
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/120.QuerySessionState]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_WIFIRSTATE,DEG_WIFIRSTATE
MapAttributes=DEG_WIFIAAASTATE,DEG_WIFIAAASTATE
MapAttributes=DEG_WIFIRAAASESSID,DEG_WIFIRAAASESSID
MapAttributes=DEG_WIFIRMDN,DEG_WIFIRMDN
MapAttributes=DEG_WIFIRUPDATETIMESTAMP,DEG_WIFIRUPDATETIMESTAMP
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError]

ClassName=ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,=,0
TrueRuleChain=100.ProcessRadiusSession
FalseRuleChain=200.SetErrorInfo
FalseRuleChain=210.SetErrorLog
FalseRuleChain=220.GenerateAccessRequestSystemErrorEndAuditData


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/200.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.36"
AdornOps=set DEG_WifiReplyMessageString "Unable to access or create entry in DEG_WIFIRADIUSSESSION table"


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/210.SetErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiAcctSessionIdString
Attributes=DEG_WifiUserNameIMSIString
LogLevel=CRITICAL
Message=Database Error: Unable to access or create entry in DEG_WIFIRADIUSSESSION Table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/220.GenerateAccessRequestSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=509.GenerateDiscardedRadiusAccessAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreKeyExistsFlagInteger,=,1
TrueRuleChain=100.CopyTableAttributes
TrueRuleChain=200.CheckRadiusSessionState
FalseRuleChain=300.RecordNotFound


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/300.RecordNotFound]

ClassName=AdornmentRule
AdornOps=set DEG_WIFIRSTATE ""


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/100.CopyTableAttributes]

ClassName=AdornmentRule
AdornOps=copy DEG_WIFIRSTATE DEG_WifiRadiusStateString
AdornOps=copy DEG_WIFIAAASTATE DEG_WifiAAASessionStateTbString
AdornOps=copy DEG_WIFIRUPDATETIMESTAMP DEG_WifiJMSTempReqStartTime
AdornOps=copy DEG_WIFIRAAASESSID DEG_WifiSessionIdString
AdornOps=copy DEG_WIFIRMDN DEG_WifiMDNString

[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/200.CheckRadiusSessionState]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiRadiusStateString,=,"NEW"
TrueRuleChain=100.UpdateStateBeforeSendingToAAA


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/200.CheckRadiusSessionState/100.UpdateStateBeforeSendingToAAA]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRadiusSessionUpdate
RuleNames=200.ExecuteRadiusSessionUpdate
RuleNames=300.CheckRadiusSessionUpdateStatus


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/200.CheckRadiusSessionState/100.UpdateStateBeforeSendingToAAA/100.InitRadiusSessionUpdate]

AdornOps=set DEG_WifiRadiusStateString "WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA"
AdornOps=copy DEG_WifiRadiusStateString DEG_WIFIRSTATE
AdornOps=setsystime DEG_WIFIRUPDATETIMESTAMP
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/200.CheckRadiusSessionState/100.UpdateStateBeforeSendingToAAA/200.ExecuteRadiusSessionUpdate]

ClassName=UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_WIFIRSTATE,DEG_WIFIRSTATE
MapAttributes=DEG_WIFIRUPDATETIMESTAMP,DEG_WIFIRUPDATETIMESTAMP
NativeCondition=MatchingSession
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/200.CheckRadiusSessionState/100.UpdateStateBeforeSendingToAAA/300.CheckRadiusSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,=,1
Conditions=DEG_WifiSessionStoreKeyExistsFlagInteger,=,0
Operations=or
TrueRuleChain=100.GenerateDiscardedRadiusAccessAuditData
TrueRuleChain=200.SetErrorValues
TrueRuleChain=300.LogErrorValues
FalseRuleChain=400.SetSessionStatus


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/200.CheckRadiusSessionState/100.UpdateStateBeforeSendingToAAA/300.CheckRadiusSessionUpdateStatus/100.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/200.CheckRadiusSessionState/100.UpdateStateBeforeSendingToAAA/300.CheckRadiusSessionUpdateStatus/100.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString "WifiAuthInterface"
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3168"
AdornOps=copy DEG_WifiMDNString DEG_AuditMdnString
AdornOps=set DEG_AuditTransactionTypeString "ACCESSDISCARD"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy SrcHost DEG_AuditASPIdString
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/200.CheckRadiusSessionState/100.UpdateStateBeforeSendingToAAA/300.CheckRadiusSessionUpdateStatus/100.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString " DEGWIFI TO WIFIGW -> Discarding RADIUS Access request(error): DEG_WifiReturnCodeString = "
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/200.CheckRadiusSessionState/100.UpdateStateBeforeSendingToAAA/300.CheckRadiusSessionUpdateStatus/100.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiHostString DEG_AuditMessageString
ClassName=AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/200.CheckRadiusSessionState/100.UpdateStateBeforeSendingToAAA/300.CheckRadiusSessionUpdateStatus/100.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

ClassName=AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "DB access error,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_AuditResultCodeString DEG_AuditNRBMessageString


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/200.CheckRadiusSessionState/100.UpdateStateBeforeSendingToAAA/300.CheckRadiusSessionUpdateStatus/100.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/200.CheckRadiusSessionState/100.UpdateStateBeforeSendingToAAA/300.CheckRadiusSessionUpdateStatus/200.SetErrorValues]

ClassName=AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.37"
AdornOps=set DEG_WifiReplyMessageString "DB access error DEG_WIFI_RADIUSSESSION"


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/200.CheckRadiusSessionState/100.UpdateStateBeforeSendingToAAA/300.CheckRadiusSessionUpdateStatus/300.LogErrorValues]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiAcctSessionIdString
Attributes=DEG_WifiRadiusStateString
LogLevel=CRITICAL
Message=Database Error: Unable To update DEG_WIFIRADIUSSESSION Table
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/130.CheckDBError/100.ProcessRadiusSession/200.CheckRadiusSessionState/100.UpdateStateBeforeSendingToAAA/300.CheckRadiusSessionUpdateStatus/400.SetSessionStatus]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WIFIRSTATE "WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiStateString,=,DEG_WifiAAASessionStateTbString
Conditions=DEG_WifiErrorProcessingFlagInteger,=,0
Operation=and
TrueRuleChain=100.SendRadiusRequestToAAA
FalseRuleChain=200.SetErrorValues
FalseRuleChain=210.LogErrorValues
FalseRuleChain=220.GenerateDiscardedRadiusAccessAuditData


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/200.SetErrorValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiOutReturnCodeString "3003"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.38"
AdornOps=set DEG_WifiReplyMessageString "State mismatch"


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/210.LogErrorValues]

Attributes=DEG_WifiStateString
Attributes=DEG_WifiAAASessionStateTbString
Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
ClassName=LogNMERule
LogLevel=INFO
Message=State in the incoming Request does not match state stored in the Table :
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/220.GenerateDiscardedRadiusAccessAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=509.GenerateDiscardedRadiusAccessAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA]

ClassName=RuleChain
RuleNames=100.RadiusNMEConversion
RuleNames=110.GenerateAAACallStartAuditData
RuleNames=200.SendRadiusRequest
RuleNames=300.SetOutReturnCodeIfErrorAttributeSet


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/100.RadiusNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_WifiUserNameString,AAARadiusMessage.request.accessRequest.UserName
NMEToStructuredNMEMap=DEG_WifiCodeInteger,AAARadiusMessage.request.accessRequest.code
NMEToStructuredNMEMap=DEG_WifiEAPMessageBinary,AAARadiusMessage.request.accessRequest.EAPMessage
NMEToStructuredNMEMap=DEG_WifiStateBinary,AAARadiusMessage.request.accessRequest.State
NMEToStructuredNMEMap=DEG_WifiUserNameIMSIBinary,AAARadiusMessage.request.accessRequest.CallingStationId
NMEToStructuredNMEMap=DEG_WifiAuthRequestTypeInteger,AAARadiusMessage.request.accessRequest.ServiceType
NMEToStructuredNMEMap=DEG_WifiSessionIdString,AAARadiusMessage.request.accessRequest.AcctSessionId
NMEToStructuredNMEMap=DEG_WifiRequestTypeInteger,AAARadiusMessage.request.requestType,1
#NMEToStructuredNMEMap=DEG_WifiCalledStationIdBinary,CalledStationId
#NMEToStructuredNMEMap=DEG_WifiHostString,AAARadiusMessage.request.accessRequest.Host
#NMEToStructuredNMEMap=DEG_WifiPortInteger,AAARadiusMessage.request.accessRequest.Port
#NMEToStructuredNMEMap=DEG_WifiSessionIdString,AAARadiusMessage.request.accessRequest.AcctSessionID
#NMEToStructuredNMEMap=DEG_WifiNASIPAddressBinary,AAARadiusMessage.request.accessRequest.NASIPAddress
#NMEToStructuredNMEMap=DEG_WifiNASPortLong,AAARadiusMessage.request.accessRequest.NASPort
#NMEToStructuredNMEMap=DEG_WifiNASPortTypeLong,AAARadiusMessage.request.accessRequest.NASPortType
#NMEToStructuredNMEMap=DEG_WifiNASIdentifierBinary,AAARadiusMessage.request.accessRequest.NASIdentifier
#NMEToStructuredNMEMap=DEG_WifiMessageAuthenticatorBinary,AAARadiusMessage.request.accessRequest.MessageAuthenticator
#NMEToStructuredNMEMap=DEG_WifiAuthenticatorBinary,AAARadiusMessage.request.accessRequest.authenticator
SNMEType=radius:Umbrella


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/110.GenerateAAACallStartAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=501.GenerateAAARadiusCallStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/200.SendRadiusRequest]

ClassName=RadiusClientRule
DecodeAttributes=radius:RadiusMessage,AAARadiusMessage
DecodedAttributeSpecifier=specifier
EncodeAttribute=AAARadiusMessage
RootNMEType=radius:Umbrella
ConnectorName=200.RadiusClientProtocolAdapter
ErrorCodeAttribute=DEG_WifiRadiusErrorString
ErrorPacketAttribute=DEG_WifiErrorPacketBinary
ErrorRuleChain=401.RadiusErrorLog
SynchronousMode=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiRadiusErrorString,!=,""
TrueRuleChain=100.SetErrorParams
FalseRuleChain=200.CheckRadiusRequest
FalseRuleChain=300.ValidateRadiusResponse


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/100.SetErrorParams]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_WifiRadiusErrorString DEG_WifiReplyMessageString
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiOutReturnCodeString "3004"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.39"


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/200.GenerateDiscardedRadiusAccessAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=509.GenerateDiscardedRadiusAccessAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/200.CheckRadiusRequest]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
SNMEType=radius:Umbrella
StructuredNMEToNMEMap=AAARadiusMessage.answer.answerType,DEG_WifiAnswerTypeInteger,0
CreateSNMEIfNeeded=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None
Conditions=DEG_WifiAnswerTypeInteger,=,11
Conditions=DEG_WifiAnswerTypeInteger,=,3
Conditions=DEG_WifiAnswerTypeInteger,=,2
Conditions=DEG_WifiAnswerTypeInteger,=,DEG_WifiAnswerTypeInteger
TrueRuleChain=ProcessAccessChallenge
TrueRuleChain=ProcessAccessReject
TrueRuleChain=ProcessAccessAccept
TrueRuleChain=InvalidAnswerType
ProcessAccessChallenge=801.ProcessAccessChallenge
ProcessAccessReject=802.ProcessAccessReject
ProcessAccessAccept=803.ProcessAccessAccept
InvalidAnswerType=804.InvalidAnswerType


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/804.InvalidAnswerType]

ClassName=RuleChain
RuleNames=100.SetErrorMessage
RuleNames=200.LogErrorMessage
RuleNames=300.GenerateAccessDiscardAuditAndNRBRecord


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/804.InvalidAnswerType/100.SetErrorMessage]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiOutReturnCodeString "3003"
AdornOps=set DEG_WifiProcessingErrorIdString "DEG20.WRI.36"
AdornOps=set DEG_WifiReplyMessageString "Either AAA is not responding or responded with invalid radius code"


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/804.InvalidAnswerType/300.GenerateAccessDiscardAuditAndNRBRecord]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=509.GenerateDiscardedRadiusAccessAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/804.InvalidAnswerType/200.LogErrorMessage]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiProcessingErrorIdString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiAnswerTypeInteger
LogLevel=INFO
Message=AAA is not responding or responded with invalid radius code :
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitParams
RuleNames=110.ExtractChallengeAttbributes
RuleNames=110.SetIfNull
RuleNames=120.ConvertBinToStr
RuleNames=130.LogAccessChallengeReceived
RuleNames=200.ValidateRadiusStateAndEAPPayload


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge/100.InitParams]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiAAASessionStateString ""
AdornOps=set DEG_WifiAAASessionStateBinary 0
AdornOps=set DEG_WifiEAPMessageString ""
AdornOps=set DEG_WifiEAPMessageBinary 0


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge/110.ExtractChallengeAttbributes]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
SNMEType=radius:Umbrella
StructuredNMEToNMEMap=AAARadiusMessage.answer.accessChallenge.State,DEG_WifiAAASessionStateBinary,0
StructuredNMEToNMEMap=AAARadiusMessage.answer.accessChallenge.EAPMessage,DEG_WifiEAPMessageBinary,0
StructuredNMEToNMEMap=AAARadiusMessage.answer.accessChallenge.ReplyMessages[0].value,DEG_WifiReplyMessageString


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge/110.SetIfNull]

AdornOps=setifnull DEG_WifiAAASessionStateBinary 0
AdornOps=setifnull DEG_WifiEAPMessageBinary 0
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge/120.ConvertBinToStr]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=bin2str DEG_WifiAAASessionStateBinary DEG_WifiAAASessionStateString
AdornOps=bin2str DEG_WifiEAPMessageBinary DEG_WifiEAPMessageString


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge/130.LogAccessChallengeReceived]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiAAASessionStateString
Attributes=DEG_WifiRadiusStateString
Attributes=DEG_WifiEAPMessageBinary
Attributes=DEG_WifiAnswerTypeInteger
LogLevel=INFO
Message=AccessChallenge Received From AAA: 
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge/200.ValidateRadiusStateAndEAPPayload]

ClassName=com.hp.usage.script.rules.ExpressionConditionalRule
Expression=(DEG_WifiAAASessionStateBinary != null) && (DEG_WifiEAPMessageBinary != null)
TrueRuleChain=200.UpdateRadiusSessionStore
FalseRuleChain=200.InvalidResponsefromAAA
FalseRuleChain=210.LogInvalidResponsefromAAA


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge/200.ValidateRadiusStateAndEAPPayload/200.UpdateRadiusSessionStore]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRadiusSessionUpdate
RuleNames=200.ExecuteRadiusSessionUpdate
RuleNames=300.CheckRadiusSessionUpdateStatus


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge/200.ValidateRadiusStateAndEAPPayload/200.UpdateRadiusSessionStore/100.InitRadiusSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_WIFI_RADIUSSESSION
AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 0
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_WifiSessionIdString DEG_WIFIRAAASESSID
AdornOps=copy DEG_WifiUserNameString DEG_WIFIRUSERNAME
AdornOps=copy DEG_WifiUserNameIMSIString DEG_WIFIRIMSI
AdornOps=copy DEG_WifiAAASessionStateString DEG_WIFIAAASTATE
AdornOps=set DEG_WifiRadiusStateString "WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
AdornOps=copy DEG_WifiRadiusStateString DEG_WIFIRSTATE


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge/200.ValidateRadiusStateAndEAPPayload/200.UpdateRadiusSessionStore/200.ExecuteRadiusSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_WIFIRAAASESSID,DEG_WIFIRAAASESSID
MapAttributes=DEG_WIFIAAASTATE,DEG_WIFIAAASTATE
MapAttributes=DEG_WIFIRSTATE,DEG_WIFIRSTATE
MapAttributes=DEG_WIFIRUSERNAME,DEG_WIFIRUSERNAME
MapAttributes=DEG_WIFIRIMSI,DEG_WIFIRIMSI
MapAttributes=DEG_WIFIRUPDATETIMESTAMP,DEG_WIFIRUPDATETIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge/200.ValidateRadiusStateAndEAPPayload/200.UpdateRadiusSessionStore/300.CheckRadiusSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,=,1
Conditions=DEG_WifiSessionStoreKeyExistsFlagInteger,=,0
Operations=or
TrueRuleChain=100.LogError
FalseRuleChain=200.SetSessionStatus
FalseRuleChain=300.GenerateAAACallEndOkAuditData


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge/200.ValidateRadiusStateAndEAPPayload/200.UpdateRadiusSessionStore/300.CheckRadiusSessionUpdateStatus/100.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiSessionIdString
Attributes=DEG_WifiMDNString
Attributes=DEG_WIFIRSTATE
Attributes=DEG_WIFIAAASTATE
Attributes=DEG_WIFIRUSERNAME
NullAlso=true
LogLevel=CRITICAL
Message=Database Error: while updating DEG_WIFI_RADIUSSESSION store for State value:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.



[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge/200.ValidateRadiusStateAndEAPPayload/200.UpdateRadiusSessionStore/300.CheckRadiusSessionUpdateStatus/200.SetSessionStatus]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WIFIRSTATE "WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge/200.ValidateRadiusStateAndEAPPayload/200.UpdateRadiusSessionStore/300.CheckRadiusSessionUpdateStatus/300.GenerateAAACallEndOkAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=510.GenerateAAARadiusAkaChallengeEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge/200.ValidateRadiusStateAndEAPPayload/200.InvalidResponsefromAAA]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
AdornOps=set DEG_WifiReplyMessageString "Invalid response from AAA"


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/801.ProcessAccessChallenge/200.ValidateRadiusStateAndEAPPayload/210.LogInvalidResponsefromAAA]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiAAASessionStateBinary
Attributes=DEG_WifiResultCodeInteger
Attributes=DEG_WifiReplyMessageString
LogLevel=ERROR
Message=AAA Invalid Response :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=AAA Response Back with Invalid Code.Contact HP Support.


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/802.ProcessAccessReject]

ClassName=RuleChain
RuleNames=100.ExtractRadiusAccessRejectNMEs
RuleNames=110.ExtractEAPPayload
RuleNames=200.ValidateResponse
RuleNames=300.UpdateRadiusSessionStore
RuleNames=400.LogReject


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/802.ProcessAccessReject/100.ExtractRadiusAccessRejectNMEs]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
#StructuredNMEToNMEMap=AAARadiusMessage.answer.accessReject.EAPMessage,DEG_WifiEAPMessageBinary,0
StructuredNMEToNMEMap=AAARadiusMessage.answer.accessReject.ReplyMessages[0].value,DEG_WifiReplyMessageString,""
SNMEType=radius:Umbrella


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/802.ProcessAccessReject/110.ExtractEAPPayload]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=bin2str DEG_WifiEAPMessageBinary DEG_WifiEAPMessageString
AdornOps=setifnull DEG_WifiReplyMessageString ""


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/802.ProcessAccessReject/200.ValidateResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiRadiusStateString "AKA_CHALLENGE_REJECTED_BY_AAA"


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/802.ProcessAccessReject/300.UpdateRadiusSessionStore]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRadiusSessionUpdate
RuleNames=200.ExecuteRadiusSessionUpdate
RuleNames=300.CheckRadiusSessionUpdateStatus


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/802.ProcessAccessReject/300.UpdateRadiusSessionStore/100.InitRadiusSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_WIFI_RADIUSSESSION
AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 0
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_WifiSessionIdString DEG_WIFIRAAASESSID
AdornOps=copy DEG_WifiRadiusStateString DEG_WIFIRSTATE
AdornOps=setsystime DEG_WIFIRUPDATETIMESTAMP


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/802.ProcessAccessReject/300.UpdateRadiusSessionStore/200.ExecuteRadiusSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_WIFIRSTATE,DEG_WIFIRSTATE
MapAttributes=DEG_WIFIRUPDATETIMESTAMP,DEG_WIFIRUPDATETIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/802.ProcessAccessReject/300.UpdateRadiusSessionStore/300.CheckRadiusSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,=,1
Conditions=DEG_WifiSessionStoreKeyExistsFlagInteger,=,0
Operations=or
TrueRuleChain=100.LogError
FalseRuleChain=200.SetSessionStatus
FalseRuleChain=300.GenerateAAACallEndOkAuditData


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/802.ProcessAccessReject/300.UpdateRadiusSessionStore/300.CheckRadiusSessionUpdateStatus/100.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiSessionIdString
Attributes=DEG_WIFIRSTATE
NullAlso=true
LogLevel=CRITICAL
Message=Database Error: while updating DEG_WIFI_RADIUSSESSION store for State value:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/802.ProcessAccessReject/300.UpdateRadiusSessionStore/300.CheckRadiusSessionUpdateStatus/200.SetSessionStatus]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WIFIRSTATE "AKA_CHALLENGE_REJECTED_BY_AAA"
AdornOps=copy DEG_WifiReplyMessageString DEG_WifiOutReturnCodeString


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/802.ProcessAccessReject/300.UpdateRadiusSessionStore/300.CheckRadiusSessionUpdateStatus/300.GenerateAAACallEndOkAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=511.GenerateAAARadiusAkaRejectEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/802.ProcessAccessReject/400.LogReject]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiRadiusStateString
Attributes=DEG_WifiReplyMessageString
Attributes=DEG_WifiAnswerTypeInteger
NullAlso=true
LogLevel=INFO
Message= AccessReject received From AAA :
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept]

ClassName=RuleChain
RuleNames=001.Initialise
RuleNames=100.RadiusAcceptSNMEConversion
RuleNames=100.SetIfNull
RuleNames=110.ExtractResponseAttributes
RuleNames=300.ValidateResponse


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/001.Initialise]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiUserNameString ""
#AdornOps=set DEG_OEMDevAuthRequestTypeInteger 0
AdornOps=set DEG_WifiAAASessionStateString ""
AdornOps=set DEG_WifiAAASessionStateBinary 0
AdornOps=set DEG_WifiEAPMessageString ""
AdornOps=set DEG_WifiEAPMessageBinary 0


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/100.RadiusAcceptSNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
StructuredNMEToNMEMap=AAARadiusMessage.answer.accessAccept.UserName,DEG_WifiUserNameString
StructuredNMEToNMEMap=AAARadiusMessage.answer.accessAccept.EAPMessage,DEG_WifiEAPMessageBinary,0
StructuredNMEToNMEMap=AAARadiusMessage.answer.accessAccept.State,DEG_WifiAAASessionStateBinary,0
StructuredNMEToNMEMap=AAARadiusMessage.answer.accessAccept.ReplyMessages[0].value,DEG_WifiReplyMessageString
SNMEType=radius:Umbrella


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/100.SetIfNull]

AdornOps=setifnull DEG_WifiUserNameString ""
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/110.ExtractResponseAttributes]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ValidateRadiusState


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/110.ExtractResponseAttributes/100.ValidateRadiusState]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiAAASessionStateBinary,!=,0
Conditions=DEG_WifiEAPMessageBinary,!=,0
Operation=and
TrueRuleChain=100.ConvertResponseAttributes
TrueRuleChain=110.LogResponseAttributes


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/110.ExtractResponseAttributes/100.ValidateRadiusState/100.ConvertResponseAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=bin2str DEG_WifiEAPMessageBinary DEG_WifiEAPMessageString
AdornOps=bin2str DEG_WifiAAASessionStateBinary DEG_WifiAAASessionStateString


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/110.ExtractResponseAttributes/100.ValidateRadiusState/110.LogResponseAttributes]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiSessionIdString
Attributes=DEG_WifiAAASessionStateBinary
LogLevel=INFO
Message=AccessAccept Parameters validated successfully :
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/300.ValidateResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiAAASessionStateTbString,=,DEG_WifiAAASessionStateString
TrueRuleChain=100.SetSessionStatus
TrueRuleChain=200.UpdateRadiusSessionStore



#[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/400.Valid#ateRadiusResponse/803.ProcessAccessAccept/300.ValidateResponse/100.SetErrorStatus]

#AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
#AdornOps=set DEG_WifiReplyMessageString "Invalid State from AAA"
#AdornOps=set DEG_WifiOutReturnCodeString 3001


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/300.ValidateResponse/100.SetSessionStatus]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WifiRadiusStateString "AUTHENTICATED_BY_AAA"
AdornOps=setsystime DEG_FULLAUTHTIMESTAMP


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/300.ValidateResponse/200.UpdateRadiusSessionStore]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRadiusSessionUpdate
RuleNames=200.ExecuteRadiusSessionUpdate
RuleNames=300.CheckRadiusSessionUpdateStatus


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/300.ValidateResponse/200.UpdateRadiusSessionStore/100.InitRadiusSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_WIFI_RADIUSSESSION
AdornOps=set DEG_WifiSessionStoreErrorFlagInteger 0
AdornOps=set DEG_WifiSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_WifiSessionIdString DEG_WIFIRAAASESSID
AdornOps=copy DEG_WifiRadiusStateString DEG_WIFIRSTATE
AdornOps=copy DEG_WifiAAASessionStateString DEG_WIFIAAASTATE
AdornOps=setsystime DEG_WIFIRUPDATETIMESTAMP



[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/300.ValidateResponse/200.UpdateRadiusSessionStore/200.ExecuteRadiusSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_WIFIRSTATE,DEG_WIFIRSTATE
MapAttributes=DEG_WIFIAAASTATE,DEG_WIFIAAASTATE
MapAttributes=DEG_WIFIRUPDATETIMESTAMP,DEG_WIFIRUPDATETIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_Wifi_RadiusSession_SessionStore


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/300.ValidateResponse/200.UpdateRadiusSessionStore/300.CheckRadiusSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_WifiSessionStoreErrorFlagInteger,=,1
Conditions=DEG_WifiSessionStoreKeyExistsFlagInteger,=,0
Operations=or
TrueRuleChain=100.LogError
FalseRuleChain=200.SetSessionStatus
FalseRuleChain=300.GenerateAAACallEndOkAuditData


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/300.ValidateResponse/200.UpdateRadiusSessionStore/300.CheckRadiusSessionUpdateStatus/100.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_WifiSessionIdString
Attributes=DEG_WifiUserNameString
NullAlso=true
LogLevel=CRITICAL
Message=Database Error: while updating DEG_WIFI_RADIUSSESSION store for State value:
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/300.ValidateResponse/200.UpdateRadiusSessionStore/300.CheckRadiusSessionUpdateStatus/200.SetSessionStatus]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_WIFIRSTATE "AUTHENTICATED_BY_AAA"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/400.SendRadiusEAPPayloadToAAA/140.CheckDBAAASessionState/100.SendRadiusRequestToAAA/300.SetOutReturnCodeIfErrorAttributeSet/300.ValidateRadiusResponse/803.ProcessAccessAccept/300.ValidateResponse/200.UpdateRadiusSessionStore/300.CheckRadiusSessionUpdateStatus/300.GenerateAAACallEndOkAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=512.GenerateAAARadiusAkaAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/501.GenerateAAARadiusCallStartAuditDataRuleChain]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/501.GenerateAAARadiusCallStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=copy DEG_WifiAAAProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_WifiAcctSessionIdString DEG_AuditSessionIdString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditDurationLong 0
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3003"
AdornOps=copy DEG_WIFIRMDN DEG_AuditMdnString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "WifiAAAAccessRequest"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/501.GenerateAAARadiusCallStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO DEGAUTH -> Sending Access Request to AAA:"
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/501.GenerateAAARadiusCallStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_WifiTmp1String "DEG_WifiMDNString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WIFIRMDN DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameIMSIString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiUserNameIMSIString DEG_AuditMessageString
ClassName=AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/501.GenerateAAARadiusCallStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sending Access Request to AAA,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_AuditResultCodeString DEG_AuditNRBMessageString
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/501.GenerateAAARadiusCallStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetRequestStartTime
RuleNames=200.CheckErrorCode


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/100.SetRequestStartTime]

AdornOps=setsystime DEG_WifiJMSTempReqStartTime
AdornOps=- DEG_WifiJMSTempReqStartTime 1 DEG_WifiJMSTempReqStartTime
AdornOps=set DEG_WifiNrbMonitoringSessionIdList null
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode]


ClassName=SwitchConditionRule
Conditions=DEG_WifiRadiusErrorString,=,"DECODE_ERROR"
Conditions=DEG_WifiRadiusErrorString,=,"ENCODE_ERROR"
Conditions=DEG_WifiRadiusErrorString,=,"REQUEST_TIMEOUT"
Conditions=DEG_WifiRadiusErrorString,=,"RESPONSE_SEND_FAILED"
Conditions=DEG_WifiRadiusErrorString,=,"UNKNOWN"


DECODE_ERROR=110.InvokeDECODE_ERROR
ENCODE_ERROR=130.InvokeENCODE_ERROR
REQUEST_TIMEOUT=170.InvokeREQUEST_TIMEOUT
RESPONSE_SEND_FAILED=180.InvokeRESPONSE_SEND_FAILED
UNKNOWN=190.InvokeUNKNOWN


TrueRuleChain=DECODE_ERROR
TrueRuleChain=ENCODE_ERROR
TrueRuleChain=REQUEST_TIMEOUT
TrueRuleChain=RESPONSE_SEND_FAILED
TrueRuleChain=UNKNOWN

[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR]

ClassName=RuleChain
RuleNames=000.SetParams
RuleNames=100.LogNME
#RuleNames=300.GenerateDiscardedRadiusAccessAuditData


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/000.SetParams]

ClassName=AdornmentRule
AdornOps=set DEG_WifiReplyMessageString "Codec failed to decode."
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=DECODE_ERROR :


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/300.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/300.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=set DEG_AuditMdnString ""
AdornOps=set DEG_AuditIMSIString ""
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=set DEG_AuditChannelNameString ""
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiErrorHostString DEG_AuditASPIdString
AdornOps=set DEG_AuditASPNameString ""

ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/300.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO DEGAUTH -> Discarding RADIUS Access request(error): DEG_WifiOutReturnCodeString = "
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/300.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiErrorHostString DEG_AuditMessageString
ClassName=AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/300.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "RADIUS Access expected,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_AuditResultCodeString DEG_AuditNRBMessageString
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/110.InvokeDECODE_ERROR/300.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/130.InvokeENCODE_ERROR]

ClassName=RuleChain
RuleNames=000.SetParams
RuleNames=100.LogNME
#RuleNames=300.GenerateDiscardedRadiusAccessAuditData


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/130.InvokeENCODE_ERROR/000.SetParams]

ClassName=AdornmentRule
AdornOps=set DEG_WifiReplyMessageString "Codec failed to encode"
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/130.InvokeENCODE_ERROR/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=Error while Encoding the request

[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/130.InvokeENCODE_ERROR/300.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/130.InvokeENCODE_ERROR/300.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=set DEG_AuditMdnString ""
AdornOps=set DEG_AuditIMSIString ""
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=set DEG_AuditChannelNameString ""
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiErrorHostString DEG_AuditASPIdString
AdornOps=set DEG_AuditASPNameString ""

ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/130.InvokeENCODE_ERROR/300.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO DEGAUTH -> Discarding RADIUS Access request(error): DEG_WifiOutReturnCodeString = "
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/130.InvokeENCODE_ERROR/300.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiErrorHostString DEG_AuditMessageString
ClassName=AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/130.InvokeENCODE_ERROR/300.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "RADIUS Access expected,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_AuditResultCodeString DEG_AuditNRBMessageString
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/130.InvokeENCODE_ERROR/300.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/170.InvokeREQUEST_TIMEOUT]

ClassName=RuleChain
RuleNames=000.SetParams
RuleNames=100.LogNME
#_RuleNames=300.GenerateDiscardedRadiusAccessAuditData


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/170.InvokeREQUEST_TIMEOUT/000.SetParams]

ClassName=AdornmentRule
AdornOps=set DEG_WifiReplyMessageString "Did not receive a response within response timeout or Could not contact server"


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/170.InvokeREQUEST_TIMEOUT/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=REQUEST TIMEOUT :


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/170.InvokeREQUEST_TIMEOUT/300.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/170.InvokeREQUEST_TIMEOUT/300.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=set DEG_AuditMdnString ""
AdornOps=set DEG_AuditIMSIString ""
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=set DEG_AuditChannelNameString ""
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiErrorHostString DEG_AuditASPIdString
AdornOps=set DEG_AuditASPNameString ""

ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/170.InvokeREQUEST_TIMEOUT/300.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO DEGAUTH -> Discarding RADIUS Access request(error): DEG_WifiOutReturnCodeString = "
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/170.InvokeREQUEST_TIMEOUT/300.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiErrorHostString DEG_AuditMessageString
ClassName=AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/170.InvokeREQUEST_TIMEOUT/300.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "RADIUS Access expected,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_AuditResultCodeString DEG_AuditNRBMessageString
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/170.InvokeREQUEST_TIMEOUT/300.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED]

ClassName=RuleChain
RuleNames=000.SetParams
RuleNames=100.LogNME
#_RuleNames=300.GenerateDiscardedRadiusAccessAuditData


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED/000.SetParams]

ClassName=AdornmentRule
AdornOps=set DEG_WifiReplyMessageString "Request send failed to server"
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED/300.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED/300.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=set DEG_AuditFormatIdString "V02"
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=set DEG_AuditMdnString ""
AdornOps=set DEG_AuditIMSIString ""
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=set DEG_AuditChannelNameString ""
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiErrorHostString DEG_AuditASPIdString
AdornOps=set DEG_AuditASPNameString ""
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED/300.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO DEGAUTH -> Discarding RADIUS Access request(error): DEG_WifiOutReturnCodeString = "
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED/300.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiErrorHostString DEG_AuditMessageString
ClassName=AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED/300.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Request send failed to server,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_AuditResultCodeString DEG_AuditNRBMessageString
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED/300.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/180.InvokeRESPONSE_SEND_FAILED/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=RESPONSE_SEND_FAILED :


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/190.InvokeUNKNOWN]

ClassName=RuleChain
RuleNames=000.SetParams
RuleNames=100.LogNME
#_RuleNames=300.GenerateDiscardedRadiusAccessAuditData


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/190.InvokeUNKNOWN/000.SetParams]

ClassName=AdornmentRule
AdornOps=set DEG_WifiReplyMessageString "Any unknown error occured"
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/190.InvokeUNKNOWN/100.LogNME]

ClassName=LogNMERule
Attributes=DEG_WifiRadiusErrorString
Attributes=DEG_WifiReplyMessageString
LogLevel=INFO
Message=Unknown Error :


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/190.InvokeUNKNOWN/300.GenerateDiscardedRadiusAccessAuditData]

ClassName=RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/190.InvokeUNKNOWN/300.GenerateDiscardedRadiusAccessAuditData/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "3004"
AdornOps=set DEG_AuditMdnString ""
AdornOps=set DEG_AuditIMSIString ""
AdornOps=set DEG_AuditTransactionTypeString "WifiEAPDiscard"
AdornOps=set DEG_AuditSourceDestinationString "WIFIGW"
AdornOps=- DEG_AuditTimestampLong DEG_WifiJMSTempReqStartTime DEG_AuditDurationLong
AdornOps=set DEG_AuditChannelIdString ""
AdornOps=set DEG_AuditChannelNameString ""
AdornOps=set DEG_AuditASPServiceIdString ""
AdornOps=set DEG_AuditASPServiceNameString ""
AdornOps=copy DEG_WifiErrorHostString DEG_AuditASPIdString
AdornOps=set DEG_AuditASPNameString ""

ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/190.InvokeUNKNOWN/300.GenerateDiscardedRadiusAccessAuditData/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGWIFI TO DEGAUTH -> Discarding RADIUS Access request(error): DEG_WifiOutReturnCodeString = "
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/190.InvokeUNKNOWN/300.GenerateDiscardedRadiusAccessAuditData/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=+ DEG_AuditMessageString DEG_AuditResultCodeString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String "DEG_WifiDeviceIpAddressString = "
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiErrorHostString DEG_AuditMessageString
ClassName=AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/190.InvokeUNKNOWN/300.GenerateDiscardedRadiusAccessAuditData/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "RADIUS Access expected,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_AuditResultCodeString DEG_AuditNRBMessageString
AdornOps=set DEG_WifiErrorProcessingFlagInteger 1
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/401.RadiusErrorLog/200.CheckErrorCode/190.InvokeUNKNOWN/300.GenerateDiscardedRadiusAccessAuditData/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/510.GenerateAAARadiusAkaChallengeEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/510.GenerateAAARadiusAkaChallengeEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_WifiAcctSessionIdString DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_WifiAAAProcessStartTimeLong DEG_AuditDurationLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_WifiOutReturnCodeString "0"
AdornOps=copy DEG_WifiOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_WIFIRMDN DEG_AuditMdnString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "WifiAAAAccessChallenge"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/510.GenerateAAARadiusAkaChallengeEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGAUTH TO DEGWIFI -> Access Challenge received from AAA:"
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/510.GenerateAAARadiusAkaChallengeEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_WifiTmp1String "DEG_WifiMDNString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WIFIRMDN DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameIMSIString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiOEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiOutReturnCodeString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/510.GenerateAAARadiusAkaChallengeEndAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Access Challenge received from AAA"


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/510.GenerateAAARadiusAkaChallengeEndAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/511.GenerateAAARadiusAkaRejectEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/511.GenerateAAARadiusAkaRejectEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_WifiAcctSessionIdString DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_WifiAAAProcessStartTimeLong DEG_AuditDurationLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=copy DEG_WifiOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_WIFIRMDN DEG_AuditMdnString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "WifiAAAAccessReject"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/511.GenerateAAARadiusAkaRejectEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGAUTH TO DEGWIFI -> Authentication attempt rejected by AAA:"
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/511.GenerateAAARadiusAkaRejectEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_WifiTmp1String "DEG_WifiMDNString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WIFIRMDN DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameIMSIString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiOEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiOutReturnCodeString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/511.GenerateAAARadiusAkaRejectEndAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Authentication attempt rejected by AAA"


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/511.GenerateAAARadiusAkaRejectEndAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/512.GenerateAAARadiusAkaAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/512.GenerateAAARadiusAkaAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_WifiAcctSessionIdString DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_WifiAAAProcessStartTimeLong DEG_AuditDurationLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "RADIUS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_WifiOutReturnCodeString "0"
AdornOps=copy DEG_WifiOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_WIFIRMDN DEG_AuditMdnString
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "WifiAAAAccessAccept"
AdornOps=set DEG_AuditSourceDestinationString "AAA"
AdornOps=copy DEG_WifiUserNameIMSIString DEG_AuditChannelNameString
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/512.GenerateAAARadiusAkaAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEGAUTH TO DEGWIFI -> Successful authentication by AAA :"
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/512.GenerateAAARadiusAkaAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_WifiTmp1String "DEG_WifiMDNString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WIFIRMDN DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiUserNameIMSIString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiOEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_WifiTmp1String ", DEG_WifiOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_WifiTmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_WifiOutReturnCodeString DEG_AuditMessageString
ClassName=AdornmentRule


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/512.GenerateAAARadiusAkaAuthenticatedEndAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Successful authentication by AAA"


[/templates/DEG/WifiAuthInterface/WifiEAPAKAAuthenticatorRadius/RuleChains/512.GenerateAAARadiusAkaAuthenticatedEndAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true