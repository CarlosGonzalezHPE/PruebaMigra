
[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core]


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains]

RuleChainNames=213.DEG20ProcessOEMGetPhoneNumberRuleChain
RuleChainNames=711.DEG20GenerateGetPhoneNumberStartAuditDataRuleChain
RuleChainNames=712.DEG20GenerateGetPhoneNumberEndErrorAuditDataRuleChain
RuleChainNames=713.DEG20GenerateGetPhoneNumberEndOKAuditDataRuleChain
RuleChainNames=714.DEG20GenerateGetPhoneNumberDisabledAuditDataRuleChain


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequest
RuleNames=110.ReadSysValue


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/100.InitRequest]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSysParameter "getPhoneNumber"
AdornOps=set DEG_CDevSysValueString ${DEVICE_GETPHONENUMBER_STATUS}
AdornOps=lower DEG_CDevSysValueString DEG_CDevSysValueString


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSysValueString,=,enabled
TrueRuleChain=100.GenerateGetPhoneNumberStartAuditData
TrueRuleChain=110.ExtractGetPhoneNumberAttributes
TrueRuleChain=120.GenerateResponseEntry
FalseRuleChain=200.GeneratePhoneDisabledResponse


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/100.GenerateGetPhoneNumberStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=711.DEG20GenerateGetPhoneNumberStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/110.ExtractGetPhoneNumberAttributes]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
StructuredNMEToNMEMap=client_nonce.CData,DEG_OEMDevClientNonceString,""


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/120.GenerateResponseEntry]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevClientNonceString,=,""
TrueRuleChain=100.InitErrorResponse400C
TrueRuleChain=110.GenerateGetPhoneNumberEndErrorAuditData
FalseRuleChain=200.DecodeClientNonce
FalseRuleChain=210.CheckClientNonceIfBase64


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/120.GenerateResponseEntry/100.InitErrorResponse400C]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_OEMDevErrorMessageString "ClientNonce not present in request"


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/120.GenerateResponseEntry/110.GenerateGetPhoneNumberEndErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=712.DEG20GenerateGetPhoneNumberEndErrorAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/120.GenerateResponseEntry/200.DecodeClientNonce]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=decBase64 DEG_OEMDevClientNonceString DEG_OEMDevClientNonceBin


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/120.GenerateResponseEntry/210.CheckClientNonceIfBase64]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=100.GeneratePhoneEnabledResponse


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/120.GenerateResponseEntry/210.CheckClientNonceIfBase64/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevClientNonceBin == null


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/120.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitOkResponse
RuleNames=200.GenerateSign
RuleNames=210.ConvertSignData
RuleNames=300.GenerateOkResponseEntry
RuleNames=350.PopulateAuditNRBMessageAttribute
RuleNames=400.GenerateGetPhoneNumberEndOKAuditData


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/120.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse/100.InitOkResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6000
AdornOps=set DEG_OEMDevRespPhoneNumberString ${DEVICE_COUNTRYISD_CODE}
AdornOps=+ DEG_OEMDevRespPhoneNumberString DEG_SSL_MDN DEG_OEMDevRespPhoneNumberString
AdornOps=bin2str DEG_OEMDevClientNonceBin DEG_OEMDevClientNonceString
AdornOps=str2bin DEG_OEMDevRespPhoneNumberString DEG_OEMDevRespPhoneNumberBin
AdornOps=+ DEG_OEMDevClientNonceBin DEG_OEMDevRespPhoneNumberBin DEG_OEMDevSignDataSrcBytes


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/120.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse/200.GenerateSign]

ClassName=CreateSignedDataRule
DestinationAttribute=DEG_OEMDevSignDataDstBytes
Signers=Signer1
SourceAttribute=DEG_OEMDevSignDataSrcBytes

#RFE79 Allow GetPhoneNumber Signature certificate to be different from DEG Server certificate.
[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/120.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse/200.GenerateSign/Signer1]

Alias=${PHONENUM_CERT_SIGNATURE_ALIAS}
ClassName=KeyStoreBasedSigner
KeyStoreFormat=JKS
KeyStoreLocation=${PHONENUM_CERT_KEYSTORE_FILE}
KeyStorePassword=${PHONENUM_CERT_SIGNATURE_PASSWORD}


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/120.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse/210.ConvertSignData]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=encBase64 DEG_OEMDevSignDataDstBytes DEG_OEMDevRespSignatureString

##DEG part Comment begins#
#AdornOps=set DEG_OEMDevRespSignatureString FAKEcertificate
##DEG part Comment ends#


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/120.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse/300.GenerateOkResponseEntry]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
NMEToStructuredNMEMap=DEG_OEMDevRespPhoneNumberString,jsonResponse.phone_number.CData
NMEToStructuredNMEMap=DEG_OEMDevRespSignatureString,jsonResponse.signature.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/120.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse/350.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getPhoneNumber Success response: "
AdornOps=set DEG_AuditNRBMessageString "getPhoneNumber success response ,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString

[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/120.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse/400.GenerateGetPhoneNumberEndOKAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=713.DEG20GenerateGetPhoneNumberEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/200.GeneratePhoneDisabledResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=50.DEG20GenerateGetPhoneNumberStartAudit
RuleNames=100.InitResponse
RuleNames=125.PopulateAuditNRBMessageAttribute
RuleNames=150.DEG20GenerateGetPhoneNumberEndAudit
RuleNames=200.GenerateResponseEntry
RuleNames=201.SetErrorInfo
RuleNames=300.Log

[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/200.GeneratePhoneDisabledResponse/50.DEG20GenerateGetPhoneNumberStartAudit]


ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=711.DEG20GenerateGetPhoneNumberStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/200.GeneratePhoneDisabledResponse/100.InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002

[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/200.GeneratePhoneDisabledResponse/125.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getPhoneNumber disable response: "
AdornOps=set DEG_AuditNRBMessageString "getPhoneNumber Disable response ,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString

[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/200.GeneratePhoneDisabledResponse/150.DEG20GenerateGetPhoneNumberEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=713.DEG20GenerateGetPhoneNumberEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/200.GeneratePhoneDisabledResponse/200.GenerateResponseEntry]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/200.GeneratePhoneDisabledResponse/201.SetErrorInfo]
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GPN.0201"
AdornOps=set DEG_OEMDevErrorMessageString "getPhoneNumber is Disabled"


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/213.DEG20ProcessOEMGetPhoneNumberRuleChain/110.ReadSysValue/200.GeneratePhoneDisabledResponse/300.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_MDN
Attributes=DEG_CDevSysParameter
Attributes=DEG_CDevGetPhoneNumberSysValueString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=INFO
Message=Action getPhoneNumber Disabled: 
NullAlso=true
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/711.DEG20GenerateGetPhoneNumberStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/711.DEG20GenerateGetPhoneNumberStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditTransactionTypeString "getPhoneNumber"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString

[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/711.DEG20GenerateGetPhoneNumberStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEVICE TO DEG -> Received getPhoneNumber request: "


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/711.DEG20GenerateGetPhoneNumberStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevUniqueIDString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevUniqueIDString DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/711.DEG20GenerateGetPhoneNumberStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Received getPhoneNumber request"


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/711.DEG20GenerateGetPhoneNumberStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/712.DEG20GenerateGetPhoneNumberEndErrorAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/712.DEG20GenerateGetPhoneNumberEndErrorAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "400"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=set DEG_AuditTransactionTypeString "getPhoneNumber"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/712.DEG20GenerateGetPhoneNumberEndErrorAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getPhoneNumber Error response: "


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/712.DEG20GenerateGetPhoneNumberEndErrorAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevUniqueIDString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevUniqueIDString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString

[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/712.DEG20GenerateGetPhoneNumberEndErrorAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "getPhoneNumber Error response"

[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/712.DEG20GenerateGetPhoneNumberEndErrorAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/713.DEG20GenerateGetPhoneNumberEndOKAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
#RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
#RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/713.DEG20GenerateGetPhoneNumberEndOKAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_AuditResultCodeString "1"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditTransactionTypeString "getPhoneNumber"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/713.DEG20GenerateGetPhoneNumberEndOKAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getPhoneNumber response: "


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/713.DEG20GenerateGetPhoneNumberEndOKAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevUniqueIDString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevUniqueIDString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/713.DEG20GenerateGetPhoneNumberEndOKAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "getPhoneNumber success response,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/713.DEG20GenerateGetPhoneNumberEndOKAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/714.DEG20GenerateGetPhoneNumberDisabledAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/714.DEG20GenerateGetPhoneNumberDisabledAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=copy DEG_OEMDevUniqueIDString DEG_AuditUniqueIDString
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditTransactionTypeString "getPhoneNumber"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/714.DEG20GenerateGetPhoneNumberDisabledAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getPhoneNumber response: "


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/714.DEG20GenerateGetPhoneNumberDisabledAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevUniqueIDString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevUniqueIDString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/714.DEG20GenerateGetPhoneNumberDisabledAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Request denied by policy,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString


[/templates/DEG/DeviceInterface/GetPhoneNumber_V2Core/RuleChains/714.DEG20GenerateGetPhoneNumberDisabledAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true