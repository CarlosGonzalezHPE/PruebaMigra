[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize]


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/Connectors]

##RFE26-Customization interface for EAPAKAAuthenticatorDiamete template / AAA inteface templatization
###can change the value of atrribute ApplicationId/AuthApplicationIds;  SupportedVendorIds/ VendorId/ VendorSpecificAppIds could be added/changed.
[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/Connectors/300.DiameterAdapter]

ClassName=com.hp.usage.diameter.DiameterAdapter
#QXCM1001544811:3.2.4 China Unicom issues,issue 8:2017041008
ApplicationId=${DEG_DAIMETER_APLLICATION_ID}
ApplicationIdAttribute=DEG_OEMDevAppIdLong
#QXCM1001544811:3.2.4 China Unicom issues,issue 8:2017041008
AuthApplicationIds=${DEG_DAIMETER_APLLICATION_ID}
CommandCodeAttribute=DEG_OEMDevCommandcodeInteger
E2EAttribute=DEG_OEMDevE2ELong
ErrorFlagAttribute=DEG_OEMDevErrorFlagInteger
HbHAttribute=DEG_OEMDevHbHLong
JNDIName=Device
Managed=${MANAGED_SETUP}
NeedResponseAttribute=DEG_OEMDevNeedResponseInteger
ProductName=Diameter HSS Client
ProxiableFlagAttribute=DEG_OEMDevProxiableFlagInteger
RemoteHostAttribute=DEG_OEMDevDesthostString
RemoteRealmAttribute=DEG_OEMDevDestRealmString
RequestFlagAttribute=DEG_OEMDevRequestFlagInteger
RetransmitFlagAttribute=DEG_OEMDevRetransmitFlagInteger
RetryTimeouts=3,20
MaxMessageSize=8192
ServerIP=${DEVICE_DIAMETER_SERVER_HOST_IP}
ServerHost=${DEVICE_DIAMETER_SERVER_HOST_NAME}
ServerRealm=${DEVICE_SERVER_REALM}
StopAttribute=DEG_OEMDevStopInteger
PersistentConnectionAddress=${PRIMARY_AAA_HOST_NAME},${AAA_SERVER_REALM}
PersistentConnectionAddress=${SECONDARY_AAA_HOST_NAME},${AAA_SERVER_REALM}

##RFE82:Issue1:Moved Transport part from the core to custom so that delivery team can change to DiameterSCTPTransport
[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/Connectors/300.DiameterAdapter/Transport]

ClassName=com.hp.usage.diameter.DiameterTCPTransport
HostName=${DEVICE_DIAMETER_SERVER_HOST_IP}
HostsMap=${PRIMARY_AAA_HOST_NAME},${AAA_SERVER_REALM},${PRIMARY_AAA_HOST_IP},${PRIMARY_AAA_HOST_PORT}
HostsMap=${SECONDARY_AAA_HOST_NAME},${AAA_SERVER_REALM},${SECONDARY_AAA_HOST_IP},${SECONDARY_AAA_HOST_PORT}
PortNumber=${DEVICE_DIAMETER_SERVER_PORT}

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301.AAAProcessingRuleChain]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301.AAAProcessingRuleChain/111.SetRequestParams]

##Delivery team can set their own attributes here; can set ApplicationId if it is changed in DiameterAdapter##
ClassName=com.hp.siu.collector.rules.AdornmentRule
#QXCM1001544811:3.2.4 China Unicom issues,issue 8:2017041008
AdornOps=set DEG_OEMDevAuthApplicationIdInteger ${DEG_DAIMETER_APLLICATION_ID}
#AdornOps=set DEG_OEMDevAuthApplicationIdInteger 11111


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301B.SendDERToAAARuleChain]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301B.SendDERToAAARuleChain/100.DERNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_SSL_AAA_SESSIONID,session_id
NMEToStructuredNMEMap=DEG_OEMDevAuthApplicationIdInteger,auth_application_id
NMEToStructuredNMEMap=DEG_OEMDevOriginHostString,origin_Host
NMEToStructuredNMEMap=DEG_OEMDevOriginRealmString,origin_Realm
NMEToStructuredNMEMap=DEG_OEMDevPrimaryDestRealmString,destination_Realm
NMEToStructuredNMEMap=DEG_OEMDevAuthRequestTypeInteger,auth_request_type
NMEToStructuredNMEMap=DEG_OEMDevEAPPayloadBinary,eap_payload
NMEToStructuredNMEMap=DEG_OEMDevSubscriberIdString,user_Name
NMEToStructuredNMEMap=DEG_OEMDevImsiString,calling_station_id
NMEToStructuredNMEMap=DEG_OEMDevRATTypeInteger,RAT_type
NMEToStructuredNMEMap=DEG_OEMDevVisitedNetworkIdBinary,visited_network_identifier
NMEToStructuredNMEMap=DEG_OEMDevAuthLifeTime,authorization_lifeTime
NMEToStructuredNMEMap=DEG_OEMDevAuthGracePeriod,auth_grace_period
NMEToStructuredNMEMap=DEG_OEMDevAuthSessionState,auth_session_state
#NMEToStructuredNMEMap=DEG_OEMDevPrimaryDesthostString,destination_host
NMEToStructuredNMEMap=DEG_OEMDevANIDString,ANID
NMEToStructuredNMEMap=DEG_OEMDevDiameterStateBinary,state
SNMEType=diameterSWa:DiameterEAPRequestSWa


###can change the value of atrribute ApplicationId etc.
[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301B.SendDERToAAARuleChain/120.SendDERRequest]

ClassName=com.hp.usage.diameter.DiameterClientRule
#QXCM1001544811:3.2.4 China Unicom issues,issue 8:2017041008
ApplicationId=${DEG_DAIMETER_APLLICATION_ID}
CommandCode=268
DCJNDIName=Device
DestinationHostAttribute=DEG_OEMDevPrimaryDesthostString
DestinationRealmAttribute=DEG_OEMDevPrimaryDestRealmString
DestinationHostAttribute=DEG_OEMDevSecondaryDesthostString
DestinationRealmAttribute=DEG_OEMDevSecondaryDestRealmString
DisconnectAttribute=disc
E2EAttribute=DEG_OEMDevE2ELong
ErrorResultFlagAttribute=errFlag
HbHAttribute=DEG_OEMDevHbHLong
ProxiableFlagAttribute=DEG_OEMDevProxiableFlagInteger
RequestFlagAttribute=DEG_OEMDevRequestFlagInteger
Retries=0
#SecondaryDestinationHostAttribute=DEG_OEMDevSecondaryDesthostString
#SecondaryDestinationRealmAttribute=DEG_OEMDevSecondaryDestRealmString
TimeOut=5000
TimeOutFlagAttribute=toFlag
WaitForConnection=false


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.ReceiveDEAFromAAARuleChain]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.ReceiveDEAFromAAARuleChain/100.DEASNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
SNMEType=diameterSWa:DiameterEAPAnswerSWa
StructuredNMEToNMEMap=session_id,DEG_SSL_AAA_SESSIONID
StructuredNMEToNMEMap=auth_application_id,DEG_OEMDevAuthApplicationIdInteger
StructuredNMEToNMEMap=result_Code,DEG_OEMDevResultCodeInteger,0
StructuredNMEToNMEMap=experimental_result[0].vendor_id,DEG_OEMDevVendorIdInteger
StructuredNMEToNMEMap=experimental_result[0].experimental_result_code,DEG_OEMDevExperimentalResultCodeInteger
StructuredNMEToNMEMap=origin_Host,DEG_OEMDevOriginHostString
StructuredNMEToNMEMap=origin_Realm,DEG_OEMDevOriginRealmString
StructuredNMEToNMEMap=auth_request_type,DEG_OEMDevAuthRequestTypeInteger
StructuredNMEToNMEMap=eap_payload,DEG_OEMDevEAPPayloadBinary
StructuredNMEToNMEMap=user_Name,DEG_SSL_NAI
StructuredNMEToNMEMap=error_message,DEG_OEMDevErrorMessageString
StructuredNMEToNMEMap=state,DEG_OEMDevDiameterStateBinary
StructuredNMEToNMEMap=redirect_host,DEG_OEMDevRedirectedHostString
StructuredNMEToNMEMap=visited_network_identifier,DEG_OEMDevVisitedNetworkIdBinary

#QXCM1001557688: Managing Default Result Code - 500C response
[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.ReceiveDEAFromAAARuleChain/110.LogIfInvalidResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevResultCodeInteger,within,[3001-3010]

##QXCM1001423232:When AAA respods with error code 5001, then 6300 response is to be sent to device (DEG2.3CPE)
Conditions=DEG_OEMDevResultCodeInteger,within,[5002,5004-5017,5241,5450,5452]
Operations=or


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.SendDERToSecondaryAAA]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.SendDERToSecondaryAAA/010.SetParameters]

##Delivery team can set their own attributes here; can set ApplicationId if it is changed in DiameterAdapter##
ClassName=com.hp.siu.collector.rules.AdornmentRule
#QXCM1001544811:3.2.4 China Unicom issues,issue 8:2017041008
AdornOps=set DEG_OEMDevAuthApplicationIdInteger ${DEG_DAIMETER_APLLICATION_ID}
#AdornOps=set DEG_OEMDevAuthApplicationIdInteger 11111

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.SendDERToSecondaryAAA/100.DERNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_SSL_AAA_SESSIONID,session_id
NMEToStructuredNMEMap=DEG_OEMDevAuthApplicationIdInteger,auth_application_id
NMEToStructuredNMEMap=DEG_OEMDevOriginHostString,origin_Host
NMEToStructuredNMEMap=DEG_OEMDevOriginRealmString,origin_Realm
NMEToStructuredNMEMap=DEG_OEMDevSecondaryDestRealmString,destination_Realm
NMEToStructuredNMEMap=DEG_OEMDevAuthRequestTypeInteger,auth_request_type
NMEToStructuredNMEMap=DEG_OEMDevEAPPayloadBinary,eap_payload
NMEToStructuredNMEMap=DEG_OEMDevSubscriberIdString,user_Name
NMEToStructuredNMEMap=DEG_OEMDevImsiString,calling_station_id
NMEToStructuredNMEMap=DEG_OEMDevRATTypeInteger,RAT_type
NMEToStructuredNMEMap=DEG_OEMDevVisitedNetworkIdBinary,visited_network_identifier
NMEToStructuredNMEMap=DEG_OEMDevAuthLifeTime,authorization_lifeTime
NMEToStructuredNMEMap=DEG_OEMDevAuthGracePeriod,auth_grace_period
NMEToStructuredNMEMap=DEG_OEMDevAuthSessionState,auth_session_state
NMEToStructuredNMEMap=DEG_OEMDevANIDString,ANID
NMEToStructuredNMEMap=DEG_OEMDevDiameterStateBinary,state
NMEToStructuredNMEMap=DEG_OEMDevAAAFailureIndicationFlagInteger,failure_indication
SNMEType=diameterSWa:DiameterEAPRequestSWa

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.SendDERToSecondaryAAA/120.SendDERRequest]

#QXCM1001544811:3.2.4 China Unicom issues,issue 8:2017041008
ApplicationId=${DEG_DAIMETER_APLLICATION_ID}
ClassName=com.hp.usage.diameter.DiameterClientRule
CommandCode=268
DCJNDIName=Device
DestinationHostAttribute=DEG_OEMDevRedirectedHostString
DestinationRealmAttribute=DEG_OEMDevSecondaryDestRealmString
DisconnectAttribute=disc
E2EAttribute=DEG_OEMDevE2ELong
ErrorResultFlagAttribute=errFlag
HbHAttribute=DEG_OEMDevHbHLong
ProxiableFlagAttribute=DEG_OEMDevProxiableFlagInteger
RequestFlagAttribute=DEG_OEMDevRequestFlagInteger
Retries=0
TimeOut=5000
TimeOutFlagAttribute=toFlag
WaitForConnection=false

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.ReceiveDEAFromSecondaryAAA]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.ReceiveDEAFromSecondaryAAA/100.DEASNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
SNMEType=diameterSWa:DiameterEAPAnswerSWa
StructuredNMEToNMEMap=session_id,DEG_SSL_AAA_SESSIONID
StructuredNMEToNMEMap=auth_application_id,DEG_OEMDevAuthApplicationIdInteger
StructuredNMEToNMEMap=result_Code,DEG_OEMDevResultCodeInteger,0
StructuredNMEToNMEMap=experimental_result[0].vendor_id,DEG_OEMDevVendorIdInteger
StructuredNMEToNMEMap=experimental_result[0].experimental_result_code,DEG_OEMDevExperimentalResultCodeInteger
StructuredNMEToNMEMap=origin_Host,DEG_OEMDevOriginHostString
StructuredNMEToNMEMap=origin_Realm,DEG_OEMDevOriginRealmString
StructuredNMEToNMEMap=auth_request_type,DEG_OEMDevAuthRequestTypeInteger
StructuredNMEToNMEMap=eap_payload,DEG_OEMDevEAPPayloadBinary
StructuredNMEToNMEMap=user_Name,DEG_SSL_NAI
StructuredNMEToNMEMap=error_message,DEG_OEMDevErrorMessageString
StructuredNMEToNMEMap=state,DEG_OEMDevDiameterStateBinary


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.SendDERToAAAInFailureCondition]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.SendDERToAAAInFailureCondition/010.SetParameters]

##Delivery team can set their own attributes here; can set ApplicationId if it is changed in DiameterAdapter##
ClassName=com.hp.siu.collector.rules.AdornmentRule
#QXCM1001544811:3.2.4 China Unicom issues,issue 8:2017041008
AdornOps=set DEG_OEMDevAuthApplicationIdInteger ${DEG_DAIMETER_APLLICATION_ID}
#AdornOps=set DEG_OEMDevAuthApplicationIdInteger 11111

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.SendDERToAAAInFailureCondition/100.DERNMEConversion]


ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_SSL_AAA_SESSIONID,session_id
NMEToStructuredNMEMap=DEG_OEMDevAuthApplicationIdInteger,auth_application_id
NMEToStructuredNMEMap=DEG_OEMDevOriginHostString,origin_Host
NMEToStructuredNMEMap=DEG_OEMDevOriginRealmString,origin_Realm
NMEToStructuredNMEMap=DEG_OEMDevSecondaryDestRealmString,destination_Realm
NMEToStructuredNMEMap=DEG_OEMDevAuthRequestTypeInteger,auth_request_type
NMEToStructuredNMEMap=DEG_OEMDevEAPPayloadBinary,eap_payload
NMEToStructuredNMEMap=DEG_OEMDevSubscriberIdString,user_Name
NMEToStructuredNMEMap=DEG_OEMDevImsiString,calling_station_id
NMEToStructuredNMEMap=DEG_OEMDevRATTypeInteger,RAT_type
NMEToStructuredNMEMap=DEG_OEMDevVisitedNetworkIdBinary,visited_network_identifier
NMEToStructuredNMEMap=DEG_OEMDevAuthLifeTime,authorization_lifeTime
NMEToStructuredNMEMap=DEG_OEMDevAuthGracePeriod,auth_grace_period
NMEToStructuredNMEMap=DEG_OEMDevAuthSessionState,auth_session_state
NMEToStructuredNMEMap=DEG_OEMDevANIDString,ANID
NMEToStructuredNMEMap=DEG_OEMDevDiameterStateBinary,state
NMEToStructuredNMEMap=DEG_OEMDevAAAFailureIndicationFlagInteger,failure_indication
SNMEType=diameterSWa:DiameterEAPRequestSWa

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.SendDERToAAAInFailureCondition/120.SendDERRequest]

#QXCM1001544811:3.2.4 China Unicom issues,issue 8:2017041008
ApplicationId=${DEG_DAIMETER_APLLICATION_ID}
ClassName=com.hp.usage.diameter.DiameterClientRule
CommandCode=268
DCJNDIName=Device
DestinationHostAttribute=DEG_OEMDevRememberedHostNameString
DestinationRealmAttribute=DEG_OEMDevRememberedRealmString
DisconnectAttribute=disc
E2EAttribute=DEG_OEMDevE2ELong
ErrorResultFlagAttribute=errFlag
HbHAttribute=DEG_OEMDevHbHLong
ProxiableFlagAttribute=DEG_OEMDevProxiableFlagInteger
RequestFlagAttribute=DEG_OEMDevRequestFlagInteger
Retries=0
TimeOut=5000
TimeOutFlagAttribute=toFlag
WaitForConnection=false

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.ReceiveDEAFromAAAInFailureCondition]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301C.ReceiveDEAFromAAAInFailureCondition/100.DEASNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
SNMEType=diameterSWa:DiameterEAPAnswerSWa
StructuredNMEToNMEMap=session_id,DEG_SSL_AAA_SESSIONID
StructuredNMEToNMEMap=auth_application_id,DEG_OEMDevAuthApplicationIdInteger
StructuredNMEToNMEMap=result_Code,DEG_OEMDevResultCodeInteger,0
StructuredNMEToNMEMap=experimental_result[0].vendor_id,DEG_OEMDevVendorIdInteger
StructuredNMEToNMEMap=experimental_result[0].experimental_result_code,DEG_OEMDevExperimentalResultCodeInteger
StructuredNMEToNMEMap=origin_Host,DEG_OEMDevOriginHostString
StructuredNMEToNMEMap=origin_Realm,DEG_OEMDevOriginRealmString
StructuredNMEToNMEMap=auth_request_type,DEG_OEMDevAuthRequestTypeInteger
StructuredNMEToNMEMap=eap_payload,DEG_OEMDevEAPPayloadBinary
StructuredNMEToNMEMap=user_Name,DEG_SSL_NAI
StructuredNMEToNMEMap=error_message,DEG_OEMDevErrorMessageString
StructuredNMEToNMEMap=state,DEG_OEMDevDiameterStateBinary
StructuredNMEToNMEMap=redirect_host,DEG_OEMDevRedirectedHostString

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/302.SendPostChallengeDER]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/302.SendPostChallengeDER/100.DERNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_SSL_AAA_SESSIONID,session_id
NMEToStructuredNMEMap=DEG_OEMDevAuthApplicationIdInteger,auth_application_id
NMEToStructuredNMEMap=DEG_OEMDevOriginHostString,origin_Host
NMEToStructuredNMEMap=DEG_OEMDevOriginRealmString,origin_Realm
NMEToStructuredNMEMap=DEG_OEMDevPrimaryDestRealmString,destination_Realm
NMEToStructuredNMEMap=DEG_OEMDevAuthRequestTypeInteger,auth_request_type
NMEToStructuredNMEMap=DEG_OEMDevEAPPayloadBinary,eap_payload
NMEToStructuredNMEMap=DEG_OEMDevSubscriberIdString,user_Name
NMEToStructuredNMEMap=DEG_OEMDevImsiString,calling_station_id
NMEToStructuredNMEMap=DEG_OEMDevRATTypeInteger,RAT_type
NMEToStructuredNMEMap=DEG_OEMDevVisitedNetworkIdBinary,visited_network_identifier
NMEToStructuredNMEMap=DEG_OEMDevAuthLifeTime,authorization_lifeTime
NMEToStructuredNMEMap=DEG_OEMDevAuthGracePeriod,auth_grace_period
NMEToStructuredNMEMap=DEG_OEMDevAuthSessionState,auth_session_state
NMEToStructuredNMEMap=DEG_OEMDevANIDString,ANID
NMEToStructuredNMEMap=DEG_OEMDevDiameterStateBinary,state
NMEToStructuredNMEMap=DEG_OEMDevAAAFailureIndicationFlagInteger,failure_indication
SNMEType=diameterSWa:DiameterEAPRequestSWa

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/302.SendPostChallengeDER/120.SendDERRequest]

#QXCM1001544811:3.2.4 China Unicom issues,issue 8:2017041008
ApplicationId=${DEG_DAIMETER_APLLICATION_ID}
ClassName=com.hp.usage.diameter.DiameterClientRule
CommandCode=268
DCJNDIName=Device
DestinationHostAttribute=DEG_OEMDevDestinationHostString
DestinationRealmAttribute=DEG_OEMDevDestinationRealmString
DisconnectAttribute=disc
E2EAttribute=DEG_OEMDevE2ELong
ErrorResultFlagAttribute=errFlag
HbHAttribute=DEG_OEMDevHbHLong
ProxiableFlagAttribute=DEG_OEMDevProxiableFlagInteger
RequestFlagAttribute=DEG_OEMDevRequestFlagInteger
Retries=0
TimeOut=5000
TimeOutFlagAttribute=toFlag
WaitForConnection=false

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/303.STRProcessingRuleChain]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/303.STRProcessingRuleChain/101.SetRequestParams]

##Delivery team can set their own attributes here##
ClassName=com.hp.siu.collector.rules.AdornmentRule
#QXCM1001544811:3.2.4 China Unicom issues,issue 8:2017041008
AdornOps=set DEG_OEMDevAuthApplicationIdInteger ${DEG_DAIMETER_APLLICATION_ID}
#AdornOps=set DEG_OEMDevAuthApplicationIdInteger 11111


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/303.STRProcessingRuleChain/110.STRNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevDiameterSessionIdString,session_id
NMEToStructuredNMEMap=DEG_OEMDevOriginHostString,origin_Host
NMEToStructuredNMEMap=DEG_OEMDevOriginRealmString,origin_Realm
NMEToStructuredNMEMap=DEG_OEMDevPrimaryDestRealmString,destination_Realm
NMEToStructuredNMEMap=DEG_OEMDevAuthApplicationIdInteger,auth_application_id
NMEToStructuredNMEMap=DEG_OEMDevTerminationCauseInteger,termination_cause
NMEToStructuredNMEMap=DEG_OEMDevSubscriberIdString,user_Name
#NMEToStructuredNMEMap=DEG_OEMDevPrimaryDesthostString,destination_host
SNMEType=diameterSWa:SessionTerminationRequestSWa

###can change the value of atrribute ApplicationId etc.
[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/303.STRProcessingRuleChain/300.SendSTRRequest]

ClassName=com.hp.usage.diameter.DiameterClientRule
#QXCM1001544811:3.2.4 China Unicom issues,issue 8:2017041008
ApplicationId=${DEG_DAIMETER_APLLICATION_ID}
CommandCode=275
DCJNDIName=Device
DestinationHostAttribute=DEG_OEMDevPrimaryDesthostString
DestinationRealmAttribute=DEG_OEMDevPrimaryDestRealmString
SecondaryDestinationHostAttribute=DEG_OEMDevSecondaryDesthostString
SecondaryDestinationRealmAttribute=DEG_OEMDevSecondaryDestRealmString
DisconnectAttribute=disc
E2EAttribute=DEG_OEMDevE2ELong
ErrorResultFlagAttribute=errFlag
HbHAttribute=DEG_OEMDevHbHLong
TimeOut=0
TimeOutFlagAttribute=toFlag
WaitForConnection=false


[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/304.STAProcessingRuleChain]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/304.STAProcessingRuleChain/200.STASNMEConversion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
StructuredNMEToNMEMap=session_id,DEG_OEMDevDiameterSessionIdString
StructuredNMEToNMEMap=result_Code,DEG_OEMDevResultCodeInteger,0
StructuredNMEToNMEMap=origin_Host,DEG_OEMDevOriginHostString
StructuredNMEToNMEMap=origin_Realm,DEG_OEMDevOriginRealmString
StructuredNMEToNMEMap=error_message,DEG_OEMDevErrorMessageString
StructuredNMEToNMEMap=experimental_result[0].vendor_id,DEG_OEMDevVendorIdInteger
StructuredNMEToNMEMap=experimental_result[0].experimental_result_code,DEG_OEMDevExperimentalResultCodeInteger
SNMEType=diameterSWa:SessionTerminationAnswerSWa

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/400.GenerateOEMResponse]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/400.GenerateOEMResponse/100.CheckCustomizedResponse]

#RFE 47 Delivery team can set the SSL State to set the response as per their requirement.
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevAAACustomResponseInteger 0
#AdornOps=set DEG_SSL_STATE "AKA_CHALLENGE_REJECTED_BY_AAA"


#QXCM1001557688: Managing Default Result Code - 500C response
[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301D.ValidateResponseFromAAARuleChain]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected]

[/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/301D.ValidateResponseFromAAARuleChain/100.CheckAAAResultCode/200.CheckIfDiameterMultiRoundAuth/200.CheckIfDiameterAuthRejected/200.isDiameterError]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=errFlag,!=,0
Conditions=DEG_OEMDevResultCodeInteger,within,[3001-3005,3007-3010]
##QXCM1001423232:When AAA respods with error code 5001, then 6300 response is to be sent to device (DEG2.3CPE)
Conditions=DEG_OEMDevResultCodeInteger,within,[5002,5004-5017,5241,5450,5452]
Operations=or,or
