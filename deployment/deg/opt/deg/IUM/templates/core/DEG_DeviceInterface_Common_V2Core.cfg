[/templates/DEG/DeviceInterface/Common_V2Core]

[/templates/DEG/DeviceInterface/Common_V2Core/Connectors]

ConnectorNames=300.JDBCOperationsConnector

[/templates/DEG/DeviceInterface/Common_V2Core/Connectors/300.JDBCOperationsConnector]

ClassName=com.hp.usage.jdbc.JDBCClientConnector
OpNameAttribute=DEG_OEMDevJDBCOpNameString

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService]

ClassName=com.hp.siu.serverutils.RefDataServiceManager
QueryNames=DEG_COMPANION_TOKENS
QueryNames=DEG_MONITORING_SESSIONS_ActiveSessionsV2
QueryNames=DEG_COMPANION_TOKENS_SECONDARYDEVICE
QueryNames=DEG_DEVICE_DATA
QueryNames=DEG_TOKENS_ByIMSI
QueryNames=DEG_DEVICE_DATAWithUNIQUEIDAndEntitlement

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATAWithUNIQUEIDAndEntitlement]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_UNIQUE_ID,DEG_UNIQUE_ID
FieldExtracted=DEG_ENTITLEMENT_NAME,DEG_ENTITLEMENT_NAME
FieldExtracted=DEG_APNS_TOKEN,DEG_APNS_TOKEN
FieldExtracted=DEG_PUSH_NOTIFICATION_STATUS,DEG_PUSH_NOTIFICATION_STATUS
FieldExtracted=DEG_IMSI,DEG_IMSI
CommonPolicyID=Policy1
QueryString=SELECT %FIELDS FROM DEG_DEVICE_DATA where DEG_UNIQUE_ID=%DEG_UNIQUE_ID and DEG_ENTITLEMENT_NAME=%DEG_ENTITLEMENT_NAME
ResultAttribute=DEG_RowFoundInteger
ResultIndexAttribute=DEG_RowFoundIndexInteger

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATAWithUNIQUEIDAndEntitlement/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=200.SetErrorFlag

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATAWithUNIQUEIDAndEntitlement/ErrorRule/200.SetErrorFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATAWithUNIQUEIDAndEntitlement/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_RowFoundInteger 0
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_DEVICE_DATA"
AdornOps=set DEG_APNS_TOKEN ""
AdornOps=set DEG_PUSH_NOTIFICATION_STATUS 0
AdornOps=set DEG_OEMDevProvisioningAPNSTokenList null
AdornOps=set DEG_OEMDevProvisioningEntitlementList null
AdornOps=set DEG_OEMDevProvisioningUniqueIdList null


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATAWithUNIQUEIDAndEntitlement/ResultRowRule]

ClassName=RuleChain
RuleNames=100.SetErrorResponse
RuleNames=LogRule
RuleNames=SetPushNotificationAttribute


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATAWithUNIQUEIDAndEntitlement/ResultRowRule/100.SetErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString  "DEG.DI.GA.0201"
AdornOps=set DEG_OEMDevMessageString ""

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATAWithUNIQUEIDAndEntitlement/ResultRowRule/LogRule]

ClassName=LogNMERule
LogLevel=DEBUG4
Attributes=DEG_UNIQUE_ID
Attributes=DEG_PUSH_NOTIFICATION_STATUS
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Message=DEVICE DATA 1::

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATAWithUNIQUEIDAndEntitlement/ResultRowRule/SetPushNotificationAttribute]

ClassName=AdornmentRule
AdornOps=setifnull DEG_APNS_TOKEN ""
AdornOps=copy DEG_APNS_TOKEN DEG_OEMDevAPNSTokenString
AdornOps=copy DEG_ENTITLEMENT_NAME DEG_OEMDevAPNSTopicString
AdornOps=copy DEG_UNIQUE_ID DEG_APNSUniqueIdString

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_TOKENS_ByIMSI]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_MDN,DEG_MDN
FieldExtracted=DEG_IMSI,DEG_IMSI
FieldExtracted=DEG_UNIQUE_ID,DEG_UNIQUE_ID
FieldExtracted=DEG_SUBSTOKEN,DEG_SUBSTOKEN
FieldExtracted=DEG_TOKENSTATUS,DEG_TOKENSTATUS
FieldExtracted=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
CommonPolicyID=Policy1
QueryString=select %FIELDS from DEG_TOKENS WHERE DEG_IMSI=%DEG_IMSI
ResultAttribute=DEG_RowFoundInteger
ResultIndexAttribute=DEG_RowFoundIndexInteger

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_TOKENS_ByIMSI/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetErrorLog

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_TOKENS_ByIMSI/ErrorRule/100.SetErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_TOKENS_ByIMSI/InitialRule]

AdornOps=set DEG_RowFoundInteger 0
AdornOps=set DEG_MDN 0
AdornOps=set DEG_SUBSTOKEN ""
AdornOps=set DEG_TOKENSTATUS ""
AdornOps=set DEG_EVENTTIMESTAMP 0
AdornOps=set DEG_UNIQUE_ID ""
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_TOKENS"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATA]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_ENTITLEMENT_NAME,DEG_ENTITLEMENT_NAME
CommonPolicyID=JDBCQueryExclusivePolicy
QueryString=SELECT %FIELDS FROM DEG_DEVICE_DATA WHERE DEG_IMSI=%DEG_OEMDevImsiString
ResultAttribute=DEG_RowFoundInteger
ResultIndexAttribute=DEG_RowFoundIndexInteger

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATA/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=95.SetErrorInfo
RuleNames=100.LogAlarming
RuleNames=200.SetErrorFlag

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATA/ErrorRule/95.SetErrorInfo]
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0202"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_DEVICE_DATA table"



[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATA/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error:Unable to lookup or access DEG_DEVICE_DATA table
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATA/ErrorRule/200.SetErrorFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATA/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_RowFoundInteger DEG_RowFoundInteger

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATA/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_RowFoundInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_DEVICE_DATA"
AdornOps=set DEG_ENTITLEMENT_NAME ""

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATA/ResultRowRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitialRule
RuleNames=200.CheckEntitlementList

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATA/ResultRowRule/100.InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_ENTITLEMENT_NAME DEG_OEMDevEntitlementNameString
AdornOps=+ DEG_OEMDevEntitlementNameString = DEG_OEMDevtempEntitlementNameString
AdornOps=+ , DEG_OEMDevtempEntitlementNameString DEG_OEMDevtempEntitlementNameString
AdornOps=+ , DEG_EntitlementStatus DEG_EntitlementtempStatus
AdornOps=+ DEG_EntitlementtempStatus , DEG_EntitlementtempStatus

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATA/ResultRowRule/200.CheckEntitlementList]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_EntitlementtempStatus,contains,DEG_OEMDevtempEntitlementNameString

FalseRuleChain=100.DeleteDeviceDataTable

#QXCM1001547509:  SCM_SW:CS APNS Token Deleted 
[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATA/ResultRowRule/200.CheckEntitlementList/100.DeleteDeviceDataTable]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevtempEntitlementNameString,=,",CarrierSpace="
FalseRuleChain=150.DeleteDeviceDataTable

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_DEVICE_DATA/ResultRowRule/200.CheckEntitlementList/100.DeleteDeviceDataTable/150.DeleteDeviceDataTable]

ClassName=com.hp.siu.sessionserver.rules.PurgeSessionsRule
PurgeConditions=DEG_IMSI,=,%DEG_IMSI
PurgeConditions=DEG_ENTITLEMENT_NAME,=,%DEG_ENTITLEMENT_NAME
SessionStore=DEG_DEVICE_DATA_SessionStore


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_IMSI,DEG_IMSI
FieldExtracted=DEG_DEVICE_ID,DEG_DEVICE_ID
FieldExtracted=DEG_SERVICE_TOKEN,DEG_SERVICE_TOKEN
FieldExtracted=DEG_UNIQUE_ID,DEG_UNIQUE_ID
FieldExtracted=DEG_SERVICETOKEN_STATUS,DEG_SERVICETOKEN_STATUS
FieldExtracted=DEG_TOKENCREATE_TIMESTAMP,DEG_TOKENCREATE_TIMESTAMP
CommonPolicyID=JDBCQueryExclusivePolicy
QueryString=SELECT %FIELDS FROM DEG_COMPANION_TOKENS WHERE DEG_IMSI=%DEG_OEMDevImsiString
ResultAttribute=DEG_RowFoundInteger
ResultIndexAttribute=DEG_RowFoundIndexInteger


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=070.SetErrorInfo
RuleNames=100.LogAlarming
RuleNames=200.SetErrorFlag

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS/ErrorRule/070.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0203"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_COMPANION_TOKENS table"

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error:Unable to lookup or access DEG_COMPANION_TOKENS table
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS/ErrorRule/200.SetErrorFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_RowFoundInteger DEG_RowFoundInteger

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_RowFoundInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_COMPANION_TOKENS"
AdornOps=set DEG_IMSI ""
AdornOps=set DEG_DEVICE_ID ""
AdornOps=set DEG_SERVICE_TOKEN ""
AdornOps=set DEG_OEMDevServiceTokenIndexInteger -1


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS/ResultRowRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitialRule
RuleNames=200.CheckSTRegenerate
#QXCM1001409544 and QXCM1001410178 :Service-Tokens are of wrong format and Subscribers-IDs are of wrong format
[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS/ResultRowRule/100.InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_RowFoundInteger 1
AdornOps=copy DEG_SERVICETOKEN_STATUS DEG_OEMDevServiceTokenStatusString
AdornOps=copy DEG_SERVICE_TOKEN DEG_OEMDevServiceTokenString
AdornOps=copy DEG_DEVICE_ID DEG_OEMDeviceIdString
AdornOps=copy DEG_OEMDeviceIdString DEG_OEMCompTokensDeviceIdString
AdornOps=copy DEG_TOKENCREATE_TIMESTAMP DEG_OEMDevTokenCreateTimestampLong
AdornOps=+ DEG_OEMDevTokenCreateTimestampLong DEG_OEMDevTokenLifetimeLong DEG_OEMDevTokenCreateTimestampLong
AdornOps=+ DEG_OEMDevServiceTokenIndexInteger 1 DEG_OEMDevServiceTokenIndexInteger
AdornOps=setifnull DEG_UNIQUE_ID ""
AdornOps=copy DEG_UNIQUE_ID DEG_OEMDevCompanionTokenUniqueIdString

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS/ResultRowRule/200.CheckSTRegenerate]

ClassName=com.hp.siu.collector.rules.ConditionalRule
#Conditions=DEG_OEMDevServiceTokenStatusString,=,"DE"
Conditions=DEG_OEMDevCurrentTimeStampLong,>,DEG_OEMDevTokenCreateTimestampLong
Conditions=DEG_OEMDevServiceTokenStatusString,=,"RE"

Operations=or
#QXCM1001411240: IMS credential and device data should be free for expired service token device
TrueRuleChain=200.ReGenerateServiceToken
FalseRuleChain=100.AddDeviceIdToList
FalseRuleChain=110.CheckServiceTokenType
FalseRuleChain=120.PopulateServiceTokenResponse


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS/ResultRowRule/200.CheckSTRegenerate/100.AddDeviceIdToList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMCompTokensDeviceIdString
ListAttribute=DEG_OEMDevResponseSubscriberIdList

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS/ResultRowRule/200.CheckSTRegenerate/110.CheckServiceTokenType]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevServiceTokenTypeString,=,"unlimited"
Conditions=DEG_OEMDevServiceTokenIndexInteger,=,0

Operations=and

TrueRuleChain=100.GenerateResponse

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS/ResultRowRule/200.CheckSTRegenerate/110.CheckServiceTokenType/100.GenerateResponse]

ClassName=NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevServiceTokenString,jsonResponse.service_tokens[DEG_OEMDevServiceTokenIndexInteger].CData,""
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS/ResultRowRule/200.CheckSTRegenerate/120.PopulateServiceTokenResponse]

ClassName=NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevServiceTokenString,jsonResponse.service_tokens[DEG_OEMDevServiceTokenIndexInteger].CData,""
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS/ResultRowRule/200.CheckSTRegenerate/200.ReGenerateServiceToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
ResponseAttributes=DEG_OEMDevServiceTokenString
RuleChain=223T.DEG20ReGenSTAndUpdateDBRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_MSESSIONID,DEG_MSESSIONID
#JDBCDataSourceConnectorName=120.RefDataDbConnectorNRB
CommonPolicyID=Policy2
QueryString=SELECT %FIELDS  FROM DEG_MONITORING_SESSIONS WHERE DEG_MSESSIONTYPE in ('MDN','IMSI','UNIQ') AND DEG_MSESSIONSTATUS='AE' AND DEG_MSESSIONKEY=%DEG_MSESSIONKEY
ResultAttribute=DEG_NrbMatchFoundInteger
ResultIndexAttribute=DEG_NrbIndexInteger

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=090.SetErrorInfo
RuleNames=100.LogAlarming

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ErrorRule/090.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0204"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_MONITORING_SESSIONS table"

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ErrorRule/100.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error:Unable to lookup or access DEG_MONITORING_SESSIONS table
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/FinalRule]

AdornOps=copy DEG_NrbMatchFoundInteger DEG_NrbMatchFoundInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/InitialRule]

AdornOps=set DEG_NrbMatchFoundInteger 0
AdornOps=set DEG_MSESSIONID ""
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_MONITORING_SESSIONS"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ResultRowRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.Set_MatchFound
RuleNames=200.PopulateMonitoringSessionIdsList

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ResultRowRule/100.Set_MatchFound]

AdornOps=set DEG_NrbMatchFoundInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ResultRowRule/200.PopulateMonitoringSessionIdsList]

ClassName=AddToListAttributeRule
Delimiters=,
InputAttribute=DEG_MSESSIONID
ListAttribute=DEG_NrbMonitoringSessionIdList


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_IMSI,DEG_IMSI
FieldExtracted=DEG_SERVICE_TOKEN,DEG_SERVICE_TOKEN
FieldExtracted=DEG_SERVICETOKEN_STATUS,DEG_SERVICETOKEN_STATUS
FieldExtracted=DEG_UNIQUE_ID,DEG_UNIQUE_ID
FieldExtracted=DEG_DEVICE_ID,DEG_DEVICE_ID
FieldExtracted=DEG_TOKENCREATE_TIMESTAMP,DEG_TOKENCREATE_TIMESTAMP
#RFE75 fix related files.
#New header attribute 'user-agent' added as part of http request from the device.
#iOS device sends specific User-Agent strings that can identify the specific device and version of iOS.
FieldExtracted=DEG_USER_AGENT,DEG_USER_AGENT
CommonPolicyID=JDBCQueryExclusivePolicy
QueryString=SELECT %FIELDS FROM DEG_COMPANION_TOKENS WHERE DEG_IMSI=%DEG_OEMDevImsiString
ResultAttribute=DEG_RowFoundInteger
ResultIndexAttribute=DEG_RowFoundIndexInteger

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=099.SetErrorInfo
RuleNames=100.LogAlarming
RuleNames=200.SetErrorFlag

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ErrorRule/099.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0205"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_COMPANION_TOKENS table"

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error:Unable to lookup or access DEG_COMPANION_TOKENS table
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ErrorRule/200.SetErrorFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_RowFoundInteger DEG_RowFoundInteger

#Previous unique id of companion is fetching from companion tokens table(for GPSAS custom template) before its get updated with new unique id.
[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_RowFoundInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_COMPANION_TOKENS"
AdornOps=set DEG_IMSI ""
AdornOps=set DEG_SERVICE_TOKEN ""
AdornOps=set DEG_SERVICETOKEN_STATUS ""
AdornOps=set DEG_OEMDevServiceTokenNotMatchString 0
AdornOps=set CUST_VOWIFI_IN_PrevUniqueIDString ""

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitialRule
RuleNames=200.CheckServiceToken


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/100.InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_RowFoundInteger 1
#AdornOps=copy DEG_OEMDevServiceTokenString DEG_OEMDevServiceTokenString
AdornOps=copy DEG_DEVICE_ID DEG_OEMDeviceIdString
AdornOps=copy DEG_TOKENCREATE_TIMESTAMP DEG_OEMDevTokenCreateTimestampLong
AdornOps=+ DEG_OEMDevTokenCreateTimestampLong DEG_OEMDevTokenLifetimeLong DEG_OEMDevTokenCreateTimestampLong
AdornOps=setifnull DEG_UNIQUE_ID ""
AdornOps=copy DEG_UNIQUE_ID DEG_OEMDevCompanionDeviceUniqueIDString
AdornOps=setifnull DEG_USER_AGENT ""

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
#Conditions=DEG_IMSI,!=,DEG_OEMDevImsiString
Conditions=DEG_SERVICE_TOKEN,!=,DEG_OEMDevServiceTokenString
Conditions=DEG_SERVICETOKEN_STATUS,=,"RE"
#QXCM1001419098 fix : if status is RE and service token is expired then false rule chain will call and return 6006 with APNS to primary device
Conditions=DEG_OEMDevCurrentTimeStampLong,<,DEG_OEMDevTokenCreateTimestampLong

Operations=or,and

TrueRuleChain=100.UpdateCompanionTokenTableWhereRE

FalseRuleChain=100.InitServiceTokenKey
FalseRuleChain=200.CheckTokenExpiration

#for thr purpuse of knowing which device is used DEG for license pont of view.

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/100.UpdateCompanionTokenTableWhereRE]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SERVICE_TOKEN,=,DEG_OEMDevServiceTokenString

TrueRuleChain=100.InitCompanionTokesUpdate
TrueRuleChain=200.ExecuteCompanionTokensUpdate

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/100.UpdateCompanionTokenTableWhereRE/100.InitCompanionTokesUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_SERVICETOKEN_STATUS DEG_SERVICETOKEN_STATUS
AdornOps=copy DEG_UNIQUE_ID CUST_VOWIFI_IN_PrevUniqueIDString
AdornOps=copy DEG_OEMDevUniqueIdString DEG_UNIQUE_ID
AdornOps=copy DEG_TOKENCREATE_TIMESTAMP DEG_TOKENCREATE_TIMESTAMP
AdornOps=setsystime DEG_AUTH_TIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_COMPANION_TOKENS"
#RFE75 fix related files.
#New header attribute 'user-agent' added as part of http request from the device.
#iOS device sends specific User-Agent strings that can identify the specific device and version of iOS.
AdornOps=copy DEG_OEMDevUserAgentString DEG_USER_AGENT

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/100.UpdateCompanionTokenTableWhereRE/200.ExecuteCompanionTokensUpdate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=225D.DEG21UpdateCompanionTokenRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/100.InitServiceTokenKey]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevServiceTokenNotMatchString 1

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevCurrentTimeStampLong,>,DEG_OEMDevTokenCreateTimestampLong

TrueRuleChain=100.InitDeviceDataLookup
TrueRuleChain=110.LookUpDeviceData
TrueRuleChain=120.CheckDBErrorFlag

FalseRuleChain=200.CompanionTokenNotExpired

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/100.InitDeviceDataLookup]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=set DEG_ENTITLEMENT_NAME ${VOWIFI_ENTITLEMENT_NAME}

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/110.LookUpDeviceData]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
NativeCondition=4.MatchByIMSIAndEntitelementName
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
MapAttributes=DEG_ENTITLEMENT_NAME,DEG_ENTITLEMENT_NAME
MapAttributes=DEG_APNS_TOKEN,DEG_APNS_TOKEN
MapAttributes=DEG_PUSH_NOTIFICATION_STATUS,DEG_PUSH_NOTIFICATION_STATUS
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/120.CheckDBErrorFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.PrintError
FalseRuleChain=200.CheckKeyExistFlag

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/120.CheckDBErrorFlag/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0206"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_DEVICE_DATA table"

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/120.CheckDBErrorFlag/110.PrintError]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevUniqueIDString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: while looking up in DEG_DEVICE_DATA table
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/120.CheckDBErrorFlag/200.CheckKeyExistFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1

TrueRuleChain=100.InitialRule
TrueRuleChain=110.RowFound
FalseRuleChain=200.RowNotFound

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/120.CheckDBErrorFlag/200.CheckKeyExistFlag/100.InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
#AdornOps=copy DEG_PUSH_NOTIFICATION_STATUS DEG_OEMDevPushNotificationStatusString
AdornOps=set DEG_OEMDevAPNSTopicString ${VOWIFI_ENTITLEMENT_NAME}
AdornOps=copy DEG_APNS_TOKEN DEG_OEMDevAPNSTokenString
AdornOps=copy DEG_UNIQUE_ID DEG_APNSUniqueIdString
AdornOps=copy DEG_OEMDevImsiString DEG_CarrIMSIString

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/120.CheckDBErrorFlag/200.CheckKeyExistFlag/110.RowFound]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_PUSH_NOTIFICATION_STATUS,=,6100

TrueRuleChain=001.InitAPNSParams
TrueRuleChain=100.SendAPNSNotification
TrueRuleChain=110.GenerateResponse

FalseRuleChain=200.GenerateResponse


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/120.CheckDBErrorFlag/200.CheckKeyExistFlag/110.RowFound/001.InitAPNSParams]

ClassName=com.hp.siu.collector.rules.AdornmentRule

ClassName=AdornmentRule
AdornOps=copy DEG_MDN DEG_CarrMDNLong
AdornOps=copy DEG_OEMDevImsiString DEG_CarrIMSIString
AdornOps=copy DEG_OEMDevAPNSTopicString DEG_APNSTopicString
AdornOps=copy DEG_OEMDevAPNSTokenString APNS_TokenString
AdornOps=set DEG_TriggerTypeString "service-token-invalidated"



[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/120.CheckDBErrorFlag/200.CheckKeyExistFlag/110.RowFound/100.SendAPNSNotification]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_Apple_APNS_SendNotification_Init
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/120.CheckDBErrorFlag/200.CheckKeyExistFlag/110.RowFound/110.GenerateResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=233N.DEG21ServiceToken_ValidateAndGenerateResponseRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/120.CheckDBErrorFlag/200.CheckKeyExistFlag/110.RowFound/200.GenerateResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=233N.DEG21ServiceToken_ValidateAndGenerateResponseRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/120.CheckDBErrorFlag/200.CheckKeyExistFlag/200.RowNotFound]

ClassName=com.hp.siu.collector.rules.RuleChain
#RuleNames=100.InitVaraibles
RuleNames=110.GenerateResponse

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/120.CheckDBErrorFlag/200.CheckKeyExistFlag/200.RowNotFound/100.InitVaraibles]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_UNIQUE_ID ""

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/120.CheckDBErrorFlag/200.CheckKeyExistFlag/200.RowNotFound/110.GenerateResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=233N.DEG21ServiceToken_ValidateAndGenerateResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_UNIQUE_ID,=,""
Conditions=DEG_UNIQUE_ID,=,DEG_OEMDevUniqueIdString
Conditions=DEG_UNIQUE_ID,!=,DEG_OEMDevUniqueIdString


TrueRuleChain=NullUniqeID
TrueRuleChain=SameUniqueID
TrueRuleChain=DifferentUniqueID


NullUniqeID=100.InitVaraibles
NullUniqeID=110.UpdateCompanionTokenTable

SameUniqueID=200.InitVaraibles
SameUniqueID=210.UpdateCompanionTokenTable

DifferentUniqueID=310.UpdateCompanionTokenTable
DifferentUniqueID=330.UpdateIMSDataTable
DifferentUniqueID=340.DeleteDeviceDataTable


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/100.InitVaraibles]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_SERVICETOKEN_STATUS "AE"
AdornOps=copy DEG_UNIQUE_ID CUST_VOWIFI_IN_PrevUniqueIDString
AdornOps=copy DEG_OEMDevUniqueIdString DEG_UNIQUE_ID
AdornOps=setsystime DEG_TOKENCREATE_TIMESTAMP
AdornOps=setsystime DEG_AUTH_TIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_COMPANION_TOKENS"
#RFE75 fix related files.
#New header attribute 'user-agent' added as part of http request from the device.
#iOS device sends specific User-Agent strings that can identify the specific device and version of iOS.
AdornOps=copy DEG_OEMDevUserAgentString DEG_USER_AGENT

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/110.UpdateCompanionTokenTable]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=225D.DEG21UpdateCompanionTokenRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/200.InitVaraibles]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_SERVICETOKEN_STATUS DEG_SERVICETOKEN_STATUS
AdornOps=copy DEG_UNIQUE_ID CUST_VOWIFI_IN_PrevUniqueIDString
AdornOps=copy DEG_UNIQUE_ID DEG_UNIQUE_ID
AdornOps=setsystime DEG_TOKENCREATE_TIMESTAMP
AdornOps=setsystime DEG_AUTH_TIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_COMPANION_TOKENS"
#RFE75 fix related files.
#New header attribute 'user-agent' added as part of http request from the device.
#iOS device sends specific User-Agent strings that can identify the specific device and version of iOS.
AdornOps=copy DEG_OEMDevUserAgentString DEG_USER_AGENT

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/210.UpdateCompanionTokenTable]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=225D.DEG21UpdateCompanionTokenRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/310.UpdateCompanionTokenTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitCompanionTokesUpdate
RuleNames=200.ExecuteCompanionTokensUpdate

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/310.UpdateCompanionTokenTable/100.InitCompanionTokesUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_SERVICETOKEN_STATUS "AE"
AdornOps=copy DEG_UNIQUE_ID CUST_VOWIFI_IN_PrevUniqueIDString
AdornOps=copy DEG_OEMDevUniqueIdString DEG_UNIQUE_ID
AdornOps=setsystime DEG_TOKENCREATE_TIMESTAMP
AdornOps=setsystime DEG_AUTH_TIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_COMPANION_TOKENS"
#RFE75 fix related files.
#New header attribute 'user-agent' added as part of http request from the device.
#iOS device sends specific User-Agent strings that can identify the specific device and version of iOS.
AdornOps=copy DEG_OEMDevUserAgentString DEG_USER_AGENT

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/310.UpdateCompanionTokenTable/200.ExecuteCompanionTokensUpdate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=225D.DEG21UpdateCompanionTokenRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/330.UpdateIMSDataTable]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=225F.DEG21UpdateIMSDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/340.DeleteDeviceDataTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitDeviceDataDelete
RuleNames=200.Lookupsession
RuleNames=300.ChcekIfKeyExists

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/340.DeleteDeviceDataTable/100.InitDeviceDataDelete]

AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevCompanionDeviceUniqueIDString DEG_UNIQUE_ID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/340.DeleteDeviceDataTable/200.Lookupsession]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
MapAttributes=DEG_ENTITLEMENT_NAME,DEG_ENTITLEMENT_NAME
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/340.DeleteDeviceDataTable/300.ChcekIfKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExistFlag
TrueRuleChain=110.SetErrorLogInfo
TrueRuleChain=110.PrintError

[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/340.DeleteDeviceDataTable/300.ChcekIfKeyExists/110.SetErrorLogInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0207"
AdornOps=set DEG_OEMDevErrorMessageString "Processing OEM action:"


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/340.DeleteDeviceDataTable/300.ChcekIfKeyExists/110.PrintError]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevUniqueIDString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: while looking up in DEG_DEVICE_DATA table
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/340.DeleteDeviceDataTable/300.ChcekIfKeyExists/200.CheckKeyExistFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
TrueRuleChain=DeleteSessionRule


[/templates/DEG/DeviceInterface/Common_V2Core/ReferenceDataService/DEG_COMPANION_TOKENS_SECONDARYDEVICE/ResultRowRule/200.CheckServiceToken/200.CheckTokenExpiration/200.CompanionTokenNotExpired/340.DeleteDeviceDataTable/300.ChcekIfKeyExists/200.CheckKeyExistFlag/DeleteSessionRule]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
SessionStore=DEG_DEVICE_DATA_SessionStore
NativeCondition=2.MatchByUniqueId


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains]


RuleChainNames=223.DEG20ProcessOEMRequestRuleChain
RuleChainNames=223A.DEG20ValidateBodyRuleChain
RuleChainNames=223B.DEG20ProcessActionRuleChain
RuleChainNames=223D.DEG20SslSessionLookupStatusRuleChain
RuleChainNames=223E.DEG20NewRequest_CheckSslSessionStatusRuleChain
RuleChainNames=223F.DEG20RequestOk_CheckSslSessionStatusRuleChain
RuleChainNames=223G.DEG20UnknownSubscriber_ProcessActionRuleChain
RuleChainNames=223H.DEG20BlackListedSubscriber_ProcessActionRuleChain
RuleChainNames=223I.DEG20Authenticated_ProcessActionRuleChain
RuleChainNames=223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain
RuleChainNames=223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain
RuleChainNames=223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain
RuleChainNames=223M.DEG20UpdateSslSessionStateRuleChain
RuleChainNames=233N.DEG21ServiceToken_ValidateAndGenerateResponseRuleChain
RuleChainNames=223T.DEG20ReGenSTAndUpdateDBRuleChain
RuleChainNames=223O.DEG30GetDeviceDataRuleChain
RuleChainNames=007.DEG20ReadEntitlementFCMappingNameRuleChain
RuleChainNames=008.DEG20ReadCompanionDataRuleChain
RuleChainNames=009.DEG21ReadCompanionDataRuleChain
RuleChainNames=010.DEG21ReadDeviceDataRuleChain
RuleChainNames=650.DEG20GenerateAuditAndNRBEventsRuleChain
RuleChainNames=651.DEG20DumpMonitoringTransactionsRuleChain

##QXCM1001472893: Enable/Disable and Update push notification actions customization defect,SOAP connections in custom template has been removed

RuleChainNames=006.UpdateDEGTokensTable
RuleChainNames=010.InvokeExternalCarrierRuleChain

###QXCM1001434190###
###Added below rule chain to display data in historical only###

RuleChainNames=652.DEG20GenerateAuditAndNRBEventsRuleChainHistoryOnly

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ExtractAndLogActionDetails
RuleNames=110.CheckHealthCheckAction
RuleNames=200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber
RuleNames=300.ValidateBody
RuleNames=400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber
RuleNames=500.ResetSSLSessionStatus
RuleNames=600.UnknownSubscriberProcessAction
RuleNames=610.StatusDisallowedProcessAction
RuleNames=650.BlackListSubscriberProcessAction
RuleNames=700.ProcessAction


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/100.ExtractAndLogActionDetails]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.ExtractActionDetails
RuleNames=001.SetErrorInfo
RuleNames=002.LogStartOfActionProcessing

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/100.ExtractAndLogActionDetails/000.ExtractActionDetails]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
StructuredNMEToNMEMap=request_id.CData,DEG_OEMDevRequestIdString
StructuredNMEToNMEMap=action_name.CData,DEG_OEMDevActionNameString
StructuredNMEToNMEMap=token.CData,DEG_OEMDevRespTokenString

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/100.ExtractAndLogActionDetails/001.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0208"
AdornOps=set DEG_OEMDevMessageString "Processing OEM action:"
AdornOps=setifnull DEG_OEMDevActionNameString ""
AdornOps=copy DEG_OEMDevActionNameString DEG_AuditTransactionTypeString

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/100.ExtractAndLogActionDetails/002.LogStartOfActionProcessing]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevRespTokenString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
LogLevel=DEBUG
Message=Processing OEM action: 
NullAlso=true
PropertyName=LogRequestInOutLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/110.CheckHealthCheckAction]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,"healthCheck"

TrueRuleChain=100.InitResponse
TrueRuleChain=200.SetSuccessResponse

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/110.CheckHealthCheckAction/100.InitResponse]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 200
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_OEMDevRespStatusString 6000

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/110.CheckHealthCheckAction/200.SetSuccessResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"

Operations=or,or

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/200.ResetProcessedIntegerFlagForUnknownAndBlackListSubscriber/TrueRule]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 0

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/300.ValidateBody]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223A.DEG20ValidateBodyRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"

Operations=or,or

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/400.SetProcessedIntegerFlagForUnknownAndBlackListSubscriber/TrueRule]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/500.ResetSSLSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,!=,0
Conditions=DEG_SSL_STATE,!=,"WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA"
Conditions=DEG_SSL_STATE,!=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,!=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,!=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,!=,"DISALLOWED_ACTION"
Operations=and,and,and,and,and
TrueRuleChain=100.ResetSslStateToNew

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/500.ResetSSLSessionStatus/100.ResetSslStateToNew]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_STATE "NEW"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/600.UnknownSubscriberProcessAction]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
TrueRuleChain=100.SetUnknowSubscriberResponse
TrueRuleChain=110.SendUnknowSubscriberResponse

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/600.UnknownSubscriberProcessAction/100.SetUnknowSubscriberResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/600.UnknownSubscriberProcessAction/110.SendUnknowSubscriberResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/610.StatusDisallowedProcessAction]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
TrueRuleChain=100.SetDisallowedActionResponse
TrueRuleChain=110.SendDisallowedActionResponse

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/610.StatusDisallowedProcessAction/100.SetDisallowedActionResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/610.StatusDisallowedProcessAction/110.SendDisallowedActionResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/650.BlackListSubscriberProcessAction]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
TrueRuleChain=100.SetBlackListSubscriberResponse
TrueRuleChain=110.SendBlackListSubscriberResponse

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/650.BlackListSubscriberProcessAction/100.SetBlackListSubscriberResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/650.BlackListSubscriberProcessAction/110.SendBlackListSubscriberResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223.DEG20ProcessOEMRequestRuleChain/700.ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223B.DEG20ProcessActionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ValidateBody

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

Operations=DoAll

TrueRuleChain=CheckIfRequestIdIsPopulated
TrueRuleChain=CheckIfActionNameIsPopulated
TrueRuleChain=ValidateRequestList
TrueRuleChain=CreateRequestList
TrueRuleChain=ValidateRequestAction
TrueRuleChain=CreateRequestActionList

CheckIfRequestIdIsPopulated=100.CheckIfRequestIdIsPopulated
CheckIfActionNameIsPopulated=200.CheckIfActionNameIsPopulated
ValidateRequestList=300.CheckRequestList
CreateRequestList=400.AddRequestToList
ValidateRequestAction=500.CheckRequestActionList
CreateRequestActionList=600.AddRequestActionToList

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/100.CheckIfRequestIdIsPopulated]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestIdString,=,""
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/100.CheckIfRequestIdIsPopulated/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0209"
AdornOps=set DEG_OEMDevErrorMessageString "Request Id is empty"


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/100.CheckIfRequestIdIsPopulated/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid OEM action - request-id is empty: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Request-ID should not be empty which is present in the request .

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/100.CheckIfRequestIdIsPopulated/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/100.CheckIfRequestIdIsPopulated/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/200.CheckIfActionNameIsPopulated]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,""
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
#KPI report statistics is based on the action name in the request.As action name is empty, audits are not required.Since its not counted #in KPI report.
#TrueRuleChain=120.GenerateStartAudit
#TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/200.CheckIfActionNameIsPopulated/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0210"
AdornOps=set DEG_OEMDevErrorMessageString "Action name is empty"


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/200.CheckIfActionNameIsPopulated/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid OEM action - action-name is empty: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/200.CheckIfActionNameIsPopulated/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/200.CheckIfActionNameIsPopulated/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/300.CheckRequestList]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_OEMDevRequestIdList
RuleChain=100.CompareRequestId
TmpAttributeName=DEG_OEMDevTemp1String

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/300.CheckRequestList/100.CompareRequestId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestIdString,=,DEG_OEMDevTemp1String
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/300.CheckRequestList/100.CompareRequestId/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0211"
AdornOps=set DEG_OEMDevErrorMessageString "Duplicate request-id"


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/300.CheckRequestList/100.CompareRequestId/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - duplicate request-id: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Request-id present in the request should be unique.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/300.CheckRequestList/100.CompareRequestId/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/300.CheckRequestList/100.CompareRequestId/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/400.AddRequestToList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevRequestIdString
ListAttribute=DEG_OEMDevRequestIdList


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/500.CheckRequestActionList]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_OEMDevActionNameList
RuleChain=100.CompareActionName
TmpAttributeName=DEG_OEMDevTemp1String

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/500.CheckRequestActionList/100.CompareActionName]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,DEG_OEMDevTemp1String
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/500.CheckRequestActionList/100.CompareActionName/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0212"
AdornOps=set DEG_OEMDevErrorMessageString "Duplicate request action"


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/500.CheckRequestActionList/100.CompareActionName/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - duplicate request action: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Action Name present in the request should be unique.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/500.CheckRequestActionList/100.CompareActionName/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/500.CheckRequestActionList/100.CompareActionName/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223A.DEG20ValidateBodyRuleChain/100.ValidateBody/600.AddRequestActionToList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevActionNameString
ListAttribute=DEG_OEMDevActionNameList

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223B.DEG20ProcessActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ProcessAction

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223B.DEG20ProcessActionRuleChain/100.ProcessAction]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.LookUpSslSession
TrueRuleChain=120.CheckSslSessionLookupStatus

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223B.DEG20ProcessActionRuleChain/100.ProcessAction/100.LookUpSslSession]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevNeedLookUPSessionInteger,=,1
TrueRuleChain=100.InitSslSessionLookup
TrueRuleChain=110.ExecuteSslSessionLookup
TrueRuleChain=120.BackUPSessionFlags
FalseRuleChain=200.CopyToSSFlags

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223B.DEG20ProcessActionRuleChain/100.ProcessAction/100.LookUpSslSession/200.CopyToSSFlags]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevSSTempErrorFlagInteger DEG_CDevSessionStoreErrorFlagInteger
AdornOps=copy DEG_CDevSSTempKeyExistsFlagInteger DEG_CDevSessionStoreKeyExistsFlagInteger

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223B.DEG20ProcessActionRuleChain/100.ProcessAction/100.LookUpSslSession/100.InitSslSessionLookup]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_OEMDevNeedLookUPSessionInteger 0

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223B.DEG20ProcessActionRuleChain/100.ProcessAction/100.LookUpSslSession/110.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
MapAttributes=DEG_SSL_ID_PROV_STATUS,DEG_SSL_ID_PROV_STATUS
MapAttributes=DEG_SSL_GW_ADDR,DEG_SSL_GW_ADDR
MapAttributes=DEG_SSL_ADDRESS_UPDATE_URL,DEG_SSL_ADDRESS_UPDATE_URL
MapAttributes=DEG_SSL_ADDRESS_STATUS,DEG_SSL_ADDRESS_STATUS
MapAttributes=DEG_SSL_TC_STATUS,DEG_SSL_TC_STATUS
MapAttributes=DEG_SSL_POSTDATA,DEG_SSL_POSTDATA
MapAttributes=DEG_SSL_EntitlementStatus,DEG_SSL_EntitlementStatus
MapAttributes=DEG_SSL_COMPANION_DEVICE_COUNT,DEG_SSL_COMPANION_DEVICE_COUNT
MapAttributes=DEG_SSL_CUSTOM_FIELD,DEG_SSL_CUSTOM_FIELD
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223B.DEG20ProcessActionRuleChain/100.ProcessAction/100.LookUpSslSession/120.BackUPSessionFlags]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevSessionStoreErrorFlagInteger DEG_CDevSSTempErrorFlagInteger
AdornOps=copy DEG_CDevSessionStoreKeyExistsFlagInteger DEG_CDevSSTempKeyExistsFlagInteger

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223B.DEG20ProcessActionRuleChain/100.ProcessAction/120.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223D.DEG20SslSessionLookupStatusRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SslSessionLookup

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup]


ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_SSL_REQUEST_STATE,=,"NEW"
Conditions=DEG_SSL_REQUEST_STATE,within,[400C,500C]
Conditions=DEG_SSL_REQUEST_STATE,within,[200,200C]
Conditions=DEG_SSL_REQUEST_STATE,=,DEG_SSL_REQUEST_STATE
Operations=None

TrueRuleChain=SystemError
TrueRuleChain=NoSslSession
TrueRuleChain=NewRequest
TrueRuleChain=RequestError
TrueRuleChain=RequestOk
TrueRuleChain=UnknownStatus

SystemError=095.SetErrorInfo
SystemError=100.SystemErrorLog
SystemError=110.SetSslRequestState_500C
SystemError=120.GenerateStartAudit
SystemError=130.GenerateErrorEndAudit

NoSslSession=190.SetErrorInfo
NoSslSession=200.NoSslSessionLog
NoSslSession=210.SetSslRequestState_500C
NoSslSession=220.GenerateStartAudit
NoSslSession=230.GenerateErrorEndAudit

NewRequest=310.InitGateWayAddress
NewRequest=300.NewRequest_CheckSslSessionStatus

RequestError=355.RequestErrorInfo
RequestError=400.RequestErrorLog

RequestOk=500.RequestOk_CheckSslSessionStatus

UnknownStatus=590.SetErrorInfo
UnknownStatus=600.UnknownStatusLog
UnknownStatus=610.SetSslRequestState_500C

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/095.SetErrorInfo]
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0213"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_SSL_SESSION table"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/100.SystemErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access DEG_SSL_SESSION table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/110.SetSslRequestState_500C]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "500C"

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/190.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0214"
AdornOps=set DEG_OEMDevErrorMessageString "Internal system error as SSL Session does exist in DEG_SSL_SESSION store"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/200.NoSslSessionLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Internal system error as SSL Session does exist in DEG_SSL_SESSION store: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/210.SetSslRequestState_500C]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "500C"

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/220.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/230.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/310.InitGateWayAddress]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_SSL_GW_ADDR DEG_OEMDevGatewayAddressString

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/300.NewRequest_CheckSslSessionStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223E.DEG20NewRequest_CheckSslSessionStatusRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/355.RequestErrorInfo]
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0215"
AdornOps=set DEG_OEMDevErrorMessageString "Skipping processing OEM action - request is in error state:"


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/400.RequestErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Skipping processing OEM action - request is in error state: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/500.RequestOk_CheckSslSessionStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223F.DEG20RequestOk_CheckSslSessionStatusRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/590.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0216"
AdornOps=set DEG_OEMDevErrorMessageString "SSL SESSION is in unrecognized state"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/600.UnknownStatusLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Action processed with error - SSL SESSION is in unrecognized state: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223D.DEG20SslSessionLookupStatusRuleChain/100.SslSessionLookup/610.SetSslRequestState_500C]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "500C"


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223E.DEG20NewRequest_CheckSslSessionStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.NewRequest_Check

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223E.DEG20NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_SSL_STATE,=,"NEW"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE

TrueRuleChain=NewSslSession
TrueRuleChain=AkaWait
TrueRuleChain=UnknownSslSessionState

NewSslSession=100.NewSslSession_ProcessAction

AkaWait=200.AkaWait_ProcessAction

UnknownSslSessionState=300.Unknown_UpdateRequestStateTo500C

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223E.DEG20NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/100.NewSslSession_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=210.DEG20ProcessOEMGetAuthenticationRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223E.DEG20NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/200.AkaWait_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=212.DEG20ProcessOEMPostChallengeRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223E.DEG20NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=210.CheckSslSessionUpdateStatus

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223E.DEG20NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/100.InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_REQUEST_STATE "500C"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223E.DEG20NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
#MapAttributes=DEG_SSL_CUSTOM_FIELD,DEG_SSL_CUSTOM_FIELD
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223E.DEG20NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1

TrueRuleChain=097.SetErrorInfo
TrueRuleChain=100.SystemErrorLog
TrueRuleChain=110.GenerateStartAudit
TrueRuleChain=120.GenerateErrorEndAudit
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223E.DEG20NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/097.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0217"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update or access DEG_SSL_SESSION table"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223E.DEG20NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/100.SystemErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223E.DEG20NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/110.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223E.DEG20NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/120.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223E.DEG20NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=90.SetErrorInfo
TrueRuleChain=100.RowNotFound

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223E.DEG20NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists/90.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0218"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION store"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223E.DEG20NewRequest_CheckSslSessionStatusRuleChain/100.NewRequest_Check/300.Unknown_UpdateRequestStateTo500C/210.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.RowNotFound]


ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.RequestOk_Check

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
#Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
Conditions=DEG_SSL_STATE,starts,"AKA_CHALLENGE_REJECTED"
#Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
#Fix for QXCM1001521530 -- Value set in custom template is not reflecting in the getauth response
Conditions=DEG_SSL_STATE,within,[DISALLOWED_ACTION,UNKNOWN_DEVICE]
Conditions=DEG_SSL_STATE,starts,"AUTHENTICATED"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE

TrueRuleChain=UnknownSubscriber
TrueRuleChain=BlackListedSubscriber
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=StatusDisallowed
TrueRuleChain=Authenticated
TrueRuleChain=Unknown

UnknownSubscriber=100.UnknownSubscriber_ProcessAction
BlackListedSubscriber=110.BlackListedSubscriber_ProcessAction

AkaWait=200.AkaWait_InitResponse
AkaWait=210.AkaWait_GenerateResponse

AkaRejected=300.AkaRejected_InitResponse
AkaRejected=310.AkaRejected_GenerateResponse

Authenticated=400.Authenticated_ProcessAction

Unknown=500.Unknown_UpdateRequestStateTo500C

StatusDisallowed=600.DisallowedAction_InitResponse
StatusDisallowed=610.DisallowedAction_GenerateResponse


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/100.UnknownSubscriber_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223G.DEG20UnknownSubscriber_ProcessActionRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/110.BlackListedSubscriber_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223H.DEG20BlackListedSubscriber_ProcessActionRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/200.AkaWait_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/210.AkaWait_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/300.AkaRejected_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/310.AkaRejected_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/600.DisallowedAction_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/610.DisallowedAction_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/400.Authenticated_ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223I.DEG20Authenticated_ProcessActionRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/500.Unknown_UpdateRequestStateTo500C]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=300.CheckSslSessionUpdateStatus

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/500.Unknown_UpdateRequestStateTo500C/100.InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_REQUEST_STATE "500C"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/500.Unknown_UpdateRequestStateTo500C/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
#MapAttributes=DEG_SSL_CUSTOM_FIELD,DEG_SSL_CUSTOM_FIELD
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/500.Unknown_UpdateRequestStateTo500C/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1

TrueRuleChain=099.SetErrorInfo
TrueRuleChain=100.LogError
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/500.Unknown_UpdateRequestStateTo500C/300.CheckSslSessionUpdateStatus/099.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0219"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update or access DEG_SSL_SESSION table"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/500.Unknown_UpdateRequestStateTo500C/300.CheckSslSessionUpdateStatus/100.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/500.Unknown_UpdateRequestStateTo500C/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/500.Unknown_UpdateRequestStateTo500C/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG20GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/500.Unknown_UpdateRequestStateTo500C/300.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=098.ErrorInfo
TrueRuleChain=100.RowNotFound

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/500.Unknown_UpdateRequestStateTo500C/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/098.ErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0220"
AdornOps=set DEG_OEMDevErrorMessageString "Row is not found in DEG_SSL_SESSION table"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223F.DEG20RequestOk_CheckSslSessionStatusRuleChain/100.RequestOk_Check/500.Unknown_UpdateRequestStateTo500C/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.RowNotFound]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store
PropertyName=LogRequestIssueLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223G.DEG20UnknownSubscriber_ProcessActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=200.ExtractActionDetails
RuleNames=300.ValidateAndGenerateResponse
RuleNames=400.UpdateSslSessionState


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223G.DEG20UnknownSubscriber_ProcessActionRuleChain/100.InitWorkingVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 0


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223G.DEG20UnknownSubscriber_ProcessActionRuleChain/200.ExtractActionDetails]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
StructuredNMEToNMEMap=request_id.CData,DEG_OEMDevRequestIdString,""
StructuredNMEToNMEMap=action_name.CData,DEG_OEMDevActionNameString,""

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223G.DEG20UnknownSubscriber_ProcessActionRuleChain/300.ValidateAndGenerateResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223G.DEG20UnknownSubscriber_ProcessActionRuleChain/400.UpdateSslSessionState]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223M.DEG20UpdateSslSessionStateRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223H.DEG20BlackListedSubscriber_ProcessActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=200.ExtractActionDetails
RuleNames=300.ValidateAndGenerateResponse
RuleNames=400.UpdateSslSessionState

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223H.DEG20BlackListedSubscriber_ProcessActionRuleChain/100.InitWorkingVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 0

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223H.DEG20BlackListedSubscriber_ProcessActionRuleChain/200.ExtractActionDetails]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
StructuredNMEToNMEMap=request_id.CData,DEG_OEMDevRequestIdString,""
StructuredNMEToNMEMap=action_name.CData,DEG_OEMDevActionNameString,""

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223H.DEG20BlackListedSubscriber_ProcessActionRuleChain/300.ValidateAndGenerateResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223H.DEG20BlackListedSubscriber_ProcessActionRuleChain/400.UpdateSslSessionState]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223M.DEG20UpdateSslSessionStateRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223I.DEG20Authenticated_ProcessActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=200.ExtractActionDetails
RuleNames=300.ValidateAndGenerateResponse
RuleNames=400.UpdateSslSessionState

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223I.DEG20Authenticated_ProcessActionRuleChain/100.InitWorkingVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=set DEG_SSL_REQUEST_STATE "200C"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223I.DEG20Authenticated_ProcessActionRuleChain/200.ExtractActionDetails]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
StructuredNMEToNMEMap=request_id.CData,DEG_OEMDevRequestIdString,""
StructuredNMEToNMEMap=action_name.CData,DEG_OEMDevActionNameString,""

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223I.DEG20Authenticated_ProcessActionRuleChain/300.ValidateAndGenerateResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223I.DEG20Authenticated_ProcessActionRuleChain/400.UpdateSslSessionState]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=223M.DEG20UpdateSslSessionStateRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223M.DEG20UpdateSslSessionStateRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckSessionDeleted


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223M.DEG20UpdateSslSessionStateRuleChain/100.CheckSessionDeleted]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSSLSSDeletedInteger,=,0
TrueRuleChain=100.InitSslSessionUpdate
TrueRuleChain=200.ExecuteSslSessionUpdate
TrueRuleChain=210.CheckSslSessionUpdateStatus

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223M.DEG20UpdateSslSessionStateRuleChain/100.CheckSessionDeleted/100.InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=setifnull DEG_SSL_CUSTOM_FIELD ""

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223M.DEG20UpdateSslSessionStateRuleChain/100.CheckSessionDeleted/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_CUSTOM_FIELD,DEG_SSL_CUSTOM_FIELD
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223M.DEG20UpdateSslSessionStateRuleChain/100.CheckSessionDeleted/210.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1

TrueRuleChain=50.ErrorInfo
TrueRuleChain=100.LogError
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223M.DEG20UpdateSslSessionStateRuleChain/100.CheckSessionDeleted/210.CheckSslSessionUpdateStatus/50.ErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0221"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update DEG_SSL_SESSION store"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223M.DEG20UpdateSslSessionStateRuleChain/100.CheckSessionDeleted/210.CheckSslSessionUpdateStatus/100.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store while Processing UnknownSubscriber
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223M.DEG20UpdateSslSessionStateRuleChain/100.CheckSessionDeleted/210.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=96.SetErrorInfo
TrueRuleChain=100.RowNotFound

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223M.DEG20UpdateSslSessionStateRuleChain/100.CheckSessionDeleted/210.CheckSslSessionUpdateStatus/200.CheckKeyExists/96.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0222"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find the row in DEG_SSL_SESSION store while Processing UnknownSubscriber"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223M.DEG20UpdateSslSessionStateRuleChain/100.CheckSessionDeleted/210.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.RowNotFound]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store while Processing UnknownSubscriber
PropertyName=LogRequestIssueLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.UnknownSubscriber_ValidateAndGenerateResponse

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=CheckIfRequestIdIsPopulated
TrueRuleChain=CheckIfActionNameIsPopulated
TrueRuleChain=CheckIfUnqIdAndAction
TrueRuleChain=InitResponse
TrueRuleChain=GenerateResponse

CheckIfRequestIdIsPopulated=100.CheckIfRequestIdIsPopulated

CheckIfActionNameIsPopulated=200.CheckIfActionNameIsPopulated

CheckIfUnqIdAndAction=300.CheckIfUnqIdAndAction

InitResponse=400.AddActionToList
InitResponse=410.InitResponse

GenerateResponse=500.GenerateResponse

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated]


ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestIdString,=,""
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0223"
AdornOps=set DEG_OEMDevErrorMessageString "Request Id is empty"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - request-id is empty
PropertyName=LogRequestIssueLevel1
UseProperty=true

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,""
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0224"
AdornOps=set DEG_OEMDevErrorMessageString "Action name is empty"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - action-name is empty
PropertyName=LogRequestIssueLevel1
UseProperty=true

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitValues
RuleNames=110.CheckListAttr

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/100.InitValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevRequestIdString DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString _ DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString DEG_OEMDevActionNameString DEG_OEMDevRequestIdAndNameString

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_OEMDevRequestIdAndNameList
RuleChain=100.CompareRequestName
TmpAttributeName=DEG_OEMDevTmpRequestIdAndNameString

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestIdAndNameString,=,DEG_OEMDevTmpRequestIdAndNameString
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0225"
AdornOps=set DEG_OEMDevErrorMessageString "Duplicate request-id or Action Name"


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=WARNING
Message=Request processed with error -  not unique request-id and request-name
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/400.AddActionToList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevRequestIdAndNameString
ListAttribute=DEG_OEMDevRequestIdAndNameList

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/410.InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223J.DEG20UnknownSubscriber_ValidateAndGenerateResponseRuleChain/100.UnknownSubscriber_ValidateAndGenerateResponse/500.GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.BlackListedSubscriber_ValidateAndGenerateResponse

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=CheckIfRequestIdIsPopulated
TrueRuleChain=CheckIfActionNameIsPopulated
TrueRuleChain=CheckIfUnqIdAndAction
TrueRuleChain=InitResponse
TrueRuleChain=GenerateResponse

CheckIfRequestIdIsPopulated=100.CheckIfRequestIdIsPopulated

CheckIfActionNameIsPopulated=200.CheckIfActionNameIsPopulated

CheckIfUnqIdAndAction=300.CheckIfUnqIdAndAction

InitResponse=400.AddActionToList
InitResponse=410.InitResponse

GenerateResponse=500.GenerateResponse

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestIdString,=,""
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0226"
AdornOps=set DEG_OEMDevErrorMessageString "Request Id is empty"


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - request-id is empty
PropertyName=LogRequestIssueLevel1
UseProperty=true

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,""
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0227"
AdornOps=set DEG_OEMDevErrorMessageString "Action name is empty"


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - action-name is empty
PropertyName=LogRequestIssueLevel1
UseProperty=true

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitValues
RuleNames=110.CheckListAttr

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/100.InitValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevRequestIdString DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString _ DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString DEG_OEMDevActionNameString DEG_OEMDevRequestIdAndNameString


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_OEMDevRequestIdAndNameList
RuleChain=100.CompareRequestName
TmpAttributeName=DEG_OEMDevTmpRequestIdAndNameString


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestIdAndNameString,=,DEG_OEMDevTmpRequestIdAndNameString
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0228"
AdornOps=set DEG_OEMDevErrorMessageString "Duplicate request-id or Action Name"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=WARNING
Message=Request processed with error -  not unique request-id and request-name
PropertyName=LogRequestIssueLevel1
UseProperty=true

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/400.AddActionToList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevRequestIdAndNameString
ListAttribute=DEG_OEMDevRequestIdAndNameList

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/410.InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223K.DEG20BlackListedSubscriber_ValidateAndGenerateResponseRuleChain/100.BlackListedSubscriber_ValidateAndGenerateResponse/500.GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.Authenticated_ValidateAndGenerateResponse

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse]


ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=CheckIfRequestIdIsPopulated
TrueRuleChain=CheckIfActionNameIsPopulated
TrueRuleChain=CheckIfUnqIdAndAction
TrueRuleChain=InitResponse

CheckIfRequestIdIsPopulated=100.CheckIfRequestIdIsPopulated

CheckIfActionNameIsPopulated=200.CheckIfActionNameIsPopulated

CheckIfUnqIdAndAction=300.CheckIfUnqIdAndAction

InitResponse=400.AddActionToList
InitResponse=410.IdentifyActionTypeAndProcess

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestIdString,=,""
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0229"
AdornOps=set DEG_OEMDevErrorMessageString "Request Id is empty"


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/100.CheckIfRequestIdIsPopulated/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - request-id is empty
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,""
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0230"
AdornOps=set DEG_OEMDevErrorMessageString "Action name is empty"


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/200.CheckIfActionNameIsPopulated/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - action-name is empty
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitValues
RuleNames=110.CheckListAttr


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/100.InitValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevRequestIdString DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString _ DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString DEG_OEMDevActionNameString DEG_OEMDevRequestIdAndNameString

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_OEMDevRequestIdAndNameList
RuleChain=100.CompareRequestName
TmpAttributeName=DEG_OEMDevTmpRequestIdAndNameString

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestIdAndNameString,=,DEG_OEMDevTmpRequestIdAndNameString
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0231"
AdornOps=set DEG_OEMDevErrorMessageString "Duplicate request-id or Action Name"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/300.CheckIfUnqIdAndAction/110.CheckListAttr/100.CompareRequestName/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error -  not unique request-id and request-name
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Request-id and Request -Name are not unique in the Request parameter.


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/400.AddActionToList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevRequestIdAndNameString
ListAttribute=DEG_OEMDevRequestIdAndNameList

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_OEMDevActionNameString,within,[getAuthentication,postChallenge]
Conditions=DEG_OEMDevActionNameString,=,"getPhoneNumber"
Conditions=DEG_OEMDevActionNameString,=,"getEntitlement"
Conditions=DEG_OEMDevActionNameString,=,"updatePushToken"
Conditions=DEG_OEMDevActionNameString,=,"getSubscriptionAndUsageStatus"
Conditions=DEG_OEMDevActionNameString,=,"setProvisioning"
Conditions=DEG_OEMDevActionNameString,=,"getProvisioning"
Conditions=DEG_OEMDevActionNameString,=,"getPhoneServicesAccountStatus"
Conditions=DEG_OEMDevActionNameString,=,"enablePushNotification"
Conditions=DEG_OEMDevActionNameString,=,"disablePushNotification"
Conditions=DEG_OEMDevActionNameString,=,"setEntitlement"
Conditions=DEG_OEMDevActionNameString,=,"getEmergencyAddressInfo"
Conditions=DEG_OEMDevActionNameString,=,"getSIMStatus"
Conditions=DEG_OEMDevActionNameString,=,"signUpForSIMService"
Conditions=DEG_OEMDevActionNameString,=,"getPreferredRoamingNetworks"
Conditions=DEG_OEMDevActionNameString,=,"getCarrierSpaceUpdates"
Conditions=DEG_OEMDevActionNameString,=,"updateAccountWithFeatureOrService"
Conditions=DEG_OEMDevActionNameString,=,DEG_OEMDevActionNameString


TrueRuleChain=AUTH
TrueRuleChain=GPN
TrueRuleChain=GE
TrueRuleChain=UPT
TrueRuleChain=GSAUS
TrueRuleChain=SetProvision
TrueRuleChain=getProvision
TrueRuleChain=GPSAS
TrueRuleChain=EPN
TrueRuleChain=DPN
TrueRuleChain=SetEntitlement
TrueRuleChain=GEAI
TrueRuleChain=getSIMStatus
TrueRuleChain=signUpForSIMService
TrueRuleChain=GPRN
TrueRuleChain=GCSU
TrueRuleChain=UAWFOS
TrueRuleChain=Unknown


AUTH=100.AUTH_InitResponse
AUTH=110.AUTH_GenerateResponseEntry


GPN=200.ProcessGetPhoneNumberAction

GE=300.ProcessGetEntitlementAction

UPT=400.ProcessUpdatePushTokenAction

GSAUS=500.ProcessGetSubscriptionAndUsageStatusAction
SetEntitlement=550.ProcessSetEntitlementAction

Unknown=600.Unknown_InitResponse
Unknown=610.Unknown_GenerateResponseEntry

GCSU=800.ProcessGetCarrierSpaceUpdates
UAWFOS=900.ProcessUpdateAccountWithFeatureOrService
SetProvision=700.ProcessSetProvisioningAction
getProvision=800.ProcessGetProvisioningAction
GPSAS=900.ProcessGetPhoneServicesAccountStatusAction
EPN=1000.ProcessEnablePushNotificationAction
DPN=1100.ProcessDisablePushNotification
GEAI=1200.GetEmergencyAddressInfo
getSIMStatus=1300.ProcessGetSIMStatus
signUpForSIMService=1400.ProcessSignUpforSIMService
GPRN=1500.ProcessGetPreferredRoamingNetworks



[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/900.ProcessUpdateAccountWithFeatureOrService]


ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=334.ProcessOEMUpdateAccountWithFeatureOrService
UseRuleChainManagerPool=true





[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/800.ProcessGetCarrierSpaceUpdates]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=515.ProcessOEMGetCarrierSpaceUpdatesRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/1500.ProcessGetPreferredRoamingNetworks]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=230.DEG32ProcessOEMGetPreferredRoamingNetworksRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/1300.ProcessGetSIMStatus]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=215.DEG31ProcessOEMGetSIMStatusRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/1400.ProcessSignUpforSIMService]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=100.DEG31ProcessSignupForSimServiceRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/1200.GetEmergencyAddressInfo]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=100.DEG23ProcessOEMGetEmergencyAddressInfoRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/1100.ProcessDisablePushNotification]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=221.DEG20ProcessOEMDisablePushNotificationRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/900.ProcessGetPhoneServicesAccountStatusAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=218.DEG20ProcessOEMGetPhoneServicesAccountStatusRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/700.ProcessSetProvisioningAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=219.DEG20ProcessOEMSetProvisioningRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/800.ProcessGetProvisioningAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=217.DEG20ProcessOEMGetProvisioningRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/1000.ProcessEnablePushNotificationAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=220.DEG20ProcessOEMEnablePushNotificationRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/100.AUTH_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/110.AUTH_GenerateResponseEntry]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/200.ProcessGetPhoneNumberAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=213.DEG20ProcessOEMGetPhoneNumberRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/300.ProcessGetEntitlementAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=214.DEG20ProcessOEMGetEntitlementRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/400.ProcessUpdatePushTokenAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=215.DEG20ProcessOEMUpdatePushTokenRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/500.ProcessGetSubscriptionAndUsageStatusAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=216.DEG20ProcessOEMGetSubscriptionAndUsageStatusRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/600.Unknown_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6001


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/610.Unknown_GenerateResponseEntry]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223L.DEG20Authenticated_ValidateAndGenerateResponseRuleChain/100.Authenticated_ValidateAndGenerateResponse/410.IdentifyActionTypeAndProcess/550.ProcessSetEntitlementAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=214.DEG20ProcessOEMSetEntitlementRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVar
RuleNames=200.SetEntitlementDeviceType
RuleNames=120.ProceesFeatureCode
RuleNames=120.UpdateDEGSSLSessionTable

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/100.InitVar]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevSubscriberEntitlementFeatureString ""

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/200.SetEntitlementDeviceType]

SetDeviceTypeToPrimary=100.SetDeviceTypeToPrimary
SetDeviceTypeToCompanion=200.SetDeviceTypeToCompanion
SetDeviceTypeToPrimary4GBA=100.SetDeviceTypeToPrimary
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevAuthTypeString,=,"EAP-AKA"
Conditions=DEG_OEMDevAuthTypeString,=,"none"
Conditions=DEG_OEMDevAuthTypeString,=,"GBA"
Conditions=DEG_OEMDevAuthTypeString,=,DEG_OEMDevAuthTypeString
TrueRuleChain=SetDeviceTypeToPrimary
TrueRuleChain=SetDeviceTypeToCompanion
TrueRuleChain=SetDeviceTypeToPrimary4GBA
TrueRuleChain=Unknown
Unknown=310.SetLogInfo
Unknown=310.UnknownErrorLog

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/200.SetEntitlementDeviceType/100.SetDeviceTypeToPrimary]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_ENTITLEMENT_DEVICETYPE "Primary"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/200.SetEntitlementDeviceType/200.SetDeviceTypeToCompanion]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_ENTITLEMENT_DEVICETYPE "Companion"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/200.SetEntitlementDeviceType/310.SetLogInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0232"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid getAuthentication action"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/200.SetEntitlementDeviceType/310.UnknownErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid getAuthentication action - auth-type attribute must be EAK-AKA or none: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=During getAuthentication action - auth-type attribute must be EAK-AKA or should be NONE.

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.ProceesFeatureCode]

ClassName=com.hp.siu.collector.rules.RuleChain
#RuleNames=000.Init
RuleNames=100.CallCustomTemplate
#RuleNames=100.CopyCustomToCore
RuleNames=100.ExtractEntitlementName

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.ProceesFeatureCode/000.Init]

AdornOps=copy tmp_FEATCODE DEG_FEATCODE
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.ProceesFeatureCode/100.CallCustomTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_Apple_GE_EntitlementStatus
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.ProceesFeatureCode/100.ExtractEntitlementName]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitArrayIndex
RuleNames=200.ProcessEntitlementNames
#RuleNames=300.Log

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.ProceesFeatureCode/100.ExtractEntitlementName/100.InitArrayIndex]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevArrayIndexInteger -1
AdornOps=set DEG_OEMDevEntitlementNameListToStr ""

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.ProceesFeatureCode/100.ExtractEntitlementName/200.ProcessEntitlementNames]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_OEMDevEntitlementNameList
RuleChain=100.IncrementArrayIndex
RuleChain=110.PrintEntitlementMessage
RuleChain=120.CheckEntitlementDeviceType
TmpAttributeName=DEG_OEMDevEntitlementNameString

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.ProceesFeatureCode/100.ExtractEntitlementName/200.ProcessEntitlementNames/100.IncrementArrayIndex]

AdornOps=+ DEG_OEMDevArrayIndexInteger 1 DEG_OEMDevArrayIndexInteger
AdornOps=set DEG_OEMDevEntitlementStatusInteger 0
AdornOps=copy DEG_OEMDevEntitlementNameString DEG_DEVICE_ENTITLEMENT
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0233"
AdornOps=set DEG_OEMDevErrorMessageString "Feature Code to Entitlement"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.ProceesFeatureCode/100.ExtractEntitlementName/200.ProcessEntitlementNames/110.PrintEntitlementMessage]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_FEATCODE
Attributes=DEG_OEMDevSubscriberEntitlementFeatureString
Attributes=DEG_OEMDevDeviceTypeString
Attributes=DEG_ENTITLEMENT_DEVICETYPE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Feature Code to Entitlement :
PropertyName=LogRequestIssueLevel1
UseProperty=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.ProceesFeatureCode/100.ExtractEntitlementName/200.ProcessEntitlementNames/120.CheckEntitlementDeviceType]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_ENTITLEMENT_DEVICETYPE,within,[Primary,Common]
Conditions=DEG_ENTITLEMENT_DEVICETYPE,within,[Companion,Common]

TrueRuleChain=PR
TrueRuleChain=CR

PR=10.CheckPrimaryDeviceType
CR=20.CheckCompanionDeviceType
Operations=None


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.ProceesFeatureCode/100.ExtractEntitlementName/200.ProcessEntitlementNames/120.CheckEntitlementDeviceType/10.CheckPrimaryDeviceType]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevDeviceTypeString,=,Primary
TrueRuleChain=100.InsertRowForPrimaryDevice


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.ProceesFeatureCode/100.ExtractEntitlementName/200.ProcessEntitlementNames/120.CheckEntitlementDeviceType/10.CheckPrimaryDeviceType/100.InsertRowForPrimaryDevice]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=210E.DEG20CheckDeviceDataTableRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.ProceesFeatureCode/100.ExtractEntitlementName/200.ProcessEntitlementNames/120.CheckEntitlementDeviceType/20.CheckCompanionDeviceType]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevDeviceTypeString,=,Companion
TrueRuleChain=100.InsertRowForCompanionDevice


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.ProceesFeatureCode/100.ExtractEntitlementName/200.ProcessEntitlementNames/120.CheckEntitlementDeviceType/20.CheckCompanionDeviceType/100.InsertRowForCompanionDevice]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=210E.DEG20CheckDeviceDataTableRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.UpdateDEGSSLSessionTable]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberEntitlementFeatureString,!=,""
TrueRuleChain=100.UpdateSSLTable


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.UpdateDEGSSLSessionTable/100.UpdateSSLTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitDEGSSLSessionTable
RuleNames=110.UpdateDEGSSLSessionTable
RuleNames=120.CheckDBErrorFlag


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.UpdateDEGSSLSessionTable/100.UpdateSSLTable/100.InitDEGSSLSessionTable]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=substr 1 length DEG_OEMDevSubscriberEntitlementFeatureString DEG_OEMDevSubscriberEntitlementFeatureString


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.UpdateDEGSSLSessionTable/100.UpdateSSLTable/110.UpdateDEGSSLSessionTable]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_CUSTOM_FIELD,DEG_SSL_CUSTOM_FIELD
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.UpdateDEGSSLSessionTable/100.UpdateSSLTable/120.CheckDBErrorFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.SetErrorLog


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.UpdateDEGSSLSessionTable/100.UpdateSSLTable/120.CheckDBErrorFlag/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevErrorMessageString "Problem in update DEG_SSL_SESSION table."
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0234"


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/007.DEG20ReadEntitlementFCMappingNameRuleChain/120.UpdateDEGSSLSessionTable/100.UpdateSSLTable/120.CheckDBErrorFlag/110.SetErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_SSL_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to Update DEG_SSL_SESSION table
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/008.DEG20ReadCompanionDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReadCompanionDataTable

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/008.DEG20ReadCompanionDataRuleChain/100.ReadCompanionDataTable]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_COMPANION_TOKENS


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/008.DEG20ReadCompanionDataRuleChain/100.ReadCompanionDataTable/ErrorRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/008.DEG20ReadCompanionDataRuleChain/100.ReadCompanionDataTable/NoMatchRule]

#ClassName=com.hp.siu.collector.rules.AdornmentRule
#AdornOps=set DEG_CDevDBNoMatchFlagInteger 1
ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224G.DEG20InsertCompanionTokenRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/009.DEG21ReadCompanionDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReadCompanionDataTable


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/009.DEG21ReadCompanionDataRuleChain/100.ReadCompanionDataTable]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_COMPANION_TOKENS_SECONDARYDEVICE

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/009.DEG21ReadCompanionDataRuleChain/100.ReadCompanionDataTable/ErrorRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/009.DEG21ReadCompanionDataRuleChain/100.ReadCompanionDataTable/NoMatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitResponse
RuleNames=100.NomatchError
RuleNames=100.NoMatchLog
RuleNames=200.UpdateSslSessionState
RuleNames=300.GenerateResponse


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/009.DEG21ReadCompanionDataRuleChain/100.ReadCompanionDataTable/NoMatchRule/100.InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6300
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "200"
AdornOps=set DEG_SSL_STATE "AKA_CHALLENGE_REJECTED_BY_DEG_TOKEN"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/009.DEG21ReadCompanionDataRuleChain/100.ReadCompanionDataTable/NoMatchRule/100.NomatchError]
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0235"
AdornOps=set DEG_OEMDevErrorMessageString "Unmatch Service token"

##QXCM1001417754-Need more detailed info in the log files for 6300 response  for  companion device

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/009.DEG21ReadCompanionDataRuleChain/100.ReadCompanionDataTable/NoMatchRule/100.NoMatchLog]
ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevUniqueIdString
Attributes=DEG_OEMDevServiceTokenString
Attributes=DEG_OEMDevRespStatusString
Attributes=DEG_OEMDevRequestProcessedInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Database does not contain any service token to match:
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/009.DEG21ReadCompanionDataRuleChain/100.ReadCompanionDataTable/NoMatchRule/200.UpdateSslSessionState]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=225E.DEG21UpdateSslSessionStateRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/009.DEG21ReadCompanionDataRuleChain/100.ReadCompanionDataTable/NoMatchRule/300.GenerateResponse]


ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/010.DEG21ReadDeviceDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReadCompanionDataTable

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/010.DEG21ReadDeviceDataRuleChain/100.ReadCompanionDataTable]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_DEVICE_DATA

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/010.DEG21ReadDeviceDataRuleChain/100.ReadCompanionDataTable/ErrorRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/010.DEG21ReadDeviceDataRuleChain/100.ReadCompanionDataTable/NoMatchRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBNoMatchFlagInteger 1


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/650.DEG20GenerateAuditAndNRBEventsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpAuditRecord
RuleNames=200.DumpMonitoringTransactions

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/650.DEG20GenerateAuditAndNRBEventsRuleChain/100.DumpAuditRecord]

ClassName=com.hp.siu.sessionserver.rules.NMEStoreRule
NMEStore=AuditNmeStore


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/650.DEG20GenerateAuditAndNRBEventsRuleChain/200.DumpMonitoringTransactions]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_NrbMonitoringSessionIdList
RequestAttributes=DEG_AuditProcessingNodeString
RequestAttributes=DEG_AuditTimestampLong
RequestAttributes=DEG_AuditInterfaceString
RequestAttributes=DEG_AuditInOutString
RequestAttributes=DEG_AuditResultCodeString
RequestAttributes=DEG_AuditMdnString
RequestAttributes=DEG_AuditIMSIString
RequestAttributes=DEG_AuditTransactionTypeString
RequestAttributes=DEG_AuditSourceDestinationString
RequestAttributes=DEG_AuditNRBMessageString
RequestAttributes=DEG_AuditMessageString
RequestAttributes=DEG_AuditEntitlementNameString
RequestAttributes=DEG_AuditUniqueIDString
RequestAttributes=DEG_AuditSourceDestinationVersionString
RuleChain=651.DEG20DumpMonitoringTransactionsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpMonitoringTransactions

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.DumpMonitoringTransactions

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_NrbMonitoringSessionIdList != null


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_NrbMonitoringSessionIdList
RuleChain=100.InsertMonitoringTransactionToDb
TmpAttributeName=DEG_NrbMonitoringSessionIdString

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORINGID_GENERATOR


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateTransactionId
RuleNames=110.PopulateMonitoringTransactionAttributes
RuleNames=120.InitInsert2Db
RuleNames=200.Insert2Db
RuleNames=300.CheckCreateStatus


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/100.GenerateTransactionId]

AdornOps=setsystime DEG_Tmp1Long
AdornOps=copy DEG_Tmp1Long DEG_Tmp1String
AdornOps=+ DEG_Tmp1String DEG_MSESSIONTRANSID DEG_MSESSIONTRANSID
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/110.PopulateMonitoringTransactionAttributes]

AdornOps=copy DEG_AuditProcessingNodeString DEG_MSESSIONPROCID
AdornOps=copy DEG_AuditTimestampLong DEG_MSESSIONTIMESTAMP
AdornOps=copy DEG_AuditInterfaceString DEG_MSESSIONINTERFACE
AdornOps=copy DEG_AuditInOutString DEG_MSESSIONINOUT
AdornOps=copy DEG_AuditResultCodeString DEG_MSESSIONRESULTCODE
AdornOps=copy DEG_AuditMdnString DEG_MSESSIONMDN
AdornOps=copy DEG_AuditIMSIString DEG_MSESSIONIMSI
AdornOps=copy DEG_AuditTransactionTypeString DEG_MSESSIONTRANSACTIONTYPE
AdornOps=copy DEG_AuditSourceDestinationString DEG_MSESSIONSOURCEDESTINATION
AdornOps=copy DEG_AuditNRBMessageString DEG_MSESSIONMESSAGE
AdornOps=copy DEG_AuditUniqueIDString DEG_MSESSIONUNIQUE_ID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/120.InitInsert2Db]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_NrbMonitoringSessionIdString DEG_MSESSIONID
AdornOps=set log_DB_Operation "CREATE"
AdornOps=set log_Table_Name "DEG_MONITORING_TRANSACTIONS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/200.Insert2Db]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_MONITORING_TRANSACTIONS_SessionStore

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
Operations=or
TrueRuleChain=078.ErrorInfo
TrueRuleChain=100.ErrorLog

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus/078.ErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0236"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to create entry in DEG_MONITORING_TRANSACTIONS table"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus/100.ErrorLog]

Attributes=DEG_MSESSIONID
Attributes=DEG_MSESSIONTRANSID
Attributes=DEG_MSESSIONPROCID
Attributes=DEG_MSESSIONTIMESTAMP
Attributes=DEG_MSESSIONINTERFACE
Attributes=DEG_MSESSIONINOUT
Attributes=DEG_MSESSIONRESULTCODE
Attributes=DEG_MSESSIONMDN
Attributes=DEG_MSESSIONTRANSACTIONTYPE
Attributes=DEG_MSESSIONSOURCEDESTINATION
Attributes=DEG_MSESSIONMESSAGE
Attributes=DEG_MSESSIONUNIQUE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to create entry in DEG_MONITORING_TRANSACTIONS session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetEmptyTransactionId
RuleNames=150.Info
RuleNames=200.Log

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/100.SetEmptyTransactionId]

AdornOps=set DEG_MSESSIONTRANSID ""
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/150.Info]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0237"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to generate unique value of monitoring transaction id"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/200.Log]

Attributes=DEG_MSESSIONTRANSID
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Message=Unable to generate unique value of monitoring transaction id: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

###QXCM1001434190###
###Definition of 652.DEG20GenerateAuditAndNRBEventsRuleChainHistoryOnly###

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/652.DEG20GenerateAuditAndNRBEventsRuleChainHistoryOnly]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpAuditRecord

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/652.DEG20GenerateAuditAndNRBEventsRuleChainHistoryOnly/100.DumpAuditRecord]

ClassName=com.hp.siu.sessionserver.rules.NMEStoreRule
NMEStore=AuditNmeStore


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/233N.DEG21ServiceToken_ValidateAndGenerateResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitResponse
RuleNames=100.NoMatchError
RuleNames=100.NoMatchLog
RuleNames=110.UpdateSslSessionState
RuleNames=120.UpdateCompanionTokenTable
RuleNames=130.TokenExpiredResponse
RuleNames=140.GenerateServiceTokenExpiredEndAuditDataRuleChain

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/233N.DEG21ServiceToken_ValidateAndGenerateResponseRuleChain/140.GenerateServiceTokenExpiredEndAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=802.DEG21GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/233N.DEG21ServiceToken_ValidateAndGenerateResponseRuleChain/100.InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6006
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "200"
AdornOps=set DEG_SSL_STATE "AKA_CHALLENGE_REJECTED_BY_DEG_TOKEN"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/233N.DEG21ServiceToken_ValidateAndGenerateResponseRuleChain/100.NoMatchError]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0238"
AdornOps=set DEG_OEMDevErrorMessageString "Token expired"


## Loginformation when 6006 response for companion device when matching token has been expired

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/233N.DEG21ServiceToken_ValidateAndGenerateResponseRuleChain/100.NoMatchLog]
ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevUniqueIdString
Attributes=DEG_SERVICE_TOKEN
Attributes=DEG_OEMDevServiceTokenString
Attributes=DEG_TOKENCREATE_TIMESTAMP
Attributes=DEG_OEMDevRespStatusString
Attributes=DEG_OEMDevRequestProcessedInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Incoming service token has been expired:
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/233N.DEG21ServiceToken_ValidateAndGenerateResponseRuleChain/110.UpdateSslSessionState]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=225E.DEG21UpdateSslSessionStateRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/233N.DEG21ServiceToken_ValidateAndGenerateResponseRuleChain/120.UpdateCompanionTokenTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitCompanionTokesUpdate
RuleNames=200.ExecuteCompanionTokensUpdate

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/233N.DEG21ServiceToken_ValidateAndGenerateResponseRuleChain/120.UpdateCompanionTokenTable/100.InitCompanionTokesUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_SERVICETOKEN_STATUS "RE"
AdornOps=copy DEG_OEMDevCompanionDeviceUniqueIDString DEG_UNIQUE_ID
#AdornOps=copy DEG_UNIQUE_ID DEG_UNIQUE_ID
AdornOps=copy DEG_TOKENCREATE_TIMESTAMP DEG_TOKENCREATE_TIMESTAMP
AdornOps=setsystime DEG_AUTH_TIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_COMPANION_TOKENS"


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/233N.DEG21ServiceToken_ValidateAndGenerateResponseRuleChain/120.UpdateCompanionTokenTable/200.ExecuteCompanionTokensUpdate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=225D.DEG21UpdateCompanionTokenRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/233N.DEG21ServiceToken_ValidateAndGenerateResponseRuleChain/130.TokenExpiredResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReGenerateAndUpdateDB


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

Operations=DoAll

TrueRuleChain=GenerateServiceToken
TrueRuleChain=DeleteDeviceData
TrueRuleChain=UpdateIMSData
TrueRuleChain=UpdateCompanionToken
TrueRuleChain=AddDeviceIdToList
TrueRuleChain=PopulateServiceTokenResponse

GenerateServiceToken=100.GenerateServiceToken
DeleteDeviceData=200.DeleteDeviceDataTable
UpdateIMSData=300.UpdateIMSDataTable
UpdateCompanionToken=400.UpdateCompanionTokenTable
AddDeviceIdToList=500.AddDeviceIdToList
PopulateServiceTokenResponse=600.PopulateServiceTokenResponse

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/100.GenerateServiceToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
ResponseAttributes=DEG_OEMDevServiceTokenString
RuleChain=210A.DEG20GenerateServiceTokensRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/200.DeleteDeviceDataTable]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_UNIQUE_ID,!=,""
TrueRuleChain=100.InitDeviceDataUpdate
TrueRuleChain=200.DeleteDeviceDataTable
TrueRuleChain=300.CheckDeleteStatus


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/200.DeleteDeviceDataTable/100.InitDeviceDataUpdate]

AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/200.DeleteDeviceDataTable/200.DeleteDeviceDataTable]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
NativeCondition=2.MatchByUniqueId
SessionStore=DEG_DEVICE_DATA_SessionStore
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/200.DeleteDeviceDataTable/300.CheckDeleteStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SystemError_SetResponse
TrueRuleChain=110.SystemError_Log
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/200.DeleteDeviceDataTable/300.CheckDeleteStatus/100.SystemError_SetResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0239"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/200.DeleteDeviceDataTable/300.CheckDeleteStatus/110.SystemError_Log]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Unable to perform delete operation on DEG_DEVICE_DATA table: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/200.DeleteDeviceDataTable/300.CheckDeleteStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/200.DeleteDeviceDataTable/300.CheckDeleteStatus/200.CheckKeyExists/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0240"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/200.DeleteDeviceDataTable/300.CheckDeleteStatus/200.CheckKeyExists/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=DEBUG
Message=Database Error: No data in DEG_DEVICE_DATA session store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true

#QUIX ID:QXCM1001411240::"Primary device request after receiving APNS push Notification that one of the allocated service token is expired".
[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/300.UpdateIMSDataTable]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_UNIQUE_ID,!=,""
TrueRuleChain=100.InitLookup
TrueRuleChain=200.LookupIMSData
TrueRuleChain=300.CheckLookupStatus

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/300.UpdateIMSDataTable/100.InitLookup]

AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_IMS_DATA"
AdornOps=set DEG_DEVICE_ID ""
AdornOps=copy DEG_OEMDevCompanionTokenUniqueIdString DEG_UNIQUE_ID
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/300.UpdateIMSDataTable/200.LookupIMSData]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_DEVICE_ID,DEG_DEVICE_ID
NativeCondition=4.MatchByIMSIAndUniqueId
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_IMS_DATA_SessionStore


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/300.UpdateIMSDataTable/300.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
Operations=None
RowExists=200.InitUpdate
RowExists=210.UpdateIMSData
RowExists=220.CheckUpdateStatus
SystemError=100.SystemError_SetResponse
SystemError=110.SystemError_Log
TrueRuleChain=SystemError
TrueRuleChain=RowExists


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/300.UpdateIMSDataTable/300.CheckLookupStatus/100.SystemError_SetResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0241"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/300.UpdateIMSDataTable/300.CheckLookupStatus/110.SystemError_Log]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Unable to perform lookup or access DEG_IMS_DATA table: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/300.UpdateIMSDataTable/300.CheckLookupStatus/200.InitUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_IMS_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_UNIQUE_ID ""
AdornOps=setsystime DEG_LASTUPDATE
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/300.UpdateIMSDataTable/300.CheckLookupStatus/210.UpdateIMSData]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
MapAttributes=DEG_LASTUPDATE,DEG_LASTUPDATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_IMS_DATA_SessionStore


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/300.UpdateIMSDataTable/300.CheckLookupStatus/220.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SystemError_SetResponse
TrueRuleChain=110.SystemError_Log


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/300.UpdateIMSDataTable/300.CheckLookupStatus/220.CheckUpdateStatus/100.SystemError_SetResponse]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0242"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/300.UpdateIMSDataTable/300.CheckLookupStatus/220.CheckUpdateStatus/110.SystemError_Log]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_UNIQUE_ID
Attributes=DEG_MDN
Attributes=DEG_DEVICE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Unable to perform update or access DEG_IMS_DATA table: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/400.UpdateCompanionTokenTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.UpdateCompanionTokenTable
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/400.UpdateCompanionTokenTable/100.InitUpdate]

AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_COMPANION_TOKENS"
AdornOps=set DEG_SERVICETOKEN_STATUS "DE"
AdornOps=set DEG_UNIQUE_ID ""
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevServiceTokenString DEG_SERVICE_TOKEN
AdornOps=copy DEG_OEMCompTokensDeviceIdString DEG_DEVICE_ID
AdornOps=setsystime DEG_TOKENCREATE_TIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/400.UpdateCompanionTokenTable/200.UpdateCompanionTokenTable]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
MapAttributes=DEG_SERVICE_TOKEN,DEG_SERVICE_TOKEN
MapAttributes=DEG_SERVICETOKEN_STATUS,DEG_SERVICETOKEN_STATUS
MapAttributes=DEG_TOKENCREATE_TIMESTAMP,DEG_TOKENCREATE_TIMESTAMP
#RFE75 fix related files.
#New header attribute 'user-agent' added as part of http request from the device.
#iOS device sends specific User-Agent strings that can identify the specific device and version of iOS.
MapAttributes=DEG_USER_AGENT,DEG_USER_AGENT
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_COMPANION_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/400.UpdateCompanionTokenTable/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/400.UpdateCompanionTokenTable/300.CheckUpdateStatus/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0243"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/400.UpdateCompanionTokenTable/300.CheckUpdateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_DEVICE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Unable to update entry in DEG_COMPANION_TOKENS session store: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Check whether TimesTen is up. If it is up, There is no specific row to update . Contact HP Support.


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/400.UpdateCompanionTokenTable/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/400.UpdateCompanionTokenTable/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0244"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/400.UpdateCompanionTokenTable/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_DEVICE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Unable to update entry in DEG_COMPANION_TOKENS session store: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/500.AddDeviceIdToList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMCompTokensDeviceIdString
ListAttribute=DEG_OEMDevResponseSubscriberIdList


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223T.DEG20ReGenSTAndUpdateDBRuleChain/100.ReGenerateAndUpdateDB/600.PopulateServiceTokenResponse]

ClassName=NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevServiceTokenString,jsonResponse.service_tokens[DEG_OEMDevServiceTokenIndexInteger].CData,""
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores]

ClassName=com.hp.siu.sessionserver.SessionStoreManager
SessionStoreNames=DEG_DEVICE_DATA_SessionStore
SessionStoreNames=DEG_COMPANION_TOKENS_SessionStore
SessionStoreNames=DEG_IMS_DATA_SessionStore
SessionStoreNames=DEG_DEVICE_HEARTBEAT_SessionStore

[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_DEVICE_HEARTBEAT_SessionStore]

Attributes=DEG_IMSI,key
Attributes=NEXT_HB_TIME_BINT
Attributes=LAST_SENT_HB_TIME_BINT
Attributes=PENDING_HB_RESPONSE_FLAG
Attributes=FIRST_GETPROV_TIME_BINT
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DatabaseId=DEG_DEVICE_HEARTBEAT
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
NativeConditions=1.MatchByIMSI
SQLTypeMap=DEG_IMSI,VARCHAR(64)
SQLTypeMap=NEXT_HB_TIME_BINT,BIGINT
SQLTypeMap=LAST_SENT_HB_TIME_BINT,BIGINT
SQLTypeMap=PENDING_HB_RESPONSE_FLAG,TINYINT
SQLTypeMap=FIRST_GETPROV_TIME_BINT,BIGINT
CommonPolicyID=Policy1

[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_DEVICE_HEARTBEAT_SessionStore/1.MatchByIMSI]

Condition=where DEG_IMSI=%DEG_IMSI
 
#RFE83 APNS token size change
[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_DEVICE_DATA_SessionStore]

Attributes=DEG_UNIQUE_ID,key
Attributes=DEG_ENTITLEMENT_NAME,key
Attributes=DEG_IMSI
Attributes=DEG_APNS_TOKEN
Attributes=DEG_OLD_APNS_TOKEN
Attributes=DEG_PROVISIONING_STATUS
Attributes=DEG_PUSH_NOTIFICATION_STATUS
Attributes=DEG_SERVICE_MGMT_POSTDATA
Attributes=DEG_DISPLAY_NAME
Attributes=DEG_ADDRESS_STATUS
Attributes=DEG_TC_STATUS
Attributes=DEG_ADDR_UPDATE_POSTDATA
Attributes=DEG_ADDR_REFID
Attributes=DEG_ADDR_REFID_EXP_DATE
Attributes=DEG_LASTUPDATE
Attributes=DEG_SIP_USERNAME
Attributes=DEG_SELF_PROV_STARTDATE
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DatabaseId=DEG_DEVICE_DATA
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
NativeConditions=1.MatchByIMSI
NativeConditions=2.MatchByUniqueId
NativeConditions=3.MatchByUniqueIdAndVoWiFiEntitelementNames
NativeConditions=4.MatchByIMSIAndEntitelementName
NativeConditions=5.MatchByIMSIUniqueIdAndEntitelementName
SQLTypeMap=DEG_UNIQUE_ID,VARCHAR(64)
SQLTypeMap=DEG_ENTITLEMENT_NAME,VARCHAR(32)
SQLTypeMap=DEG_IMSI,VARCHAR(64)
SQLTypeMap=DEG_APNS_TOKEN,VARCHAR(100)
#QXCM1001544811:3.2.4 China Unicom issues,issue 1:2017041001
SQLTypeMap=DEG_OLD_APNS_TOKEN,VARCHAR(100)
SQLTypeMap=DEG_PROVISIONING_STATUS,BIGINT
SQLTypeMap=DEG_PUSH_NOTIFICATION_STATUS,BIGINT
SQLTypeMap=DEG_SERVICE_MGMT_POSTDATA,VARCHAR(256)
SQLTypeMap=DEG_DISPLAY_NAME,VARCHAR(128)
SQLTypeMap=DEG_ADDRESS_STATUS,TINYINT
SQLTypeMap=DEG_TC_STATUS,TINYINT
SQLTypeMap=DEG_ADDR_UPDATE_POSTDATA,VARCHAR(8192)
SQLTypeMap=DEG_ADDR_REFID,VARCHAR(64)
SQLTypeMap=DEG_ADDR_REFID_EXP_DATE,DATE
SQLTypeMap=DEG_LASTUPDATE,DATE
SQLTypeMap=DEG_SIP_USERNAME,VARCHAR(256)
SQLTypeMap=DEG_SELF_PROV_STARTDATE,DATE
CommonPolicyID=Policy1

[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_DEVICE_DATA_SessionStore/1.MatchByIMSI]

Condition=where DEG_IMSI=%DEG_IMSI

[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_DEVICE_DATA_SessionStore/2.MatchByUniqueId]

Condition=where DEG_UNIQUE_ID=%DEG_UNIQUE_ID

[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_DEVICE_DATA_SessionStore/3.MatchByUniqueIdAndVoWiFiEntitelementNames]

Condition=where DEG_ENTITLEMENT_NAME IN('VoWiFi','iCloudVoWiFi') and DEG_UNIQUE_ID=%DEG_UNIQUE_ID

[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_DEVICE_DATA_SessionStore/4.MatchByIMSIAndEntitelementName]

Condition=where DEG_IMSI=%DEG_IMSI and DEG_ENTITLEMENT_NAME=%DEG_ENTITLEMENT_NAME

[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_DEVICE_DATA_SessionStore/5.MatchByIMSIUniqueIdAndEntitelementName]

Condition=where DEG_IMSI=%DEG_IMSI and DEG_ENTITLEMENT_NAME=%DEG_ENTITLEMENT_NAME and DEG_UNIQUE_ID=%DEG_UNIQUE_ID


[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_COMPANION_TOKENS_SessionStore]

Attributes=DEG_IMSI,key
Attributes=DEG_DEVICE_ID,key
Attributes=DEG_UNIQUE_ID
Attributes=DEG_SERVICE_TOKEN
Attributes=DEG_SERVICETOKEN_STATUS
Attributes=DEG_AUTH_TIMESTAMP
Attributes=DEG_TOKENCREATE_TIMESTAMP
Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
#RFE75 fix related files.
#New header attribute 'user-agent' added as part of http request from the device.
#iOS device sends specific User-Agent strings that can identify the specific device and version of iOS.
Attributes=DEG_USER_AGENT
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DatabaseId=DEG_COMPANION_TOKENS
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
NativeConditions=1.MatchByUniqueId
NativeConditions=1.MatchByImsi
NativeConditions=2.MatchByImsiAndServiceToken
SQLTypeMap=DEG_IMSI,VARCHAR(64)
SQLTypeMap=DEG_DEVICE_ID,VARCHAR(64)
SQLTypeMap=DEG_UNIQUE_ID,VARCHAR(64)
SQLTypeMap=DEG_SERVICE_TOKEN,VARCHAR(100)
SQLTypeMap=DEG_SERVICETOKEN_STATUS,CHAR(2)
SQLTypeMap=DEG_AUTH_TIMESTAMP,BIGINT
SQLTypeMap=DEG_TOKENCREATE_TIMESTAMP,BIGINT	
SQLTypeMap=DEG_AUTH_COUNT,BIGINT
SQLTypeMap=DEG_BLACKLIST_FLAG,BIGINT
#RFE75 fix related files.
#New header attribute 'user-agent' added as part of http request from the device.
#iOS device sends specific User-Agent strings that can identify the specific device and version of iOS.
SQLTypeMap=DEG_USER_AGENT,VARCHAR(256)
CommonPolicyID=Policy1


[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_COMPANION_TOKENS_SessionStore/1.MatchByUniqueId]

Condition=where DEG_UNIQUE_ID=%DEG_UNIQUE_ID

[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_COMPANION_TOKENS_SessionStore/1.MatchByImsi]

Condition=where DEG_IMSI=%DEG_IMSI

[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_COMPANION_TOKENS_SessionStore/2.MatchByImsiAndServiceToken]

Condition=where DEG_IMSI=%DEG_IMSI and DEG_SERVICE_TOKEN=%DEG_SERVICE_TOKEN

[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_IMS_DATA_SessionStore]

Attributes=DEG_IMSI,key
Attributes=DEG_DEVICE_ID,key
Attributes=DEG_UNIQUE_ID
Attributes=DEG_IMS_PRIVATE_ID
Attributes=DEG_IMS_PUBLIC_ID
Attributes=DEG_SIP_USERNAME
Attributes=DEG_SIP_PASSWORD
Attributes=DEG_PROVTIME
Attributes=DEG_LASTUPDATE
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DatabaseId=DEG_IMS_DATA
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
NativeConditions=1.MatchByIMSI
NativeConditions=2.MatchBySipUserName
NativeConditions=3.MatchByIMSIAndSipUserName
NativeConditions=4.MatchByIMSIAndUniqueId
NativeConditions=5.MatchByIMSIAndDeviceId
NativeConditions=6.MatchByUniqueId
NativeConditions=7.MatchByNullUniqueId
SQLTypeMap=DEG_IMSI,VARCHAR(64)
SQLTypeMap=DEG_DEVICE_ID,VARCHAR(64)
SQLTypeMap=DEG_UNIQUE_ID,VARCHAR(64)
SQLTypeMap=DEG_IMS_PRIVATE_ID,VARCHAR(256)
SQLTypeMap=DEG_IMS_PUBLIC_ID,VARCHAR(256)
SQLTypeMap=DEG_SIP_USERNAME,VARCHAR(256)
SQLTypeMap=DEG_SIP_PASSWORD,VARCHAR(256)
SQLTypeMap=DEG_PROVTIME,TIMESTAMP(6)
SQLTypeMap=DEG_LASTUPDATE,DATE
CommonPolicyID=Policy1

[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_IMS_DATA_SessionStore/1.MatchByIMSI]

Condition=where DEG_IMSI=%DEG_IMSI


[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_IMS_DATA_SessionStore/2.MatchBySipUserName]

Condition=where DEG_SIP_USERNAME=%DEG_SIP_USERNAME


[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_IMS_DATA_SessionStore/3.MatchByIMSIAndSipUserName]

Condition=where DEG_IMSI=%DEG_IMSI and DEG_SIP_USERNAME=%DEG_SIP_USERNAME

[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_IMS_DATA_SessionStore/4.MatchByIMSIAndUniqueId]

Condition=where DEG_IMSI=%DEG_IMSI and DEG_UNIQUE_ID=%DEG_UNIQUE_ID

[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_IMS_DATA_SessionStore/5.MatchByIMSIAndDeviceId]

Condition=where DEG_IMSI=%DEG_IMSI and DEG_DEVICE_ID=%DEG_DEVICE_ID

[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_IMS_DATA_SessionStore/6.MatchByUniqueId]

Condition=where DEG_UNIQUE_ID=%DEG_UNIQUE_ID

[/templates/DEG/DeviceInterface/Common_V2Core/SessionStores/DEG_IMS_DATA_SessionStore/7.MatchByNullUniqueId]

Condition=where DEG_IMSI=%DEG_IMSI and DEG_DEVICE_ID!=%DEG_DEVICE_ID and DEG_UNIQUE_ID is NOT NULL

################################################

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/006.UpdateDEGTokensTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdatePushToken
RuleNames=200.UpdateInternalTokenTable
RuleNames=300.CheckTokenUpdateStatus
RuleNames=400.CallCustomPT_SendToken

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/006.UpdateDEGTokensTable/100.InitUpdatePushToken]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_TOKENS
AdornOps=copy DEG_OEMDevAPNSTokenString DEG_PUSH_TOKEN
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/006.UpdateDEGTokensTable/200.UpdateInternalTokenTable]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_PUSH_TOKEN,DEG_PUSH_TOKEN
NativeCondition=1.MatchingByMDN
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/006.UpdateDEGTokensTable/300.CheckTokenUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Operations=or
TrueRuleChain=100.SetError
TrueRuleChain=110.LogError


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/006.UpdateDEGTokensTable/300.CheckTokenUpdateStatus/100.SetError]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0245"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/006.UpdateDEGTokensTable/300.CheckTokenUpdateStatus/110.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_PUSH_TOKEN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Database Error: System error while updating DEG_TOKENS store 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/006.UpdateDEGTokensTable/400.CallCustomPT_SendToken]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVariables
RuleNames=110.CopyBeforeCUSTRC_Apple_PT_SendToken
RuleNames=111.SetErrorInfo
RuleNames=120.LogBeforeCUSTRC_Apple_PT_SendToken
RuleNames=200.ProcessCUSTRC_Apple_PT_SendToken
RuleNames=201.SetErrorInfo
RuleNames=300.CopyAfterCUSTRC_Apple_PT_SendToken
RuleNames=400.LogAfterCUSTRC_Apple_PT_SendToken


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/006.UpdateDEGTokensTable/400.CallCustomPT_SendToken/100.InitVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull DEG_MDN 0
AdornOps=setifnull DEG_OEMDevAPNSTokenString ""
AdornOps=setifnull DEG_OEMDevImsiString ""
AdornOps=setifnull DEG_OEMDevRequestProcessedInteger 0


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/006.UpdateDEGTokensTable/400.CallCustomPT_SendToken/110.CopyBeforeCUSTRC_Apple_PT_SendToken]

ClassName=AdornmentRule
AdornOps=copy DEG_OEMDevAPNSTokenString CUST_UPD_IN_APNSTokenString
AdornOps=copy DEG_MDN CUST_UPD_IN_MDN
AdornOps=copy DEG_OEMDevImsiString CUST_UPD_IN_IMSIString
AdornOps=copy DEG_OEMDevRequestProcessedInteger CUST_UPD_OUT_ErrorInteger

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/006.UpdateDEGTokensTable/400.CallCustomPT_SendToken/111.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0246"
AdornOps=set DEG_OEMDevMessageString "Log before custom template invocation:"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/006.UpdateDEGTokensTable/400.CallCustomPT_SendToken/120.LogBeforeCUSTRC_Apple_PT_SendToken]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Log before custom template invocation:
Attributes=DEG_MDN
Attributes=DEG_OEMDevAPNSTokenString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestProcessedInteger
Attributes=CUST_UPD_IN_MDN
Attributes=CUST_UPD_IN_IMSIString
Attributes=CUST_UPD_IN_APNSTokenString
Attributes=CUST_UPD_OUT_ErrorInteger
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/006.UpdateDEGTokensTable/400.CallCustomPT_SendToken/200.ProcessCUSTRC_Apple_PT_SendToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_Apple_PT_SendToken
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/006.UpdateDEGTokensTable/400.CallCustomPT_SendToken/300.CopyAfterCUSTRC_Apple_PT_SendToken]

ClassName=AdornmentRule
AdornOps=copy CUST_UPD_IN_APNSTokenString DEG_OEMDevAPNSTokenString
AdornOps=copy CUST_UPD_IN_MDN DEG_MDN
AdornOps=copy CUST_UPD_IN_IMSIString DEG_OEMDevImsiString
AdornOps=copy CUST_UPD_OUT_ErrorInteger DEG_OEMDevRequestProcessedInteger

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/006.UpdateDEGTokensTable/400.CallCustomPT_SendToken/201.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0247"
AdornOps=set DEG_OEMDevMessageString "Log after invoking custom template:"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/006.UpdateDEGTokensTable/400.CallCustomPT_SendToken/400.LogAfterCUSTRC_Apple_PT_SendToken]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Log after invoking custom template:
Attributes=DEG_MDN
Attributes=DEG_OEMDevAPNSTokenString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestProcessedInteger
Attributes=CUST_UPD_IN_MDN
Attributes=CUST_UPD_IN_IMSIString
Attributes=CUST_UPD_IN_APNSTokenString
Attributes=CUST_UPD_OUT_ErrorInteger
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/010.InvokeExternalCarrierRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVariables
RuleNames=110.CopyBeforeCustomTemplateCall
RuleNames=111.SetErrorInfo
RuleNames=120.LogBeforeCustomTemplateCall
RuleNames=200.ProcessAPNSShareCustomRuleChain
RuleNames=300.CopyAfterCustomTemplateCall
RuleNames=301.SetErrorInfo
RuleNames=400.LogAfterCustomTemplateCall


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/010.InvokeExternalCarrierRuleChain/100.InitVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull DEG_CDevSysParameter ""
AdornOps=setifnull DEG_OEMDevEntitlementNameString ""
AdornOps=setifnull DEG_OEMDevNewApnTokenString ""
AdornOps=setifnull DEG_OEMDevAPNsResponseFromCarrierString 0
AdornOps=setifnull DEG_OEMDevEntitlementNameStringlist null
AdornOps=setifnull DEG_OEMDevNewApnTokenStringlist null


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/010.InvokeExternalCarrierRuleChain/110.CopyBeforeCustomTemplateCall]

ClassName=AdornmentRule
AdornOps=copy DEG_OEMDevImsiString CUST_EDPN_IN_IMSIString
AdornOps=copy DEG_CDevSysParameter CUST_EDPN_IN_ActionName
AdornOps=copy DEG_OEMDevEntitlementNameStringlist CUST_EDPN_IN_EntitlementNameList
AdornOps=copy DEG_OEMDevNewApnTokenStringlist CUST_EDPN_IN_NewApnTokenList
AdornOps=copy DEG_OEMDevAPNsResponseFromCarrierString CUST_EDPN_OUT_APNsResponseFromCarrierString


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/010.InvokeExternalCarrierRuleChain/111.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0248"
AdornOps=set DEG_OEMDevMessageString "Log before invoking custom template for sharing APNS token:"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/010.InvokeExternalCarrierRuleChain/120.LogBeforeCustomTemplateCall]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Log before invoking custom template for sharing APNS token:
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevSysParameter
Attributes=DEG_OEMDevEntitlementNameString
Attributes=DEG_OEMDevNewApnTokenString
Attributes=DEG_OEMDevAPNsResponseFromCarrierString
Attributes=DEG_OEMDevNewApnTokenString
Attributes=CUST_EDPN_IN_IMSIString
Attributes=CUST_EDPN_IN_ActionName
Attributes=CUST_EDPN_IN_EntitlementNameList
Attributes=CUST_EDPN_IN_NewApnTokenList
Attributes=CUST_EDPN_OUT_APNsResponseFromCarrierString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/010.InvokeExternalCarrierRuleChain/200.ProcessAPNSShareCustomRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUST_RC_ShareAPNSTokenWithCarrierRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/010.InvokeExternalCarrierRuleChain/300.CopyAfterCustomTemplateCall]

ClassName=AdornmentRule
AdornOps=copy CUST_EDPN_IN_IMSIString DEG_OEMDevImsiString
AdornOps=copy CUST_EDPN_IN_ActionName DEG_CDevSysParameter
AdornOps=copy CUST_EDPN_IN_EntitlementNameList DEG_OEMDevEntitlementNameStringlist
AdornOps=copy CUST_EDPN_IN_NewApnTokenList DEG_OEMDevNewApnTokenStringlist
AdornOps=copy CUST_EDPN_OUT_APNsResponseFromCarrierString DEG_OEMDevAPNsResponseFromCarrierString


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/010.InvokeExternalCarrierRuleChain/301.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.0249"
AdornOps=set DEG_OEMDevMessageString "Log after invoking custom template:"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/010.InvokeExternalCarrierRuleChain/400.LogAfterCustomTemplateCall]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG2
Message=Log after invoking custom template for sharing APNS token:
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevSysParameter
Attributes=DEG_OEMDevEntitlementNameStringlist
Attributes=DEG_OEMDevNewApnTokenString
Attributes=DEG_OEMDevAPNsResponseFromCarrierString
Attributes=DEG_OEMDevNewApnTokenStringlist
Attributes=CUST_EDPN_IN_IMSIString
Attributes=CUST_EDPN_IN_ActionName
Attributes=CUST_EDPN_IN_EntitlementNameList
Attributes=CUST_EDPN_IN_NewApnTokenList
Attributes=CUST_EDPN_OUT_APNsResponseFromCarrierString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223O.DEG30GetDeviceDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=110.LookupDeviceDataTable
RuleNames=120.CheckDBErrorFlag
RuleNames=130.DelOldUIDInDeviceData

#QXCM1001562425:  APNS enablePushNotification update ignore the IMSI
[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223O.DEG30GetDeviceDataRuleChain/130.DelOldUIDInDeviceData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1


[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223O.DEG30GetDeviceDataRuleChain/130.DelOldUIDInDeviceData/FalseRule]

ClassName=com.hp.siu.sessionserver.rules.PurgeSessionsRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore
PurgeConditions=DEG_IMSI,=,%DEG_IMSI
PurgeConditions=DEG_UNIQUE_ID,!=,%DEG_UNIQUE_ID
PurgeConditions=DEG_ENTITLEMENT_NAME,!=,iCloudVoWiFi

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223O.DEG30GetDeviceDataRuleChain/110.LookupDeviceDataTable]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
NativeCondition=5.MatchByIMSIUniqueIdAndEntitelementName
LogInvalidSession=false
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
MapAttributes=DEG_ENTITLEMENT_NAME,DEG_ENTITLEMENT_NAME
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_TC_STATUS,DEG_TC_STATUS
MapAttributes=DEG_ADDRESS_STATUS,DEG_ADDRESS_STATUS
MapAttributes=DEG_PROVISIONING_STATUS,DEG_PROVISIONING_STATUS
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223O.DEG30GetDeviceDataRuleChain/120.CheckDBErrorFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExistFlag

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.PrintErrorLog

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223O.DEG30GetDeviceDataRuleChain/120.CheckDBErrorFlag/200.CheckKeyExistFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1

TrueRuleChain=100.CopyValues

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223O.DEG30GetDeviceDataRuleChain/120.CheckDBErrorFlag/200.CheckKeyExistFlag/100.CopyValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_TC_STATUS CUST_GSP_OUT_VoWiFi_TC_STATUS
AdornOps=copy DEG_ADDRESS_STATUS CUST_GSP_OUT_VoWiFi_ADDR_STATUS
AdornOps=copy DEG_PROVISIONING_STATUS CUST_GSP_OUT_VoWiFi_PROVISIONING_STATUS

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223O.DEG30GetDeviceDataRuleChain/120.CheckDBErrorFlag/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.0250"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_DEVICE_DATA table"

[/templates/DEG/DeviceInterface/Common_V2Core/RuleChains/223O.DEG30GetDeviceDataRuleChain/120.CheckDBErrorFlag/110.PrintErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevUniqueIDString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: in looking up DEG_DEVICE_DATA table
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.