[/templates/DEG/DEGDROID_DeviceInterface/Common_Core]

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors]

ClassName=ConnectorManager
ConnectorNames=100.DEGDROIDDeviceHttpsConnector
ConnectorNames=100.RefreshCacheConnector
#ConnectorNames=120.RefDataDbConnectorNRB
ConnectorNames=130.LoadBalancerHeartBeatHttpConnector
ConnectorNames=202.HttpRequestClient


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/100.RefreshCacheConnector]

ClassName=com.hp.siu.plugins.dna.collector.rules.SocketConnector
ListenPort=${DEGDROID_LISTEN_PORT}


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/100.DEGDROIDDeviceHttpsConnector]

#ClassName=com.hp.siu.plugins.tomcat.HttpConnector
#Context=DEGDROIDInterface
#Port=9014
#UseContextIdentifierOnly=true
#ConnectionTimeout=5000
#MaxKeepAliveRequests=5

AcceptCount=${DEVICE_HTTP_ACCEPT_COUNT}
ClassName=HttpConnector
ConnectionTimeout=5000
Context=DEGDROIDInterface
KeyStoreFile=${DEGDROID_SERVER_CERT_KEYSTORE_FILE}
KeyStorePassword=${DEGDROID_SERVER_CERT_SIGNATURE_PASSWORD}
Managed=true
MaxKeepAliveRequests=5
MaxProcessors=${DEVICE_HTTP_CON_MAX_PROCESSORS}
MaxSpareProcessors=${DEVICE_HTTP_CON_MIN_PROCESSORS}
MinProcessors=${DEVICE_HTTP_CON_MIN_PROCESSORS}
Port=${DEGDROID_SERVER_PORT}
Secured=true
ServerXMLTemplate=${SERVER_XML_TEMPLATE}
UseContextIdentifierOnly=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/100.DEGDROIDDeviceHttpsConnector/DEGDROIDInterface]

ClassName=com.hp.usage.soap.TextContextProvider
ContextIdentifier=DEGDROIDInterface
#RequestHeaderMap=Cookie,DEG_OEMDevSslSessionIdString,"INVALID"
ErrorMessageAttribute=DEG_OEMDevHttpErrorMessageString
ErrorNameAttribute=DEG_OEMDevHttpErrorNameString
ErrorRuleChain=120.DEG30ProcessOEMParsingErrorRuleChain
NoLogExceptions=com.hp.usage.listoperations.CustomRuleException
RequestAttributeMap=IMSI_EAP,DEG_OEMDevEAPSubscriberIdString,dummy
RequestAttributeMap=EAP_PAYLD,DEG_OEMDevEAPPayloadString,dummy
RequestAttributeMap=IMSI,DEG_OEMDevSubscriberIdString,dummy
RequestAttributeMap=OTP,DEG_OEMDevOTPLong,99999
RequestAttributeMap=token,DEG_OEMDevTokenString,dummy
RequestAttributeMap=service_name,DEG_OEMDevServiceNameList,com.hp.siu.utils.StringAttribute|1|64756d6d79
RequestAttributeMap=version,DEG_OEMDevVersionInteger,-1
RequestAttributeMap=terminal_vendor,DEG_OEMDevTerminalVendorString,dummy
RequestAttributeMap=terminal_model,DEG_OEMDevTerminalModelString,dummy
RequestAttributeMap=terminal_sw_version,DEG_OEMDevTermianlSWversionString,dummy
RequestAttributeMap=terminal_id,DEGDROID_TerminalUniqueIdString,dummy
RequestAttributeMap=friendly_device_name,DEG_OEMDevFriendlyDeviceString,-99DEGINVALID-99
RequestAttributeMap=sip_username,DEG_OEMDevSipUserNameString,-99DEGINVALID-99
RequestAttributeMap=ACTION_NAME,DEG_OEMDevActionNameString,dummy
RequestHeaderMap=x-up-calling-line-id,DEG_OEMDevMsisdnString,dummy
RequestHeaderMap=Cookie,DEG_OEMDevCookieList,null
RequestURIAttribute=DEG_OEMDevRequestURIString
#RFE71 : Display source ip in device log.
ClientAddressAttribute=DEG_OEMDevSourceIPAddressString
ResponseHeaderMap=Content-Type,ResponseMessageHeader,"text/xml;charset=UTF-8"
ResponseHandlerAttribute=DEG_OEMDevResponseHandlerString
ResponseHeaderMap=Connection,DEG_OEMDevConnectionString
ResponseHeaderMap=Content-Encoding,DEG_OEMDevEncodingString
ResponseStatusAttribute=DEG_OEMDevHttpStatusInteger
ResponseHeaderMap=Retry-After,ResponseHeaderRetryAfterInteger,0
RuleChainName=100.DEG30ProcessAndroidRequestRuleChain
#SSLSessionIDAttribute=DEG_OEMDevSslSessionIdString
QueryStringAttribute=DEG_OEMDevRequestAttributeString
#RequestHeaderMap=Set-Cookie,DEGDROID_SSL_COOKIE_ID,"none"
ResponseHeaderMap=Set-Cookie,DEGDROID_SSL_COOKIE_ID
ResponseHandlers=EmptyResponseHandler
ResponseHandlers=TextResponseHandler

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/100.DEGDROIDDeviceHttpsConnector/DEGDROIDInterface/EmptyResponseHandler]

ClassName=EmptyResponseGenerator


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/100.DEGDROIDDeviceHttpsConnector/DEGDROIDInterface/TextResponseHandler]

ClassName=PlainHttpResponseGenerator
SourceAttribute=ResponseMessage


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/130.LoadBalancerHeartBeatHttpConnector]

AcceptCount=${DEGDROID_HTTP_ACCEPT_COUNT}
ClassName=com.hp.siu.plugins.tomcat.HttpConnector
ConnectionTimeout=${DEGDROID_HEARTBEAT_CONN_TIMEOUT}
Context=GETStatus
Managed=${MANAGED_SETUP}
MaxKeepAliveRequests=1
MaxProcessors=${DEGDROID_HTTP_HEARTBEAT_CON_MAX_PROCESSORS}
MaxSpareProcessors=${DEGDROID_HTTP_HEARTBEAT_CON_MIN_PROCESSORS}
MinProcessors=${DEGDROID_HTTP_HEARTBEAT_CON_MIN_PROCESSORS}
Port=${DEGDROID_HEARTBEAT_HTTP_PORT}
UseContextIdentifierOnly=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/130.LoadBalancerHeartBeatHttpConnector/GETStatus]

ClassName=TextContextProvider
ContextIdentifier=GETStatus
RuleChainName=170.GenerateResponseForLoadBalancerHeartBeat


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/130.LoadBalancerHeartBeatHttpConnector/GETStatus/ResponseHandler]

ClassName=PlainHttpResponseGenerator
SourceAttribute=DEGDROID_OEMDevLoadBalRespMsgString

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/202.HttpRequestClient]

ClassName=HttpClientConnector
Requests=HttpRequestPost

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/202.HttpRequestClient/HttpRequestPost]

ClassName=com.hp.usage.http.client.PlainHttpRequest
HttpMethod=POST
RequestAttributeMap=ACTION_NAME,DEG_OEMDevActionNameString,"healthCheck"
ResponseHandlers=HttpResponseHandler
ResultCodeAttribute=DEG_OEMDevHttpStatusInteger

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/202.HttpRequestClient/HttpRequestPost/HttpResponseHandler]

ClassName=com.hp.usage.http.client.PlainHttpResponseHandler
DestinationAttribute=DEG_OEMDevHttpStatusString

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/202.HttpRequestClient/EndPoints]

ClassName=DynamicEndPointSelector
KeyAttributeName=RemoteHostURL

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/Connectors/202.HttpRequestClient/EndPoints/EndPoint]

ClassName=HttpEndPoint
KeyStoreFile=${DEGDROID_SERVER_CERT_KEYSTORE_FILE}
KeyStorePassword=${DEGDROID_SERVER_CERT_SIGNATURE_PASSWORD}
RemoteHostURL=${DEGDROID_HEALTHCHECK_REQUEST_URL}
NumConnections=${DEGDROID_NUM_CONNECTIONS}
ConnectionTimeout=${DEGDROID_CONNECTION_TIMEOUT}
SocketTimeout=${DEGDROID_SOCKET_TIMEOUT}

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService]

ClassName=com.hp.siu.serverutils.RefDataServiceManager
QueryNames=DEG_MONITORINGID_GENERATOR
QueryNames=DEG_MONITORING_SESSIONS_ActiveSessions
##added this DEG_MONITORING_SESSIONS_ActiveSessionsV2 only for the purpose of keeping getSubariberProfile Core common for both DEGAcme and DEGDROID
QueryNames=DEG_MONITORING_SESSIONS_ActiveSessionsV2
QueryNames=DEG_SYS_PARAMETER_PARA2VAL
QueryNames=DEG_LIC_LIMITS_TokenLifeTime

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_MSESSIONTRANSID,DEG_MSESSIONTRANSID
#JDBCDataSourceConnectorName=120.RefDataDbConnectorNRB
CommonPolicyID=Policy2
QueryString=SELECT SEQUENCE_NEXTVAL('DEG_MONITORINGID_GENERATOR') AS DEG_MSESSIONTRANSID
ResultAttribute=DEG_NrbMatchFoundInteger
ResultIndexAttribute=DEG_NrbIndexInteger

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=99.InitErrorLog
RuleNames=100.LogAlarming

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/ErrorRule/99.InitErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0000"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup DEG_MONITORINGID_GENERATOR table"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to lookup DEG_MONITORINGID_GENERATOR table :
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_NrbMatchFoundInteger DEG_NrbMatchFoundInteger

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_NrbMatchFoundInteger 0
AdornOps=set DEG_NrbIndexInteger 0
AdornOps=set DEG_MSESSIONTRANSID 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_MONITORINGID_GENERATOR.NEXTVAL"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORINGID_GENERATOR/ResultRowRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_NrbMatchFoundInteger 1


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_MSESSIONID,DEG_MSESSIONID
#JDBCDataSourceConnectorName=120.RefDataDbConnectorNRB
CommonPolicyID=Policy2
QueryString=SELECT %FIELDS  FROM DEG_MONITORING_SESSIONS WHERE DEG_MSESSIONTYPE in ('MDN','IMSI') AND DEG_MSESSIONSTATUS='AE' AND DEG_MSESSIONKEY=%DEG_MSESSIONKEY
ResultAttribute=DEG_NrbMatchFoundInteger
ResultIndexAttribute=DEG_NrbIndexInteger

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=99.InitErrorLog
RuleNames=100.LogAlarming

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ErrorRule/99.InitErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0001"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup DEG_MONITORING_SESSIONS table"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to lookup DEG_MONITORING_SESSIONS table :
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/FinalRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.Copy_MatchFoundFlag
RuleNames=200.CheckMSessionKey

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/FinalRule/100.Copy_MatchFoundFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_NrbMatchFoundInteger DEG_NrbMatchFoundInteger

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/FinalRule/200.CheckMSessionKey]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_MSESSIONKEY,=,0

TrueRuleChain=100.Set_MSessionKeyFlag

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/FinalRule/200.CheckMSessionKey/100.Set_MSessionKeyFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SessionKeyInteger 1

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_NrbMatchFoundInteger 0
AdornOps=set DEG_MSESSIONID ""
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_MONITORING_SESSIONS"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ResultRowRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.Set_MatchFound
RuleNames=200.PopulateMonitoringSessionIdsList

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ResultRowRule/100.Set_MatchFound]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_NrbMatchFoundInteger 1

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessions/ResultRowRule/200.PopulateMonitoringSessionIdsList]

ClassName=AddToListAttributeRule
Delimiters=,
InputAttribute=DEG_MSESSIONID
ListAttribute=DEG_NrbMonitoringSessionIdList

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2]

ClassName=com.hp.usage.refdatasrv.JDBCQuery
FieldExtracted=DEG_MSESSIONID,DEG_MSESSIONID
#JDBCDataSourceConnectorName=120.RefDataDbConnectorNRB
CommonPolicyID=Policy2
QueryString=SELECT %FIELDS  FROM DEG_MONITORING_SESSIONS WHERE DEG_MSESSIONTYPE in ('MDN','IMSI','UNIQ') AND DEG_MSESSIONSTATUS='AE' AND DEG_MSESSIONKEY=%DEG_MSESSIONKEY
ResultAttribute=DEG_NrbMatchFoundInteger
ResultIndexAttribute=DEG_NrbIndexInteger

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=99.InitErrorLog
RuleNames=100.LogAlarming

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ErrorRule/99.InitErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0002"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup DEG_MONITORING_SESSIONS table"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ErrorRule/100.LogAlarming]

Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to lookup DEG_MONITORING_SESSIONS table :
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/FinalRule]

AdornOps=copy DEG_NrbMatchFoundInteger DEG_NrbMatchFoundInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/InitialRule]

AdornOps=set DEG_NrbMatchFoundInteger 0
AdornOps=set DEG_MSESSIONID ""
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_MONITORING_SESSIONS"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ResultRowRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.Set_MatchFound
RuleNames=200.PopulateMonitoringSessionIdsList

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ResultRowRule/100.Set_MatchFound]

AdornOps=set DEG_NrbMatchFoundInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_MONITORING_SESSIONS_ActiveSessionsV2/ResultRowRule/200.PopulateMonitoringSessionIdsList]

ClassName=AddToListAttributeRule
Delimiters=,
InputAttribute=DEG_MSESSIONID
ListAttribute=DEG_NrbMonitoringSessionIdList


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL]

ClassName=com.hp.usage.refdatasrv.CachedQuery
ResultAttribute=DEG_CDevMatchFoundInteger
ResultIndexAttribute=DEG_CDevIndexInteger

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/Cache]

ClassName=com.hp.usage.refdatasrv.HashMapLookupCache
CacheAttributes=DEG_SYSVALUE
CacheKeyAttributes=DEG_SYSPARAMETER
NMEKeyAttributes=DEG_CDevSysParameter

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=99.InitErrorLog
RuleNames=100.LogAlarming
RuleNames=200.SetErrorFlag

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule/99.InitErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0003"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup DEG_SYS_PARAMETER table"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to lookup DEG_SYS_PARAMETER table :
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ErrorRule/200.SetErrorFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevMatchFoundInteger DEG_CDevMatchFoundInteger

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevMatchFoundInteger 0
AdornOps=set DEG_CDevIndexInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_SYS_PARAMETERS"
AdornOps=set DEG_SYSVALUE ""
AdornOps=set DEG_SYSPARAMETER ""

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/Loader]

ClassName=com.hp.usage.refdatasrv.JDBCLoader
FieldExtracted=DEG_SYSPARAMETER,DEG_SYSPARAMETER
FieldExtracted=DEG_SYSVALUE,DEG_SYSVALUE
CommonPolicyID=Policy1
QueryString=select %FIELDS from DEG_SYS_PARAMETERS

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/RefreshPolicy]

ClassName=com.hp.siu.plugins.dna.collector.rules.CronIntervalRefreshPolicy
RefreshCronInterval=0 * * * *

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_SYS_PARAMETER_PARA2VAL/ResultRowRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevMatchFoundInteger 1
AdornOps=copy DEG_SYSVALUE DEG_CDevSysValueString


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime]

ClassName=com.hp.usage.refdatasrv.CachedQuery
ResultAttribute=DEG_CDevMatchFoundInteger
ResultIndexAttribute=DEG_CDevIndexInteger


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/Cache]

ClassName=com.hp.usage.refdatasrv.HashMapLookupCache
CacheAttributes=DEG_TKN_LIFETIME
CacheAttributes=DEG_AUTHTHRESHOLD_COUNT
CacheKeyAttributes=DEG_LIC_TYPE
NMEKeyAttributes=DEG_OEMDevLicenseTypeString


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/ErrorRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=150.SetErrorInfo
RuleNames=100.LogAlarming
RuleNames=200.SetErrorFlag

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/ErrorRule/150.SetErrorInfo]
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0004"
AdornOps=set DEG_OEMDevErrorMessageString "Database Error"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/ErrorRule/100.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_JsonEncodeAttribute
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=CRITICAL
Message=Database Error:
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/ErrorRule/200.SetErrorFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/FinalRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevMatchFoundInteger DEG_CDevMatchFoundInteger


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/InitialRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevMatchFoundInteger 0
AdornOps=set DEG_CDevIndexInteger 0
AdornOps=set log_DB_Operation "QUERY"
AdornOps=set log_Table_Name "DEG_LIC_LIMITS"
AdornOps=set DEG_TKN_LIFETIME 0
AdornOps=set DEG_LIC_TYPE ""


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/Loader]

ClassName=com.hp.usage.refdatasrv.JDBCLoader
FieldExtracted=DEG_LIC_TYPE,DEG_LIC_TYPE
FieldExtracted=DEG_TKN_LIFETIME,DEG_TKN_LIFETIME
FieldExtracted=DEG_AUTHTHRESHOLD_COUNT,DEG_AUTHTHRESHOLD_COUNT
CommonPolicyID=Policy1
QueryString=select %FIELDS from DEG_LIC_LIMITS


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/RefreshPolicy]

ClassName=com.hp.siu.plugins.dna.collector.rules.CronIntervalRefreshPolicy
RefreshCronInterval=0 * * * *


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/ReferenceDataService/DEG_LIC_LIMITS_TokenLifeTime/ResultRowRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevMatchFoundInteger 1
AdornOps=copy DEG_TKN_LIFETIME DEG_OEMDevTokenLifetimeLong
AdornOps=copy DEG_AUTHTHRESHOLD_COUNT DEG_OEMDevAuthThresholdCountInteger


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains]

ClassName=com.hp.siu.sessionserver.RuleChainManager
RuleChainNames=100.DEG30ProcessAndroidRequestRuleChain
RuleChainNames=110.DEG30ValidateInitialRequestRuleChain
RuleChainNames=120.DEG30ProcessOEMParsingErrorRuleChain
RuleChainNames=130.DEG30CheckTokenTimeStampRuleChain
RuleChainNames=140.DEG30GenerateBlackListedResponseRuleChain
RuleChainNames=150.DEG30BlackListeSubscriberRuleChain
RuleChainNames=160.DEG30GetResponseTemplatesRuleChain
RuleChainNames=170.GenerateResponseForLoadBalancerHeartBeat
RuleChainNames=000.SessionStoreDefaultErrorRuleChain
RuleChainNames=001.SessionStoreKeyNotExistsRuleChain
RuleChainNames=002.SessionStoreDuplicateKeyRuleChain
RuleChainNames=003.ReadSystemParameterRuleChain
RuleChainNames=170.DEG30CheckEAPAKADefaultRuleChain
RuleChainNames=005.DEG30StoreTokenRuleChain
RuleChainNames=300.DEG30ProcessOTPRuleChain
RuleChainNames=400.DEG30PrcessNONERuleChain
RuleChainNames=600.GenerateAuditAndNRBEventsRuleChain
RuleChainNames=601.DumpMonitoringTransactionsRuleChain
RuleChainNames=650.DEG20GenerateAuditAndNRBEventsRuleChain
RuleChainNames=651.DEG20DumpMonitoringTransactionsRuleChain
RuleChainNames=705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain
RuleChainNames=180.ProcessResponseAttributeCustomization
#RuleChainNames=CUSTRC_Android_InputValidation
RuleChainNames=CUSTRC_RCSInitialConnectCustomize
RuleChainNames=004.ReadTokenLifeTimeRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CallGenrateEapAkaAuthRejectRule

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/705.DEG20GenerateGetAuthenticationAkaRejectedEndAuditDataRuleChain/100.CallGenrateEapAkaAuthRejectRule]

ClassName=LocalRuleChainInvoker
RuleChain=705.DEG30GenerateEapAkaInitialRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequestVariables
RuleNames=110.ReadValue
RuleNames=120.CheckErrorAndNoMatchFlag


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/100.InitRequestVariables]

AdornOps=set DEG_CDevSysParameter "EAPAKADefaultAuthWhenError"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
Conditions=DEG_CDevSysValueString,=,"Enabled"
FalseRuleChain=200.InitResponse
#FalseRuleChain=210.SetErrorResponse
Operations=and,and
TrueRuleChain=100.SetSessionStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag/100.SetSessionStatus]

AdornOps=set DEG_AUTHENTICATION_SUBTYPE "DFT"
AdornOps=set DEG_AUTHENTICATION_TYPE "EAP"
AdornOps=set DEG_SSL_STATE AUTHENTICATED_BY_DEG_TOKEN
ClassName=com.hp.siu.collector.rules.AdornmentRule

#59-Sprint Issue.DroidInterface returns a 503 error code instead of 500 when it cannot reach AAA.Changed DEG_SSL_REQUEST_STATE from 503C to 500C in below rule chain.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag/200.InitResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=errFlag,=,2
FalseRuleChain=200.SetErrorFromAAAResponse
TrueRuleChain=100.SetAAACommunicationFailureResponse

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag/200.InitResponse/200.SetErrorFromAAAResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "503C"
AdornOps=set  DEG_SSL_STATE "AKA_CHALLENGE_REJECTED_BY_AAA"
AdornOps=set ResponseHeaderRetryAfterInteger ${DEGDROID_DEVICE_HTTP_RETRY_WINDOW}
AdornOps=set DEG_CDevOutReturnCodeString "503"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag/200.InitResponse/100.SetAAACommunicationFailureResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set  DEG_SSL_STATE "AKA_CHALLENGE_REJECTED_BY_AAA"
AdornOps=set ResponseHeaderRetryAfterInteger ${DEGDROID_DEVICE_HTTP_RETRY_WINDOW}
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=set DEG_OEMDevErrorMessageString "Authentication attempt rejected by AAA"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.DEG30CheckEAPAKADefaultRuleChain/120.CheckErrorAndNoMatchFlag/210.SetErrorResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/650.DEG20GenerateAuditAndNRBEventsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpAuditRecord
RuleNames=200.DumpMonitoringTransactions

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/650.DEG20GenerateAuditAndNRBEventsRuleChain/100.DumpAuditRecord]

ClassName=com.hp.siu.sessionserver.rules.NMEStoreRule
NMEStore=AuditNmeStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/650.DEG20GenerateAuditAndNRBEventsRuleChain/200.DumpMonitoringTransactions]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_NrbMonitoringSessionIdList
RequestAttributes=DEG_AuditProcessingNodeString
RequestAttributes=DEG_AuditTimestampLong
RequestAttributes=DEG_AuditInterfaceString
RequestAttributes=DEG_AuditInOutString
RequestAttributes=DEG_AuditResultCodeString
RequestAttributes=DEG_AuditMdnString
RequestAttributes=DEG_AuditIMSIString
RequestAttributes=DEG_AuditTransactionTypeString
RequestAttributes=DEG_AuditSourceDestinationString
RequestAttributes=DEG_AuditNRBMessageString
RequestAttributes=DEG_AuditMessageString
RequestAttributes=DEG_AuditEntitlementNameString
RequestAttributes=DEG_AuditUniqueIDString
RequestAttributes=DEG_AuditSourceDestinationVersionString
RuleChain=651.DEG20DumpMonitoringTransactionsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpMonitoringTransactions

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.DumpMonitoringTransactions

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_NrbMonitoringSessionIdList != null


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_NrbMonitoringSessionIdList
RuleChain=100.InsertMonitoringTransactionToDb
TmpAttributeName=DEG_NrbMonitoringSessionIdString

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORINGID_GENERATOR


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateTransactionId
RuleNames=110.PopulateMonitoringTransactionAttributes
RuleNames=120.InitInsert2Db
RuleNames=200.Insert2Db
RuleNames=300.CheckCreateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/100.GenerateTransactionId]

AdornOps=setsystime DEG_Tmp1Long
AdornOps=copy DEG_Tmp1Long DEG_Tmp1String
AdornOps=+ DEG_Tmp1String DEG_MSESSIONTRANSID DEG_MSESSIONTRANSID
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/110.PopulateMonitoringTransactionAttributes]

AdornOps=copy DEG_AuditProcessingNodeString DEG_MSESSIONPROCID
AdornOps=copy DEG_AuditTimestampLong DEG_MSESSIONTIMESTAMP
AdornOps=copy DEG_AuditInterfaceString DEG_MSESSIONINTERFACE
AdornOps=copy DEG_AuditInOutString DEG_MSESSIONINOUT
AdornOps=copy DEG_AuditResultCodeString DEG_MSESSIONRESULTCODE
AdornOps=copy DEG_AuditMdnString DEG_MSESSIONMDN
AdornOps=copy DEG_AuditIMSIString DEG_MSESSIONIMSI
AdornOps=copy DEG_AuditTransactionTypeString DEG_MSESSIONTRANSACTIONTYPE
AdornOps=copy DEG_AuditSourceDestinationString DEG_MSESSIONSOURCEDESTINATION
AdornOps=copy DEG_AuditNRBMessageString DEG_MSESSIONMESSAGE
AdornOps=copy DEG_AuditUniqueIDString DEG_MSESSIONUNIQUE_ID
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/120.InitInsert2Db]

AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_NrbMonitoringSessionIdString DEG_MSESSIONID
AdornOps=set log_DB_Operation "CREATE"
AdornOps=set log_Table_Name "DEG_MONITORING_TRANSACTIONS"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/200.Insert2Db]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_MONITORING_TRANSACTIONS_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
Operations=or
TrueRuleChain=99.InitErrorLog
TrueRuleChain=100.ErrorLog

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus/99.InitErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0005"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to create entry in DEG_MONITORING_TRANSACTIONS table"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus/100.ErrorLog]

Attributes=DEG_MSESSIONID
Attributes=DEG_MSESSIONTRANSID
Attributes=DEG_MSESSIONPROCID
Attributes=DEG_MSESSIONTIMESTAMP
Attributes=DEG_MSESSIONINTERFACE
Attributes=DEG_MSESSIONINOUT
Attributes=DEG_MSESSIONRESULTCODE
Attributes=DEG_MSESSIONMDN
Attributes=DEG_MSESSIONTRANSACTIONTYPE
Attributes=DEG_MSESSIONSOURCEDESTINATION
Attributes=DEG_MSESSIONMESSAGE
Attributes=DEG_MSESSIONUNIQUE_ID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: Unable to create entry in DEG_MONITORING_TRANSACTIONS session store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetEmptyTransactionId
RuleNames=200.Log

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/100.SetEmptyTransactionId]

AdornOps=set DEG_MSESSIONTRANSID ""
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0006"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to generate unique value of monitoring transaction id"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/651.DEG20DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/200.Log]

Attributes=DEG_MSESSIONTRANSID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=Unable to generate unique value of monitoring transaction id: 
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/600.GenerateAuditAndNRBEventsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpAuditRecord
RuleNames=200.DumpMonitoringTransactions


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/600.GenerateAuditAndNRBEventsRuleChain/100.DumpAuditRecord]

ClassName=com.hp.siu.sessionserver.rules.NMEStoreRule
NMEStore=AuditNmeStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/600.GenerateAuditAndNRBEventsRuleChain/200.DumpMonitoringTransactions]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_NrbMonitoringSessionIdList
RequestAttributes=DEG_AuditProcessingNodeString
RequestAttributes=DEG_AuditTimestampLong
RequestAttributes=DEG_AuditInterfaceString
RequestAttributes=DEG_AuditInOutString
RequestAttributes=DEG_AuditResultCodeString
RequestAttributes=DEG_AuditMdnString
RequestAttributes=DEG_AuditIMSIString
RequestAttributes=DEG_AuditTransactionTypeString
RequestAttributes=DEG_AuditSourceDestinationString
RequestAttributes=DEG_AuditNRBMessageString
RequestAttributes=DEG_AuditMessageString
RuleChain=601.DumpMonitoringTransactionsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.DumpMonitoringTransactions


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.DumpMonitoringTransactions


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_NrbMonitoringSessionIdList != null


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions]

ClassName=com.hp.siu.collector.rules.ListAttributeIterator
ListAttributeName=DEG_NrbMonitoringSessionIdList
RuleChain=100.InsertMonitoringTransactionToDb
TmpAttributeName=DEG_NrbMonitoringSessionIdString


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORINGID_GENERATOR


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateTransactionId
RuleNames=110.PopulateMonitoringTransactionAttributes
RuleNames=120.InitInsert2Db
RuleNames=200.Insert2Db
RuleNames=300.CheckCreateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/100.GenerateTransactionId]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_Tmp1Long
AdornOps=copy DEG_Tmp1Long DEG_Tmp1String
AdornOps=+ DEG_Tmp1String DEG_MSESSIONTRANSID DEG_MSESSIONTRANSID


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/110.PopulateMonitoringTransactionAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_AuditProcessingNodeString DEG_MSESSIONPROCID
AdornOps=copy DEG_AuditTimestampLong DEG_MSESSIONTIMESTAMP
AdornOps=copy DEG_AuditInterfaceString DEG_MSESSIONINTERFACE
AdornOps=copy DEG_AuditInOutString DEG_MSESSIONINOUT
AdornOps=copy DEG_AuditResultCodeString DEG_MSESSIONRESULTCODE
AdornOps=copy DEG_AuditMdnString DEG_MSESSIONMDN
AdornOps=copy DEG_AuditIMSIString DEG_MSESSIONIMSI
AdornOps=copy DEG_AuditTransactionTypeString DEG_MSESSIONTRANSACTIONTYPE
AdornOps=copy DEG_AuditSourceDestinationString DEG_MSESSIONSOURCEDESTINATION
AdornOps=copy DEG_AuditNRBMessageString DEG_MSESSIONMESSAGE
AdornOps=set DEG_MSESSIONUNIQUE_ID ""


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/120.InitInsert2Db]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_NrbMonitoringSessionIdString DEG_MSESSIONID
AdornOps=set log_DB_Operation "CREATE"
AdornOps=set log_Table_Name "DEG_MONITORING_TRANSACTIONS"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/200.Insert2Db]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_MONITORING_TRANSACTIONS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
Operations=or
TrueRuleChain=99.InitErrorLog
TrueRuleChain=100.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus/99.InitErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0007"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to create entry in DEG_MONITORING_TRANSACTIONS table"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/MatchRule/300.CheckCreateStatus/100.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_MSESSIONID
Attributes=DEG_MSESSIONTRANSID
Attributes=DEG_MSESSIONPROCID
Attributes=DEG_MSESSIONTIMESTAMP
Attributes=DEG_MSESSIONINTERFACE
Attributes=DEG_MSESSIONINOUT
Attributes=DEG_MSESSIONRESULTCODE
Attributes=DEG_MSESSIONMDN
Attributes=DEG_MSESSIONTRANSACTIONTYPE
Attributes=DEG_MSESSIONSOURCEDESTINATION
Attributes=DEG_MSESSIONMESSAGE
LogLevel=ERROR
Message=Database Error: Unable to create entry in DEG_MONITORING_TRANSACTIONS session store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetEmptyTransactionId
RuleNames=200.Log


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/100.SetEmptyTransactionId]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_MSESSIONTRANSID ""
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0008"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to generate unique value of monitoring transaction id"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/601.DumpMonitoringTransactionsRuleChain/100.DumpMonitoringTransactions/100.DumpMonitoringTransactions/100.InsertMonitoringTransactionToDb/NoMatchRule/200.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_MSESSIONTRANSID
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=ERROR
Message=Unable to generate unique value of monitoring transaction id: 
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/003.ReadSystemParameterRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReadSystemParameter

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/003.ReadSystemParameterRuleChain/100.ReadSystemParameter]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_SYS_PARAMETER_PARA2VAL


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/003.ReadSystemParameterRuleChain/100.ReadSystemParameter/ErrorRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBErrorFlagInteger 1


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/003.ReadSystemParameterRuleChain/100.ReadSystemParameter/NoMatchRule]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevDBNoMatchFlagInteger 1


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/002.SessionStoreDuplicateKeyRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetDuplicateKeyFlag

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/002.SessionStoreDuplicateKeyRuleChain/100.SetDuplicateKeyFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitLookup
RuleNames=200.Lookup
RuleNames=300.CheckLookupStatus

#Sprint Issue Tracker #67 : Unique-id is not being checked for manageDeviceCredentials call 
#Previous unique id is fetching from tokens table(for GPSAS custom template) before its get updated with new unique id.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/100.InitLookup]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=set CUST_VOWIFI_IN_PrevUniqueIDString ""


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/200.Lookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_UNIQUE_ID,CUST_VOWIFI_IN_PrevUniqueIDString
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckIfSessionKeyExists


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0009"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEGDROID_TOKENS table"
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEGDROID_TOKENS table
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.TokenNotFound

FalseRuleChain=200.TokenFound

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitCreate
RuleNames=200.Create
RuleNames=300.CheckCreateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/100.InitCreate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=copy DEG_CDevTokenString DEG_SUBSTOKEN
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=set DEG_TOKENSTATUS "AE"
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set DEG_AUTH_COUNT 1
AdornOps=set DEG_BLACKLIST_FLAG 0
AdornOps=set log_DB_Operation "CREATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=set DEG_PUSH_TOKEN ""
AdornOps=setifnull DEG_OEMDevUniqueIDString ""
AdornOps=copy DEG_OEMDevUniqueIDString DEG_UNIQUE_ID
AdornOps=setsystime DEG_BLACKLISTWINDOW_STARTTIME

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/200.Create]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckDuplicateKeyError


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0010"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to create entry in DEGDROID_TOKENS table"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=CRITICAL
Message=Database Error: Unable to create entry in DEGDROID_TOKENS session store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
TrueRuleChain=100.UpdateRecentlyCreatedToken


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/100.InitUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=copy DEG_CDevTokenString DEG_SUBSTOKEN
AdornOps=set DEG_TOKENSTATUS "AE"
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_AUTHENTICATION_TYPE,DEG_AUTHENTICATION_TYPE
MapAttributes=DEG_AUTHENTICATION_SUBTYPE,DEG_AUTHENTICATION_SUBTYPE
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckKeyExists


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0011"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEGDROID_TOKENS table"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEGDROID_TOKENS session store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0012"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEGDROID_TOKENS table"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/100.TokenNotFound/300.CheckCreateStatus/200.CheckDuplicateKeyError/100.UpdateRecentlyCreatedToken/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEGDROID_TOKENS session store
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/100.InitUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=copy DEG_CDevTokenString DEG_SUBSTOKEN
AdornOps=copy DEG_OEMDevUniqueIDString DEG_UNIQUE_ID
AdornOps=set DEG_TOKENSTATUS "AE"
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/200.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_SUBSTOKEN,DEG_SUBSTOKEN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
MapAttributes=DEG_AUTHENTICATION_TYPE,DEG_AUTHENTICATION_TYPE
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
MapAttributes=DEG_AUTHENTICATION_SUBTYPE,DEG_AUTHENTICATION_SUBTYPE
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
MapAttributes=DEG_APP_TOKEN_FLAG,DEG_APP_TOKEN_FLAG
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckKeyExists


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0013"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEGDROID_TOKENS table"
AdornOps=set DEG_CDevOutReturnCodeString "500"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevUniqueIDString
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEGDROID_TOKENS table : 
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/200.CheckKeyExists]


ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0014"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEGDROID_TOKENS table"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/005.DEG30StoreTokenRuleChain/300.CheckLookupStatus/200.CheckIfSessionKeyExists/200.TokenFound/300.CheckUpdateStatus/200.CheckKeyExists/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEGDROID_TOKENS table : 
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/000.SessionStoreDefaultErrorRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetLookupErrorFlag
RuleNames=200.LogAlarming

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/000.SessionStoreDefaultErrorRuleChain/100.SetLookupErrorFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0015"
AdornOps=set DEG_OEMDevErrorMessageString "Error while accessing database table"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/000.SessionStoreDefaultErrorRuleChain/200.LogAlarming]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error:
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/001.SessionStoreKeyNotExistsRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ClearDuplicateKeyFlag

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/001.SessionStoreKeyNotExistsRuleChain/100.ClearDuplicateKeyFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=110.CheckHealthCheckDetails
RuleNames=001.Environmetalvalidation
RuleNames=200.CheckRequestProcessedInteger


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/100.InitWorkingVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=set DEG_OEMDevHttpStatusInteger 200
AdornOps=set DEG_OEMDevResponseHandlerString "dummy"
AdornOps=set DEG_OEMDevSSLSSDeletedInteger 0
AdornOps=setsystime DEG_CDevProcessStartTimeLong
AdornOps=set DEG_AuditProcessingNodeString ${HOST_NAME}
#AdornOps=set DEG_OEMDevDateTimeZoneString "UTC"
AdornOps=set DEG_AuditTransactionTypeString "initial-connect"
#QXCM1001470325 fix done by copying DEGDROID_TerminalUniqueIdString to DEG_OEMDevUniqueIDString.
AdornOps=setifnull DEGDROID_TerminalUniqueIdString ""
AdornOps=copy DEGDROID_TerminalUniqueIdString DEG_OEMDevUniqueIDString
AdornOps=set DEG_DevAuthTypeString ${DEGDROID_AUTH_TYPE}
#AdornOps=lower DEG_DevAuthTypeString DEG_DevAuthTypeString
AdornOps=set DEG_OEMDevSslSessionIdString ""
AdornOps=set DEG_OEMDeviceTypeString "Android"

AdornOps=set DEG_AuditSourceDestinationString "AndroidDevice"
AdornOps=set DEG_OEMDevDeviceTypeString ""
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=set DEG_AuditUniqueIDString ""
AdornOps=set DEG_OEMDeviceTokenValidityLong ${DEGDROID_DEVICE_TOKEN_VALIDITY}
AdornOps=* DEG_OEMDeviceTokenValidityLong 1000 DEG_OEMDeviceTokenValidityLong
AdornOps=set DEG_OEMDeviceFullAuthMustWindowLong ${DEGDROID_FULL_AUTH_MUST_WINDOW}
AdornOps=* DEG_OEMDeviceFullAuthMustWindowLong 1000 DEG_OEMDeviceFullAuthMustWindowLong
AdornOps=set DEG_TOKEN_VALIDITY_SECONDS ${DEGDROID_DEVICE_TOKEN_VALIDITY}
AdornOps=copy DEG_TOKEN_VALIDITY_SECONDS DEG_TOKEN_VALIDITY_SECONDSString
AdornOps=set DEG_DevRowExistsFlagInteger 0
AdornOps=set DEG_OEMDevCookieExistInteger 0
AdornOps=setifnull DEG_SSL_ID ""
AdornOps=setifnull DEG_MDN 0
AdornOps=setifnull DEG_OEMDevImsiString ""


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/110.CheckHealthCheckDetails]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,"healthCheck"

TrueRuleChain=100.InitResponse

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/110.CheckHealthCheckDetails/100.InitResponse]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 200
AdornOps=set DEG_SSL_REQUEST_STATE "200C"

#DEGDROID_FULL_AUTH_MUST_WINDOW must be more than the DEGDROID_DEVICE_TOKEN_VALIDITY other wise process will stop.
[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/001.Environmetalvalidation]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDeviceTokenValidityLong,<,DEG_OEMDeviceFullAuthMustWindowLong

FalseRuleChain=100.SetErrorInfo
FalseRuleChain=110.ErrorLog

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/001.Environmetalvalidation/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0016"
AdornOps=set DEG_OEMDevErrorMessageString "Network Authentication Required"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/001.Environmetalvalidation/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDeviceTokenValidityLong
Attributes=DEG_OEMDeviceFullAuthMustWindowLong
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error:DEGDROID_FULL_AUTH_MUST_WINDOW must be more than the DEGDROID_DEVICE_TOKEN_VALIDITY
NullAlso=true
#Action=DEGDROID_FULL_AUTH_MUST_WINDOW must be more than the DEGDROID_DEVICE_TOKEN_VALIDITY .Please contact HP Admin


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.SetAuditTranscationType
TrueRuleChain=110.GetOrGenerateCookie
TrueRuleChain=115.InitLog
TrueRuleChain=115.LogNewHttRequest
TrueRuleChain=120.InsertSession
TrueRuleChain=130.CheckForAuthType
TrueRuleChain=140.SetParametersOfHttpsResponse
TrueRuleChain=150.CheckIfDeleteSSLSession


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/115.InitLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0017"
AdornOps=set DEG_OEMDevMessageString "Received new https request for AndroidDEVICE"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/115.LogNewHttRequest]

Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevTokenString
Attributes=DEGDROID_TerminalUniqueIdString
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEGDROID_SSL_COOKIE_ID
Attributes=DEG_OEMDevOTPLong
#RFE71 : Display source ip in device log.
Attributes=DEG_OEMDevSourceIPAddressString
Attributes=DEG_OEMDevVersionInteger
Attributes=DEG_OEMDevTerminalVendorString
Attributes=DEG_OEMDevTerminalModelString
Attributes=DEG_OEMDevTermianlSWversionString
Attributes=DEG_OEMDevFriendlyDeviceString
Attributes=DEG_OEMDevSipUserNameString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=AndroidDEVICE TO DEG -> Received new https request:
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=100.IterateCookieList
FalseRuleChain=110.CheckIfDEGCookieExists
TrueRuleChain=110.CheckIfDEGCookieExists


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/100.IterateCookieList]

ClassName=ListAttributeIterator
ListAttributeName=DEG_OEMDevCookieList
RuleChain=100.CheckCookieList
TmpAttributeName=DEG_OEMDevCookieTmpString


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/100.IterateCookieList/100.CheckCookieList]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevCookieTmpString,contains,"DEGCID="
TrueRuleChain=100.SetDEGCookie
TrueRuleChain=200.CheckCookieLength


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/100.IterateCookieList/100.CheckCookieList/100.SetDEGCookie]

AdornOps=copy DEG_OEMDevCookieTmpString DEGDROID_SSL_COOKIE_ID
AdornOps=copy DEGDROID_SSL_COOKIE_ID DEG_SSL_ID
AdornOps=copy DEGDROID_SSL_COOKIE_ID DEG_OEMDevSslSessionIdString
AdornOps=set DEG_OEMDevCookieExistInteger 1
AdornOps=length DEG_OEMDevSslSessionIdString DEG_OEMDevSslSessionIdLengthInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/100.IterateCookieList/100.CheckCookieList/200.CheckCookieLength]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSslSessionIdLengthInteger,>,64
TrueRuleChain=100.SetErrorResponse
TrueRuleChain=200.SetErrorLog
TrueRuleChain=300.StartAudit


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/100.IterateCookieList/100.CheckCookieList/200.CheckCookieLength/100.SetErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0018"
AdornOps=set DEG_OEMDevErrorMessageString "Cookie length in the request is exceeded than expected length."
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevOutReturnCodeString "500"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/100.IterateCookieList/100.CheckCookieList/200.CheckCookieLength/200.SetErrorLog]

Attributes=DEG_OEMDevSslSessionIdLengthInteger
Attributes=DEGDROID_SSL_COOKIE_ID
Attributes=DEG_SSL_ID
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=Cookie length in the request is exceeded than expected length. Cannot process the request : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/100.IterateCookieList/100.CheckCookieList/200.CheckCookieLength/300.StartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/110.CheckIfDEGCookieExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevCookieExistInteger,=,0
TrueRuleChain=100.GenerateCookie


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/110.CheckIfDEGCookieExists/100.GenerateCookie]

AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEGDROID_SSL_COOKIE_ID
AdornOps=set DEG_SSL_ID "DEGCID="
AdornOps=+ DEG_SSL_ID DEGDROID_SSL_COOKIE_ID DEG_SSL_ID
AdornOps=copy DEG_SSL_ID DEGDROID_SSL_COOKIE_ID
AdornOps=copy DEGDROID_SSL_COOKIE_ID DEG_OEMDevSslSessionIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/110.GetOrGenerateCookie/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevCookieList == null


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/100.SetAuditTranscationType]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestAttributeString,contains,"IMSI_EAP="
Conditions=DEG_OEMDevRequestAttributeString,contains,"IMSI="
Conditions=DEG_OEMDevRequestAttributeString,contains,"EAP_PAYLD="
Conditions=DEG_OEMDevRequestAttributeString,=,"DEG_OEMDevRequestAttributeString"
Operations=None

TrueRuleChain=SetFullAuthTranscationtype
TrueRuleChain=SetFastAuthTranscationtype
TrueRuleChain=SetChallengeTranscationtype
TrueRuleChain=setInitialConnectTransactiontype

SetFullAuthTranscationtype=100.SetFullAuthTranscationtype
SetFastAuthTranscationtype=200.SetFastAuthTranscationtype
SetChallengeTranscationtype=300.SetChallengeTranscationtype
setInitialConnectTransactiontype=400.setInitialConnectTransactiontype


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/100.SetAuditTranscationType/100.SetFullAuthTranscationtype]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditTransactionTypeString "full-auth-init"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/100.SetAuditTranscationType/200.SetFastAuthTranscationtype]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditTransactionTypeString "fast-auth"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/100.SetAuditTranscationType/300.SetChallengeTranscationtype]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditTransactionTypeString "full-auth-challenge"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/100.SetAuditTranscationType/400.setInitialConnectTransactiontype]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditTransactionTypeString "initial-connect"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=InsertSslSession

InsertSslSession=100.InitSslSessionLookup
#InsertSslSession=115.CheckCookieIDExist
InsertSslSession=110.ExecuteSslSessionLookup
InsertSslSession=120.CheckSslSessionLookupStatus

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/100.InitSslSessionLookup]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/110.ExecuteSslSessionLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_STATE,DEG_SSL_AAA_STATE
#MapAttributes=DEGDROID_SSL_COOKIE_ID,DEGDROID_SSL_COOKIE_ID
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore
#NativeCondition=MatchByCookieID

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/115.CheckCookieIDExist]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEGDROID_SSL_COOKIE_ID,contains,"none"
Conditions=DEGDROID_SSL_COOKIE_ID,=,""
Operations=or
TrueRuleChain=100.CreateCookie
FalseRuleChain=150.CopyCookiefromRequest


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/115.CheckCookieIDExist/150.CopyCookiefromRequest]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEGDROID_SSL_COOKIE_ID DEG_SSL_ID


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/115.CheckCookieIDExist/100.CreateCookie]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEGDROID_SSL_COOKIE_ID
AdornOps=copy DEGDROID_SSL_COOKIE_ID DEG_SSL_ID


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_SSL_ID,=,DEG_SSL_ID
TrueRuleChain=SystemError
TrueRuleChain=NoSslSession
TrueRuleChain=SslSessionExists

SystemError=000.SystemError_SetHttpErrorResponse
SystemError=010.SystemErrorLog
SystemError=020.StartAuditRuleChain

NoSslSession=100.NoSslSession_InitSslSessionCreate
NoSslSession=110.NoSslSession_ExecuteSslSessionCreate
NoSslSession=120.NoSslSession_CheckSslSessionCreateStatus

SslSessionExists=200.SslSessionExists_InitSslSessionUpdate


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/000.SystemError_SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_OEMDevConnectionString "close"
#AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0019"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_SSL_SESSION table"
AdornOps=set DEG_CDevOutReturnCodeString "500"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/010.SystemErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to lookup or access DEG_SSL_SESSION table
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/020.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/100.NoSslSession_InitSslSessionCreate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation INSERT
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 0
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_STATE "NEW"
AdornOps=set DEG_SSL_REQUEST_STATE "NEW"
AdornOps=set DEG_SSL_NAI ""
AdornOps=set DEG_SSL_IMSI ""
AdornOps=set DEG_SSL_MDN ""
AdornOps=set DEG_SSL_UNIQUE_ID ""
AdornOps=setsystime DEG_SSL_CREATETIMESTAMP
AdornOps=copy DEG_SSL_ID DEG_SSL_AAA_SESSIONID
#AdornOps=set DEG_SSL_AAA_SESSIONID ""
AdornOps=set DEG_SSL_AAA_STATE ""
AdornOps=set DEG_STR_FLAG 0
AdornOps=set DEG_SSL_ID_PROV_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=set DEG_SSL_GW_ADDR "NA"
AdornOps=set DEG_SSL_POSTDATA ""
AdornOps=set DEG_SSL_ADDRESS_UPDATE_URL ${DEVICE_SERVICE_MNGT_URL}
AdornOps=set DEG_SSL_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=set DEG_SSL_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=set DEG_SSL_EntitlementStatus ""
#DEGDROID_OTP is string or int?
AdornOps=set DEGDROID_SSL_OTP 0
AdornOps=set DEG_GETAUTH_CONTACTED_AAA ""

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/110.NoSslSession_ExecuteSslSessionCreate]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
Operations=or
TrueRuleChain=000.GenerateStartAudit
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus/000.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus/100.SetHttpErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0020"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to access or create entry in DEG_SSL_SESSION table"
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/120.NoSslSession_CheckSslSessionCreateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to access or create entry in DEG_SSL_SESSION table
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/120.InsertSession/120.CheckSslSessionLookupStatus/200.SslSessionExists_InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_REQUEST_STATE "NEW"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/130.CheckForAuthType]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.CallProcesses


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/130.CheckForAuthType/100.CallProcesses]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_DevAuthTypeString,=,"EAP_AKA"
Conditions=DEG_DevAuthTypeString,=,"OTP"
Conditions=DEG_DevAuthTypeString,=,"NONE"

TrueRuleChain=ProcessEAP_AKARuleChain
TrueRuleChain=ProcessOTPRuleChain
TrueRuleChain=ProcessNONERuleChain

ProcessEAP_AKARuleChain=100.ProcessEAP_AKARuleChain
ProcessOTPRuleChain=200.ProcessOTPRuleChain
ProcessNONERuleChain=300.ProcessNONERuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/130.CheckForAuthType/100.CallProcesses/100.ProcessEAP_AKARuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200.DEG30ProcessRequestRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/130.CheckForAuthType/100.CallProcesses/200.ProcessOTPRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=300.DEG30ProcessOTPRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/130.CheckForAuthType/100.CallProcesses/300.ProcessNONERuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=400.DEG30PrcessNONERuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_SSL_REQUEST_STATE,=,"200"
Conditions=DEG_SSL_REQUEST_STATE,=,"200C"
Conditions=DEG_SSL_REQUEST_STATE,=,"403C"
Conditions=DEG_SSL_REQUEST_STATE,=,"500C"
Conditions=DEG_SSL_REQUEST_STATE,=,"511C"
Conditions=DEG_SSL_REQUEST_STATE,=,"503C"
Conditions=DEG_SSL_REQUEST_STATE,=,DEG_SSL_REQUEST_STATE

TrueRuleChain=Http200
TrueRuleChain=Http200C
TrueRuleChain=Http403C
TrueRuleChain=Http500C
TrueRuleChain=Http511C
TrueRuleChain=Http503C
TrueRuleChain=HttpUnknown


Http200=100.Http200_SetHttpResponse
Http200=104.Http200_InitErrorLog
Http200=110.Http200_LogResponse

Http200C=200.Http200C_SetHttpResponse
Http200C=205.Http200C_InitErrorLog
Http200C=210.Http200C_LogResponse

Http403C=255.Http403C_InitErrorLog
Http403C=300.Http403C_LogResponse
Http403C=310.Http403C_RaiseException

Http500C=350.Http500C_InitErrorLog
Http500C=400.Http500C_LogResponse
Http500C=410.Http500C_RaiseException

HttpUnknown=450.HttpUnknown_InitErrorLog
HttpUnknown=500.HttpUnknown_LogResponse
HttpUnknown=510.HttpUnknown_RaiseException

Http511C=550.Http511C_InitErrorLog
Http511C=600.Http511C_LogResponse
Http511C=610.Http511C_RaiseException

Http503C=655.Http503C_InitErrorLog
Http503C=700.Http503C_LogResponse
Http503C=710.Http503C_RaiseException

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/100.Http200_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 200
AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"
###AdornOps=set DEG_OEMDevConnectionString "keep-alive"
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_OEMDevRequestProcessedInteger 0

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/104.Http200_InitErrorLog]
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0021"
AdornOps=set DEG_OEMDevMessageString "Action processed successfully"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/110.Http200_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevRespPhoneNumberString
Attributes=DEG_OEMDevRespStatusString
Attributes=DEG_OEMDevMessageString
Attributes=DEG_CDevProcessingMessageIdString
LogLevel=INFO
Message=Action processed successfully - http status set to 200 and http session not closed: 
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/200.Http200C_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 200
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "TextResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_OEMDevRequestProcessedInteger 0

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/205.Http200C_InitErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0022"
AdornOps=set DEG_OEMDevMessageString "Action processed successfully"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/210.Http200C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevRespPhoneNumberString
Attributes=DEG_OEMDevRespStatusString
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
LogLevel=INFO
NullAlso=true
Message=Action processed successfully - http status set to 200 and http session closed: 

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/255.Http403C_InitErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0023"
AdornOps=setifnull DEG_OEMDevErrorMessageString "OEM action is invalid"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/300.Http403C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=INFO
Message=OEM action is invalid - http status is set to 403 and http session closed: 
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/310.Http403C_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=403C
ErrorMessage=Http Request is rejected with http status 403

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/350.Http500C_InitErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0024"
AdornOps=setifnull DEG_OEMDevErrorMessageString "Http status is set to 500 and http session closed"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/400.Http500C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=INFO
Message=Internal error during OEM action processing - http status set to 500 and http session closed: 
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/410.Http500C_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=500C
ErrorMessage=Http Request is rejected with http status 500

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/450.HttpUnknown_InitErrorLog]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0025"
AdornOps=set DEG_OEMDevErrorMessageString "Unknown internal error during OEM action processing"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/500.HttpUnknown_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=INFO
Message=Unknown internal error during OEM action processing - http status set to 500 and http session closed: 
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/510.HttpUnknown_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=500C
ErrorMessage=Http Request is rejected with http status 500

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/550.Http511C_InitErrorLog]
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0026"
AdornOps=set DEG_OEMDevErrorMessageString "Internal error during OEM action processing"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/600.Http511C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=INFO
Message=Internal error during OEM action processing - http status set to 511 and http session closed: 
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/610.Http511C_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=511C
ErrorMessage=Http Request is rejected with http status 511

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/655.Http503C_InitErrorLog]
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0027"
AdornOps=set DEG_OEMDevErrorMessageString "Internal error during OEM action processing"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/700.Http503C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=INFO
Message=Internal error during OEM action processing - http status set to 503 and http session closed: 
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/140.SetParametersOfHttpsResponse/710.Http503C_RaiseException]

ClassName=com.hp.usage.listoperations.RaiseCustomRuleExceptionRule
ErrorId=503C
ErrorMessage=Http Request is rejected with http status 503

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/150.CheckIfDeleteSSLSession]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSSLSSDeletedInteger,=,0
TrueRuleChain=100.CheckSSLSessionStatus

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/150.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"NEW"
Conditions=DEG_SSL_STATE,=,UNKNOWN_SUBSCRIBER
Conditions=DEG_SSL_STATE,=,AUTHENTICATED_BY_DEG_TOKEN
Conditions=DEG_SSL_STATE,=,AUTHENTICATED_BY_AAA
Conditions=DEG_SSL_STATE,=,AKA_CHALLENGE_REJECTED_BY_AAA
Operations=or,or,or,or
TrueRuleChain=100.InitSslSessionDelete
TrueRuleChain=110.ExecuteSslSessionDelete

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/150.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus/100.InitSslSessionDelete]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_OEMDevSSLSSDeletedInteger 1

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/100.DEG30ProcessAndroidRequestRuleChain/200.CheckRequestProcessedInteger/150.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus/110.ExecuteSslSessionDelete]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
SessionStore=DEG_SSL_SESSION_SessionStore
#NativeCondition=MatchByCookieID


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ValidateRequest

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPSubscriberIdString,=,dummy
Conditions=DEG_OEMDevEAPPayloadString,=,dummy
Conditions=DEG_OEMDevSubscriberIdString,=,dummy
Conditions=DEG_OEMDevTokenString,=,dummy
Conditions=DEG_OEMDevServiceNameList,=,com.hp.siu.utils.StringAttribute|1|64756d6d79
Conditions=DEG_OEMDevVersionInteger,=,-1
Conditions=DEG_OEMDevTerminalVendorString,=,dummy
Conditions=DEG_OEMDevTerminalModelString,=,dummy
Conditions=DEG_OEMDevTermianlSWversionString,=,dummy
Conditions=DEGDROID_TerminalUniqueIdString,=,dummy
Conditions=DEG_OEMDevFriendlyDeviceString,=,-99DEGINVALID-99
Conditions=DEG_OEMDevSipUserNameString,=,-99DEGINVALID-99
Conditions=DEG_OEMDevOTPLong,=,99999
Operations=and,and,and,and,and,and,and,and,and,and,and,and

TrueRuleChain=100.CallForRCSLogic

##QXCM1001474759 -- Device send the request without any parameters and it returns 200 OK instead of 403.

FalseRuleChain=200.ValidateRequestParameters


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/100.CallForRCSLogic]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=150.DEG30RCSInitialConnectRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/150.GenerateStartAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=ValidateEAPSubscriberId
TrueRuleChain=ValidateIMSISubscriberId
TrueRuleChain=ValidateEAPPayload
TrueRuleChain=ValidateToken
TrueRuleChain=ValidateServiceName
TrueRuleChain=ValidateVersion
TrueRuleChain=ValidateOTP
TrueRuleChain=ValidateIMSIEAPandIMSI
TrueRuleChain=ValidateIMSIEAPandToken
TrueRuleChain=ValidateEAPPayloadandIMSI
TrueRuleChain=ValidateEAPPayloadandToken
TrueRuleChain=ValidateIMSIEAPandEAPPayload
TrueRuleChain=ValidateIMSIandToken
TrueRuleChain=ValidateServiceNameandVersion
TrueRuleChain=ValidateTerminalUniqueId

ValidateEAPSubscriberId=100.ValidateEAPSubscriberId
ValidateIMSISubscriberId=110.ValidateIMSISubscriberId
ValidateEAPPayload=200.ValidateEAPPayload
ValidateToken=300.ValidateToken
ValidateOTP=310.ValidateOTP
ValidateServiceName=400.ValidateServiceName
ValidateVersion=500.ValidateVersion
ValidateIMSIEAPandIMSI=600.ValidateIMSIEAPandIMSI
ValidateIMSIEAPandToken=700.ValidateIMSIEAPandToken
ValidateEAPPayloadandIMSI=800.ValidateEAPPayloadandIMSI
ValidateEAPPayloadandToken=900.ValidateEAPPayloadandToken
ValidateIMSIEAPandEAPPayload=1000.ValidateIMSIEAPandEAPPayload
ValidateIMSIandToken=1100.ValidateIMSIEAPandEAPPayload
ValidateServiceNameandVersion=1200.ValidateServiceNameandVersion
ValidateTerminalUniqueId=1300.ValidateTerminalUniqueId

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1300.ValidateTerminalUniqueId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEGDROID_TerminalUniqueIdString,=,""
Conditions=DEGDROID_TerminalUniqueIdString,=,dummy
Operations=or
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1300.ValidateTerminalUniqueId/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0028"
AdornOps=set DEG_OEMDevErrorMessageString "Terminal ID is mandatory"
AdornOps=set DEG_OEMDevUniqueIDString ""
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1300.ValidateTerminalUniqueId/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevServiceNameList
Attributes=DEG_OEMDevVersionInteger
Attributes=DEGDROID_TerminalUniqueIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request : Terminal ID is empty:
NullAlso=true
#Action=Invalid initial-auth-request : Both Service name and Version should come in the request.  Contact HP Support.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1300.ValidateTerminalUniqueId/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1200.ValidateServiceNameandVersion]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevServiceNameList,!=,com.hp.siu.utils.StringAttribute|1|
Conditions=DEG_OEMDevServiceNameList,!=,com.hp.siu.utils.StringAttribute|1|64756d6d79
Conditions=DEG_OEMDevVersionInteger,=,-1

Operations=and,and

TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1200.ValidateServiceNameandVersion/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0029"
AdornOps=set DEG_OEMDevErrorMessageString "Both Servicename and Version should come inthe request"
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1200.ValidateServiceNameandVersion/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevServiceNameList
Attributes=DEG_OEMDevVersionInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request : Both Service name and Version should come in the request:
NullAlso=true
#Action=Invalid initial-auth-request : Both Service name and Version should come in the request.  Contact HP Support.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1200.ValidateServiceNameandVersion/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/100.ValidateEAPSubscriberId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPSubscriberIdString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/100.ValidateEAPSubscriberId/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0030"
AdornOps=set DEG_OEMDevErrorMessageString "EAP SubscriberId is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/100.ValidateEAPSubscriberId/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request : EAP SubscriberId is empty: 
NullAlso=true
#Action=Invalid initial-auth-request : EAP SubscriberId is empty . Contact HP Admin.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/100.ValidateEAPSubscriberId/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/110.ValidateIMSISubscriberId]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/110.ValidateIMSISubscriberId/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0031"
AdornOps=set DEG_OEMDevErrorMessageString "SubscriberId is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/110.ValidateIMSISubscriberId/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
LogLevel=WARNING
Message=Invalid request : SubscriberId is empty: 
NullAlso=true
#Action=Invalid initial-auth-request : SubscriberId is empty .


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/110.ValidateIMSISubscriberId/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/200.ValidateEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPPayloadString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/200.ValidateEAPPayload/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0032"
AdornOps=set DEG_OEMDevErrorMessageString "EAPPayload is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/200.ValidateEAPPayload/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request : EAPPayload is empty: 
NullAlso=true
#Action=Invalid initial-auth-request : EAPPayload is empty. Contact HP Admin.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/200.ValidateEAPPayload/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/300.ValidateToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenString,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/300.ValidateToken/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
#AdornOps=set DEG_OEMDevHttpStatusInteger 403
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0033"
AdornOps=set DEG_OEMDevErrorMessageString "Token is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/300.ValidateToken/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request : Token is empty: 
NullAlso=true
#Action=Invalid initial-auth-request : Token is empty .Contact HP Admin.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/300.ValidateToken/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/310.ValidateOTP]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevOTPLong,=,-1
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/310.ValidateOTP/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0034"
AdornOps=set DEG_OEMDevErrorMessageString "OTP is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/310.ValidateOTP/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request : OTP is empty: 
NullAlso=true
#Action=Invalid initial-auth-request : OTP is empty . Contact HP Admin.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/310.ValidateOTP/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/400.ValidateServiceName]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevServiceNameList,=,com.hp.siu.utils.StringAttribute|1|
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/400.ValidateServiceName/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0035"
AdornOps=set DEG_OEMDevErrorMessageString "service_name is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/400.ValidateServiceName/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevServiceNameList
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request : service_name is empty: 
NullAlso=true
#Action=Invalid initial-auth-request : service_name is empty .Contact HP Admin

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/400.ValidateServiceName/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/500.ValidateVersion]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevVersionInteger,=,""
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/500.ValidateVersion/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0036"
AdornOps=set DEG_OEMDevErrorMessageString "version is empty"
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/500.ValidateVersion/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevVersionInteger
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request : version is empty: 
NullAlso=true
#Action=Invalid initial-auth-request : version is empty . Contact HP Admin.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/500.ValidateVersion/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/600.ValidateIMSIEAPandIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy

Operations=and

TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/600.ValidateIMSIEAPandIMSI/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0037"
AdornOps=set DEG_OEMDevErrorMessageString "Both EAP SubscriberId and SubscriberId should not come in the request"
AdornOps=set DEG_CDevOutReturnCodeString "403"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/600.ValidateIMSIEAPandIMSI/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request : Both EAP SubscriberId and SubscriberId should not come in the request:
NullAlso=true
#Action=Invalid initial-auth-request : Both EAP SubscriberId and SubscriberId should not come in the request.Contact HP Admin.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/600.ValidateIMSIEAPandIMSI/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/700.ValidateIMSIEAPandToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevTokenString,!=,dummy

Operations=and

TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/700.ValidateIMSIEAPandToken/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0038"
AdornOps=set DEG_OEMDevErrorMessageString "Both EAP SubscriberId and token should not come inthe request"
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/700.ValidateIMSIEAPandToken/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request : Both EAP SubscriberId and token should not come inthe request:
NullAlso=true
#Action=Invalid initial-auth-request : Both EAP SubscriberId and token should not come in the request . Contact HP Admin.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/700.ValidateIMSIEAPandToken/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/800.ValidateEAPPayloadandIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPPayloadString,!=,dummy
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy

Operations=and

TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/800.ValidateEAPPayloadandIMSI/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0039"
AdornOps=set DEG_OEMDevErrorMessageString "Both EAPPayload  and SubscriberId should not come inthe request"
AdornOps=set DEG_CDevOutReturnCodeString "403"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/800.ValidateEAPPayloadandIMSI/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request : Both EAPPayload  and SubscriberId should not come in the request:
NullAlso=true
#Action=Invalid initial-auth-request : Both EAPPayload  and SubscriberId should not come in the request.Contact HP Admin.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/800.ValidateEAPPayloadandIMSI/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/900.ValidateEAPPayloadandToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPPayloadString,!=,dummy
Conditions=DEG_OEMDevTokenString,!=,dummy

Operations=and

TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/900.ValidateEAPPayloadandToken/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0040"
AdornOps=set DEG_OEMDevErrorMessageString "Both EAPPayload  and token should not come inthe request"
AdornOps=set DEG_CDevOutReturnCodeString "403"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/900.ValidateEAPPayloadandToken/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_OEMDevTokenString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request : Both EAPPayload  and token should not come inthe request:
NullAlso=true
#Action=Invalid initial-auth-request : Both EAPPayload  and token should not come in the request .Contact HP Admin.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/900.ValidateEAPPayloadandToken/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1000.ValidateIMSIEAPandEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevEAPSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevEAPPayloadString,!=,dummy

Operations=and

TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1000.ValidateIMSIEAPandEAPPayload/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0041"
AdornOps=set DEG_OEMDevErrorMessageString "Both EAP SubscriberId and EAPPayload should not come inthe request"
AdornOps=set DEG_CDevOutReturnCodeString "403"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1000.ValidateIMSIEAPandEAPPayload/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevEAPSubscriberIdString
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request : Both EAP SubscriberId and EAPPayload should not come in the request:
NullAlso=true
#Action=Invalid initial-auth-request : Both EAP SubscriberId and EAPPayload should not come in the request . Contact HP Admin.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1000.ValidateIMSIEAPandEAPPayload/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1100.ValidateIMSIEAPandEAPPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy
Conditions=DEG_OEMDevTokenString,=,dummy
Conditions=DEG_DevAuthTypeString,!=,NONE

Operations=and,and

TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1100.ValidateIMSIEAPandEAPPayload/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0042"
AdornOps=set DEG_OEMDevErrorMessageString "Token is required in the request"
AdornOps=set DEG_CDevOutReturnCodeString "403"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1100.ValidateIMSIEAPandEAPPayload/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_DevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevEAPPayloadString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request : Token is required in the request:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/110.DEG30ValidateInitialRequestRuleChain/100.ValidateRequest/200.ValidateRequestParameters/1100.ValidateIMSIEAPandEAPPayload/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetParametersOfHttpResponse
RuleNames=200.CheckIfDeleteSSLSession


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_SSL_REQUEST_STATE,=,"NEW"
Conditions=DEG_OEMDevHttpErrorNameString,contains,DecodeException
Conditions=DEG_OEMDevHttpErrorNameString,contains,XMLStreamException
Conditions=DEG_SSL_REQUEST_STATE,=,"403C"
Conditions=DEG_SSL_REQUEST_STATE,=,"500C"
Conditions=DEG_SSL_REQUEST_STATE,=,"503C"
Conditions=DEG_SSL_REQUEST_STATE,=,"511C"
Conditions=DEG_SSL_REQUEST_STATE,=,DEG_SSL_REQUEST_STATE

TrueRuleChain=GzipParseError
TrueRuleChain=JsonParseError
TrueRuleChain=JsonParseError2
TrueRuleChain=Http403C
TrueRuleChain=Http500C
TrueRuleChain=Http503C
TrueRuleChain=Http511C
TrueRuleChain=HttpUnknown

GzipParseError=100.GzipParseError_SetHttpResponse
GzipParseError=110.GzipParseError_LogResponse

JsonParseError=200.JsonParseError_SetHttpResponse
JsonParseError=210.JsonParseError_LogResponse

JsonParseError2=200.JsonParseError_SetHttpResponse
JsonParseError2=210.JsonParseError_LogResponse

Http403C=300.Http403C_SetHttpResponse
Http403C=305.Http403C_EndAudit
Http403C=310.Http403C_LogResponse

Http500C=400.Http500C_SetHttpResponse
Http500C=405.Http500C_EndAudit
Http500C=410.Http500C_LogResponse

Http503C=600.Http503C_SetHttpResponse
Http503C=610.Http503C_LogResponse

Http511C=700.Http511C_SetHttpResponse
Http511C=710.Http511C_LogResponse

HttpUnknown=500.HttpUnknown_SetHttpResponse
HttpUnknown=510.HttpUnknown_LogResponse


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/100.GzipParseError_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 403
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0043"
AdornOps=set DEG_OEMDevErrorMessageString "GZIP decopmressing error"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/110.GzipParseError_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=GZIP decopmressing error - request processed with http status 403 and http session closed: 
NullAlso=true
#Action=GZIP decopmressing error - request processed with http status 403 and http session closed . Contact HP Admin.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/200.JsonParseError_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 403
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0044"
AdornOps=set DEG_OEMDevErrorMessageString "JSON parsing error"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/210.JsonParseError_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=JSON parsing error - request processed with http status 403 and http session closed: 
NullAlso=true
#Action=JSON parsing error - request processed with http status 403 and http session closed . Contact HP Admin.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/300.Http403C_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 403
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0045"
#AdornOps=set DEG_OEMDevErrorMessageString "Invalid request, http status 403"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/305.Http403C_EndAudit]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,!=,"UNKNOWN_SUBSCRIBER"
TrueRuleChain=InvokeEndAuditDataRuleChain


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/305.Http403C_EndAudit/InvokeEndAuditDataRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/310.Http403C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Invalid request  Response is http status 403 and http session closed
NullAlso=true
#Action=Invalid request  Response is http status 403 and http session closed . Contact HP Admin.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/400.Http500C_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0046"
AdornOps=setifnull DEG_OEMDevErrorMessageString "Internal error, http status 500"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/405.Http500C_EndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/410.Http500C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Internal error Response is http status 500 and http session closed
NullAlso=true
#Action=Internal error Response is http status 500 and http session closed. Contact HP Admin.


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/600.Http503C_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 503
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0047"
AdornOps=set DEG_OEMDevErrorMessageString "Internal error, http status 503"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/610.Http503C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Internal error Response is http status 503 and http session closed
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/700.Http511C_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 511
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0048"
AdornOps=set DEG_OEMDevErrorMessageString "Internal error, http status 511"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/710.Http511C_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Internal error Response is http status 511 and http session closed
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/500.HttpUnknown_SetHttpResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevHttpStatusInteger 500
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0049"
AdornOps=set DEG_OEMDevErrorMessageString "Unrecognized internal state"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/100.SetParametersOfHttpResponse/510.HttpUnknown_LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_SSL_REQUEST_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Unrecognized internal state - request processed with http status 500 and http session closed: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/200.CheckIfDeleteSSLSession]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSSLSSDeletedInteger,=,0
TrueRuleChain=100.CheckSSLSessionStatus


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/200.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"NEW"
Conditions=DEG_SSL_STATE,=,UNKNOWN_SUBSCRIBER
Conditions=DEG_SSL_STATE,=,AUTHENTICATED_BY_DEG_TOKEN
Conditions=DEG_SSL_STATE,=,AUTHENTICATED_BY_AAA
Conditions=DEG_SSL_STATE,=,AKA_CHALLENGE_REJECTED_BY_AAA
Operations=or,or,or,or
TrueRuleChain=100.InitSslSessionDelete
TrueRuleChain=110.ExecuteSslSessionDelete


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/200.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus/100.InitSslSessionDelete]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation DELETE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_OEMDevSSLSSDeletedInteger 1


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/120.DEG30ProcessOEMParsingErrorRuleChain/200.CheckIfDeleteSSLSession/100.CheckSSLSessionStatus/110.ExecuteSslSessionDelete]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
SessionStore=DEG_SSL_SESSION_SessionStore
#NativeCondition=MatchByCookieID


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckTokenTimeStamp

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0


FalseRuleChain=200.SetFullAuthTimeStamp
TrueRuleChain=100.GetDifference
TrueRuleChain=110.SetTokenLifeTime
TrueRuleChain=110.CheckTokenLifeTime
TrueRuleChain=115.SetErrorInfo
TrueRuleChain=120.TokenExpirationLog

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/200.SetFullAuthTimeStamp]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_FULLAUTHTIMESTAMP

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/100.GetDifference]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_FULLAUTHTIMESTAMP DEG_OEMDevTokenTimeStampDiffLong

#in case of Android token life time taken from the enviroment variable
[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.SetTokenLifeTime]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevEAPTokenLifetimeLong ${DEGDROID_FULL_AUTH_MUST_WINDOW}
AdornOps=* DEG_OEMDevEAPTokenLifetimeLong 1000 DEG_OEMDevEAPTokenLifetimeLong

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.CheckTokenLifeTime]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenTimeStampDiffLong,<=,DEG_OEMDevEAPTokenLifetimeLong

TrueRuleChain=100.SetFastAuthFlag
FalseRuleChain=200.CheckRequestIMSI

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.CheckTokenLifeTime/100.SetFastAuthFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevFastAuthFlag 1

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.CheckTokenLifeTime/200.CheckRequestIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,!=,dummy

TrueRuleChain=200.SetErrorInfo
TrueRuleChain=210.ErrorLog
TrueRuleChain=220.GenerateInitialAuthSystemErrorEndAuditData


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.CheckTokenLifeTime/200.CheckRequestIMSI/200.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "511C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0050"
AdornOps=set DEG_SSL_STATE "NEW"
AdornOps=set DEG_CDevOutReturnCodeString "511"
AdornOps=set DEG_OEMDevErrorMessageString "Network Authentication Required"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.CheckTokenLifeTime/200.CheckRequestIMSI/210.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_FULLAUTHTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=INFO
Message=Token Expired : Network Authentication Required : 
NullAlso=true
#Action=Network Authentication Required. Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.CheckTokenLifeTime/200.CheckRequestIMSI/220.GenerateInitialAuthSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=707.DEG30GenerateEapAkaInitialSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/115.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0051"
AdornOps=set DEG_OEMDevErrorMessageString "Token Expire"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/130.DEG30CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/120.TokenExpirationLog]

Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevCurrentTimeStampLong
Attributes=DEG_OEMDevTokenTimeStampDiffLong
Attributes=DEG_FULLAUTHTIMESTAMP
Attributes=DEG_OEMDevFastAuthFlag
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_TOKENSTATUS
Attributes=DEG_OEMDevTokenString
Attributes=DEG_SUBSTOKEN
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_OEMDevEAPTokenLifetimeLong
Attributes=DEG_CDevDBErrorFlagInteger
Attributes=DEG_CDevDBNoMatchFlagInteger
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=TokenExpiration Log:
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.BlackListSubscriber_InitResponse
RuleNames=200.UpdateSslSessionState

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/100.BlackListSubscriber_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 511
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 511
AdornOps=set DEG_SSL_REQUEST_STATE "511C"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=300.CheckSslSessionUpdateStatus

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/100.InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_SSL_STATE "BLACKLISTED_SUBSCRIBER"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.StartAuditRuleChain
FalseRuleChain=120.StartAuditRuleChain
FalseRuleChain=200.CheckKeyExists


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0052"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update entry in DEG_SSL_SESSION table"
AdornOps=set DEG_CDevOutReturnCodeString "500"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=CRITICAL
Message=Database Error: Unable to update entry in DEG_SSL_SESSION table : 
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/120.StartAuditRuleChain]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=501.GenerateAndroidStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
FalseRuleChain=100.GenerateEndAuditForBlackListSubsciber


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.GenerateEndAuditForBlackListSubsciber]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=708.DEG30GenerateEapAkaInitialBlackListSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0053"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/140.DEG30GenerateBlackListedResponseRuleChain/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Database Error: Unable to update entry in DEG_SSL_SESSION session store
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain]

ClassName=RuleChain
RuleNames=100.InitVariables
RuleNames=200.CheckIfBlackListEnabled


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/100.InitVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
#AdornOps=copy DEG_CDevMobileNumberString DEG_MDN
AdornOps=setifnull DEG_MDN 0
AdornOps=setifnull DEG_BLACKLIST_FLAG 0
AdornOps=setifnull DEG_AUTH_COUNT 0
AdornOps=set DEG_EVENTTIMESTAMP 0
AdornOps=set DEG_FULLAUTHTIMESTAMP 0
AdornOps=set DEG_BLACKLISTWINDOW_STARTTIME 0
AdornOps=set DEG_OEMDevBlacklistStatusString ${DEG_BLACKLIST_STATUS}
AdornOps=lower DEG_OEMDevBlacklistStatusString DEG_OEMDevBlacklistStatusString


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled]

ClassName=ConditionalRule
Conditions=DEG_OEMDevBlacklistStatusString,=,"enabled"
TrueRuleChain=200.LookupDEGDROIDToken
TrueRuleChain=300.CheckDEGToken
TrueRuleChain=400.UpdateDEGToken


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/200.LookupDEGDROIDToken]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
MapAttributes=DEG_BLACKLISTWINDOW_STARTTIME,DEG_BLACKLISTWINDOW_STARTTIME
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckIfSessionKeyExists


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0054"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
AdornOps=set DEG_CDevOutReturnCodeString "500"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEGDROID_TOKENS table
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=100.TokenNotFound
FalseRuleChain=200.TokenFound


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/100.TokenNotFound]

ClassName=AdornmentRule
AdornOps=set DEG_AUTH_COUNT 0
AdornOps=setsystime DEG_BLACKLISTWINDOW_STARTTIME


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckIfSubscriberIsBlacklisted
RuleNames=200.CheckAndUpdateAuthCount


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted]

ClassName=ConditionalRule
Conditions=DEG_BLACKLIST_FLAG,=,1
TrueRuleChain=100.SetBlackListedResponse


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GetDifference
RuleNames=200.CheckDOAWindow


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/100.GetDifference]

ClassName=AdornmentRule
AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=set DEG_OEMDevDenialOfActionWindowLong ${DENIAL_OF_ACTION_WINDOW}
AdornOps=copy DEG_BLACKLISTWINDOW_STARTTIME DEG_OEMDevDOAStartTimeLong
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_OEMDevDOAStartTimeLong DEG_OEMDevTimeStampDiffLong


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/200.CheckDOAWindow]

ClassName=ConditionalRule
Conditions=DEG_OEMDevTimeStampDiffLong,<,DEG_OEMDevDenialOfActionWindowLong
TrueRuleChain=100.GenerateBlackListedResponse
TrueRuleChain=101.SetErrorResponse
TrueRuleChain=200.LogBlackListSubscriber
FalseRuleChain=200.ResetAuthCount


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/200.CheckDOAWindow/100.GenerateBlackListedResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=140.DEG30GenerateBlackListedResponseRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/200.CheckDOAWindow/101.SetErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0055"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber is blacklisted"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/200.CheckDOAWindow/200.LogBlackListSubscriber]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_AUTH_COUNT
Attributes=DEG_OEMDevImsiString
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_BLACKLISTWINDOW_STARTTIME
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Message=Subscriber is blacklisted :
LogLevel=ERROR
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/100.CheckIfSubscriberIsBlacklisted/100.SetBlackListedResponse/200.CheckDOAWindow/200.ResetAuthCount]

ClassName=AdornmentRule
AdornOps=set DEG_BLACKLIST_FLAG 0
AdornOps=set DEG_AUTH_COUNT 0
AdornOps=setsystime DEG_BLACKLISTWINDOW_STARTTIME


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount]

ClassName=ConditionalRule
Conditions=DEG_BLACKLIST_FLAG,=,0
TrueRuleChain=VerifyIfSubscriberBlacklisted


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted]

ClassName=RuleChain
RuleNames=100.GetDifference
RuleNames=200.CheckEventTimeStamp


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/100.GetDifference]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=copy DEG_BLACKLISTWINDOW_STARTTIME DEG_OEMDevBlackListWindowStartTimeLong
AdornOps=set DEG_OEMDevBlackListWindowLong ${BLACKLIST_TIMEWINDOW}
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_OEMDevBlackListWindowStartTimeLong DEG_OEMDevTimeStampDiffLong


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTimeStampDiffLong,<,DEG_OEMDevBlackListWindowLong
TrueRuleChain=000.GetAuthThresholdCount
TrueRuleChain=100.UpdateAuthCount
TrueRuleChain=200.CheckAuthCount
FalseRuleChain=200.ResetAuthCount


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequest
RuleNames=110.ReadValue
RuleNames=120.CheckErrorAndNoMatchFlag


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/100.InitRequest]

AdornOps=set DEG_OEMDevLicenseTypeString "EAP"
AdornOps=set DEG_OEMDevAuthThresholdCountInteger 0
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_OEMDevLicenseTypeString
ResponseAttributes=DEG_OEMDevAuthThresholdCountInteger
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=004.ReadTokenLifeTimeRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
FalseRuleChain=210.SetErrorForLog
FalseRuleChain=220.ErrorLog
TrueRuleChain=100.CheckIfKeyExist


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag/210.SetErrorForLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0056"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag/220.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to access DEG_LIC_LIMITS cache
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
FalseRuleChain=210.SetErrorForLog
FalseRuleChain=220.RowNotExistsLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/210.SetErrorForLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0057"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/000.GetAuthThresholdCount/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/220.RowNotExistsLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=No Row Found in DEG_LIC_LIMITS cache: 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/100.UpdateAuthCount]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=+ DEG_AUTH_COUNT 1 DEG_AUTH_COUNT


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.CheckAuthCount]

ClassName=ConditionalRule
Conditions=DEG_AUTH_COUNT,>,DEG_OEMDevAuthThresholdCountInteger
TrueRuleChain=100.SetBlackListed
TrueRuleChain=200.SendBlacklistResponse
TrueRuleChain=210.SetErrorResponse
TrueRuleChain=300.LogBlackListSubscriber

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.CheckAuthCount/210.SetErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0058"
AdornOps=set DEG_OEMDevErrorMessageString "Subscriber is blacklisted"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.CheckAuthCount/300.LogBlackListSubscriber]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_BLACKLISTWINDOW_STARTTIME
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Message=Subscriber is blacklisted :
LogLevel=ERROR
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.CheckAuthCount/100.SetBlackListed]

AdornOps=set DEG_BLACKLIST_FLAG 1
#AdornOps=set DEG_AUTH_COUNT 0
AdornOps=setsystime DEG_BLACKLISTWINDOW_STARTTIME
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.CheckAuthCount/200.SendBlacklistResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=140.DEG30GenerateBlackListedResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/300.CheckDEGToken/200.CheckIfSessionKeyExists/200.TokenFound/200.CheckAndUpdateAuthCount/VerifyIfSubscriberBlacklisted/200.CheckEventTimeStamp/200.ResetAuthCount]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AUTH_COUNT 1
AdornOps=setsystime DEG_BLACKLISTWINDOW_STARTTIME


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.LogRule
RuleNames=010.SetErrorResponse
RuleNames=100.InitUpdate
RuleNames=200.Update
RuleNames=300.CheckUpdateStatus

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/010.SetErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0059"
AdornOps=set DEG_OEMDevMessageString "While updating DEGDROID_TOKENS table"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/000.LogRule]

ClassName=LogNMERule
Message=While updating DEGDROID_TOKENS table :
Attributes=DEG_IMSI
Attributes=DEG_BLACKLISTWINDOW_STARTTIME
Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
LogLevel=DEBUG
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/100.InitUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
#AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=setsystime DEG_EVENTTIMESTAMP
AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEGDROID_TOKENS"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/200.Update]

ClassName=ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
TrueRuleChain=UpdateTokenstable


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/200.Update/UpdateTokenstable]

ClassName=UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_BLACKLIST_FLAG,DEG_BLACKLIST_FLAG
MapAttributes=DEG_AUTH_COUNT,DEG_AUTH_COUNT
MapAttributes=DEG_EVENTTIMESTAMP,DEG_EVENTTIMESTAMP
MapAttributes=DEG_BLACKLISTWINDOW_STARTTIME,DEG_BLACKLISTWINDOW_STARTTIME
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_TOKENS_SessionStore


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1

TrueRuleChain=000.SetErrorInfo
TrueRuleChain=100.SystemErrorLog


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/300.CheckUpdateStatus/000.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
#AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0060"
AdornOps=set DEG_OEMDevErrorMessageString "Error while updating DEGDROID_TOKENS table"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/150.DEG30BlackListeSubscriberRuleChain/200.CheckIfBlackListEnabled/400.UpdateDEGToken/300.CheckUpdateStatus/100.SystemErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=log_DB_Operation
Attributes=log_Table_Name
Attributes=DEG_IMSI
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=CRITICAL
Message=Database Error: while updating DEGDROID_TOKENS table :
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ExecuteResponseTemplateLookup
RuleNames=200.CheckLookupStatus

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/100.ExecuteResponseTemplateLookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_AUTH_TYPE,DEG_AUTH_TYPE
MapAttributes=DEG_AUTH_STEP,DEG_AUTH_STEP
MapAttributes=DEG_XML_TEMPLATES_FILE,DEG_XML_TEMPLATES_FILE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEGDROID_AUTH_XML_TEMPLATES_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/200.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0

TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/200.CheckLookupStatus/100.SetHTTPErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0061"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to perform lookup or access DEGDROID_AUTH_XML_TEMPLATES table"
AdornOps=set DEG_CDevOutReturnCodeString "500"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/200.CheckLookupStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEGDROID_AUTH_XML_TEMPLATES table
NullAlso=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/200.CheckLookupStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog

FalseRuleChain=200.MessageFormatRule

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/200.CheckLookupStatus/200.CheckKeyExists/200.MessageFormatRule]

ClassName=com.hp.usage.rules.transform.MessageFormatRule
Locale=en_US
MessageFormat=DEG_XML_TEMPLATES_FILE
ResultAttribute=DEG_XML_TEMPLATES_FILE
UseDynamicMessageFormat=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/200.CheckLookupStatus/200.CheckKeyExists/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevOutReturnCodeString "500"
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0062"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to find a row in DEGDROID_AUTH_XML_TEMPLATES table"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/160.DEG30GetResponseTemplatesRuleChain/200.CheckLookupStatus/200.CheckKeyExists/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=ERROR
Message=Database Error: Unable to find the record in DEGDROID_AUTH_XML_TEMPLATES table : 
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckDBStatus
RuleNames=100.InitializeRequestVariables
RuleNames=110.InvokeHttpRequest
RuleNames=120.CheckResultCode
RuleNames=121.SetErrorResponse
RuleNames=200.LogResponse

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdateAttributes
RuleNames=200.UpdateHCData
RuleNames=300.CheckUpdateStatus

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/100.InitUpdateAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_CDevHCDBCheckInteger 0
AdornOps=set DEG_HC_PROCESS_NAME ${DEGDROID_DEVICEINTERFACE_PROCESS_NAME}
AdornOps=setsystime DEG_HC_LASTUPDATE

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/200.UpdateHCData]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_HC_LASTUPDATE,DEG_HC_LASTUPDATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_HC_DATA_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0

TrueRuleChain=100.SetErrorInfo
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevHCDBCheckInteger 500

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.InitCreate
TrueRuleChain=200.InsertHCData
TrueRuleChain=300.CheckCreateStatus

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/200.CheckKeyExists/100.InitCreate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set DEG_CDevHCDBCheckInteger 0
AdornOps=set DEG_HC_PROCESS_NAME ${DEGDROID_DEVICEINTERFACE_PROCESS_NAME}
AdornOps=setsystime DEG_HC_LASTUPDATE

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/200.CheckKeyExists/200.InsertHCData]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
DuplicateErrorRuleChain=002.SessionStoreDuplicateKeyRuleChain
LogInvalidSession=false
SessionStore=DEG_HC_DATA_SessionStore

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/200.CheckKeyExists/300.CheckCreateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

Operations=or

TrueRuleChain=100.SetErrorInfo

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.CheckDBStatus/300.CheckUpdateStatus/200.CheckKeyExists/300.CheckCreateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevHCDBCheckInteger 500

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/100.InitializeRequestVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=setifnull DEG_OEMDevRespStatusString 0
AdornOps=set DEG_OEMDevEAPSubscriberIdString "AgAAOwEwMzEwMTI5ODIwMDQwMDAxQG5haS5lcGMubW5jMTI5Lm1jYzMxMC4zZ3BwbmV0d29yay5vcmc="
AdornOps=set DEG_OEMDevActionNameString "healthCheck"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/110.InvokeHttpRequest]

ClassName=com.hp.usage.lookup.SynchronousLookupRule
ConnectorName=202.HttpRequestClient
ErrorCodeAttribute=DEG_CDevProcessingErrorIdString
ErrorMessageAttribute=DEG_OEMDevErrorMessageString

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/110.InvokeHttpRequest/SetErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0063"
AdornOps=set DEG_OEMDevErrorMessageString "HttpRequestClient-ErrorRule"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/110.InvokeHttpRequest/ErrorRule]

ClassName=LogNMERule
LogLevel=DEBUG
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Message=HttpRequestClient-ErrorRule
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/110.InvokeHttpRequest/SetErrorResponseFlag]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DDI.0064"
AdornOps=set DEG_OEMDevErrorMessageString "HttpRequestClient-NoMatchRule"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/110.InvokeHttpRequest/NoMatchRule]

ClassName=LogNMERule
LogLevel=DEBUG
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Message=HttpRequestClient-NoMatchRule
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/120.CheckResultCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevHttpStatusInteger,=,200
Conditions=DEG_CDevHCDBCheckInteger,=,0
Operations=and

TrueRuleChain=100.SetSuccessResponse
FalseRuleChain=200.SetFailureResponse

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/120.CheckResultCode/100.SetSuccessResponse]

ClassName=AdornmentRule
AdornOps=set DEGDROID_OEMDevLoadBalRespMsgString "DEGDROID_DeviceInterface Status:UP AND RUNNING"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/120.CheckResultCode/200.SetFailureResponse]

ClassName=AdornmentRule
AdornOps=set DEGDROID_OEMDevLoadBalRespMsgString "DEGDROID_DeviceInterface Status:Down or Hanging"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/121.SetErrorResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0065"
AdornOps=set DEG_OEMDevMessageString "F5 HeartBeat"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/170.GenerateResponseForLoadBalancerHeartBeat/200.LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEGDROID_OEMDevLoadBalRespMsgString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
LogLevel=DEBUG
Message=F5 HeartBeat: 
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVariables
RuleNames=200.CopyBeforeResponseAttributeCustomize
RuleNames=250.SetResponseAttributeCustomize
RuleNames=300.LogBeforeResponseAttributeCustomize
RuleNames=400.ProcessResponseAttributeCustomize
RuleNames=500.CopyAfterResponseAttributeCustomize
RuleNames=550.SetAfterResponseAttributeCustomize
RuleNames=600.LogAfterResponseAttributeCustomize


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/100.InitVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull DEG_DevAuthTypeString ""
AdornOps=setifnull DEG_OEMDevSslSessionIdString ""
AdornOps=setifnull DEG_OEMDevImsiString ""
AdornOps=setifnull CUST_DDRPP_OUT_Status 0

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/200.CopyBeforeResponseAttributeCustomize]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_DevAuthTypeString CUST_DDRPP_IN_AuthTypeString
AdornOps=copy DEG_OEMDevSslSessionIdString CUST_DDRPP_IN_SslSessionIdString
AdornOps=copy DEG_OEMDevImsiString CUST_DDRPP_IN_IMSIString
AdornOps=copy DEG_OEMDevRequestProcessedInteger CUST_DDRPP_OUT_Status

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/250.SetResponseAttributeCustomize]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0066"
AdornOps=set DEG_OEMDevMessageString "before response attribute customization"

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/300.LogBeforeResponseAttributeCustomize]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=CUST_DDRPP_IN_AuthTypeString
Attributes=CUST_DDRPP_IN_SslSessionIdString
Attributes=CUST_DDRPP_IN_IMSIString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
LogLevel=DEBUG2
Message=Log before response attribute customization::
NullAlso=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/400.ProcessResponseAttributeCustomize]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_Android_Response_Custom_Values
UseRuleChainManagerPool=true

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/500.CopyAfterResponseAttributeCustomize]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=CUST_DDRPP_OUT_Status,=,1
TrueRuleChain=100.SetCustomAttribute

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/500.CopyAfterResponseAttributeCustomize/100.SetCustomAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/550.SetAfterResponseAttributeCustomize]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DDI.0067"
AdornOps=set DEG_OEMDevMessageString "after response attribute customization"


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/180.ProcessResponseAttributeCustomization/600.LogAfterResponseAttributeCustomize]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
Attributes=CUST_DDRPP_OUT_Status
LogLevel=DEBUG2
Message=Log after response attribute customization::
NullAlso=true


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/004.ReadTokenLifeTimeRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ReadTokenLifeTime


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/004.ReadTokenLifeTimeRuleChain/100.ReadTokenLifeTime]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_LIC_LIMITS_TokenLifeTime


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/004.ReadTokenLifeTimeRuleChain/100.ReadTokenLifeTime/ErrorRule]

AdornOps=set DEG_CDevDBErrorFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/RuleChains/004.ReadTokenLifeTimeRuleChain/100.ReadTokenLifeTime/NoMatchRule]

AdornOps=set DEG_CDevDBNoMatchFlagInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores]

ClassName=com.hp.siu.sessionserver.SessionStoreManager
SessionStoreNames=DEG_MONITORING_TRANSACTIONS_SessionStore
SessionStoreNames=DEG_SSL_SESSION_SessionStore
SessionStoreNames=DEGDROID_TOKENS_SessionStore
SessionStoreNames=DEGDROID_AUTH_XML_TEMPLATES_SessionStore
SessionStoreNames=DEG_DEVICE_DATA_SessionStore
SessionStoreNames=DEG_HC_DATA_SessionStore

#QXCM1001530845 -- JDBC Pooling in not working for NRB DSN
[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_MONITORING_TRANSACTIONS_SessionStore]

Attributes=DEG_MSESSIONID,key
Attributes=DEG_MSESSIONTRANSID,key
Attributes=DEG_MSESSIONIMSI
Attributes=DEG_MSESSIONPROCID
Attributes=DEG_MSESSIONTIMESTAMP
Attributes=DEG_MSESSIONINTERFACE
Attributes=DEG_MSESSIONINOUT
Attributes=DEG_MSESSIONRESULTCODE
Attributes=DEG_MSESSIONMDN
Attributes=DEG_MSESSIONTRANSACTIONTYPE
Attributes=DEG_MSESSIONSOURCEDESTINATION
Attributes=DEG_MSESSIONMESSAGE
Attributes=DEG_MSESSIONUNIQUE_ID
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
CommonPolicyID=Policy2
DbSchema=${DBSCHEMA_NRB}
DatabaseId=DEG_MONITORING_TRANSACTIONS
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_MONI_TRANS}
SQLTypeMap=DEG_MSESSIONID,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONTRANSID,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONPROCID,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONTIMESTAMP,BIGINT
SQLTypeMap=DEG_MSESSIONINTERFACE,VARCHAR(10)
SQLTypeMap=DEG_MSESSIONINOUT,VARCHAR(3)
SQLTypeMap=DEG_MSESSIONRESULTCODE,VARCHAR(15)
SQLTypeMap=DEG_MSESSIONMDN,BIGINT
SQLTypeMap=DEG_MSESSIONTRANSACTIONTYPE,VARCHAR(50)
SQLTypeMap=DEG_MSESSIONSOURCEDESTINATION,VARCHAR(32)
SQLTypeMap=DEG_MSESSIONMESSAGE,VARCHAR(512)
SQLTypeMap=DEG_MSESSIONIMSI,VARCHAR(64)
SQLTypeMap=DEG_MSESSIONUNIQUE_ID,VARCHAR(64)


[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_SSL_SESSION_SessionStore]

Attributes=DEG_SSL_ID,key
Attributes=DEG_SSL_STATE
Attributes=DEG_SSL_AAA_STATE
Attributes=DEG_SSL_AAA_SESSIONID
Attributes=DEG_SSL_NAI
Attributes=DEG_SSL_IMSI
Attributes=DEG_SSL_MDN
Attributes=DEG_SSL_UNIQUE_ID
Attributes=DEG_SSL_CREATETIMESTAMP
Attributes=DEG_STR_FLAG
Attributes=DEG_SSL_GW_ADDR
Attributes=DEG_SSL_ID_PROV_STATUS
Attributes=DEG_SSL_POSTDATA
Attributes=DEG_SSL_ADDRESS_UPDATE_URL
Attributes=DEG_SSL_ADDRESS_STATUS
Attributes=DEG_SSL_TC_STATUS
Attributes=DEGDROID_SSL_COOKIE_ID
Attributes=DEGDROID_SSL_OTP
Attributes=DEG_SSL_EntitlementStatus
Attributes=DEG_GETAUTH_CONTACTED_AAA
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DatabaseId=DEG_SSL_SESSION
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_SSL_SESSION}
SQLTypeMap=DEG_SSL_ID,VARCHAR(256)
SQLTypeMap=DEG_SSL_STATE,VARCHAR(256)
SQLTypeMap=DEG_SSL_AAA_SESSIONID,VARCHAR(256)
SQLTypeMap=DEG_SSL_AAA_STATE,VARBINARY(50)
SQLTypeMap=DEG_SSL_NAI,VARCHAR(256)
SQLTypeMap=DEG_SSL_IMSI,VARCHAR(256)
SQLTypeMap=DEG_SSL_MDN,VARCHAR(256)
SQLTypeMap=DEG_SSL_UNIQUE_ID,VARCHAR(256)
SQLTypeMap=DEG_SSL_CREATETIMESTAMP,BIGINT
SQLTypeMap=DEG_STR_FLAG,TINYINT
SQLTypeMap=DEG_SSL_GW_ADDR,VARCHAR(256)
SQLTypeMap=DEG_SSL_ID_PROV_STATUS,TINYINT
SQLTypeMap=DEG_SSL_POSTDATA,VARCHAR(1024)
SQLTypeMap=DEG_SSL_ADDRESS_UPDATE_URL,VARCHAR(1024)
SQLTypeMap=DEG_SSL_ADDRESS_STATUS,TINYINT
SQLTypeMap=DEG_SSL_TC_STATUS,TINYINT
SQLTypeMap=DEG_SSL_EntitlementStatus,VARCHAR(256)
SQLTypeMap=DEGDROID_SSL_COOKIE_ID,VARCHAR(64)
SQLTypeMap=DEGDROID_SSL_OTP,BIGINT
SQLTypeMap=DEG_GETAUTH_CONTACTED_AAA,VARCHAR(256)
CommonPolicyID=Policy1
NativeConditions=MatchingSession
NativeConditions=MatchingSessionID
NativeConditions=MatchByIMSI
NativeConditions=MatchByMDN
NativeConditions=MatchByCookieID

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_SSL_SESSION_SessionStore/MatchingSession]

Condition=where DEG_SSL_AAA_SESSIONID = %DEG_SSL_AAA_SESSIONID

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_SSL_SESSION_SessionStore/MatchingSessionID]

Condition=where DEG_SSL_ID = %DEG_SSL_ID

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_SSL_SESSION_SessionStore/MatchByIMSI]

Condition=where DEG_SSL_IMSI = %DEG_SSL_IMSI and DEG_SSL_ID=%DEG_SSL_ID

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_SSL_SESSION_SessionStore/MatchByMDN]

Condition=where DEG_SSL_MDN = %DEG_SSL_MDN and DEG_SSL_ID=%DEG_SSL_ID

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_SSL_SESSION_SessionStore/MatchByCookieID]

Condition=where DEGDROID_SSL_COOKIE_ID = %DEGDROID_SSL_COOKIE_ID

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEGDROID_TOKENS_SessionStore]

Attributes=DEG_IMSI,key
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_APP_TOKEN_FLAG
Attributes=DEG_AUTH_COUNT
Attributes=DEG_BLACKLIST_FLAG
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_FULLAUTHTIMESTAMP
Attributes=DEG_UNIQUE_ID
Attributes=DEG_BLACKLISTWINDOW_STARTTIME
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DbSchema=${DBSCHEMA_DEG}
DatabaseId=DEGDROID_TOKENS
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
NativeConditions=1.MatchingByMDN
SQLTypeMap=DEG_IMSI,VARCHAR(64)
SQLTypeMap=DEG_MDN,BIGINT
SQLTypeMap=DEG_SUBSTOKEN,CHAR(28)
SQLTypeMap=DEG_TOKENSTATUS,CHAR(2)
SQLTypeMap=DEG_AUTHENTICATION_TYPE,CHAR(4)
SQLTypeMap=DEG_AUTHENTICATION_SUBTYPE,CHAR(3)
SQLTypeMap=DEG_UNIQUE_ID,VARCHAR(64)
SQLTypeMap=DEG_APP_TOKEN_FLAG,TINYINT
#QXCM1001567458 -- DEGDROID_TOKENS table column type changes
SQLTypeMap=DEG_AUTH_COUNT,BIGINT
SQLTypeMap=DEG_BLACKLIST_FLAG,BIGINT
SQLTypeMap=DEG_EVENTTIMESTAMP,BIGINT
SQLTypeMap=DEG_FULLAUTHTIMESTAMP,BIGINT
SQLTypeMap=DEG_BLACKLISTWINDOW_STARTTIME,BIGINT
CommonPolicyID=Policy1

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEGDROID_TOKENS_SessionStore/1.MatchingByMDN]

Condition=where DEG_MDN=%DEG_MDN

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEGDROID_AUTH_XML_TEMPLATES_SessionStore]

Attributes=DEG_AUTH_TYPE,key
Attributes=DEG_AUTH_STEP,key
Attributes=DEG_XML_TEMPLATES_FILE
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DbSchema=${DBSCHEMA_DEG}
DatabaseId=DEGDROID_AUTH_XML_TEMPLATES
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
SQLTypeMap=DEG_AUTH_TYPE,VARCHAR(32)
SQLTypeMap=DEG_AUTH_STEP,TINYINT
SQLTypeMap=DEG_XML_TEMPLATES_FILE,VARCHAR(2000)
CommonPolicyID=Policy1
NativeConditions=10.MatchBasedonAuthType

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEGDROID_AUTH_XML_TEMPLATES_SessionStore/10.MatchBasedonAuthType]

Condition=where DEG_AUTH_TYPE=%DEG_AUTH_TYPE

#RFE83 APNS token size change
[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_DEVICE_DATA_SessionStore]

Attributes=DEG_UNIQUE_ID,key
Attributes=DEG_ENTITLEMENT_NAME,key
Attributes=DEG_IMSI
Attributes=DEG_APNS_TOKEN
Attributes=DEG_OLD_APNS_TOKEN
Attributes=DEG_PROVISIONING_STATUS
Attributes=DEG_PUSH_NOTIFICATION_STATUS
Attributes=DEG_SERVICE_MGMT_POSTDATA
Attributes=DEG_DISPLAY_NAME
Attributes=DEG_ADDRESS_STATUS
Attributes=DEG_TC_STATUS
Attributes=DEG_ADDR_UPDATE_POSTDATA
Attributes=DEG_ADDR_REFID
Attributes=DEG_ADDR_REFID_EXP_DATE
Attributes=DEG_LASTUPDATE
Attributes=DEG_SIP_USERNAME
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DatabaseId=DEG_DEVICE_DATA
DbSchema=${DBSCHEMA_DEG}
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
NativeConditions=1.MatchByIMSI
NativeConditions=2.MatchByUniqueId
NativeConditions=3.MatchByUniqueIdAndVoWiFiEntitelementNames
NativeConditions=4.MatchByIMSIAndEntitelementName
SQLTypeMap=DEG_UNIQUE_ID,VARCHAR(64)
SQLTypeMap=DEG_ENTITLEMENT_NAME,VARCHAR(32)
SQLTypeMap=DEG_IMSI,VARCHAR(64)
SQLTypeMap=DEG_APNS_TOKEN,VARCHAR(100)
#QXCM1001544811:3.2.4 China Unicom issues,issue 1:2017041001
SQLTypeMap=DEG_OLD_APNS_TOKEN,VARCHAR(100)
SQLTypeMap=DEG_PROVISIONING_STATUS,BIGINT
SQLTypeMap=DEG_PUSH_NOTIFICATION_STATUS,BIGINT
SQLTypeMap=DEG_SERVICE_MGMT_POSTDATA,VARCHAR(256)
SQLTypeMap=DEG_DISPLAY_NAME,VARCHAR(128)
SQLTypeMap=DEG_ADDRESS_STATUS,TINYINT
SQLTypeMap=DEG_TC_STATUS,TINYINT
SQLTypeMap=DEG_ADDR_UPDATE_POSTDATA,VARCHAR(8192)
SQLTypeMap=DEG_ADDR_REFID,VARCHAR(64)
SQLTypeMap=DEG_ADDR_REFID_EXP_DATE,DATE
SQLTypeMap=DEG_LASTUPDATE,DATE
SQLTypeMap=DEG_SIP_USERNAME,VARCHAR(256)
CommonPolicyID=Policy1

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_DEVICE_DATA_SessionStore/1.MatchByIMSI]

Condition=where DEG_IMSI=%DEG_IMSI

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_DEVICE_DATA_SessionStore/2.MatchByUniqueId]

Condition=where DEG_UNIQUE_ID=%DEG_UNIQUE_ID

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_DEVICE_DATA_SessionStore/3.MatchByUniqueIdAndVoWiFiEntitelementNames]

Condition=where DEG_ENTITLEMENT_NAME IN('Android_VoWiFi') and DEG_UNIQUE_ID=%DEG_UNIQUE_ID

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_DEVICE_DATA_SessionStore/4.MatchByIMSIAndEntitelementName]

Condition=where DEG_IMSI=%DEG_IMSI and DEG_ENTITLEMENT_NAME=%DEG_ENTITLEMENT_NAME

[/templates/DEG/DEGDROID_DeviceInterface/Common_Core/SessionStores/DEG_HC_DATA_SessionStore]

Attributes=DEG_HC_LASTUPDATE
Attributes=DEG_HC_PROCESS_NAME,key
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
DbSchema=${DBSCHEMA_DEG}
DatabaseId=DEG_HC_DATA
MaxDatabaseConnections=${DEVICE_MAX_DBCONN_DEG_TOKENS}
SQLTypeMap=DEG_HC_PROCESS_NAME,VARCHAR(256)
SQLTypeMap=DEG_HC_LASTUPDATE,DATE
CommonPolicyID=Policy1