[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core]


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains]

RuleChainNames=206.ProcessOEMGetPhoneNumberRuleChain
RuleChainNames=511.GenerateGetPhoneNumberStartAuditDataRuleChain
RuleChainNames=512.GenerateGetPhoneNumberEndErrorAuditDataRuleChain
RuleChainNames=513.GenerateGetPhoneNumberEndOKAuditDataRuleChain
RuleChainNames=514.GenerateGetPhoneNumberDisabledAuditDataRuleChain


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequest
RuleNames=110.ReadValue
RuleNames=120.CheckErrorAndNoMatchFlag
RuleNames=130.ExecuteDependingOnSysParameterValue


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/100.InitRequest]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSysParameter "getPhoneNumber"
AdornOps=set DEG_CDevSysValueString ""
AdornOps=set DEG_CDevGetPhoneNumberSysValueString ""
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevSysParameter
ResponseAttributes=DEG_CDevSysValueString
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=003.ReadSystemParameterRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
Operations=and
TrueRuleChain=100.SetSysValue
FalseRuleChain=200.Enabled


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/120.CheckErrorAndNoMatchFlag/100.SetSysValue]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevSysValueString DEG_CDevGetPhoneNumberSysValueString


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/120.CheckErrorAndNoMatchFlag/200.Enabled]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevGetPhoneNumberSysValueString "Enabled"


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevGetPhoneNumberSysValueString,=,"Enabled"
TrueRuleChain=100.SetProcessingStartTime
TrueRuleChain=110.GenerateGetPhoneNumberStartAuditData
TrueRuleChain=120.ExtractGetPhoneNumberAttributes
TrueRuleChain=130.GenerateResponseEntry
FalseRuleChain=200.GeneratePhoneDisabledResponse


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/100.SetProcessingStartTime]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_CDevProcessStartTimeLong


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/110.GenerateGetPhoneNumberStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=511.GenerateGetPhoneNumberStartAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/120.ExtractGetPhoneNumberAttributes]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
StructuredNMEToNMEMap=client_nonce.CData,DEG_OEMDevClientNonceString,""


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/130.GenerateResponseEntry]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevClientNonceString,=,""
TrueRuleChain=100.InitErrorResponse400C
TrueRuleChain=110.GenerateGetPhoneNumberEndErrorAuditData
FalseRuleChain=200.DecodeClientNonce
FalseRuleChain=210.CheckClientNonceIfBase64


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/130.GenerateResponseEntry/100.InitErrorResponse400C]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_OEMDevErrorMessageString "ClientNonce not present in request"


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/130.GenerateResponseEntry/110.GenerateGetPhoneNumberEndErrorAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=512.GenerateGetPhoneNumberEndErrorAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/130.GenerateResponseEntry/200.DecodeClientNonce]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=decBase64 DEG_OEMDevClientNonceString DEG_OEMDevClientNonceBin


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/130.GenerateResponseEntry/210.CheckClientNonceIfBase64]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=100.GeneratePhoneEnabledResponse


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/130.GenerateResponseEntry/210.CheckClientNonceIfBase64/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevClientNonceBin == null


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/130.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitOkResponse
RuleNames=200.GenerateSign
RuleNames=210.ConvertSignData
RuleNames=300.GenerateOkResponseEntry
RuleNames=350.PopulateAuditNRBMessageAttribute
RuleNames=400.GenerateGetPhoneNumberEndOKAuditData


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/130.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse/100.InitOkResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6000
AdornOps=set DEG_OEMDevRespPhoneNumberString ${DEVICE_COUNTRYISD_CODE}
AdornOps=+ DEG_OEMDevRespPhoneNumberString DEG_SSL_MDN DEG_OEMDevRespPhoneNumberString
AdornOps=bin2str DEG_OEMDevClientNonceBin DEG_OEMDevClientNonceString
AdornOps=str2bin DEG_OEMDevRespPhoneNumberString DEG_OEMDevRespPhoneNumberBin
AdornOps=+ DEG_OEMDevClientNonceBin DEG_OEMDevRespPhoneNumberBin DEG_OEMDevSignDataSrcBytes


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/130.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse/200.GenerateSign]

ClassName=CreateSignedDataRule
DestinationAttribute=DEG_OEMDevSignDataDstBytes
Signers=Signer1
SourceAttribute=DEG_OEMDevSignDataSrcBytes

#RFE79 Allow GetPhoneNumber Signature certificate to be different from DEG Server certificate.
[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/130.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse/200.GenerateSign/Signer1]

Alias=${PHONENUM_CERT_SIGNATURE_ALIAS}
ClassName=KeyStoreBasedSigner
KeyStoreFormat=JKS
KeyStoreLocation=${PHONENUM_CERT_KEYSTORE_FILE}
KeyStorePassword=${PHONENUM_CERT_SIGNATURE_PASSWORD}


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/130.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse/210.ConvertSignData]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=encBase64 DEG_OEMDevSignDataDstBytes DEG_OEMDevRespSignatureString

##DEG part Comment begins#
#AdornOps=set DEG_OEMDevRespSignatureString FAKEcertificate
##DEG part Comment ends#


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/130.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse/300.GenerateOkResponseEntry]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
NMEToStructuredNMEMap=DEG_OEMDevRespPhoneNumberString,jsonResponse.phone_number.CData
NMEToStructuredNMEMap=DEG_OEMDevRespSignatureString,jsonResponse.signature.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/130.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse/350.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getPhoneNumber Success response: "
AdornOps=set DEG_AuditNRBMessageString "getPhoneNumber success response ,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/130.GenerateResponseEntry/210.CheckClientNonceIfBase64/100.GeneratePhoneEnabledResponse/400.GenerateGetPhoneNumberEndOKAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=513.GenerateGetPhoneNumberEndOKAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/200.GeneratePhoneDisabledResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=50.GenerateGetPhoneNumberStartAudit
RuleNames=100.InitResponse
RuleNames=125.PopulateAuditNRBMessageAttribute
RuleNames=150.GenerateGetPhoneNumberEndAudit
RuleNames=200.GenerateResponseEntry
RuleNames=250.SetErrorInfo
RuleNames=300.Log

[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/200.GeneratePhoneDisabledResponse/50.GenerateGetPhoneNumberStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=511.GenerateGetPhoneNumberStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/200.GeneratePhoneDisabledResponse/100.InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002

[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/200.GeneratePhoneDisabledResponse/125.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getPhoneNumber disable response: "
AdornOps=set DEG_AuditNRBMessageString "getPhoneNumber disable response ,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString

[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/200.GeneratePhoneDisabledResponse/150.GenerateGetPhoneNumberEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=513.GenerateGetPhoneNumberEndOKAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/200.GeneratePhoneDisabledResponse/200.GenerateResponseEntry]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/200.GeneratePhoneDisabledResponse/250.SetErrorInfo]
ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GPN.0000"
AdornOps=set DEG_OEMDevErrorMessageString "getPhoneNumber is Disabled"

[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/206.ProcessOEMGetPhoneNumberRuleChain/130.ExecuteDependingOnSysParameterValue/200.GeneratePhoneDisabledResponse/300.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_MDN
Attributes=DEG_CDevSysParameter
Attributes=DEG_CDevGetPhoneNumberSysValueString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=INFO
Message=Action getPhoneNumber Disabled: 
NullAlso=true
PropertyName=LogRequestFlowLevel1
UseProperty=true



[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/511.GenerateGetPhoneNumberStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/511.GenerateGetPhoneNumberStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "getPhoneNumber"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/511.GenerateGetPhoneNumberStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEVICE TO DEG -> Received getPhoneNumber request: "


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/511.GenerateGetPhoneNumberStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/511.GenerateGetPhoneNumberStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString ""


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/511.GenerateGetPhoneNumberStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/512.GenerateGetPhoneNumberEndErrorAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/512.GenerateGetPhoneNumberEndErrorAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "400"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "getPhoneNumber"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/512.GenerateGetPhoneNumberEndErrorAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getPhoneNumber response: "


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/512.GenerateGetPhoneNumberEndErrorAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/512.GenerateGetPhoneNumberEndErrorAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/512.GenerateGetPhoneNumberEndErrorAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString

[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/512.GenerateGetPhoneNumberEndErrorAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/513.GenerateGetPhoneNumberEndOKAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
#RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
#RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/513.GenerateGetPhoneNumberEndOKAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "getPhoneNumber"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""

[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/513.GenerateGetPhoneNumberEndOKAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getPhoneNumber response: "


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/513.GenerateGetPhoneNumberEndOKAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/513.GenerateGetPhoneNumberEndOKAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/513.GenerateGetPhoneNumberEndOKAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString ",Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString



[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/513.GenerateGetPhoneNumberEndOKAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/514.GenerateGetPhoneNumberDisabledAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/514.GenerateGetPhoneNumberDisabledAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "getPhoneNumber"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
#AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString
AdornOps=set DEG_AuditDeviceTypeString ""


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/514.GenerateGetPhoneNumberDisabledAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending getPhoneNumber response: "


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/514.GenerateGetPhoneNumberDisabledAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/514.GenerateGetPhoneNumberDisabledAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/514.GenerateGetPhoneNumberDisabledAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditNRBMessageString "Request denied by policy,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString


[/templates/DEG/DeviceInterface/GetPhoneNumber_V1Core/RuleChains/514.GenerateGetPhoneNumberDisabledAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=600.GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true
