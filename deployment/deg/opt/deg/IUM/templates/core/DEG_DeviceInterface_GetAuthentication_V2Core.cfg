

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core]


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains]

RuleChainNames=210.DEG20ProcessOEMGetAuthenticationRuleChain
RuleChainNames=210A.DEG20GenerateServiceTokensRuleChain
RuleChainNames=210B.DEG20GenerateDevcieIDRuleChain
RuleChainNames=210C.DEG20ValidationAndProcessActionRuleChain
RuleChainNames=210D.DEG20CheckTokenTimeStampRuleChain
RuleChainNames=210E.DEG20CheckDeviceDataTableRuleChain
RuleChainNames=210F.DEG20InsertRowDeviceDataTableRuleChain
RuleChainNames=210H.DEG20UpdateRowInDeviceDataTableRuleChain


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitWorkingVariables
RuleNames=200.AddIdAndActionToList
RuleNames=300.ValidationAndProcessAction
RuleNames=400.UpdateSSLSessionStore
RuleNames=500.SetResponseHandler


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/100.InitWorkingVariables]

AdornOps=set DEG_OEMDevRequestProcessedInteger 0
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
AdornOps=set DEG_OEMDevSubscriberIdString ""
AdornOps=set DEG_OEMDevImsiString ""
AdornOps=set DEG_MDN 0
AdornOps=set DEG_IMSI ""
AdornOps=set DEG_OEMDevRespPhoneNumberString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/200.AddIdAndActionToList]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitCheck
RuleNames=200.AddToList


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/200.AddIdAndActionToList/100.InitCheck]

AdornOps=copy DEG_OEMDevRequestIdString DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString _ DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString DEG_OEMDevActionNameString DEG_OEMDevRequestIdAndNameString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/200.AddIdAndActionToList/200.AddToList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevRequestIdAndNameString
ListAttribute=DEG_OEMDevRequestIdAndNameList


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/300.ValidationAndProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=210C.DEG20ValidationAndProcessActionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"NEW"
FalseRuleChain=200.UpdateSslSessionState


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState]

ClassName=RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.ExecuteSslSessionUpdate
RuleNames=300.CheckSslSessionUpdateStatus

#Gateway Address in the JSON response attribute of getAuthentication did not use the value set in getAuthentication’s getSubscriberProfile custom template.
[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/100.InitSslSessionUpdate]

AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=copy DEG_OEMDevSubscriberIdString DEG_SSL_NAI
AdornOps=copy DEG_OEMDevImsiString DEG_SSL_IMSI
AdornOps=copy DEG_OEMDevUniqueIDString DEG_SSL_UNIQUE_ID
AdornOps=copy DEG_MDN DEG_SSL_MDN
AdornOps=copy DEG_OEMDevGatewayAddressString DEG_SSL_GW_ADDR
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDRESS_UPDATE_URL ""
AdornOps=setifnull DEG_EntitlementStatus ""
AdornOps=copy DEG_PROVISIONING_STATUS DEG_SSL_ID_PROV_STATUS
AdornOps=copy DEG_ADDR_UPDATE_POSTDATA DEG_SSL_POSTDATA
AdornOps=copy DEG_ADDRESS_STATUS DEG_SSL_ADDRESS_STATUS
AdornOps=copy DEG_TC_STATUS DEG_SSL_TC_STATUS
AdornOps=copy DEG_ADDRESS_UPDATE_URL DEG_SSL_ADDRESS_UPDATE_URL
AdornOps=copy DEG_EntitlementStatus DEG_SSL_EntitlementStatus
AdornOps=setifnull DEG_OEMDevDeviceCountIntegerTbl ""
AdornOps=copy DEG_OEMDevDeviceCountIntegerTbl DEG_SSL_COMPANION_DEVICE_COUNT
AdornOps=setifnull DEG_SSL_CUSTOM_FIELD ""
AdornOps=copy DEG_OEMDevDAIString DEG_SSL_DAI
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/200.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_AAA_STATE,DEG_SSL_AAA_STATE
MapAttributes=DEG_SSL_AAA_SESSIONID,DEG_SSL_AAA_SESSIONID
MapAttributes=DEG_SSL_NAI,DEG_SSL_NAI
MapAttributes=DEG_SSL_IMSI,DEG_SSL_IMSI
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
MapAttributes=DEG_SSL_UNIQUE_ID,DEG_SSL_UNIQUE_ID
MapAttributes=DEG_SSL_ID_PROV_STATUS,DEG_SSL_ID_PROV_STATUS
MapAttributes=DEG_SSL_GW_ADDR,DEG_SSL_GW_ADDR
MapAttributes=DEG_SSL_POSTDATA,DEG_SSL_POSTDATA
MapAttributes=DEG_SSL_ADDRESS_STATUS,DEG_SSL_ADDRESS_STATUS
MapAttributes=DEG_SSL_TC_STATUS,DEG_SSL_TC_STATUS
MapAttributes=DEG_SSL_ADDRESS_UPDATE_URL,DEG_SSL_ADDRESS_UPDATE_URL
MapAttributes=DEG_SSL_EntitlementStatus,DEG_SSL_EntitlementStatus
MapAttributes=DEG_SSL_COMPANION_DEVICE_COUNT,DEG_SSL_COMPANION_DEVICE_COUNT
MapAttributes=DEG_SSL_CUSTOM_FIELD,DEG_SSL_CUSTOM_FIELD
MapAttributes=DEG_SSL_DAI,DEG_SSL_DAI
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExists
TrueRuleChain=101.SetErrorInfo
TrueRuleChain=100.LogError

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/101.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1001"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update DEG_SSL_SESSION store"

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/100.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: while updating DEG_SSL_SESSION store
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
TrueRuleChain=95.SetErrorInfo
TrueRuleChain=100.LogError

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/95.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1002"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update DEG_SSL_SESSION store"

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/400.UpdateSSLSessionStore/200.UpdateSslSessionState/300.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Database Error: while updating DEG_SSL_SESSION store
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/500.SetResponseHandler]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,within,[200,200C]
FalseRuleChain=200.SetEmptyResponseHandler
TrueRuleChain=100.SetJsonResponseHandler


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/500.SetResponseHandler/100.SetJsonResponseHandler]

AdornOps=set DEG_OEMDevResponseHandlerString "JsonResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210.DEG20ProcessOEMGetAuthenticationRuleChain/500.SetResponseHandler/200.SetEmptyResponseHandler]

AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210A.DEG20GenerateServiceTokensRuleChain]

#Generate service tokes logic as same as token generation =
ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateserviceToken


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210A.DEG20GenerateServiceTokensRuleChain/100.GenerateserviceToken]

AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha2KeyBinary
AdornOps=encBase64 DEG_CDevSha2KeyBinary DEG_OEMDevServiceRespTokenString
AdornOps=copy DEG_OEMDevServiceRespTokenString DEG_OEMDevServiceTokenString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210B.DEG20GenerateDevcieIDRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.GenerateDeviceID


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210B.DEG20GenerateDevcieIDRuleChain/100.GenerateDeviceID]

AdornOps=copy DEG_OEMDeviceIdInteger DEG_OEMDeviceIdString
AdornOps=+ 0 DEG_OEMDeviceIdString DEG_OEMDeviceIdString
AdornOps=+ DEG_OEMDevImsiString DEG_OEMDeviceIdString DEG_OEMDeviceIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.ValidationAndProcessAction


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction]

CheckIfActionIsGetAuthentication=100.CheckIfActionIsGetAuthentication
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

ExtractGetAuthenticationAttributes=200.ExtractGetAuthenticationAttributes
CheckIfSubscriberIdAttributePresent=250.CheckIfSubscriberIdAttributePresent
ValidateEmptySubscriberID=260.ValidateEmptySubscriberID
ExtractNAIFromSubscriberIdAttribute=300.DecodePayload
ExtractNAIFromSubscriberIdAttribute=310.CheckPlayloadIfBase64
Operations=DoAll
TrueRuleChain=CheckIfActionIsGetAuthentication
TrueRuleChain=ExtractGetAuthenticationAttributes
TrueRuleChain=CheckIfSubscriberIdAttributePresent
TrueRuleChain=ValidateEmptySubscriberID
TrueRuleChain=ExtractNAIFromSubscriberIdAttribute
TrueRuleChain=ValidateIMSIInSubscriberId
TrueRuleChain=ValidateGBAAuthType
TrueRuleChain=GenerateNonceResponse
TrueRuleChain=ValidateEmptyBTIDInAuthorizationHeader
TrueRuleChain=ValidateAuthTypeAttribute
ValidateGBAAuthType=410.ValidateGBAAuthType
ValidateAuthTypeAttribute=400.ValidateAuthTypeAttribute
ValidateIMSIInSubscriberId=500.ValidateIMSIInSubscriberId
GenerateNonceResponse=600.GenerateNonceResponse
ValidateEmptyBTIDInAuthorizationHeader=700.ValidateEmptyBTIDInAuthorizationHeader


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/100.CheckIfActionIsGetAuthentication]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,!=,"getAuthentication"
TrueRuleChain=100.SetHttpErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/100.CheckIfActionIsGetAuthentication/100.SetHttpErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1003"
AdornOps=set DEG_OEMDevErrorMessageString "GetAuthentication is expected"
AdornOps=copy DEG_OEMDevActionNameString DEG_AuditTransactionTypeString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/100.CheckIfActionIsGetAuthentication/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid OEM action - getAuthentication is expected, in case of previous getAuthentication failure.
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=During first time when request sent ,getAuthentication request should be present .

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/100.CheckIfActionIsGetAuthentication/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/100.CheckIfActionIsGetAuthentication/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/200.ExtractGetAuthenticationAttributes]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
StructuredNMEToNMEMap=auth_type.CData,DEG_OEMDevAuthTypeString,""
StructuredNMEToNMEMap=subscriber_id.CData,DEG_OEMDevSubscriberIdString,dummy
StructuredNMEToNMEMap=token.CData,DEG_OEMDevTokenString,""
StructuredNMEToNMEMap=service_token.CData,DEG_OEMDevServiceTokenString
StructuredNMEToNMEMap=unique_id.CData,DEG_OEMDevUniqueIdString


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/250.CheckIfSubscriberIdAttributePresent]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,=,dummy
TrueRuleChain=100.InitResponse
TrueRuleChain=110.ExecuteResponse
TrueRuleChain=115.SetErrorInfo
TrueRuleChain=120.LogResponse
TrueRuleChain=130.GenerateStartAudit
TrueRuleChain=140.GenerateGetAuthenticationUnknownSubscriberEndAuditData

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/250.CheckIfSubscriberIdAttributePresent/100.InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 6004
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/250.CheckIfSubscriberIdAttributePresent/110.ExecuteResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/250.CheckIfSubscriberIdAttributePresent/115.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1004"
AdornOps=set DEG_OEMDevErrorMessageString "subscriber-id attribute is missing in the request"

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/250.CheckIfSubscriberIdAttributePresent/120.LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Invalid getAuthenticate action - subscriber-id attribute is missing in the request
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/250.CheckIfSubscriberIdAttributePresent/130.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/250.CheckIfSubscriberIdAttributePresent/140.GenerateGetAuthenticationUnknownSubscriberEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/260.ValidateEmptySubscriberID]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdString,=,""
TrueRuleChain=100.InitResponse
TrueRuleChain=110.SetResponse
TrueRuleChain=111.SetErrorInfo
TrueRuleChain=120.LogResponse
TrueRuleChain=130.GenerateStartAudit
TrueRuleChain=140.GenerateAuthenticatedEndAudit

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/260.ValidateEmptySubscriberID/100.InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 6301
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/260.ValidateEmptySubscriberID/110.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/260.ValidateEmptySubscriberID/111.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1005"
AdornOps=set DEG_OEMDevErrorMessageString "subscriber-id is empty in the request"


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/260.ValidateEmptySubscriberID/120.LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Invalid getAuthenticate action - subscriber-id is empty in the request
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/260.ValidateEmptySubscriberID/130.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/260.ValidateEmptySubscriberID/140.GenerateAuthenticatedEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=506.GenerateGetAuthenticationUnknownSubscriberEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/300.DecodePayload]

AdornOps=decBase64 DEG_OEMDevSubscriberIdString DEG_OEMDevEAPPayloadBinary
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/310.CheckPlayloadIfBase64]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.ConvertPayload2String
FalseRuleChain=210.DecodeNAI
TrueRuleChain=100.SetHTTPErrorResponse
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GenerateStartAudit
TrueRuleChain=130.GenerateErrorEndAudit

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/310.CheckPlayloadIfBase64/100.SetHTTPErrorResponse]

AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1006"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to Extract NAI From SubscriberId"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/310.CheckPlayloadIfBase64/110.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevTempSubscriberIdString
Attributes=DEG_OEMDevSubscriberIdLengthInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Data Error in EAP payload
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=EAP PAyload Present in the request is not valid.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/310.CheckPlayloadIfBase64/120.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/310.CheckPlayloadIfBase64/130.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/310.CheckPlayloadIfBase64/200.ConvertPayload2String]

AdornOps=bin2str DEG_OEMDevEAPPayloadBinary DEG_OEMDevTempSubscriberIdString "ISO8859_1"
AdornOps=length DEG_OEMDevTempSubscriberIdString DEG_OEMDevSubscriberIdLengthInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/310.CheckPlayloadIfBase64/210.DecodeNAI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevSubscriberIdLengthInteger,>=,6
TrueRuleChain=100.ExtractNAI


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/310.CheckPlayloadIfBase64/210.DecodeNAI/100.ExtractNAI]

AdornOps=substr 5 length DEG_OEMDevTempSubscriberIdString DEG_OEMDevSubscriberIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/310.CheckPlayloadIfBase64/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=(DEG_OEMDevEAPPayloadBinary =="") || (DEG_OEMDevEAPPayloadBinary == null)


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/410.ValidateGBAAuthType]

ClassName=ConditionalRule
Conditions=DEG_OEMDevGBAAuthTypeString,=,"GBA"
TrueRuleChain=ValidateGBAAuthTypeAttribute


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/410.ValidateGBAAuthType/ValidateGBAAuthTypeAttribute]

ClassName=ConditionalRule
Conditions=DEG_OEMDevAuthTypeString,!=,"GBA"
TrueRuleChain=SetError
TrueRuleChain=LogError


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/410.ValidateGBAAuthType/ValidateGBAAuthTypeAttribute/SetError]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_OEMDevHttpStatusInteger 403
AdornOps=set DEG_SSL_REQUEST_STATE "403C"
AdornOps=set DEG_OEMDevConnectionString "close"
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"
AdornOps=set DEG_OEMDevEncodingString "gzip"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1007"
AdornOps=set DEG_OEMDevErrorMessageString "Invalid action - auth-type attribute must be GBA"


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/410.ValidateGBAAuthType/ValidateGBAAuthTypeAttribute/LogError]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
#Attributes=DEG_CDevProcessingErrorIdString
#Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid action - auth-type attribute must be GBA : 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/400.ValidateAuthTypeAttribute]

CallGetAuthenticationPrimary=100.CallGetAuthenticationPrimary
CallGetAuthenticationSecondary=200.CallGetAuthenticationSecondary
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_OEMDevAuthTypeString,=,"EAP-AKA"
Conditions=DEG_OEMDevAuthTypeString,=,"GBA"
Conditions=DEG_OEMDevAuthTypeString,=,"none"
Conditions=DEG_OEMDevAuthTypeString,=,DEG_OEMDevAuthTypeString
TrueRuleChain=CallGetAuthenticationPrimary
TrueRuleChain=CallGetAuthenticationPrimary
TrueRuleChain=CallGetAuthenticationSecondary
TrueRuleChain=Unknown
Unknown=300.SetHTTPErrorResponse
Unknown=310.ErrorLog
Unknown=311.GenerateStartAudit
Unknown=320.GenerateErrorEndAudit


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/400.ValidateAuthTypeAttribute/100.CallGetAuthenticationPrimary]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224.DEG20ProcessOEMGetAuthenticationPrimaryRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/400.ValidateAuthTypeAttribute/200.CallGetAuthenticationSecondary]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=225.DEG21ProcessOEMGetAuthenticationCompanionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/400.ValidateAuthTypeAttribute/300.SetHTTPErrorResponse]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1008"
AdornOps=set DEG_OEMDevErrorMessageString "Auth-type attribute must be EAK-AKA or none"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/400.ValidateAuthTypeAttribute/310.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=Invalid getAuthentication action - auth-type attribute must be EAK-AKA or none: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=During getAuthentication action - auth-type attribute must be EAK-AKA or should be NONE.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/400.ValidateAuthTypeAttribute/311.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/400.ValidateAuthTypeAttribute/320.GenerateErrorEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=777.GenerateGetAuthenticationSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/500.ValidateIMSIInSubscriberId]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
TrueRuleChain=100.InitResponse
TrueRuleChain=110.SetResponse
TrueRuleChain=117.SetErrorInfo
TrueRuleChain=120.LogResponse
TrueRuleChain=130.GenerateStartAudit
TrueRuleChain=140.GenerateAuthenticatedEndAudit
Operation=match
RegExPattern=${IMSIIN_SUBSCRIBERID_PATTERN}
SourceAttribute=DEG_OEMDevSubscriberIdString

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/500.ValidateIMSIInSubscriberId/100.InitResponse]

AdornOps=set DEG_OEMDevRespStatusString 6301
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "200C"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/500.ValidateIMSIInSubscriberId/110.SetResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/500.ValidateIMSIInSubscriberId/117.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1009"
AdornOps=set DEG_OEMDevErrorMessageString "IMSI is empty in the request"

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/500.ValidateIMSIInSubscriberId/120.LogResponse]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Invalid getAuthenticate action - IMSI is empty in the request
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/500.ValidateIMSIInSubscriberId/130.GenerateStartAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=500.GenerateGetAuthenticationStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/500.ValidateIMSIInSubscriberId/140.GenerateAuthenticatedEndAudit]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=704.DEG20GenerateGetAuthenticationDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/600.GenerateNonceResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAuthTypeString,=,"GBA"
Conditions=DEG_OEMDevDigestChallengeFlagInteger,=,1
Operations=and
TrueRuleChain=SetLogInfo
TrueRuleChain=LogErrorInfo
TrueRuleChain=ExtractIMSIFromSubscriberID
TrueRuleChain=GetCustRealmValue
TrueRuleChain=CopyCustToCore
TrueRuleChain=SetRealmValue
TrueRuleChain=GenerateNonceAndOpaque


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/600.GenerateNonceResponse/SetLogInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1010"
AdornOps=set DEG_OEMDevErrorMessageString "authorization header is empty in the request"


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/600.GenerateNonceResponse/LogErrorInfo]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Invalid action - authorization header is empty in the request :
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevAuthenticationInfoString
Attributes=DEG_OEMDevWwwauthenticateString
Attributes=DEG_OEMDevAuthorizationString


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/600.GenerateNonceResponse/ExtractIMSIFromSubscriberID]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=substr "0" "@" DEG_OEMDevSubscriberIdString DEG_OEMDevImsiString
AdornOps=setifnull DEG_OEMDevImsiString ""
AdornOps=copy DEG_OEMDevImsiString CUST_GBA_IN_IMSI


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/600.GenerateNonceResponse/GetCustRealmValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_GBA_RELAM_Custom
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/600.GenerateNonceResponse/CopyCustToCore]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull CUST_GBA_OUT_Realm ""
AdornOps=copy CUST_GBA_OUT_Realm DEG_OEMDevGBARealmString


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/600.GenerateNonceResponse/SetRealmValue]

ClassName=ConditionalRule
Conditions=DEG_OEMDevGBARealmString,=,""
TrueRuleChain=SetDefaultRealm


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/600.GenerateNonceResponse/SetRealmValue/SetDefaultRealm]

ClassName=SwitchConditionRule
Conditions=DEG_OEMDevUserAgentString,=,"3gpp-gba"
Conditions=DEG_OEMDevUserAgentString,=,"3gpp-uicc"

Operation=None

TrueRuleChain=SetGBARealm
TrueRuleChain=SetUICCRealm

SetGBARealm=100.SetGBARealm
SetUICCRealm=200.SetUICCRealm


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/600.GenerateNonceResponse/SetRealmValue/SetDefaultRealm/100.SetGBARealm]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevGBARealmString "3GPP-bootstrapping"
AdornOps=+ DEG_OEMDevGBARealmString @ DEG_OEMDevGBARealmString
AdornOps=+ DEG_OEMDevGBARealmString ${DEG_DI_GBA_NAF_FQDN} DEG_OEMDevGBARealmString


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/600.GenerateNonceResponse/SetRealmValue/SetDefaultRealm/200.SetUICCRealm]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevGBARealmString "3GPP-bootstrapping-uicc"
AdornOps=+ DEG_OEMDevGBARealmString @ DEG_OEMDevGBARealmString
AdornOps=+ DEG_OEMDevGBARealmString ${DEG_DI_GBA_NAF_FQDN} DEG_OEMDevGBARealmString


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/600.GenerateNonceResponse/GenerateNonceAndOpaque]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=302.GenerateAndInserttoGBARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/700.ValidateEmptyBTIDInAuthorizationHeader]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevAuthTypeString,=,"GBA"
Conditions=DEG_OEMDevBTIDErrorFlagInteger,=,1
Operations=and
TrueRuleChain=SetLogInfo
TrueRuleChain=LogErrorInfo
TrueRuleChain=ExtractIMSIFromSubscriberID
TrueRuleChain=SetDefaultRealm
TrueRuleChain=GenerateNonceAndOpaque


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/700.ValidateEmptyBTIDInAuthorizationHeader/SetDefaultRealm]

ClassName=SwitchConditionRule
Conditions=DEG_OEMDevUserAgentString,=,"3gpp-gba"
Conditions=DEG_OEMDevUserAgentString,=,"3gpp-uicc"

Operation=None

TrueRuleChain=SetGBARealm
TrueRuleChain=SetUICCRealm

SetGBARealm=100.SetGBARealm
SetUICCRealm=200.SetUICCRealm


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/700.ValidateEmptyBTIDInAuthorizationHeader/SetDefaultRealm/100.SetGBARealm]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevGBARealmString "3GPP-bootstrapping"
AdornOps=+ DEG_OEMDevGBARealmString @ DEG_OEMDevGBARealmString
AdornOps=+ DEG_OEMDevGBARealmString ${DEG_DI_GBA_NAF_FQDN} DEG_OEMDevGBARealmString


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/700.ValidateEmptyBTIDInAuthorizationHeader/SetDefaultRealm/200.SetUICCRealm]

ClassName=AdornmentRule
AdornOps=set DEG_OEMDevGBARealmString "3GPP-bootstrapping-uicc"
AdornOps=+ DEG_OEMDevGBARealmString @ DEG_OEMDevGBARealmString
AdornOps=+ DEG_OEMDevGBARealmString ${DEG_DI_GBA_NAF_FQDN} DEG_OEMDevGBARealmString


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/700.ValidateEmptyBTIDInAuthorizationHeader/SetLogInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1011"
AdornOps=set DEG_OEMDevErrorMessageString "authorization header is empty in the request"


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/700.ValidateEmptyBTIDInAuthorizationHeader/LogErrorInfo]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Invalid action - authorization header does not contain BTID: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevAuthenticationInfoString
Attributes=DEG_OEMDevWwwauthenticateString
Attributes=DEG_OEMDevAuthorizationString


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/700.ValidateEmptyBTIDInAuthorizationHeader/ExtractIMSIFromSubscriberID]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull DEG_OEMDevImsiString ""
AdornOps=substr "0" "@" DEG_OEMDevSubscriberIdString DEG_OEMDevImsiString


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210C.DEG20ValidationAndProcessActionRuleChain/100.ValidationAndProcessAction/700.ValidateEmptyBTIDInAuthorizationHeader/GenerateNonceAndOpaque]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=302.GenerateAndInserttoGBARuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckTokenTimeStamp


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
FalseRuleChain=200.SetFullAuthTimeStamp
TrueRuleChain=100.GetDifference
TrueRuleChain=110.ReadTokenLifeTime


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/100.GetDifference]

AdornOps=setsystime DEG_OEMDevCurrentTimeStampLong
AdornOps=- DEG_OEMDevCurrentTimeStampLong DEG_FULLAUTHTIMESTAMP DEG_OEMDevTokenTimeStampDiffLong
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitRequest
RuleNames=110.ReadValue
RuleNames=120.CheckErrorAndNoMatchFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/100.InitRequest]

AdornOps=set DEG_OEMDevLicenseTypeString "EAP"
AdornOps=set DEG_OEMDevTokenLifetimeLong 0
AdornOps=set DEG_OEMDevAuthThresholdCountInteger 0
AdornOps=set DEG_CDevDBErrorFlagInteger 0
AdornOps=set DEG_CDevDBNoMatchFlagInteger 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/110.ReadValue]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_OEMDevLicenseTypeString
ResponseAttributes=DEG_OEMDevTokenLifetimeLong
ResponseAttributes=DEG_OEMDevAuthThresholdCountInteger
ResponseAttributes=DEG_CDevDBErrorFlagInteger
ResponseAttributes=DEG_CDevDBNoMatchFlagInteger
RuleChain=004.ReadTokenLifeTimeRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBErrorFlagInteger,=,0
FalseRuleChain=200.SetFullAuthTimeStamp
FalseRuleChain=210.SetErrorForLog
FalseRuleChain=220.ErrorLog
TrueRuleChain=100.CheckIfKeyExist


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevDBNoMatchFlagInteger,=,0
FalseRuleChain=200.SetFullAuthTimeStamp
FalseRuleChain=210.SetErrorForLog
FalseRuleChain=220.RowNotExistsLog
TrueRuleChain=100.SetSysValue
TrueRuleChain=110.CompareTokenExpirationTime
TrueRuleChain=120.TokenExpirationLog


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/100.SetSysValue]

AdornOps=copy DEG_OEMDevTokenLifetimeLong DEG_OEMDevEAPTokenLifetimeLong
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/110.CompareTokenExpirationTime]

ClassName=RuleChain
RuleNames=110.SetFastAuthFlagWithinEAPTokenLifetime
#RuleNames=120.GenRandomValueifWithinEAPTokenLifetimeto60days
#RuleNames=130.SetFullAuthRequiredif60daysago


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/110.CompareTokenExpirationTime/110.SetFastAuthFlagWithinEAPTokenLifetime]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenTimeStampDiffLong,<=,DEG_OEMDevEAPTokenLifetimeLong
TrueRuleChain=100.SetFastAuthFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/110.CompareTokenExpirationTime/110.SetFastAuthFlagWithinEAPTokenLifetime/100.SetFastAuthFlag]

AdornOps=set DEG_OEMDevFastAuthFlag 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/110.CompareTokenExpirationTime/120.GenRandomValueifWithinEAPTokenLifetimeto60days]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenTimeStampDiffLong,>,DEG_OEMDevEAPTokenLifetimeLong
Conditions=DEG_OEMDevTokenTimeStampDiffLong,<=,5184000000
Operations=and
TrueRuleChain=100.GenerateRandomValue


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/110.CompareTokenExpirationTime/120.GenRandomValueifWithinEAPTokenLifetimeto60days/100.GenerateRandomValue]

AdornOps=rand DEG_OEMDevRandValueInteger 1 10000000
AdornOps=% DEG_OEMDevRandValueInteger 2 DEG_OEMDevFastAuthFlag
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/110.CompareTokenExpirationTime/130.SetFullAuthRequiredif60daysago]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevTokenTimeStampDiffLong,>,5184000000
TrueRuleChain=100.SetNoFastAuthFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/110.CompareTokenExpirationTime/130.SetFullAuthRequiredif60daysago/100.SetNoFastAuthFlag]

AdornOps=set DEG_OEMDevFastAuthFlag 0
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/150.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1012"
AdornOps=set DEG_OEMDevErrorMessageString "TokenExpiration Log:"


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/120.TokenExpirationLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevCurrentTimeStampLong
Attributes=DEG_OEMDevTokenTimeStampDiffLong
Attributes=DEG_FULLAUTHTIMESTAMP
Attributes=DEG_OEMDevFastAuthFlag
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_TOKENSTATUS
Attributes=DEG_OEMDevTokenString
Attributes=DEG_SUBSTOKEN
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_OEMDevEAPTokenLifetimeLong
Attributes=DEG_CDevDBErrorFlagInteger
Attributes=DEG_CDevDBNoMatchFlagInteger
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=LogNMERule
LogLevel=DEBUG
Message=TokenExpiration Log:
PropertyName=LogRequestFlowLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/200.SetFullAuthTimeStamp]

AdornOps=setsystime DEG_FULLAUTHTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/210.SetErrorForLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1013"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/100.CheckIfKeyExist/220.RowNotExistsLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=WARNING
Message=No Row Found in DEG_LIC_LIMITS cache: 
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/200.SetFullAuthTimeStamp]

AdornOps=setsystime DEG_FULLAUTHTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/210.SetErrorForLog]

AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1014"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/110.ReadTokenLifeTime/120.CheckErrorAndNoMatchFlag/220.ErrorLog]

Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: Unable to access DEG_LIC_LIMITS cache
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.



[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210D.DEG20CheckTokenTimeStampRuleChain/100.CheckTokenTimeStamp/200.SetFullAuthTimeStamp]

AdornOps=setsystime DEG_FULLAUTHTIMESTAMP
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210E.DEG20CheckDeviceDataTableRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitDeviceDataLookup
RuleNames=110.LookUpDeviceData
RuleNames=120.CheckDBErrorFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210E.DEG20CheckDeviceDataTableRuleChain/100.InitDeviceDataLookup]

AdornOps=set log_DB_Operation SELECT
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevUniqueIDString DEG_UNIQUE_ID
AdornOps=copy DEG_DEVICE_ENTITLEMENT DEG_ENTITLEMENT_NAME
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210E.DEG20CheckDeviceDataTableRuleChain/110.LookUpDeviceData]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_UNIQUE_ID,DEG_UNIQUE_ID
MapAttributes=DEG_ENTITLEMENT_NAME,DEG_ENTITLEMENT_NAME
MapAttributes=DEG_IMSI,DEG_OEMDevIMSIInDeviceDataString
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210E.DEG20CheckDeviceDataTableRuleChain/120.CheckDBErrorFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
FalseRuleChain=200.CheckKeyExistFlag
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.PrintError


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210E.DEG20CheckDeviceDataTableRuleChain/120.CheckDBErrorFlag/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1015"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to lookup or access DEG_DEVICE_DATA table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210E.DEG20CheckDeviceDataTableRuleChain/120.CheckDBErrorFlag/110.PrintError]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevUniqueIDString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: in looking up DEG_DEVICE_DATA table
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210E.DEG20CheckDeviceDataTableRuleChain/120.CheckDBErrorFlag/200.CheckKeyExistFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
FalseRuleChain=200.InsertRow
TrueRuleChain=100.CompareIMSI


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210E.DEG20CheckDeviceDataTableRuleChain/120.CheckDBErrorFlag/200.CheckKeyExistFlag/100.CompareIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevImsiString,=,DEG_OEMDevIMSIInDeviceDataString
FalseRuleChain=51.SetErrorInfo
FalseRuleChain=100.LogRowUpdate
FalseRuleChain=200.UpdateRowWithIMSI
TrueRuleChain=180.SetErrorInfo
TrueRuleChain=100.RowPresent

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210E.DEG20CheckDeviceDataTableRuleChain/120.CheckDBErrorFlag/200.CheckKeyExistFlag/100.CompareIMSI/51.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.1016"
AdornOps=set DEG_OEMDevMessageString "Updation of row in Device Data Table"

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210E.DEG20CheckDeviceDataTableRuleChain/120.CheckDBErrorFlag/200.CheckKeyExistFlag/100.CompareIMSI/100.LogRowUpdate]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevUniqueIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_IMSI
Attributes=DEG_OEMDevIMSIInDeviceDataString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=Row needs to update in Device Data Table:
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210E.DEG20CheckDeviceDataTableRuleChain/120.CheckDBErrorFlag/200.CheckKeyExistFlag/100.CompareIMSI/200.UpdateRowWithIMSI]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=210H.DEG20UpdateRowInDeviceDataTableRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210E.DEG20CheckDeviceDataTableRuleChain/120.CheckDBErrorFlag/200.CheckKeyExistFlag/100.CompareIMSI/180.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.1017"
AdornOps=set DEG_OEMDevMessageString "Row present in Device Data Table"

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210E.DEG20CheckDeviceDataTableRuleChain/120.CheckDBErrorFlag/200.CheckKeyExistFlag/100.CompareIMSI/100.RowPresent]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevUniqueIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_IMSI
Attributes=DEG_OEMDevIMSIInDeviceDataString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Row present in Device Data Table:
PropertyName=LogRequestIssueLevel1
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210E.DEG20CheckDeviceDataTableRuleChain/120.CheckDBErrorFlag/200.CheckKeyExistFlag/200.InsertRow]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=210F.DEG20InsertRowDeviceDataTableRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210F.DEG20InsertRowDeviceDataTableRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitInsertDeviceDataLookup
RuleNames=110.InsertDeviceData
RuleNames=120.CheckDBErrorFlag


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210F.DEG20InsertRowDeviceDataTableRuleChain/100.InitInsertDeviceDataLookup]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation INSERT
AdornOps=set log_Table_Name DEG_DEVICE_DATA
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=copy DEG_OEMDevUniqueIDString DEG_UNIQUE_ID
AdornOps=copy DEG_DEVICE_ENTITLEMENT DEG_DEVICE_ENTITLEMENT
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=setifnull DEG_APNS_TOKEN ""
AdornOps=setifnull DEG_OLD_APNS_TOKEN ""
AdornOps=setifnull DEG_SUB_STATUS 0
AdornOps=setifnull DEG_PUSH_NOTIFICATION_STATUS 0
AdornOps=setifnull DEG_SERVICE_MGMT_POSTDATA ""
AdornOps=setifnull DEG_DISPLAY_NAME ""
AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_ADDR_REFID ""
AdornOps=setsystime DEG_ADDR_REFID_EXP_DATE
AdornOps=setsystime DEG_LASTUPDATE
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_SIP_USERNAME ""
AdornOps=setifnull DEG_SSL_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_SSL_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_SSL_POSTDATA ""
AdornOps=setifnull DEG_SSL_ID_PROV_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=copy DEG_SSL_ADDRESS_STATUS DEG_ADDRESS_STATUS
AdornOps=copy DEG_SSL_TC_STATUS DEG_TC_STATUS
AdornOps=copy DEG_SSL_POSTDATA DEG_ADDR_UPDATE_POSTDATA
AdornOps=copy DEG_SSL_ID_PROV_STATUS DEG_PROVISIONING_STATUS
AdornOps=setsystime DEG_SELF_PROV_STARTDATE

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210F.DEG20InsertRowDeviceDataTableRuleChain/110.InsertDeviceData]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
SessionStore=DEG_DEVICE_DATA_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210F.DEG20InsertRowDeviceDataTableRuleChain/120.CheckDBErrorFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.PrintError


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210F.DEG20InsertRowDeviceDataTableRuleChain/120.CheckDBErrorFlag/100.SetErrorInfo]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1018"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to access or create entry in DEG_DEVICE_DATA table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210F.DEG20InsertRowDeviceDataTableRuleChain/120.CheckDBErrorFlag/110.PrintError]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevUniqueIDString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Database Error: unable to add row in DEG_DEVICE_DATA table
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210H.DEG20UpdateRowInDeviceDataTableRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitUpdate
RuleNames=110.UpdateData
RuleNames=120.CheckUpdateStatus


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210H.DEG20UpdateRowInDeviceDataTableRuleChain/100.InitUpdate]

AdornOps=set log_DB_Operation "UPDATE"
AdornOps=set log_Table_Name "DEG_DEVICE_DATA"
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevUniqueIdString DEG_UNIQUE_ID
AdornOps=copy DEG_DEVICE_ENTITLEMENT DEG_DEVICE_ENTITLEMENT
AdornOps=copy DEG_OEMDevImsiString DEG_IMSI
AdornOps=set DEG_APNS_TOKEN ""
AdornOps=set DEG_OLD_APNS_TOKEN ""
AdornOps=set DEG_PUSH_NOTIFICATION_STATUS 0
AdornOps=set DEG_SERVICE_MGMT_POSTDATA ""
AdornOps=set DEG_DISPLAY_NAME ""
AdornOps=set DEG_SIP_USERNAME ""
AdornOps=setifnull DEG_PROVISIONING_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_ADDR_UPDATE_POSTDATA ""
AdornOps=setifnull DEG_SSL_ID_PROV_STATUS ${DEG_DEFAULT_PROVISIONING_STATUS}
AdornOps=setifnull DEG_SSL_ADDRESS_STATUS ${DEG_DEFAULT_ADDRESS_STATUS}
AdornOps=setifnull DEG_SSL_TC_STATUS ${DEG_DEFAULT_TC_STATUS}
AdornOps=setifnull DEG_SSL_POSTDATA ""
AdornOps=copy DEG_SSL_ID_PROV_STATUS DEG_PROVISIONING_STATUS
AdornOps=copy DEG_SSL_ADDRESS_STATUS DEG_ADDRESS_STATUS
AdornOps=copy DEG_SSL_TC_STATUS DEG_TC_STATUS
AdornOps=copy DEG_SSL_POSTDATA DEG_ADDR_UPDATE_POSTDATA
AdornOps=set DEG_ADDR_REFID ""
AdornOps=setsystime DEG_ADDR_REFID_EXP_DATE
AdornOps=setsystime DEG_LASTUPDATE
AdornOps=setsystime DEG_SELF_PROV_STARTDATE
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210H.DEG20UpdateRowInDeviceDataTableRuleChain/110.UpdateData]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_APNS_TOKEN,DEG_APNS_TOKEN
MapAttributes=DEG_OLD_APNS_TOKEN,DEG_OLD_APNS_TOKEN
MapAttributes=DEG_PROVISIONING_STATUS,DEG_PROVISIONING_STATUS
MapAttributes=DEG_PUSH_NOTIFICATION_STATUS,DEG_PUSH_NOTIFICATION_STATUS
MapAttributes=DEG_SERVICE_MGMT_POSTDATA,DEG_SERVICE_MGMT_POSTDATA
MapAttributes=DEG_DISPLAY_NAME,DEG_DISPLAY_NAME
MapAttributes=DEG_ADDRESS_STATUS,DEG_ADDRESS_STATUS
MapAttributes=DEG_TC_STATUS,DEG_TC_STATUS
MapAttributes=DEG_ADDR_UPDATE_POSTDATA,DEG_ADDR_UPDATE_POSTDATA
MapAttributes=DEG_ADDR_REFID,DEG_ADDR_REFID
MapAttributes=DEG_ADDR_REFID_EXP_DATE,DEG_ADDR_REFID_EXP_DATE
MapAttributes=DEG_LASTUPDATE,DEG_LASTUPDATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_DEVICE_DATA_SessionStore


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210H.DEG20UpdateRowInDeviceDataTableRuleChain/120.CheckUpdateStatus]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,1
NoRowExists=100.SetErrorForNoRow
NoRowExists=200.PrintMessageForNoRow
Operations=None
SystemError=100.SetErrorAttribute
SystemError=200.PrintError
TrueRuleChain=SystemError
TrueRuleChain=NoRowExists
TrueRuleChain=UpdateRow
UpdateRow=50.SetErrorInfo
UpdateRow=100.LogMessage

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210H.DEG20UpdateRowInDeviceDataTableRuleChain/120.CheckUpdateStatus/50.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.GA.1019"
AdornOps=set DEG_OEMDevMessageString "Row updated in Device Data Table"

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210H.DEG20UpdateRowInDeviceDataTableRuleChain/120.CheckUpdateStatus/100.LogMessage]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevUniqueIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=Row updated in Device Data Table:
UseProperty=true


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210H.DEG20UpdateRowInDeviceDataTableRuleChain/120.CheckUpdateStatus/100.SetErrorAttribute]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1020"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to access DEG_DEVICE_DATA table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210H.DEG20UpdateRowInDeviceDataTableRuleChain/120.CheckUpdateStatus/100.SetErrorForNoRow]

AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.GA.1021"
AdornOps=set DEG_OEMDevErrorMessageString "Unable to update DEG_DEVICE_DATA table"
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210H.DEG20UpdateRowInDeviceDataTableRuleChain/120.CheckUpdateStatus/200.PrintError]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevUniqueIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Error while access Device Data Table:
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/GetAuthentication_V2Core/RuleChains/210H.DEG20UpdateRowInDeviceDataTableRuleChain/120.CheckUpdateStatus/200.PrintMessageForNoRow]

Attributes=DEG_DEVICE_ENTITLEMENT
Attributes=DEG_OEMDevUniqueIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=CRITICAL
Message=Error while updating Device Data Table:
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.