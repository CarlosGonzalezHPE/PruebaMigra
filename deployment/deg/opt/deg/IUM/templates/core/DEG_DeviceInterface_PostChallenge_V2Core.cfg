[/templates/DEG/DeviceInterface/PostChallenge_V2Core]

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains]

RuleChainNames=212.DEG20ProcessOEMPostChallengeRuleChain
RuleChainNames=212A.DEG20ProcessActionRuleChain
RuleChainNames=212B.DEG20UpdateSslSessionStateRuleChain
RuleChainNames=212C.DEG20GenerateOEMResponseRuleChain
RuleChainNames=212D.DEG20GeneratePostChallengeEndAuditDataRuleChain

RuleChainNames=715.DEG20GeneratePostChallengeStartAuditDataRuleChain
RuleChainNames=716.DEG20GeneratePostChallengeAAAAuthenticatedEndAuditDataRuleChain
RuleChainNames=717.DEG20GeneratePostChallengeAkaWaitEndAuditDataRuleChain
RuleChainNames=718.DEG20GeneratePostChallengeDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
RuleChainNames=719.DEG20GeneratePostChallengeAkaRejectedEndAuditDataRuleChain
RuleChainNames=720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain
RuleChainNames=721.DEG20GeneratePostChallengeDisallowedActionEndAuditDataRuleChain

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckPostChallengeAction
RuleNames=200.GeneratePostChallengeEndAuditData

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction]
 
ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevActionNameString,=,postChallenge

TrueRuleChain=100.ExtractPayload
TrueRuleChain=110.DecodePayload
TrueRuleChain=120.CheckPlayloadIfBase64
TrueRuleChain=170.SetResponseHandler

FalseRuleChain=200.Set400Error
FalseRuleChain=170.SetResponseHandler
FalseRuleChain=220.LogError
FalseRuleChain=230.GeneratePostChallengeStartAuditData
FalseRuleChain=240.GeneratePostChallengeSystemErrorEndAuditData

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/100.ExtractPayload]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
StructuredNMEToNMEMap=payload.CData,DEG_OEMDevEapPayloadString


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/110.DecodePayload]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=decBase64 DEG_OEMDevEapPayloadString DEG_OEMDevEAPPayloadBinary
AdornOps=set DEG_SSL_REQUEST_STATE "200"
AdornOps=set DEG_OEMDevAuthTypeString "EAP-AKA"

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/120.CheckPlayloadIfBase64]

ClassName=com.hp.siu.collector.rules.ConditionalRule
TrueRuleChain=100.SetHTTPError
TrueRuleChain=110.ErrorLog
TrueRuleChain=120.GeneratePostChallengeStartAuditData
TrueRuleChain=130.GeneratePostChallengeSystemErrorEndAuditData
FalseRuleChain=200.ProcessAction

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/120.CheckPlayloadIfBase64/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=(DEG_OEMDevEapPayloadString =="") || (DEG_OEMDevEAPPayloadBinary == null)

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/120.CheckPlayloadIfBase64/100.SetHTTPError]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.PC.0201"
#QXCM1001509545--DEG_AuditNRBMessageString is set to "" for getAuthentication V2
AdornOps=set DEG_OEMDevErrorMessageString "Payload is Expected"

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/120.CheckPlayloadIfBase64/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevEapPayloadString
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - Invalid Payload - Unable to Perform Base64 decoding: 
PropertyName=LogRequestIssueLevel1
UseProperty=true

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/120.CheckPlayloadIfBase64/120.GeneratePostChallengeStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=715.DEG20GeneratePostChallengeStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/120.CheckPlayloadIfBase64/130.GeneratePostChallengeSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/120.CheckPlayloadIfBase64/200.ProcessAction]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=212A.DEG20ProcessActionRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/170.SetResponseHandler]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_REQUEST_STATE,starts,200
TrueRuleChain=100.SetJsonResponse
FalseRuleChain=200.SetEmptyResponse

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/170.SetResponseHandler/100.SetJsonResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevResponseHandlerString "JsonResponseHandler"
AdornOps=set DEG_OEMDevConnectionString "keep-alive"

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/170.SetResponseHandler/200.SetEmptyResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevResponseHandlerString "EmptyResponseHandler"


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/200.Set400Error]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "400C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.PC.0202"
#QXCM1001509545--DEG_AuditNRBMessageString is set to "" for getAuthentication V2
AdornOps=set DEG_OEMDevErrorMessageString "postChallenge is expected"

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/220.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_IMSI
Attributes=DEG_OEMDevEapPayloadString
Attributes=DEG_SSL_STATE
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Request processed with error - Invalid Action - postChallenge expected: 
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=During PostChallenge Action ,The action name in the request is invalid.

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/230.GeneratePostChallengeStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=715.DEG20GeneratePostChallengeStartAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/100.CheckPostChallengeAction/240.GeneratePostChallengeSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/200.GeneratePostChallengeEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,1
#Added this condition while fixing QXCM1001445539 this is required in case of EAPAKADefaultAuthWhenError=Disabled.
Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"

Operations=and

TrueRuleChain=100.AuthenticationAkaRejected

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212.DEG20ProcessOEMPostChallengeRuleChain/200.GeneratePostChallengeEndAuditData/100.AuthenticationAkaRejected]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=719.DEG20GeneratePostChallengeAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.AddIdAndActionToList
RuleNames=110.UpdateSslSessionState
RuleNames=200.AAAProcessingRule
RuleNames=210.CheckPayload
RuleNames=100.SetErrorInfo
RuleNames=220.LogEAPAKAWait
RuleNames=230.InitSslSessionAfterEAPAKA
RuleNames=300.UpdateSslSessionAfterEAPAKA
RuleNames=310.CheckSslSessionUpdateStatus
RuleNames=400.GenerateOEMResponse

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/100.AddIdAndActionToList]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitVariables
RuleNames=200.AddToList

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/100.AddIdAndActionToList/100.InitVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_OEMDevRequestIdString DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString _ DEG_OEMDevRequestIdAndNameString
AdornOps=+ DEG_OEMDevRequestIdAndNameString DEG_OEMDevActionNameString DEG_OEMDevRequestIdAndNameString
AdornOps=set DEG_OEMDevDeviceTypeString "Primary"
AdornOps=set DEG_OEMDevDBTypeString ${DEG_DB_TYPE}
AdornOps=lower DEG_OEMDevDBTypeString DEG_OEMDevDBTypeString


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/100.AddIdAndActionToList/200.AddToList]

ClassName=com.hp.siu.collector.rules.AddToListAttributeRule
InputAttribute=DEG_OEMDevRequestIdAndNameString
ListAttribute=DEG_OEMDevRequestIdAndNameList

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/110.UpdateSslSessionState]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=212B.DEG20UpdateSslSessionStateRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/200.AAAProcessingRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_OEMDevSubscriberIdString
RequestAttributes=DEG_OEMDevEAPPayloadBinary
RequestAttributes=DEG_OEMDevSslSessionIdString
#RequestAttributes=DEG_OEMDevAuthSessionStateStringTbl
RequestAttributes=DEG_SSL_AAA_STATE
RequestAttributes=DEG_SSL_AAA_SESSIONID
RequestAttributes=DEG_SSL_NAI
ResponseAttributes=DEG_SSL_STATE
ResponseAttributes=DEG_SSL_AAA_STATE
ResponseAttributes=DEG_AUTHENTICATION_TYPE
ResponseAttributes=DEG_AUTHENTICATION_SUBTYPE
ResponseAttributes=DEG_OEMDevEAPPayloadBinary
RuleChain=301.AAAProcessingRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/210.CheckPayload]

ClassName=com.hp.siu.collector.rules.ConditionalRule
FalseRuleChain=200.EncodeEAPPayload

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/210.CheckPayload/Condition]

ClassName=com.hp.usage.script.rules.ExpressionCondition
Expression=DEG_OEMDevEAPPayloadBinary == null

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/210.CheckPayload/200.EncodeEAPPayload]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=encBase64 DEG_OEMDevEAPPayloadBinary DEG_OEMDevEAPPayloadString

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/100.SetErrorInfo]

AdornOps=set DEG_OEMDevMessageString "Perform EAPAKAAtuh for AkaWait"
AdornOps=set DEG_CDevProcessingMessageIdString "DEG.DI.PC.0203"
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/220.LogEAPAKAWait]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_MDN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_AUTHENTICATION_TYPE
Attributes=DEG_AUTHENTICATION_SUBTYPE
Attributes=DEG_CDevSysValueString
Attributes=DEG_SSL_STATE
Attributes=DEG_OEMDevEapPayloadString
Attributes=DEG_OEMDevEAPPayloadBinary
Attributes=DEG_CDevProcessingMessageIdString
Attributes=DEG_OEMDevMessageString
LogLevel=DEBUG
Message=Perform EAPAKAAtuh for AkaWait: 
PropertyName=LogRequestFlowLevel1
UseProperty=true
#QXCM1001409517::Warning messages in log file for non-initialized variables
[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/230.InitSslSessionAfterEAPAKA]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION


##DoCoMo issue#6 getPhoneNumber(Description : the response "phoneNumber" of getPhoneNumber is old MDN).Added mdn update.
[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/300.UpdateSslSessionAfterEAPAKA]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
MapAttributes=DEG_SSL_MDN,DEG_SSL_MDN
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/310.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1

TrueRuleChain=100.SetErrorMessage
TrueRuleChain=110.LogError
TrueRuleChain=120.GeneratePostChallengeSystemErrorEndAuditData
FalseRuleChain=200.CheckKeyExists

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/100.SetErrorMessage]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.TransientError

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/100.SetErrorMessage/100.TransientError]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.PC.0204"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"



[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/110.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/120.GeneratePostChallengeSystemErrorEndAuditData]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1
TrueRuleChain=100.GenerateAuditData


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/120.GeneratePostChallengeSystemErrorEndAuditData/100.GenerateAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.SetErrorMessage
TrueRuleChain=110.LogError

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.SetErrorMessage]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.PC.0205"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/310.CheckSslSessionUpdateStatus/200.CheckKeyExists/110.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_MDN
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=WARNING
Message=Unable to find the row in DEG_SSL_SESSION store
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/400.GenerateOEMResponse]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=DoAll

Conditions=DEG_OEMDevRequestProcessedInteger,=,0
Conditions=DEG_OEMDevRequestProcessedInteger,=,0

TrueRuleChain=CheckTypeOfResponse
TrueRuleChain=GeneratePostChallengeEndAuditData

CheckTypeOfResponse=100.CheckCustomizedResponse
CheckTypeOfResponse=100.CheckTypeOfResponse

GeneratePostChallengeEndAuditData=200.GeneratePostChallengeEndAuditData

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/400.GenerateOEMResponse/100.CheckCustomizedResponse]

#RFE47-AAA response code processing as per delivery need

Link=/templates/DEG/DeviceInterface/EAPAKAAuthenticatorDiameterClient_Customize/RuleChains/400.GenerateOEMResponse/100.CheckCustomizedResponse

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/400.GenerateOEMResponse/100.CheckTypeOfResponse]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=212C.DEG20GenerateOEMResponseRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212A.DEG20ProcessActionRuleChain/400.GenerateOEMResponse/200.GeneratePostChallengeEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=212D.DEG20GeneratePostChallengeEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.CheckResponseType

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_SSL_STATE,=,"UNKNOWN_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"BLACKLISTED_SUBSCRIBER"
Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"
Conditions=DEG_SSL_STATE,starts,"AUTHENTICATED"
Conditions=DEG_SSL_STATE,=,DEG_SSL_STATE

TrueRuleChain=UnknownSubscriber
TrueRuleChain=BlackListedSubscriber
TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=StatusDisallowed
TrueRuleChain=Authenticated
TrueRuleChain=Unknown

UnknownSubscriber=100.UnknownSubscriber_InitResponse
UnknownSubscriber=110.UnknownSubscriber_GenerateResponse

BlackListedSubscriber=600.BlackListedSubscriber_InitResponse
BlackListedSubscriber=610.BlackListedSubscriber_GenerateResponse

AkaWait=200.AkaWait_InitResponse
AkaWait=210.AkaWait_GenerateResponse

AkaRejected=300.AkaRejected_InitResponse
AkaRejected=310.AkaRejected_DeactiveToken
AkaRejected=320.AkaRejected_GenerateResponse

Authenticated=400.Authenticated_InitResponse
Authenticated=410.Authenticated_TokenLookupForDFTCase
#RFE75 fix related files.
#New header attribute 'user-agent' added as part of http request from the device.
#iOS device sends specific User-Agent strings that can identify the specific device and version of iOS.
Authenticated=415.Authenticated_UserAgent
Authenticated=420.Authenticated_StoreToken
Authenticated=430.Authenticated_CompanionData

Authenticated=440.Authenticated_DeviceData
Authenticated=449.Authenticated_MSCHAPLookupSSLTable
Authenticated=450.Authenticated_ConnectivityAuthType
Authenticated=455.Authenticated_CheckDAI
Authenticated=460.Authenticated_GenerateResponse

Unknown=500.Unknown_SetHttpErrorResponseTo500C

StatusDisallowed=600.DisallowedAction_InitResponse
StatusDisallowed=610.DisallowedAction_GenerateResponse

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/100.UnknownSubscriber_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6004

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/110.UnknownSubscriber_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/600.BlackListedSubscriber_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6300


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/610.BlackListedSubscriber_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/200.AkaWait_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6302

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/210.AkaWait_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevEAPPayloadString,jsonResponse.challenge.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/300.AkaRejected_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6300
AdornOps=set DEG_TOKENSTATUS "DE"
AdornOps=set DEG_SSL_REQUEST_STATE "200C"


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/310.AkaRejected_DeactiveToken]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_TOKENSTATUS,DEG_TOKENSTATUS
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/320.AkaRejected_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

#Gateway Address in the JSON response attribute of getAuthentication did not use the value set in getAuthentication’s getSubscriberProfile custom template.
[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/400.Authenticated_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_APP_TOKEN_FLAG 1
AdornOps=set DEG_OEMDevRespStatusString 6000
AdornOps=genKey "HmacSHA1" 160 - DEG_CDevSha1KeyBinary
AdornOps=encBase64 DEG_CDevSha1KeyBinary DEG_OEMDevRespTokenString
AdornOps=copy DEG_OEMDevRespTokenString DEG_CDevTokenString
AdornOps=set DEG_SSL_REQUEST_STATE "200C"

AdornOps=set DEG_OEMDevtempConnectivityAuthTypeString ${CONNECTIVITY_AUTH_TYPE}
#AdornOps=lower DEG_OEMDevtempConnectivityAuthTypeString DEG_OEMDevConnectivityAuthTypeString

AdornOps=set DEG_OEMDevtempEntitlementServerAddressString ${ENTITLEMENT_SERVERADDRESS}
AdornOps=lower DEG_OEMDevtempEntitlementServerAddressString DEG_OEMDevEntitlementServerAddressString

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
Conditions=DEG_AUTHENTICATION_TYPE,=,"EAP"
Conditions=DEG_AUTHENTICATION_SUBTYPE,=,"DFT"
Operations=and,and
TrueRuleChain=100.InitValues
TrueRuleChain=110.Lookup
TrueRuleChain=120.CheckLookupStatus

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/100.InitValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_TOKENS"
AdornOps=copy DEG_MDN DEG_CDevMobileNumberString

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/110.Lookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_IMSI,DEG_IMSI
MapAttributes=DEG_MDN,DEG_MDN
MapAttributes=DEG_FULLAUTHTIMESTAMP,DEG_FULLAUTHTIMESTAMP
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_TOKENS_SessionStore

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
#TrueRuleChain=120.GeneratePostChallengeSystemErrorEndAuditData
FalseRuleChain=200.CheckTokenExist

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.PC.0206"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_TOKENS table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/120.GeneratePostChallengeSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/200.CheckTokenExist]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
FalseRuleChain=200.SetAuthTimesTamp

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/410.Authenticated_TokenLookupForDFTCase/120.CheckLookupStatus/200.CheckTokenExist/200.SetAuthTimesTamp]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_FULLAUTHTIMESTAMP

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/415.Authenticated_UserAgent]

ClassName=RuleChain
RuleNames=100.CopyCoreNMEToCustNME
RuleNames=200.CallUserAgentCustomTemplate
RuleNames=205.CheckoutuserAgentValues

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/415.Authenticated_UserAgent/100.CopyCoreNMEToCustNME]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setifnull CUST_GAC_OUT_UserAgentString ""
AdornOps=copy DEG_OEMDevUserAgentString DEG_USER_AGENT
AdornOps=copy DEG_OEMDevUserAgentString CUST_GAC_IN_UserAgentString

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/415.Authenticated_UserAgent/200.CallUserAgentCustomTemplate]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=CUSTRC_Apple_GA_UserAgentUpdate
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/415.Authenticated_UserAgent/205.CheckoutuserAgentValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy CUST_GAC_OUT_UserAgentString DEG_OEMDevUserAgentString
AdornOps=copy CUST_GAC_OUT_UserAgentString DEG_USER_AGENT
AdornOps=copy DEG_OEMDevUniqueIdString DEG_UNIQUE_ID
AdornOps=copy CUST_GAC_OUT_UserAgentString DEG_AuditUserAgentString

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/420.Authenticated_StoreToken]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RequestAttributes=DEG_CDevMobileNumberString
RequestAttributes=DEG_IMSI
RequestAttributes=DEG_CDevTokenString
RequestAttributes=DEG_AUTHENTICATION_TYPE
RequestAttributes=DEG_AUTHENTICATION_SUBTYPE
RequestAttributes=DEG_APP_TOKEN_FLAG
RequestAttributes=DEG_FULLAUTHTIMESTAMP
ResponseAttributes=DEG_OEMDevErrorMessageString
ResponseAttributes=DEG_EVENTTIMESTAMP
RuleChain=005.StoreTokenRuleChain
UseRuleChainManagerPool=true

#QXCM1001407667::DEG generates token under full authentication even if features not associated
[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/430.Authenticated_CompanionData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224J.DEG21CheckCustFeatureListRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/440.Authenticated_DeviceData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=007.DEG20ReadEntitlementFCMappingNameRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/449.Authenticated_MSCHAPLookupSSLTable]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitValues
RuleNames=110.Lookup
RuleNames=120.CheckLookupStatus

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/449.Authenticated_MSCHAPLookupSSLTable/100.InitValues]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=set log_DB_Operation "SELECT"
AdornOps=set log_Table_Name "DEG_SSL_SESSION"
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_OEMDevCustomMschapUsernameString ""
AdornOps=set DEG_OEMDevCustomMschapPasswordString ""


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/449.Authenticated_MSCHAPLookupSSLTable/110.Lookup]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_MSCHAP_PASSWORD,DEG_SSL_MSCHAP_PASSWORD
MapAttributes=DEG_SSL_MSCHAP_USERNAME,DEG_SSL_MSCHAP_USERNAME
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/449.Authenticated_MSCHAPLookupSSLTable/120.CheckLookupStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,!=,0
TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog
FalseRuleChain=200.CheckMSCHAPExists

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/449.Authenticated_MSCHAPLookupSSLTable/120.CheckLookupStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.PC.0207"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/449.Authenticated_MSCHAPLookupSSLTable/120.CheckLookupStatus/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=CRITICAL
Message=Database Error: Unable to perform lookup or access DEG_SSL_SESSION table
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true

#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/449.Authenticated_MSCHAPLookupSSLTable/120.CheckLookupStatus/200.CheckMSCHAPExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,!=,0
TrueRuleChain=100.CopyMSCHAPCredentials

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/449.Authenticated_MSCHAPLookupSSLTable/120.CheckLookupStatus/200.CheckMSCHAPExists/100.CopyMSCHAPCredentials]

AdornOps=copy DEG_SSL_MSCHAP_USERNAME DEG_OEMDevCustomMschapUsernameString
AdornOps=copy DEG_SSL_MSCHAP_PASSWORD DEG_OEMDevCustomMschapPasswordString
ClassName=com.hp.siu.collector.rules.AdornmentRule

#QXCM1001409544 and QXCM1001410178:::Service-Tokens and Subscribers-IDs are of wrong format
[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/450.Authenticated_ConnectivityAuthType]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224F.DEG20ConnectivityAuthTypeRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/455.Authenticated_CheckDAI]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=224K.DEG21CheckDAIRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/460.Authenticated_GenerateResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=200.GenerateResponse

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/460.Authenticated_GenerateResponse/200.GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
NMEToStructuredNMEMap=DEG_OEMDevRespTokenString,jsonResponse.token.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/500.Unknown_SetHttpErrorResponseTo500C]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_SSL_REQUEST_STATE "500C"


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/600.DisallowedAction_InitResponse]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRespStatusString 6002

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212C.DEG20GenerateOEMResponseRuleChain/100.CheckResponseType/610.DisallowedAction_GenerateResponse]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=DEG_OEMDevRequestIdString,jsonResponse.response_id.CData
NMEToStructuredNMEMap=DEG_OEMDevRespStatusString,jsonResponse.status.CData
SNMEType=Umbrella:Body

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212D.DEG20GeneratePostChallengeEndAuditDataRuleChain]

RuleNames=100.GeneratePostChallengeEndAuditData

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212D.DEG20GeneratePostChallengeEndAuditDataRuleChain/100.GeneratePostChallengeEndAuditData]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_SSL_STATE,=,"WAIT_FOR_AKA_CHALLENGE_RESPONSE_FROM_DEVICE"
Conditions=DEG_SSL_STATE,=,"AKA_CHALLENGE_REJECTED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_AAA"
Conditions=DEG_SSL_STATE,=,"AUTHENTICATED_BY_DEG_TOKEN"
Conditions=DEG_SSL_STATE,=,"DISALLOWED_ACTION"

TrueRuleChain=AkaWait
TrueRuleChain=AkaRejected
TrueRuleChain=AuthenticatedAAA
TrueRuleChain=AuthenticatedDEGToken
TrueRuleChain=StatusDisallowed

AkaRejected=100.GeneratePostChallengeAkaRejectedEndAuditData

AkaWait=200.GeneratePostChallengeAkaWaitEndAuditData

AuthenticatedAAA=300.GeneratePostChallengeAAAAuthenticatedEndAuditData

AuthenticatedDEGToken=400.GeneratePostChallengeDEGTokenAuthenticatedDefaultEndAuditData

StatusDisallowed=500.GeneratePostChallengeDisallowedActionEndAuditData

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212D.DEG20GeneratePostChallengeEndAuditDataRuleChain/100.GeneratePostChallengeEndAuditData/100.GeneratePostChallengeAkaRejectedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=719.DEG20GeneratePostChallengeAkaRejectedEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212D.DEG20GeneratePostChallengeEndAuditDataRuleChain/100.GeneratePostChallengeEndAuditData/200.GeneratePostChallengeAkaWaitEndAuditData]

ClassName=LocalRuleChainInvoker
RuleChain=717.DEG20GeneratePostChallengeAkaWaitEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212D.DEG20GeneratePostChallengeEndAuditDataRuleChain/100.GeneratePostChallengeEndAuditData/300.GeneratePostChallengeAAAAuthenticatedEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=716.DEG20GeneratePostChallengeAAAAuthenticatedEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212D.DEG20GeneratePostChallengeEndAuditDataRuleChain/100.GeneratePostChallengeEndAuditData/400.GeneratePostChallengeDEGTokenAuthenticatedDefaultEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=718.DEG20GeneratePostChallengeDEGTokenAuthenticatedDefaultEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212D.DEG20GeneratePostChallengeEndAuditDataRuleChain/100.GeneratePostChallengeEndAuditData/500.GeneratePostChallengeDisallowedActionEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=721.DEG20GeneratePostChallengeDisallowedActionEndAuditDataRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.InitSslSessionUpdate
RuleNames=200.GetActiveMonitoringSessionsByUNIQUEID
RuleNames=210.GetActiveMonitoringSessionsByIMSI
RuleNames=220.GetActiveMonitoringSessionsByMDN
RuleNames=300.GeneratePostChallengeStartAuditData
RuleNames=350.InitSslSessionUpdate
RuleNames=400.ExecuteSslSessionUpdate
RuleNames=410.CheckSslSessionUpdateStatus

#RFE 86 : Include Bell Changes into Product. Issue no.3b
[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/100.InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1
AdornOps=copy DEG_OEMDevSslSessionIdString DEG_SSL_ID
AdornOps=set DEG_SSL_STATE WAIT_FOR_AKA_CHALLENGE_CHECK_FROM_AAA
AdornOps=copy DEG_SSL_NAI DEG_OEMDevSubscriberIdString
AdornOps=copy DEG_SSL_IMSI DEG_OEMDevImsiString
AdornOps=copy DEG_SSL_IMSI DEG_IMSI
AdornOps=copy DEG_SSL_MDN DEG_CDevMobileNumberString
AdornOps=copy DEG_SSL_MDN DEG_MDN
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_OEMDevUniqueIDString
AdornOps=copy DEG_SSL_CUSTOM_FIELD DEG_OEMDevSubscriberProfileString

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/200.GetActiveMonitoringSessionsByUNIQUEID]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitVariables
TrueRuleChain=110.CheckIfMonitoredSession

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/200.GetActiveMonitoringSessionsByUNIQUEID/100.InitVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
#AdornOps=copy DEG_SSL_UNIQUE_ID DEG_MSESSIONKEY
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_MSESSIONKEY

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/200.GetActiveMonitoringSessionsByUNIQUEID/110.CheckIfMonitoredSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessionsV2


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/210.GetActiveMonitoringSessionsByIMSI]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitVariables
TrueRuleChain=110.CheckIfMonitoredSession

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/210.GetActiveMonitoringSessionsByIMSI/100.InitVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_IMSI DEG_MSESSIONKEY

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/210.GetActiveMonitoringSessionsByIMSI/110.CheckIfMonitoredSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessionsV2


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/220.GetActiveMonitoringSessionsByMDN]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_OEMDevRequestProcessedInteger,=,0
TrueRuleChain=100.InitVariables
TrueRuleChain=110.CheckIfMonitoredSession

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/220.GetActiveMonitoringSessionsByMDN/100.InitVariables]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_MDN DEG_MSESSIONKEY

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/220.GetActiveMonitoringSessionsByMDN/110.CheckIfMonitoredSession]

ClassName=com.hp.usage.refdatasrv.RefDataLookupRule
QueryName=DEG_MONITORING_SESSIONS_ActiveSessionsV2


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/300.GeneratePostChallengeStartAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=715.DEG20GeneratePostChallengeStartAuditDataRuleChain
UseRuleChainManagerPool=true
#QXCM1001409517::Warning messages in log file for non-initialized variables
[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/350.InitSslSessionUpdate]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set log_DB_Operation UPDATE
AdornOps=set log_Table_Name DEG_SSL_SESSION
AdornOps=set DEG_CDevSessionStoreErrorFlagInteger 0
AdornOps=set DEG_CDevSessionStoreKeyExistsFlagInteger 1

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/400.ExecuteSslSessionUpdate]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=000.SessionStoreDefaultErrorRuleChain
LogInvalidSession=false
MapAttributes=DEG_SSL_ID,DEG_SSL_ID
MapAttributes=DEG_SSL_STATE,DEG_SSL_STATE
NotExistsErrorRuleChain=001.SessionStoreKeyNotExistsRuleChain
SessionStore=DEG_SSL_SESSION_SessionStore


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreErrorFlagInteger,=,1

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=100.ErrorLog
TrueRuleChain=120.GeneratePostChallengeSystemErrorEndAuditData
FalseRuleChain=200.CheckKeyExists


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/100.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_OEMDevHttpStatusInteger
Attributes=DEG_OEMDevRequestIdString
Attributes=DEG_OEMDevActionNameString
Attributes=DEG_OEMDevAuthTypeString
Attributes=DEG_OEMDevSubscriberIdString
Attributes=DEG_OEMDevErrorMessageString
Attributes=DEG_CDevProcessingErrorIdString
LogLevel=CRITICAL
Message=Database Error: while updating DEG_SSL_SESSION store
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_OEMDevRequestProcessedInteger 1
AdornOps=set DEG_SSL_REQUEST_STATE "500C"
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.PC.0208"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"

#Adding start and End Audits for all failure cases (400 and 500)
#QXCM1001445539 -- Invalid actions processed by DeviceInterface do not generate audit records

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/120.GeneratePostChallengeSystemErrorEndAuditData]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/200.CheckKeyExists]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=DEG_CDevSessionStoreKeyExistsFlagInteger,=,0

TrueRuleChain=100.SetErrorInfo
TrueRuleChain=110.ErrorLog

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/200.CheckKeyExists/100.SetErrorInfo]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevProcessingErrorIdString "DEG.DI.PC.0209"
AdornOps=set DEG_OEMDevErrorMessageString "Transient System Error"

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/212B.DEG20UpdateSslSessionStateRuleChain/410.CheckSslSessionUpdateStatus/200.CheckKeyExists/110.ErrorLog]

ClassName=com.hp.siu.collector.rules.LogNMERule
Attributes=DEG_OEMDevSslSessionIdString
Attributes=DEG_OEMDevImsiString
Attributes=DEG_MDN
Attributes=DEG_SUBSTOKEN
Attributes=DEG_TOKENSTATUS
Attributes=DEG_EVENTTIMESTAMP
Attributes=DEG_CDevProcessingErrorIdString
Attributes=DEG_OEMDevErrorMessageString
LogLevel=WARNING
Message=Database Error: Unable to find the row in DEG_SSL_SESSION store
NullAlso=true
PropertyName=LogRequestIssueLevel1
UseProperty=true
#Action=Bring up TimesTen if it is down.  If it is up and healthy and still this error is encountered, DEG DB objects or data may be corrupt.  Contact HP Support.


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/715.DEG20GeneratePostChallengeStartAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditNRBMessageAttribute
RuleNames=500.GenerateAuditAndNRBEvents

#QXCM1001509545--DEG_AuditNRBMessageString is set to "" for getAuthentication V2
[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/715.DEG20GeneratePostChallengeStartAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=copy DEG_CDevProcessStartTimeLong DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=set DEG_AuditDurationString 0
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "IN"
AdornOps=set DEG_AuditResultCodeString "0"
AdornOps=copy DEG_SSL_MDN DEG_MDN
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_SSL_IMSI DEG_OEMDevImsiString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "postChallenge"
AdornOps=copy DEG_OEMDevActionNameString DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/715.DEG20GeneratePostChallengeStartAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_AuditMessageString "DEVICE TO DEG -> Received "
AdornOps=+ DEG_AuditMessageString  DEG_OEMDevActionNameString DEG_AuditMessageString
AdornOps=set DEG_AuditMessageString1 " request:"
AdornOps=+ DEG_AuditMessageString DEG_AuditMessageString1 DEG_AuditMessageString

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/715.DEG20GeneratePostChallengeStartAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/715.DEG20GeneratePostChallengeStartAuditDataRuleChain/400.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString ""
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/715.DEG20GeneratePostChallengeStartAuditDataRuleChain/500.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/716.DEG20GeneratePostChallengeAAAAuthenticatedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/716.DEG20GeneratePostChallengeAAAAuthenticatedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]


ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "postChallenge"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/716.DEG20GeneratePostChallengeAAAAuthenticatedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending postChallengeV2 response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/716.DEG20GeneratePostChallengeAAAAuthenticatedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/716.DEG20GeneratePostChallengeAAAAuthenticatedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/716.DEG20GeneratePostChallengeAAAAuthenticatedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by AAA,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/716.DEG20GeneratePostChallengeAAAAuthenticatedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/717.DEG20GeneratePostChallengeAkaWaitEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/717.DEG20GeneratePostChallengeAkaWaitEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "postChallenge"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/717.DEG20GeneratePostChallengeAkaWaitEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending postChallengeV2 response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/717.DEG20GeneratePostChallengeAkaWaitEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/717.DEG20GeneratePostChallengeAkaWaitEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/717.DEG20GeneratePostChallengeAkaWaitEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Sent EAP-AKA message to Device,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/717.DEG20GeneratePostChallengeAkaWaitEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/718.DEG20GeneratePostChallengeDEGTokenAuthenticatedDefaultEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/718.DEG20GeneratePostChallengeDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "1"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "postChallenge"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/718.DEG20GeneratePostChallengeDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending postChallengeV2 response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/718.DEG20GeneratePostChallengeDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_TYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_TYPE DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_AUTHENTICATION_SUBTYPE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_AUTHENTICATION_SUBTYPE DEG_AuditMessageString


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/718.DEG20GeneratePostChallengeDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/718.DEG20GeneratePostChallengeDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Successful authentication by default,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/718.DEG20GeneratePostChallengeDEGTokenAuthenticatedDefaultEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/719.DEG20GeneratePostChallengeAkaRejectedEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/719.DEG20GeneratePostChallengeAkaRejectedEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "postChallenge"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/719.DEG20GeneratePostChallengeAkaRejectedEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending postChallengeV2 response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/719.DEG20GeneratePostChallengeAkaRejectedEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/719.DEG20GeneratePostChallengeAkaRejectedEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/719.DEG20GeneratePostChallengeAkaRejectedEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Authentication attempt rejected by AAA,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/719.DEG20GeneratePostChallengeAkaRejectedEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain]


ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.CheckDEG_SSL_REQUEST_STATE
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain/001.CheckDEG_SSL_REQUEST_STATE]

ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Operations=None

Conditions=DEG_SSL_REQUEST_STATE,=,"400C"
Conditions=DEG_SSL_REQUEST_STATE,=,"500C"

TrueRuleChain=Http400C
TrueRuleChain=Http500C

Http400C=100.Http400C_SetResultCode
Http500C=200.Http500C_SetResultCode

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain/001.CheckDEG_SSL_REQUEST_STATE/100.Http400C_SetResultCode]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevOutReturnCodeString "400"

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain/001.CheckDEG_SSL_REQUEST_STATE/200.Http500C_SetResultCode]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_CDevOutReturnCodeString "500"


#QXCM1001509545--DEG_AuditNRBMessageString is set to "" for getAuthentication V2
[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=setifnull DEG_CDevOutReturnCodeString "500"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_SSL_MDN DEG_MDN
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_SSL_IMSI DEG_OEMDevImsiString 
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "postChallenge"
AdornOps=copy DEG_OEMDevActionNameString DEG_AuditTransactionTypeString
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending "
AdornOps=+ DEG_AuditMessageString DEG_OEMDevActionNameString DEG_AuditMessageString
AdornOps=set DEG_AuditMessageString1 " response:"
AdornOps=+ DEG_AuditMessageString  DEG_AuditMessageString1 DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevErrorMessageString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevErrorMessageString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=copy DEG_OEMDevErrorMessageString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/720.DEG20GeneratePostChallengeSystemErrorEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/721.DEG20GeneratePostChallengeDisallowedActionEndAuditDataRuleChain]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.PopulateCommonAuditAttributes
RuleNames=200.PopulateAuditMessageAttribute_Header
RuleNames=300.PopulateAuditMessageAttribute_Append_Attributes
RuleNames=400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString
RuleNames=500.PopulateAuditNRBMessageAttribute
RuleNames=600.GenerateAuditAndNRBEvents


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/721.DEG20GeneratePostChallengeDisallowedActionEndAuditDataRuleChain/100.PopulateCommonAuditAttributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=setsystime DEG_AuditTimestampLong
AdornOps=copy DEG_SSL_ID DEG_AuditSessionIdString
AdornOps=- DEG_AuditTimestampLong DEG_CDevProcessStartTimeLong DEG_AuditDurationString
AdornOps=set DEG_AuditInterfaceString "HTTPS"
AdornOps=set DEG_AuditInOutString "OUT"
AdornOps=set DEG_CDevOutReturnCodeString "12"
AdornOps=copy DEG_CDevOutReturnCodeString DEG_AuditResultCodeString
AdornOps=copy DEG_MDN DEG_AuditMdnString
AdornOps=copy DEG_OEMDevImsiString DEG_AuditIMSIString
AdornOps=set DEG_AuditTransactionTypeString "postChallenge"
AdornOps=set DEG_AuditSourceDestinationString "Device"
AdornOps=copy DEG_OEMDevImsiString DEG_AuditChannelNameString
AdornOps=copy DEG_SSL_UNIQUE_ID DEG_AuditUniqueIDString
AdornOps=set DEG_AuditSourceDestinationVersionString "V2"
AdornOps=set DEG_AuditEntitlementNameString ""
AdornOps=copy DEG_OEMDevDeviceTypeString DEG_AuditDeviceTypeString



[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/721.DEG20GeneratePostChallengeDisallowedActionEndAuditDataRuleChain/200.PopulateAuditMessageAttribute_Header]

AdornOps=set DEG_AuditMessageString "DEG TO DEVICE -> Sending postChallengeV2 response: "
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/721.DEG20GeneratePostChallengeDisallowedActionEndAuditDataRuleChain/300.PopulateAuditMessageAttribute_Append_Attributes]

ClassName=com.hp.siu.collector.rules.AdornmentRule
AdornOps=set DEG_Tmp1String "DEG_MDN="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_MDN DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevImsiString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevImsiString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_OEMDevSubscriberIdString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_OEMDevSubscriberIdString DEG_AuditMessageString
AdornOps=set DEG_Tmp1String ", DEG_SSL_STATE="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_SSL_STATE DEG_AuditMessageString


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/721.DEG20GeneratePostChallengeDisallowedActionEndAuditDataRuleChain/400.PopulateAuditMessageAttribute_Append_DEG_CDevOutReturnCodeString]

AdornOps=set DEG_Tmp1String ", DEG_CDevOutReturnCodeString="
AdornOps=+ DEG_AuditMessageString DEG_Tmp1String DEG_AuditMessageString
AdornOps=+ DEG_AuditMessageString DEG_CDevOutReturnCodeString DEG_AuditMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule

#RFE 32- JSON Return code for JSON request/response in NRB GUI
[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/721.DEG20GeneratePostChallengeDisallowedActionEndAuditDataRuleChain/500.PopulateAuditNRBMessageAttribute]

AdornOps=set DEG_AuditNRBMessageString "Status Disallowed Action,Return code is "
AdornOps=+ DEG_AuditNRBMessageString DEG_OEMDevRespStatusString DEG_AuditNRBMessageString
ClassName=com.hp.siu.collector.rules.AdornmentRule


[/templates/DEG/DeviceInterface/PostChallenge_V2Core/RuleChains/721.DEG20GeneratePostChallengeDisallowedActionEndAuditDataRuleChain/600.GenerateAuditAndNRBEvents]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=650.DEG20GenerateAuditAndNRBEventsRuleChain
UseRuleChainManagerPool=true